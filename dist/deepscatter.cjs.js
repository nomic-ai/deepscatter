"use strict";var t="http://www.w3.org/1999/xhtml",e={svg:"http://www.w3.org/2000/svg",xhtml:t,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function n(t){var n=t+="",i=n.indexOf(":");return i>=0&&"xmlns"!==(n=t.slice(0,i))&&(t=t.slice(i+1)),e.hasOwnProperty(n)?{space:e[n],local:t}:t}function i(e){return function(){var n=this.ownerDocument,i=this.namespaceURI;return i===t&&n.documentElement.namespaceURI===t?n.createElement(e):n.createElementNS(i,e)}}function l(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function a(t){var e=n(t);return(e.local?l:i)(e)}function r(){}function o(t){return null==t?r:function(){return this.querySelector(t)}}function s(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function d(){return[]}function c(t){return null==t?d:function(){return this.querySelectorAll(t)}}function u(t){return function(){return this.matches(t)}}function h(t){return function(e){return e.matches(t)}}var p=Array.prototype.find;function m(){return this.firstElementChild}var b=Array.prototype.filter;function f(){return Array.from(this.children)}function y(t){return new Array(t.length)}function Z(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function X(t){return function(){return t}}function G(t,e,n,i,l,a){for(var r,o=0,s=e.length,d=a.length;o<d;++o)(r=e[o])?(r.__data__=a[o],i[o]=r):n[o]=new Z(t,a[o]);for(;o<s;++o)(r=e[o])&&(l[o]=r)}function V(t,e,n,i,l,a,r){var o,s,d,c=new Map,u=e.length,h=a.length,p=new Array(u);for(o=0;o<u;++o)(s=e[o])&&(p[o]=d=r.call(s,s.__data__,o,e)+"",c.has(d)?l[o]=s:c.set(d,s));for(o=0;o<h;++o)d=r.call(t,a[o],o,a)+"",(s=c.get(d))?(i[o]=s,s.__data__=a[o],c.delete(d)):n[o]=new Z(t,a[o]);for(o=0;o<u;++o)(s=e[o])&&c.get(p[o])===s&&(l[o]=s)}function W(t){return t.__data__}function R(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function g(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function v(t){return function(){this.removeAttribute(t)}}function x(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _(t,e){return function(){this.setAttribute(t,e)}}function K(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function S(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Y(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function L(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function H(t){return function(){this.style.removeProperty(t)}}function C(t,e,n){return function(){this.style.setProperty(t,e,n)}}function N(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function J(t,e){return t.style.getPropertyValue(e)||L(t).getComputedStyle(t,null).getPropertyValue(e)}function k(t){return function(){delete this[t]}}function z(t,e){return function(){this[t]=e}}function I(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function w(t){return t.trim().split(/^|\s+/)}function T(t){return t.classList||new F(t)}function F(t){this._node=t,this._names=w(t.getAttribute("class")||"")}function Q(t,e){for(var n=T(t),i=-1,l=e.length;++i<l;)n.add(e[i])}function M(t,e){for(var n=T(t),i=-1,l=e.length;++i<l;)n.remove(e[i])}function B(t){return function(){Q(this,t)}}function U(t){return function(){M(this,t)}}function j(t,e){return function(){(e.apply(this,arguments)?Q:M)(this,t)}}function P(){this.textContent=""}function E(t){return function(){this.textContent=t}}function O(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function D(){this.innerHTML=""}function A(t){return function(){this.innerHTML=t}}function q(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function $(){this.nextSibling&&this.parentNode.appendChild(this)}function tt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function et(){return null}function nt(){var t=this.parentNode;t&&t.removeChild(this)}function it(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function lt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function at(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function rt(t){return function(){var e=this.__on;if(e){for(var n,i=0,l=-1,a=e.length;i<a;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++l]=n:this.removeEventListener(n.type,n.listener,n.options);++l?e.length=l:delete this.__on}}}function ot(t,e,n){return function(){var i,l=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(l)for(var r=0,o=l.length;r<o;++r)if((i=l[r]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),void(i.value=e);this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},l?l.push(i):this.__on=[i]}}function st(t,e,n){var i=L(t),l=i.CustomEvent;"function"==typeof l?l=new l(e,n):(l=i.document.createEvent("Event"),n?(l.initEvent(e,n.bubbles,n.cancelable),l.detail=n.detail):l.initEvent(e,!1,!1)),t.dispatchEvent(l)}function dt(t,e){return function(){return st(this,t,e)}}function ct(t,e){return function(){return st(this,t,e.apply(this,arguments))}}Z.prototype={constructor:Z,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},F.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ut=[null];function ht(t,e){this._groups=t,this._parents=e}function pt(){return new ht([[document.documentElement]],ut)}function mt(t){return"string"==typeof t?new ht([[document.querySelector(t)]],[document.documentElement]):new ht([[t]],ut)}function bt(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var l=e.getBoundingClientRect();return[t.clientX-l.left-e.clientLeft,t.clientY-l.top-e.clientTop]}}return[t.pageX,t.pageY]}function ft(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function yt(t){let e=t,n=t,i=t;function l(t,e,l=0,a=t.length){if(l<a){if(0!==n(e,e))return a;do{const n=l+a>>>1;i(t[n],e)<0?l=n+1:a=n}while(l<a)}return l}return 2!==t.length&&(e=(e,n)=>t(e)-n,n=ft,i=(e,n)=>ft(t(e),n)),{left:l,center:function(t,n,i=0,a=t.length){const r=l(t,n,i,a-1);return r>i&&e(t[r-1],n)>-e(t[r],n)?r-1:r},right:function(t,e,l=0,a=t.length){if(l<a){if(0!==n(e,e))return a;do{const n=l+a>>>1;i(t[n],e)<=0?l=n+1:a=n}while(l<a)}return l}}}ht.prototype=pt.prototype={constructor:ht,select:function(t){"function"!=typeof t&&(t=o(t));for(var e=this._groups,n=e.length,i=new Array(n),l=0;l<n;++l)for(var a,r,s=e[l],d=s.length,c=i[l]=new Array(d),u=0;u<d;++u)(a=s[u])&&(r=t.call(a,a.__data__,u,s))&&("__data__"in a&&(r.__data__=a.__data__),c[u]=r);return new ht(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return s(t.apply(this,arguments))}}(t):c(t);for(var e=this._groups,n=e.length,i=[],l=[],a=0;a<n;++a)for(var r,o=e[a],d=o.length,u=0;u<d;++u)(r=o[u])&&(i.push(t.call(r,r.__data__,u,o)),l.push(r));return new ht(i,l)},selectChild:function(t){return this.select(null==t?m:function(t){return function(){return p.call(this.children,t)}}("function"==typeof t?t:h(t)))},selectChildren:function(t){return this.selectAll(null==t?f:function(t){return function(){return b.call(this.children,t)}}("function"==typeof t?t:h(t)))},filter:function(t){"function"!=typeof t&&(t=u(t));for(var e=this._groups,n=e.length,i=new Array(n),l=0;l<n;++l)for(var a,r=e[l],o=r.length,s=i[l]=[],d=0;d<o;++d)(a=r[d])&&t.call(a,a.__data__,d,r)&&s.push(a);return new ht(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,W);var n=e?V:G,i=this._parents,l=this._groups;"function"!=typeof t&&(t=X(t));for(var a=l.length,r=new Array(a),o=new Array(a),s=new Array(a),d=0;d<a;++d){var c=i[d],u=l[d],h=u.length,p=R(t.call(c,c&&c.__data__,d,i)),m=p.length,b=o[d]=new Array(m),f=r[d]=new Array(m),y=s[d]=new Array(h);n(c,u,b,f,y,p,e);for(var Z,g,v=0,x=0;v<m;++v)if(Z=b[v]){for(v>=x&&(x=v+1);!(g=f[x])&&++x<m;);Z._next=g||null}}return(r=new ht(r,i))._enter=o,r._exit=s,r},enter:function(){return new ht(this._enter||this._groups.map(y),this._parents)},exit:function(){return new ht(this._exit||this._groups.map(y),this._parents)},join:function(t,e,n){var i=this.enter(),l=this,a=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(l=e(l))&&(l=l.selection()),null==n?a.remove():n(a),i&&l?i.merge(l).order():l},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,l=n.length,a=i.length,r=Math.min(l,a),o=new Array(l),s=0;s<r;++s)for(var d,c=n[s],u=i[s],h=c.length,p=o[s]=new Array(h),m=0;m<h;++m)(d=c[m]||u[m])&&(p[m]=d);for(;s<l;++s)o[s]=n[s];return new ht(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,l=t[e],a=l.length-1,r=l[a];--a>=0;)(i=l[a])&&(r&&4^i.compareDocumentPosition(r)&&r.parentNode.insertBefore(i,r),r=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=g);for(var n=this._groups,i=n.length,l=new Array(i),a=0;a<i;++a){for(var r,o=n[a],s=o.length,d=l[a]=new Array(s),c=0;c<s;++c)(r=o[c])&&(d[c]=r);d.sort(e)}return new ht(l,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],l=0,a=i.length;l<a;++l){var r=i[l];if(r)return r}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var l,a=e[n],r=0,o=a.length;r<o;++r)(l=a[r])&&t.call(l,l.__data__,r,a);return this},attr:function(t,e){var i=n(t);if(arguments.length<2){var l=this.node();return i.local?l.getAttributeNS(i.space,i.local):l.getAttribute(i)}return this.each((null==e?i.local?x:v:"function"==typeof e?i.local?Y:S:i.local?K:_)(i,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?H:"function"==typeof e?N:C)(t,e,null==n?"":n)):J(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?k:"function"==typeof e?I:z)(t,e)):this.node()[t]},classed:function(t,e){var n=w(t+"");if(arguments.length<2){for(var i=T(this.node()),l=-1,a=n.length;++l<a;)if(!i.contains(n[l]))return!1;return!0}return this.each(("function"==typeof e?j:e?B:U)(n,e))},text:function(t){return arguments.length?this.each(null==t?P:("function"==typeof t?O:E)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?D:("function"==typeof t?q:A)(t)):this.node().innerHTML},raise:function(){return this.each($)},lower:function(){return this.each(tt)},append:function(t){var e="function"==typeof t?t:a(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:a(t),i=null==e?et:"function"==typeof e?e:o(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(nt)},clone:function(t){return this.select(t?lt:it)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,l,a=at(t+""),r=a.length;if(!(arguments.length<2)){for(o=e?ot:rt,i=0;i<r;++i)this.each(o(a[i],e,n));return this}var o=this.node().__on;if(o)for(var s,d=0,c=o.length;d<c;++d)for(i=0,s=o[d];i<r;++i)if((l=a[i]).type===s.type&&l.name===s.name)return s.value},dispatch:function(t,e){return this.each(("function"==typeof e?ct:dt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,l=t[e],a=0,r=l.length;a<r;++a)(i=l[a])&&(yield i)}};const Zt=yt(ft),Xt=Zt.right,Gt=Zt.left;function Vt(t,e){let n,i;if(void 0===e)for(const l of t)null!=l&&(void 0===n?l>=l&&(n=i=l):(n>l&&(n=l),i<l&&(i=l)));else{let l=-1;for(let a of t)null!=(a=e(a,++l,t))&&(void 0===n?a>=a&&(n=i=a):(n>a&&(n=a),i<a&&(i=a)))}return[n,i]}yt((function(t){return null===t?NaN:+t})).center;class Wt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const l=e[i],a=t+l,r=Math.abs(t)<Math.abs(l)?t-(a-l):l-(a-t);r&&(e[n++]=r),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,i,l=this._n,a=0;if(l>0){for(a=t[--l];l>0&&(e=a,n=t[--l],a=e+n,i=n-(a-e),!i););l>0&&(i<0&&t[l-1]<0||i>0&&t[l-1]>0)&&(n=2*i,e=a+n,n==e-a&&(a=e))}return a}}class Rt extends Map{constructor(t,e=vt){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(gt(this,t))}has(t){return super.has(gt(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const i=e(n);t.has(i)&&(n=t.get(n),t.delete(i));return n}(this,t))}}function gt({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function vt(t){return null!==t&&"object"==typeof t?t.valueOf():t}var xt=Math.sqrt(50),_t=Math.sqrt(10),Kt=Math.sqrt(2);function St(t,e,n){var i,l,a,r,o=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(l=t,t=e,e=l),0===(r=Yt(t,e,n))||!isFinite(r))return[];if(r>0){let n=Math.round(t/r),i=Math.round(e/r);for(n*r<t&&++n,i*r>e&&--i,a=new Array(l=i-n+1);++o<l;)a[o]=(n+o)*r}else{r=-r;let n=Math.round(t*r),i=Math.round(e*r);for(n/r<t&&++n,i/r>e&&--i,a=new Array(l=i-n+1);++o<l;)a[o]=(n+o)/r}return i&&a.reverse(),a}function Yt(t,e,n){var i=(e-t)/Math.max(0,n),l=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,l);return l>=0?(a>=xt?10:a>=_t?5:a>=Kt?2:1)*Math.pow(10,l):-Math.pow(10,-l)/(a>=xt?10:a>=_t?5:a>=Kt?2:1)}function Lt(t,e){let n;if(void 0===e)for(const i of t)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let l of t)null!=(l=e(l,++i,t))&&(n<l||void 0===n&&l>=l)&&(n=l)}return n}function Ht(t,e){let n;if(void 0===e)for(const i of t)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let l of t)null!=(l=e(l,++i,t))&&(n>l||void 0===n&&l>=l)&&(n=l)}return n}function Ct(t,e){let n=0,i=0;if(void 0===e)for(let l of t)null!=l&&(l=+l)>=l&&(++n,i+=l);else{let l=-1;for(let a of t)null!=(a=e(a,++l,t))&&(a=+a)>=a&&(++n,i+=a)}if(n)return i/n}function Nt(t,e,n){t=+t,e=+e,n=(l=arguments.length)<2?(e=t,t=0,1):l<3?1:+n;for(var i=-1,l=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(l);++i<l;)a[i]=t+i*n;return a}var Jt,kt=(Jt=Math.random,function(t,e=0,n=t.length){let i=n-(e=+e);for(;i;){const n=Jt()*i--|0,l=t[i+e];t[i+e]=t[n+e],t[n+e]=l}return t});var zt=Math.PI,It=2*zt,wt=180/zt,Tt=zt/180,Ft=Math.abs,Qt=Math.cos,Mt=Math.sin,Bt=Math.sqrt;function Ut(){}function jt(t,e){t&&Et.hasOwnProperty(t.type)&&Et[t.type](t,e)}var Pt={Feature:function(t,e){jt(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,l=n.length;++i<l;)jt(n[i].geometry,e)}},Et={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,l=n.length;++i<l;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Ot(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,l=n.length;++i<l;)Ot(n[i],e,0)},Polygon:function(t,e){Dt(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,l=n.length;++i<l;)Dt(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,l=n.length;++i<l;)jt(n[i],e)}};function Ot(t,e,n){var i,l=-1,a=t.length-n;for(e.lineStart();++l<a;)i=t[l],e.point(i[0],i[1],i[2]);e.lineEnd()}function Dt(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Ot(t[n],e,1);e.polygonEnd()}function At(t,e){t&&Pt.hasOwnProperty(t.type)?Pt[t.type](t,e):jt(t,e)}function qt(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function $t(t,e,n,i,l){var a,r,o=[],s=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i,r,d=t[0],c=t[e];if(r=c,Ft((i=d)[0]-r[0])<1e-6&&Ft(i[1]-r[1])<1e-6){if(!d[2]&&!c[2]){for(l.lineStart(),a=0;a<e;++a)l.point((d=t[a])[0],d[1]);return void l.lineEnd()}c[0]+=2e-6}o.push(n=new qt(d,t,null,!0)),s.push(n.o=new qt(d,null,n,!1)),o.push(n=new qt(c,t,null,!1)),s.push(n.o=new qt(c,null,n,!0))}})),o.length){for(s.sort(e),te(o),te(s),a=0,r=s.length;a<r;++a)s[a].e=n=!n;for(var d,c,u=o[0];;){for(var h=u,p=!0;h.v;)if((h=h.n)===u)return;d=h.z,l.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(a=0,r=d.length;a<r;++a)l.point((c=d[a])[0],c[1]);else i(h.x,h.n.x,1,l);h=h.n}else{if(p)for(d=h.p.z,a=d.length-1;a>=0;--a)l.point((c=d[a])[0],c[1]);else i(h.x,h.p.x,-1,l);h=h.p}d=(h=h.o).z,p=!p}while(!h.v);l.lineEnd()}}}function te(t){if(e=t.length){for(var e,n,i=0,l=t[0];++i<e;)l.n=n=t[i],n.p=l,l=n;l.n=n=t[0],n.p=l}}function ee(t,e,n,i){function l(l,a){return t<=l&&l<=n&&e<=a&&a<=i}function a(l,a,o,d){var c=0,u=0;if(null==l||(c=r(l,o))!==(u=r(a,o))||s(l,a)<0^o>0)do{d.point(0===c||3===c?t:n,c>1?i:e)}while((c=(c+o+4)%4)!==u);else d.point(a[0],a[1])}function r(i,l){return Ft(i[0]-t)<1e-6?l>0?0:3:Ft(i[0]-n)<1e-6?l>0?2:1:Ft(i[1]-e)<1e-6?l>0?1:0:l>0?3:2}function o(t,e){return s(t.x,e.x)}function s(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(r){var s,d,c,u,h,p,m,b,f,y,Z,X,G,V=r,W=(G=[],{point:function(t,e,n){X.push([t,e,n])},lineStart:function(){G.push(X=[])},lineEnd:Ut,rejoin:function(){G.length>1&&G.push(G.pop().concat(G.shift()))},result:function(){var t=G;return G=[],X=null,t}}),R={point:g,lineStart:function(){R.point=v,d&&d.push(c=[]);y=!0,f=!1,m=b=NaN},lineEnd:function(){s&&(v(u,h),p&&f&&W.rejoin(),s.push(W.result()));R.point=g,f&&V.lineEnd()},polygonStart:function(){V=W,s=[],d=[],Z=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,l=d.length;n<l;++n)for(var a,r,o=d[n],s=1,c=o.length,u=o[0],h=u[0],p=u[1];s<c;++s)a=h,r=p,h=(u=o[s])[0],p=u[1],r<=i?p>i&&(h-a)*(i-r)>(p-r)*(t-a)&&++e:p<=i&&(h-a)*(i-r)<(p-r)*(t-a)&&--e;return e}(),n=Z&&e,l=(u=s,s=Array.from(function*(t){for(const e of t)yield*e}(u))).length;var u;(n||l)&&(r.polygonStart(),n&&(r.lineStart(),a(null,null,1,r),r.lineEnd()),l&&$t(s,o,e,a,r),r.polygonEnd());V=r,s=d=c=null}};function g(t,e){l(t,e)&&V.point(t,e)}function v(a,r){var o=l(a,r);if(d&&c.push([a,r]),y)u=a,h=r,p=o,y=!1,o&&(V.lineStart(),V.point(a,r));else if(o&&f)V.point(a,r);else{var s=[m=Math.max(-1e9,Math.min(1e9,m)),b=Math.max(-1e9,Math.min(1e9,b))],X=[a=Math.max(-1e9,Math.min(1e9,a)),r=Math.max(-1e9,Math.min(1e9,r))];!function(t,e,n,i,l,a){var r,o=t[0],s=t[1],d=0,c=1,u=e[0]-o,h=e[1]-s;if(r=n-o,u||!(r>0)){if(r/=u,u<0){if(r<d)return;r<c&&(c=r)}else if(u>0){if(r>c)return;r>d&&(d=r)}if(r=l-o,u||!(r<0)){if(r/=u,u<0){if(r>c)return;r>d&&(d=r)}else if(u>0){if(r<d)return;r<c&&(c=r)}if(r=i-s,h||!(r>0)){if(r/=h,h<0){if(r<d)return;r<c&&(c=r)}else if(h>0){if(r>c)return;r>d&&(d=r)}if(r=a-s,h||!(r<0)){if(r/=h,h<0){if(r>c)return;r>d&&(d=r)}else if(h>0){if(r<d)return;r<c&&(c=r)}return d>0&&(t[0]=o+d*u,t[1]=s+d*h),c<1&&(e[0]=o+c*u,e[1]=s+c*h),!0}}}}}(s,X,t,e,n,i)?o&&(V.lineStart(),V.point(a,r),Z=!1):(f||(V.lineStart(),V.point(s[0],s[1])),V.point(X[0],X[1]),o||V.lineEnd(),Z=!1)}m=a,b=r,f=o}return R}}var ne,ie,le,ae,re=t=>t,oe=new Wt,se=new Wt,de={point:Ut,lineStart:Ut,lineEnd:Ut,polygonStart:function(){de.lineStart=ce,de.lineEnd=pe},polygonEnd:function(){de.lineStart=de.lineEnd=de.point=Ut,oe.add(Ft(se)),se=new Wt},result:function(){var t=oe/2;return oe=new Wt,t}};function ce(){de.point=ue}function ue(t,e){de.point=he,ne=le=t,ie=ae=e}function he(t,e){se.add(ae*t-le*e),le=t,ae=e}function pe(){he(ne,ie)}var me=de,be=1/0,fe=be,ye=-be,Ze=ye;var Xe,Ge,Ve,We,Re={point:function(t,e){t<be&&(be=t);t>ye&&(ye=t);e<fe&&(fe=e);e>Ze&&(Ze=e)},lineStart:Ut,lineEnd:Ut,polygonStart:Ut,polygonEnd:Ut,result:function(){var t=[[be,fe],[ye,Ze]];return ye=Ze=-(fe=be=1/0),t}},ge=0,ve=0,xe=0,_e=0,Ke=0,Se=0,Ye=0,Le=0,He=0,Ce={point:Ne,lineStart:Je,lineEnd:Ie,polygonStart:function(){Ce.lineStart=we,Ce.lineEnd=Te},polygonEnd:function(){Ce.point=Ne,Ce.lineStart=Je,Ce.lineEnd=Ie},result:function(){var t=He?[Ye/He,Le/He]:Se?[_e/Se,Ke/Se]:xe?[ge/xe,ve/xe]:[NaN,NaN];return ge=ve=xe=_e=Ke=Se=Ye=Le=He=0,t}};function Ne(t,e){ge+=t,ve+=e,++xe}function Je(){Ce.point=ke}function ke(t,e){Ce.point=ze,Ne(Ve=t,We=e)}function ze(t,e){var n=t-Ve,i=e-We,l=Bt(n*n+i*i);_e+=l*(Ve+t)/2,Ke+=l*(We+e)/2,Se+=l,Ne(Ve=t,We=e)}function Ie(){Ce.point=Ne}function we(){Ce.point=Fe}function Te(){Qe(Xe,Ge)}function Fe(t,e){Ce.point=Qe,Ne(Xe=Ve=t,Ge=We=e)}function Qe(t,e){var n=t-Ve,i=e-We,l=Bt(n*n+i*i);_e+=l*(Ve+t)/2,Ke+=l*(We+e)/2,Se+=l,Ye+=(l=We*t-Ve*e)*(Ve+t),Le+=l*(We+e),He+=3*l,Ne(Ve=t,We=e)}var Me=Ce;function Be(t){this._context=t}Be.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,It)}},result:Ut};var Ue,je,Pe,Ee,Oe,De=new Wt,Ae={point:Ut,lineStart:function(){Ae.point=qe},lineEnd:function(){Ue&&$e(je,Pe),Ae.point=Ut},polygonStart:function(){Ue=!0},polygonEnd:function(){Ue=null},result:function(){var t=+De;return De=new Wt,t}};function qe(t,e){Ae.point=$e,je=Ee=t,Pe=Oe=e}function $e(t,e){Ee-=t,Oe-=e,De.add(Bt(Ee*Ee+Oe*Oe)),Ee=t,Oe=e}var tn=Ae;function en(){this._string=[]}function nn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function ln(t,e){var n,i,l=4.5;function a(t){return t&&("function"==typeof l&&i.pointRadius(+l.apply(this,arguments)),At(t,n(i))),i.result()}return a.area=function(t){return At(t,n(me)),me.result()},a.measure=function(t){return At(t,n(tn)),tn.result()},a.bounds=function(t){return At(t,n(Re)),Re.result()},a.centroid=function(t){return At(t,n(Me)),Me.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,re):(t=e).stream,a):t},a.context=function(t){return arguments.length?(i=null==t?(e=null,new en):new Be(e=t),"function"!=typeof l&&i.pointRadius(l),a):e},a.pointRadius=function(t){return arguments.length?(l="function"==typeof t?t:(i.pointRadius(+t),+t),a):l},a.projection(t).context(e)}function an(){}function rn(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),At(n,t.stream(Re)),e(Re.result()),null!=i&&t.clipExtent(i),t}function on(t,e,n){return rn(t,(function(n){var i=e[1][0]-e[0][0],l=e[1][1]-e[0][1],a=Math.min(i/(n[1][0]-n[0][0]),l/(n[1][1]-n[0][1])),r=+e[0][0]+(i-a*(n[1][0]+n[0][0]))/2,o=+e[0][1]+(l-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([r,o])}),n)}function sn(){var t,e,n,i,l,a,r,o,s=1,d=0,c=0,u=1,h=1,p=0,m=null,b=1,f=1,y=(o={point:function(t,e){var n=G([t,e]);this.stream.point(n[0],n[1])}},function(t){var e=new an;for(var n in o)e[n]=o[n];return e.stream=t,e}),Z=re;function X(){return b=s*u,f=s*h,a=r=null,G}function G(n){var i=n[0]*b,l=n[1]*f;if(p){var a=l*t-i*e;i=i*t+l*e,l=a}return[i+d,l+c]}return G.invert=function(n){var i=n[0]-d,l=n[1]-c;if(p){var a=l*t+i*e;i=i*t-l*e,l=a}return[i/b,l/f]},G.stream=function(t){return a&&r===t?a:a=y(Z(r=t))},G.postclip=function(t){return arguments.length?(Z=t,m=n=i=l=null,X()):Z},G.clipExtent=function(t){return arguments.length?(Z=null==t?(m=n=i=l=null,re):ee(m=+t[0][0],n=+t[0][1],i=+t[1][0],l=+t[1][1]),X()):null==m?null:[[m,n],[i,l]]},G.scale=function(t){return arguments.length?(s=+t,X()):s},G.translate=function(t){return arguments.length?(d=+t[0],c=+t[1],X()):[d,c]},G.angle=function(n){return arguments.length?(e=Mt(p=n%360*Tt),t=Qt(p),X()):p*wt},G.reflectX=function(t){return arguments.length?(u=t?-1:1,X()):u<0},G.reflectY=function(t){return arguments.length?(h=t?-1:1,X()):h<0},G.fitExtent=function(t,e){return on(G,t,e)},G.fitSize=function(t,e){return function(t,e,n){return on(t,[[0,0],e],n)}(G,t,e)},G.fitWidth=function(t,e){return function(t,e,n){return rn(t,(function(n){var i=+e,l=i/(n[1][0]-n[0][0]),a=(i-l*(n[1][0]+n[0][0]))/2,r=-l*n[0][1];t.scale(150*l).translate([a,r])}),n)}(G,t,e)},G.fitHeight=function(t,e){return function(t,e,n){return rn(t,(function(n){var i=+e,l=i/(n[1][1]-n[0][1]),a=-l*n[0][0],r=(i-l*(n[1][1]+n[0][1]))/2;t.scale(150*l).translate([a,r])}),n)}(G,t,e)},G}en.prototype={_radius:4.5,_circle:nn(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=nn(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},an.prototype={constructor:an,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var dn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},cn={exports:{}};!function(t,e){var n="__lodash_hash_undefined__",i=9007199254740991,l="[object Arguments]",a="[object Function]",r="[object Object]",o=/^\[object .+?Constructor\]$/,s=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[l]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d[a]=d["[object Map]"]=d["[object Number]"]=d[r]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1;var c="object"==typeof dn&&dn&&dn.Object===Object&&dn,u="object"==typeof self&&self&&self.Object===Object&&self,h=c||u||Function("return this")(),p=e&&!e.nodeType&&e,m=p&&t&&!t.nodeType&&t,b=m&&m.exports===p,f=b&&c.process,y=function(){try{var t=m&&m.require&&m.require("util").types;return t||f&&f.binding&&f.binding("util")}catch(e){}}(),Z=y&&y.isTypedArray;function X(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var G,V,W,R=Array.prototype,g=Function.prototype,v=Object.prototype,x=h["__core-js_shared__"],_=g.toString,K=v.hasOwnProperty,S=(G=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",Y=v.toString,L=_.call(Object),H=RegExp("^"+_.call(K).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=b?h.Buffer:void 0,N=h.Symbol,J=h.Uint8Array,k=C?C.allocUnsafe:void 0,z=(V=Object.getPrototypeOf,W=Object,function(t){return V(W(t))}),I=Object.create,w=v.propertyIsEnumerable,T=R.splice,F=N?N.toStringTag:void 0,Q=function(){try{var t=mt(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),M=C?C.isBuffer:void 0,B=Math.max,U=Date.now,j=mt(h,"Map"),P=mt(Object,"create"),E=function(){function t(){}return function(e){if(!xt(e))return{};if(I)return I(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function O(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function D(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function A(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function q(t){var e=this.__data__=new D(t);this.size=e.size}function $(t,e){var n=Vt(t),i=!n&&Gt(t),l=!n&&!i&&Rt(t),a=!n&&!i&&!l&&Kt(t),r=n||i||l||a,o=r?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],s=o.length;for(var d in t)!e&&!K.call(t,d)||r&&("length"==d||l&&("offset"==d||"parent"==d)||a&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||bt(d,s))||o.push(d);return o}function tt(t,e,n){(void 0!==n&&!Xt(t[e],n)||void 0===n&&!(e in t))&&it(t,e,n)}function et(t,e,n){var i=t[e];K.call(t,e)&&Xt(i,n)&&(void 0!==n||e in t)||it(t,e,n)}function nt(t,e){for(var n=t.length;n--;)if(Xt(t[n][0],e))return n;return-1}function it(t,e,n){"__proto__"==e&&Q?Q(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}O.prototype.clear=function(){this.__data__=P?P(null):{},this.size=0},O.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},O.prototype.get=function(t){var e=this.__data__;if(P){var i=e[t];return i===n?void 0:i}return K.call(e,t)?e[t]:void 0},O.prototype.has=function(t){var e=this.__data__;return P?void 0!==e[t]:K.call(e,t)},O.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=P&&void 0===e?n:e,this},D.prototype.clear=function(){this.__data__=[],this.size=0},D.prototype.delete=function(t){var e=this.__data__,n=nt(e,t);return!(n<0)&&(n==e.length-1?e.pop():T.call(e,n,1),--this.size,!0)},D.prototype.get=function(t){var e=this.__data__,n=nt(e,t);return n<0?void 0:e[n][1]},D.prototype.has=function(t){return nt(this.__data__,t)>-1},D.prototype.set=function(t,e){var n=this.__data__,i=nt(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},A.prototype.clear=function(){this.size=0,this.__data__={hash:new O,map:new(j||D),string:new O}},A.prototype.delete=function(t){var e=pt(this,t).delete(t);return this.size-=e?1:0,e},A.prototype.get=function(t){return pt(this,t).get(t)},A.prototype.has=function(t){return pt(this,t).has(t)},A.prototype.set=function(t,e){var n=pt(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},q.prototype.clear=function(){this.__data__=new D,this.size=0},q.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},q.prototype.get=function(t){return this.__data__.get(t)},q.prototype.has=function(t){return this.__data__.has(t)},q.prototype.set=function(t,e){var n=this.__data__;if(n instanceof D){var i=n.__data__;if(!j||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new A(i)}return n.set(t,e),this.size=n.size,this};var lt,at=function(t,e,n){for(var i=-1,l=Object(t),a=n(t),r=a.length;r--;){var o=a[lt?r:++i];if(!1===e(l[o],o,l))break}return t};function rt(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":F&&F in Object(t)?function(t){var e=K.call(t,F),n=t[F];try{t[F]=void 0;var i=!0}catch(a){}var l=Y.call(t);i&&(e?t[F]=n:delete t[F]);return l}(t):function(t){return Y.call(t)}(t)}function ot(t){return _t(t)&&rt(t)==l}function st(t){return!(!xt(t)||function(t){return!!S&&S in t}(t))&&(gt(t)?H:o).test(function(t){if(null!=t){try{return _.call(t)}catch(e){}try{return t+""}catch(e){}}return""}(t))}function dt(t){if(!xt(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=ft(t),n=[];for(var i in t)("constructor"!=i||!e&&K.call(t,i))&&n.push(i);return n}function ct(t,e,n,i,l){t!==e&&at(e,(function(a,o){if(l||(l=new q),xt(a))!function(t,e,n,i,l,a,o){var s=yt(t,n),d=yt(e,n),c=o.get(d);if(c)return void tt(t,n,c);var u=a?a(s,d,n+"",t,e,o):void 0,h=void 0===u;if(h){var p=Vt(d),m=!p&&Rt(d),b=!p&&!m&&Kt(d);u=d,p||m||b?Vt(s)?u=s:_t(G=s)&&Wt(G)?u=function(t,e){var n=-1,i=t.length;e||(e=Array(i));for(;++n<i;)e[n]=t[n];return e}(s):m?(h=!1,u=function(t,e){if(e)return t.slice();var n=t.length,i=k?k(n):new t.constructor(n);return t.copy(i),i}(d,!0)):b?(h=!1,f=d,y=!0?(Z=f.buffer,X=new Z.constructor(Z.byteLength),new J(X).set(new J(Z)),X):f.buffer,u=new f.constructor(y,f.byteOffset,f.length)):u=[]:function(t){if(!_t(t)||rt(t)!=r)return!1;var e=z(t);if(null===e)return!0;var n=K.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&_.call(n)==L}(d)||Gt(d)?(u=s,Gt(s)?u=function(t){return function(t,e,n,i){var l=!n;n||(n={});var a=-1,r=e.length;for(;++a<r;){var o=e[a],s=i?i(n[o],t[o],o,n,t):void 0;void 0===s&&(s=t[o]),l?it(n,o,s):et(n,o,s)}return n}(t,St(t))}(s):xt(s)&&!gt(s)||(u=function(t){return"function"!=typeof t.constructor||ft(t)?{}:E(z(t))}(d))):h=!1}var f,y,Z,X;var G;h&&(o.set(d,u),l(u,d,i,a,o),o.delete(d));tt(t,n,u)}(t,e,o,n,ct,i,l);else{var s=i?i(yt(t,o),a,o+"",t,e,l):void 0;void 0===s&&(s=a),tt(t,o,s)}}),St)}function ut(t,e){return Zt(function(t,e,n){return e=B(void 0===e?t.length-1:e,0),function(){for(var i=arguments,l=-1,a=B(i.length-e,0),r=Array(a);++l<a;)r[l]=i[e+l];l=-1;for(var o=Array(e+1);++l<e;)o[l]=i[l];return o[e]=n(r),X(t,this,o)}}(t,e,Ht),t+"")}var ht=Q?function(t,e){return Q(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Ht;function pt(t,e){var n,i,l=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?l["string"==typeof e?"string":"hash"]:l.map}function mt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return st(n)?n:void 0}function bt(t,e){var n=typeof t;return!!(e=null==e?i:e)&&("number"==n||"symbol"!=n&&s.test(t))&&t>-1&&t%1==0&&t<e}function ft(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||v)}function yt(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Zt=function(t){var e=0,n=0;return function(){var i=U(),l=16-(i-n);if(n=i,l>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(ht);function Xt(t,e){return t===e||t!=t&&e!=e}var Gt=ot(function(){return arguments}())?ot:function(t){return _t(t)&&K.call(t,"callee")&&!w.call(t,"callee")},Vt=Array.isArray;function Wt(t){return null!=t&&vt(t.length)&&!gt(t)}var Rt=M||function(){return!1};function gt(t){if(!xt(t))return!1;var e=rt(t);return e==a||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function vt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}function xt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function _t(t){return null!=t&&"object"==typeof t}var Kt=Z?function(t){return function(e){return t(e)}}(Z):function(t){return _t(t)&&vt(t.length)&&!!d[rt(t)]};function St(t){return Wt(t)?$(t,!0):dt(t)}var Yt,Lt=(Yt=function(t,e,n){ct(t,e,n)},ut((function(t,e){var n=-1,i=e.length,l=i>1?e[i-1]:void 0,a=i>2?e[2]:void 0;for(l=Yt.length>3&&"function"==typeof l?(i--,l):void 0,a&&function(t,e,n){if(!xt(n))return!1;var i=typeof e;return!!("number"==i?Wt(n)&&bt(e,n.length):"string"==i&&e in n)&&Xt(n[e],t)}(e[0],e[1],a)&&(l=i<3?void 0:l,i=1),t=Object(t);++n<i;){var r=e[n];r&&Yt(t,r,n,l)}return t})));function Ht(t){return t}t.exports=Lt}(cn,cn.exports);var un,hn,pn=cn.exports,mn=0,bn=0,fn=0,yn=0,Zn=0,Xn=0,Gn="object"==typeof performance&&performance.now?performance:Date,Vn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Wn(){return Zn||(Vn(Rn),Zn=Gn.now()+Xn)}function Rn(){Zn=0}function gn(){this._call=this._time=this._next=null}function vn(t,e,n){var i=new gn;return i.restart(t,e,n),i}function xn(){Zn=(yn=Gn.now())+Xn,mn=bn=0;try{!function(){Wn(),++mn;for(var t,e=un;e;)(t=Zn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--mn}()}finally{mn=0,function(){var t,e,n=un,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:un=e);hn=t,Kn(i)}(),Zn=0}}function _n(){var t=Gn.now(),e=t-yn;e>1e3&&(Xn-=e,yn=t)}function Kn(t){mn||(bn&&(bn=clearTimeout(bn)),t-Zn>24?(t<1/0&&(bn=setTimeout(xn,t-Gn.now()-Xn)),fn&&(fn=clearInterval(fn))):(fn||(yn=Gn.now(),fn=setInterval(_n,1e3)),mn=1,Vn(xn)))}function Sn(t,e,n){var i=new gn;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}gn.prototype=vn.prototype={constructor:gn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Wn():+n)+(null==e?0:+e),this._next||hn===this||(hn?hn._next=this:un=this,hn=this),this._call=t,this._time=n,Kn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Kn())}};var Yn={value:()=>{}};function Ln(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Hn(i)}function Hn(t){this._=t}function Cn(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Nn(t,e){for(var n,i=0,l=t.length;i<l;++i)if((n=t[i]).name===e)return n.value}function Jn(t,e,n){for(var i=0,l=t.length;i<l;++i)if(t[i].name===e){t[i]=Yn,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Hn.prototype=Ln.prototype={constructor:Hn,on:function(t,e){var n,i=this._,l=Cn(t+"",i),a=-1,r=l.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<r;)if(n=(t=l[a]).type)i[n]=Jn(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Jn(i[n],t.name,null);return this}for(;++a<r;)if((n=(t=l[a]).type)&&(n=Nn(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Hn(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,l=new Array(n),a=0;a<n;++a)l[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,l)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],l=0,a=i.length;l<a;++l)i[l].value.apply(e,n)}};const kn={capture:!0,passive:!1};function zn(t){t.preventDefault(),t.stopImmediatePropagation()}function In(t){var e=t.document.documentElement,n=mt(t).on("dragstart.drag",zn,kn);"onselectstart"in e?n.on("selectstart.drag",zn,kn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function wn(t,e){var n=t.document.documentElement,i=mt(t).on("dragstart.drag",null);e&&(i.on("click.drag",zn,kn),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Tn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Fn(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Qn(){}var Mn=1/.7,Bn="\\s*([+-]?\\d+)\\s*",Un="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",jn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pn=/^#([0-9a-f]{3,8})$/,En=new RegExp("^rgb\\("+[Bn,Bn,Bn]+"\\)$"),On=new RegExp("^rgb\\("+[jn,jn,jn]+"\\)$"),Dn=new RegExp("^rgba\\("+[Bn,Bn,Bn,Un]+"\\)$"),An=new RegExp("^rgba\\("+[jn,jn,jn,Un]+"\\)$"),qn=new RegExp("^hsl\\("+[Un,jn,jn]+"\\)$"),$n=new RegExp("^hsla\\("+[Un,jn,jn,Un]+"\\)$"),ti={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ei(){return this.rgb().formatHex()}function ni(){return this.rgb().formatRgb()}function ii(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Pn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?li(e):3===n?new si(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ai(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ai(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=En.exec(t))?new si(e[1],e[2],e[3],1):(e=On.exec(t))?new si(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Dn.exec(t))?ai(e[1],e[2],e[3],e[4]):(e=An.exec(t))?ai(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=qn.exec(t))?hi(e[1],e[2]/100,e[3]/100,1):(e=$n.exec(t))?hi(e[1],e[2]/100,e[3]/100,e[4]):ti.hasOwnProperty(t)?li(ti[t]):"transparent"===t?new si(NaN,NaN,NaN,0):null}function li(t){return new si(t>>16&255,t>>8&255,255&t,1)}function ai(t,e,n,i){return i<=0&&(t=e=n=NaN),new si(t,e,n,i)}function ri(t){return t instanceof Qn||(t=ii(t)),t?new si((t=t.rgb()).r,t.g,t.b,t.opacity):new si}function oi(t,e,n,i){return 1===arguments.length?ri(t):new si(t,e,n,null==i?1:i)}function si(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function di(){return"#"+ui(this.r)+ui(this.g)+ui(this.b)}function ci(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ui(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function hi(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new mi(t,e,n,i)}function pi(t){if(t instanceof mi)return new mi(t.h,t.s,t.l,t.opacity);if(t instanceof Qn||(t=ii(t)),!t)return new mi;if(t instanceof mi)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,l=Math.min(e,n,i),a=Math.max(e,n,i),r=NaN,o=a-l,s=(a+l)/2;return o?(r=e===a?(n-i)/o+6*(n<i):n===a?(i-e)/o+2:(e-n)/o+4,o/=s<.5?a+l:2-a-l,r*=60):o=s>0&&s<1?0:r,new mi(r,o,s,t.opacity)}function mi(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function bi(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Tn(Qn,ii,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:ei,formatHex:ei,formatHsl:function(){return pi(this).formatHsl()},formatRgb:ni,toString:ni}),Tn(si,oi,Fn(Qn,{brighter:function(t){return t=null==t?Mn:Math.pow(Mn,t),new si(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new si(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:di,formatHex:di,formatRgb:ci,toString:ci})),Tn(mi,(function(t,e,n,i){return 1===arguments.length?pi(t):new mi(t,e,n,null==i?1:i)}),Fn(Qn,{brighter:function(t){return t=null==t?Mn:Math.pow(Mn,t),new mi(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new mi(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,l=2*n-i;return new si(bi(t>=240?t-240:t+120,l,i),bi(t,l,i),bi(t<120?t+240:t-120,l,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const fi=Math.PI/180,yi=180/Math.PI;var Zi=-.14861,Xi=1.78277,Gi=-.29227,Vi=-.90649,Wi=1.97294,Ri=Wi*Vi,gi=Wi*Xi,vi=Xi*Gi-Vi*Zi;function xi(t){if(t instanceof Ki)return new Ki(t.h,t.s,t.l,t.opacity);t instanceof si||(t=ri(t));var e=t.r/255,n=t.g/255,i=t.b/255,l=(vi*i+Ri*e-gi*n)/(vi+Ri-gi),a=i-l,r=(Wi*(n-l)-Gi*a)/Vi,o=Math.sqrt(r*r+a*a)/(Wi*l*(1-l)),s=o?Math.atan2(r,a)*yi-120:NaN;return new Ki(s<0?s+360:s,o,l,t.opacity)}function _i(t,e,n,i){return 1===arguments.length?xi(t):new Ki(t,e,n,null==i?1:i)}function Ki(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Tn(Ki,_i,Fn(Qn,{brighter:function(t){return t=null==t?Mn:Math.pow(Mn,t),new Ki(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ki(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*fi,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),l=Math.sin(t);return new si(255*(e+n*(Zi*i+Xi*l)),255*(e+n*(Gi*i+Vi*l)),255*(e+n*(Wi*i)),this.opacity)}}));var Si=t=>()=>t;function Yi(t,e){return function(n){return t+n*e}}function Li(t){return 1==(t=+t)?Hi:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):Si(isNaN(e)?n:e)}}function Hi(t,e){var n=e-t;return n?Yi(t,n):Si(isNaN(t)?e:t)}var Ci=function t(e){var n=Li(e);function i(t,e){var i=n((t=oi(t)).r,(e=oi(e)).r),l=n(t.g,e.g),a=n(t.b,e.b),r=Hi(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=l(e),t.b=a(e),t.opacity=r(e),t+""}}return i.gamma=t,i}(1);var Ni,Ji=(Ni=function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),l=t[i],a=t[i+1],r=i>0?t[i-1]:2*l-a,o=i<e-1?t[i+2]:2*a-l;return function(t,e,n,i,l){var a=t*t,r=a*t;return((1-3*t+3*a-r)*e+(4-6*a+3*r)*n+(1+3*t+3*a-3*r)*i+r*l)/6}((n-i/e)*e,r,l,a,o)}},function(t){var e,n,i=t.length,l=new Array(i),a=new Array(i),r=new Array(i);for(e=0;e<i;++e)n=oi(t[e]),l[e]=n.r||0,a[e]=n.g||0,r[e]=n.b||0;return l=Ni(l),a=Ni(a),r=Ni(r),n.opacity=1,function(t){return n.r=l(t),n.g=a(t),n.b=r(t),n+""}});function ki(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,l=e.slice();return function(a){for(n=0;n<i;++n)l[n]=t[n]*(1-a)+e[n]*a;return l}}function zi(t,e){var n,i=e?e.length:0,l=t?Math.min(i,t.length):0,a=new Array(l),r=new Array(i);for(n=0;n<l;++n)a[n]=Bi(t[n],e[n]);for(;n<i;++n)r[n]=e[n];return function(t){for(n=0;n<l;++n)r[n]=a[n](t);return r}}function Ii(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function wi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ti(t,e){var n,i={},l={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Bi(t[n],e[n]):l[n]=e[n];return function(t){for(n in i)l[n]=i[n](t);return l}}var Fi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qi=new RegExp(Fi.source,"g");function Mi(t,e){var n,i,l,a=Fi.lastIndex=Qi.lastIndex=0,r=-1,o=[],s=[];for(t+="",e+="";(n=Fi.exec(t))&&(i=Qi.exec(e));)(l=i.index)>a&&(l=e.slice(a,l),o[r]?o[r]+=l:o[++r]=l),(n=n[0])===(i=i[0])?o[r]?o[r]+=i:o[++r]=i:(o[++r]=null,s.push({i:r,x:wi(n,i)})),a=Qi.lastIndex;return a<e.length&&(l=e.slice(a),o[r]?o[r]+=l:o[++r]=l),o.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,i=0;i<e;++i)o[(n=s[i]).i]=n.x(t);return o.join("")})}function Bi(t,e){var n,i,l=typeof e;return null==e||"boolean"===l?Si(e):("number"===l?wi:"string"===l?(n=ii(e))?(e=n,Ci):Mi:e instanceof ii?Ci:e instanceof Date?Ii:(i=e,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(e)?zi:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Ti:wi:ki))(t,e)}function Ui(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var ji,Pi=180/Math.PI,Ei={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Oi(t,e,n,i,l,a){var r,o,s;return(r=Math.sqrt(t*t+e*e))&&(t/=r,e/=r),(s=t*n+e*i)&&(n-=t*s,i-=e*s),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,s/=o),t*i<e*n&&(t=-t,e=-e,s=-s,r=-r),{translateX:l,translateY:a,rotate:Math.atan2(e,t)*Pi,skewX:Math.atan(s)*Pi,scaleX:r,scaleY:o}}function Di(t,e,n,i){function l(t){return t.length?t.pop()+" ":""}return function(a,r){var o=[],s=[];return a=t(a),r=t(r),function(t,i,l,a,r,o){if(t!==l||i!==a){var s=r.push("translate(",null,e,null,n);o.push({i:s-4,x:wi(t,l)},{i:s-2,x:wi(i,a)})}else(l||a)&&r.push("translate("+l+e+a+n)}(a.translateX,a.translateY,r.translateX,r.translateY,o,s),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(l(n)+"rotate(",null,i)-2,x:wi(t,e)})):e&&n.push(l(n)+"rotate("+e+i)}(a.rotate,r.rotate,o,s),function(t,e,n,a){t!==e?a.push({i:n.push(l(n)+"skewX(",null,i)-2,x:wi(t,e)}):e&&n.push(l(n)+"skewX("+e+i)}(a.skewX,r.skewX,o,s),function(t,e,n,i,a,r){if(t!==n||e!==i){var o=a.push(l(a)+"scale(",null,",",null,")");r.push({i:o-4,x:wi(t,n)},{i:o-2,x:wi(e,i)})}else 1===n&&1===i||a.push(l(a)+"scale("+n+","+i+")")}(a.scaleX,a.scaleY,r.scaleX,r.scaleY,o,s),a=r=null,function(t){for(var e,n=-1,i=s.length;++n<i;)o[(e=s[n]).i]=e.x(t);return o.join("")}}}var Ai=Di((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ei:Oi(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),qi=Di((function(t){return null==t?Ei:(ji||(ji=document.createElementNS("http://www.w3.org/2000/svg","g")),ji.setAttribute("transform",t),(t=ji.transform.baseVal.consolidate())?Oi((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Ei)}),", ",")",")");function $i(t){return((t=Math.exp(t))+1/t)/2}var tl=function t(e,n,i){function l(t,l){var a,r,o=t[0],s=t[1],d=t[2],c=l[0],u=l[1],h=l[2],p=c-o,m=u-s,b=p*p+m*m;if(b<1e-12)r=Math.log(h/d)/e,a=function(t){return[o+t*p,s+t*m,d*Math.exp(e*t*r)]};else{var f=Math.sqrt(b),y=(h*h-d*d+i*b)/(2*d*n*f),Z=(h*h-d*d-i*b)/(2*h*n*f),X=Math.log(Math.sqrt(y*y+1)-y),G=Math.log(Math.sqrt(Z*Z+1)-Z);r=(G-X)/e,a=function(t){var i,l=t*r,a=$i(X),c=d/(n*f)*(a*(i=e*l+X,((i=Math.exp(2*i))-1)/(i+1))-function(t){return((t=Math.exp(t))-1/t)/2}(X));return[o+c*p,s+c*m,d*a/$i(e*l+X)]}}return a.duration=1e3*r*e/Math.SQRT2,a}return l.rho=function(e){var n=Math.max(.001,+e),i=n*n;return t(n,i,i*i)},l}(Math.SQRT2,2,4);function el(t){return function e(n){function i(e,i){var l=t((e=_i(e)).h,(i=_i(i)).h),a=Hi(e.s,i.s),r=Hi(e.l,i.l),o=Hi(e.opacity,i.opacity);return function(t){return e.h=l(t),e.s=a(t),e.l=r(Math.pow(t,n)),e.opacity=o(t),e+""}}return n=+n,i.gamma=e,i}(1)}el((function(t,e){var n=e-t;return n?Yi(t,n>180||n<-180?n-360*Math.round(n/360):n):Si(isNaN(t)?e:t)}));var nl=el(Hi),il=Ln("start","end","cancel","interrupt"),ll=[];function al(t,e,n,i,l,a){var r=t.__transition;if(r){if(n in r)return}else t.__transition={};!function(t,e,n){var i,l=t.__transition;function a(t){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)}function r(a){var d,c,u,h;if(1!==n.state)return s();for(d in l)if((h=l[d]).name===n.name){if(3===h.state)return Sn(r);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete l[d]):+d<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete l[d])}if(Sn((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(a))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(u=n.tween.length),d=0,c=-1;d<u;++d)(h=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=h);i.length=c+1}}function o(e){for(var l=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,r=i.length;++a<r;)i[a].call(t,l);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete l[e],l)return;delete t.__transition}l[e]=n,n.timer=vn(a,0,n.time)}(t,n,{name:e,index:i,group:l,on:il,tween:ll,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function rl(t,e){var n=sl(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ol(t,e){var n=sl(t,e);if(n.state>3)throw new Error("too late; already running");return n}function sl(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function dl(t,e){var n,i,l,a=t.__transition,r=!0;if(a){for(l in e=null==e?null:e+"",a)(n=a[l]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[l]):r=!1;r&&delete t.__transition}}function cl(t,e){var n,i;return function(){var l=ol(this,t),a=l.tween;if(a!==n)for(var r=0,o=(i=n=a).length;r<o;++r)if(i[r].name===e){(i=i.slice()).splice(r,1);break}l.tween=i}}function ul(t,e,n){var i,l;if("function"!=typeof n)throw new Error;return function(){var a=ol(this,t),r=a.tween;if(r!==i){l=(i=r).slice();for(var o={name:e,value:n},s=0,d=l.length;s<d;++s)if(l[s].name===e){l[s]=o;break}s===d&&l.push(o)}a.tween=l}}function hl(t,e,n){var i=t._id;return t.each((function(){var t=ol(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return sl(t,i).value[e]}}function pl(t,e){var n;return("number"==typeof e?wi:e instanceof ii?Ci:(n=ii(e))?(e=n,Ci):Mi)(t,e)}function ml(t){return function(){this.removeAttribute(t)}}function bl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function fl(t,e,n){var i,l,a=n+"";return function(){var r=this.getAttribute(t);return r===a?null:r===i?l:l=e(i=r,n)}}function yl(t,e,n){var i,l,a=n+"";return function(){var r=this.getAttributeNS(t.space,t.local);return r===a?null:r===i?l:l=e(i=r,n)}}function Zl(t,e,n){var i,l,a;return function(){var r,o,s=n(this);if(null!=s)return(r=this.getAttribute(t))===(o=s+"")?null:r===i&&o===l?a:(l=o,a=e(i=r,s));this.removeAttribute(t)}}function Xl(t,e,n){var i,l,a;return function(){var r,o,s=n(this);if(null!=s)return(r=this.getAttributeNS(t.space,t.local))===(o=s+"")?null:r===i&&o===l?a:(l=o,a=e(i=r,s));this.removeAttributeNS(t.space,t.local)}}function Gl(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Vl(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Wl(t,e){var n,i;function l(){var l=e.apply(this,arguments);return l!==i&&(n=(i=l)&&Vl(t,l)),n}return l._value=e,l}function Rl(t,e){var n,i;function l(){var l=e.apply(this,arguments);return l!==i&&(n=(i=l)&&Gl(t,l)),n}return l._value=e,l}function gl(t,e){return function(){rl(this,t).delay=+e.apply(this,arguments)}}function vl(t,e){return e=+e,function(){rl(this,t).delay=e}}function xl(t,e){return function(){ol(this,t).duration=+e.apply(this,arguments)}}function _l(t,e){return e=+e,function(){ol(this,t).duration=e}}function Kl(t,e){if("function"!=typeof e)throw new Error;return function(){ol(this,t).ease=e}}function Sl(t,e,n){var i,l,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?rl:ol;return function(){var r=a(this,t),o=r.on;o!==i&&(l=(i=o).copy()).on(e,n),r.on=l}}var Yl=pt.prototype.constructor;function Ll(t){return function(){this.style.removeProperty(t)}}function Hl(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function Cl(t,e,n){var i,l;function a(){var a=e.apply(this,arguments);return a!==l&&(i=(l=a)&&Hl(t,a,n)),i}return a._value=e,a}function Nl(t){return function(e){this.textContent=t.call(this,e)}}function Jl(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Nl(i)),e}return i._value=t,i}var kl=0;function zl(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Il(){return++kl}var wl=pt.prototype;zl.prototype={constructor:zl,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=o(t));for(var i=this._groups,l=i.length,a=new Array(l),r=0;r<l;++r)for(var s,d,c=i[r],u=c.length,h=a[r]=new Array(u),p=0;p<u;++p)(s=c[p])&&(d=t.call(s,s.__data__,p,c))&&("__data__"in s&&(d.__data__=s.__data__),h[p]=d,al(h[p],e,n,p,h,sl(s,n)));return new zl(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=c(t));for(var i=this._groups,l=i.length,a=[],r=[],o=0;o<l;++o)for(var s,d=i[o],u=d.length,h=0;h<u;++h)if(s=d[h]){for(var p,m=t.call(s,s.__data__,h,d),b=sl(s,n),f=0,y=m.length;f<y;++f)(p=m[f])&&al(p,e,n,f,m,b);a.push(m),r.push(s)}return new zl(a,r,e,n)},selectChild:wl.selectChild,selectChildren:wl.selectChildren,filter:function(t){"function"!=typeof t&&(t=u(t));for(var e=this._groups,n=e.length,i=new Array(n),l=0;l<n;++l)for(var a,r=e[l],o=r.length,s=i[l]=[],d=0;d<o;++d)(a=r[d])&&t.call(a,a.__data__,d,r)&&s.push(a);return new zl(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,l=n.length,a=Math.min(i,l),r=new Array(i),o=0;o<a;++o)for(var s,d=e[o],c=n[o],u=d.length,h=r[o]=new Array(u),p=0;p<u;++p)(s=d[p]||c[p])&&(h[p]=s);for(;o<i;++o)r[o]=e[o];return new zl(r,this._parents,this._name,this._id)},selection:function(){return new Yl(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Il(),i=this._groups,l=i.length,a=0;a<l;++a)for(var r,o=i[a],s=o.length,d=0;d<s;++d)if(r=o[d]){var c=sl(r,e);al(r,t,n,d,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new zl(i,this._parents,t,n)},call:wl.call,nodes:wl.nodes,node:wl.node,size:wl.size,empty:wl.empty,each:wl.each,on:function(t,e){var n=this._id;return arguments.length<2?sl(this.node(),n).on.on(t):this.each(Sl(n,t,e))},attr:function(t,e){var i=n(t),l="transform"===i?qi:pl;return this.attrTween(t,"function"==typeof e?(i.local?Xl:Zl)(i,l,hl(this,"attr."+t,e)):null==e?(i.local?bl:ml)(i):(i.local?yl:fl)(i,l,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var l=n(t);return this.tween(i,(l.local?Wl:Rl)(l,e))},style:function(t,e,n){var i="transform"==(t+="")?Ai:pl;return null==e?this.styleTween(t,function(t,e){var n,i,l;return function(){var a=J(this,t),r=(this.style.removeProperty(t),J(this,t));return a===r?null:a===n&&r===i?l:l=e(n=a,i=r)}}(t,i)).on("end.style."+t,Ll(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,l,a;return function(){var r=J(this,t),o=n(this),s=o+"";return null==o&&(this.style.removeProperty(t),s=o=J(this,t)),r===s?null:r===i&&s===l?a:(l=s,a=e(i=r,o))}}(t,i,hl(this,"style."+t,e))).each(function(t,e){var n,i,l,a,r="style."+e,o="end."+r;return function(){var s=ol(this,t),d=s.on,c=null==s.value[r]?a||(a=Ll(e)):void 0;d===n&&l===c||(i=(n=d).copy()).on(o,l=c),s.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,l,a=n+"";return function(){var r=J(this,t);return r===a?null:r===i?l:l=e(i=r,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,Cl(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(hl(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Jl(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,l=sl(this.node(),n).tween,a=0,r=l.length;a<r;++a)if((i=l[a]).name===t)return i.value;return null}return this.each((null==e?cl:ul)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?gl:vl)(e,t)):sl(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?xl:_l)(e,t)):sl(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Kl(e,t)):sl(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ol(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,l=n.size();return new Promise((function(a,r){var o={value:r},s={value:function(){0==--l&&a()}};n.each((function(){var n=ol(this,i),l=n.on;l!==t&&((e=(t=l).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(s)),n.on=e})),0===l&&a()}))},[Symbol.iterator]:wl[Symbol.iterator]};var Tl={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Fl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}pt.prototype.interrupt=function(t){return this.each((function(){dl(this,t)}))},pt.prototype.transition=function(t){var e,n;t instanceof zl?(e=t._id,t=t._name):(e=Il(),(n=Tl).time=Wn(),t=null==t?null:t+"");for(var i=this._groups,l=i.length,a=0;a<l;++a)for(var r,o=i[a],s=o.length,d=0;d<s;++d)(r=o[d])&&al(r,t,e,d,o,n||Fl(r,e));return new zl(i,this._parents,t,e)};var Ql=t=>()=>t;function Ml(t,{sourceEvent:e,target:n,transform:i,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:l}})}function Bl(t,e,n){this.k=t,this.x=e,this.y=n}Bl.prototype={constructor:Bl,scale:function(t){return 1===t?this:new Bl(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Bl(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ul=new Bl(1,0,0);function jl(t){t.stopImmediatePropagation()}function Pl(t){t.preventDefault(),t.stopImmediatePropagation()}function El(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Ol(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Dl(){return this.__zoom||Ul}function Al(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function ql(){return navigator.maxTouchPoints||"ontouchstart"in this}function $l(t,e,n){var i=t.invertX(e[0][0])-n[0][0],l=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],r=t.invertY(e[1][1])-n[1][1];return t.translate(l>i?(i+l)/2:Math.min(0,i)||Math.max(0,l),r>a?(a+r)/2:Math.min(0,a)||Math.max(0,r))}function ta(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function ea(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const na=Symbol("implicit");function ia(){var t=new Rt,e=[],n=[],i=na;function l(l){let a=t.get(l);if(void 0===a){if(i!==na)return i;t.set(l,a=e.push(l)-1)}return n[a%n.length]}return l.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Rt;for(const i of n)t.has(i)||t.set(i,e.push(i)-1);return l},l.range=function(t){return arguments.length?(n=Array.from(t),l):n.slice()},l.unknown=function(t){return arguments.length?(i=t,l):i},l.copy=function(){return ia(e,n).unknown(i)},ta.apply(l,arguments),l}function la(t){return+t}var aa=[0,1];function ra(t){return t}function oa(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function sa(t,e,n){var i=t[0],l=t[1],a=e[0],r=e[1];return l<i?(i=oa(l,i),a=n(r,a)):(i=oa(i,l),a=n(a,r)),function(t){return a(i(t))}}function da(t,e,n){var i=Math.min(t.length,e.length)-1,l=new Array(i),a=new Array(i),r=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++r<i;)l[r]=oa(t[r],t[r+1]),a[r]=n(e[r],e[r+1]);return function(e){var n=Xt(t,e,1,i)-1;return a[n](l[n](e))}}function ca(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ua(){var t,e,n,i,l,a,r=aa,o=aa,s=Bi,d=ra;function c(){var t,e,n,s=Math.min(r.length,o.length);return d!==ra&&(t=r[0],e=r[s-1],t>e&&(n=t,t=e,e=n),d=function(n){return Math.max(t,Math.min(e,n))}),i=s>2?da:sa,l=a=null,u}function u(e){return null==e||isNaN(e=+e)?n:(l||(l=i(r.map(t),o,s)))(t(d(e)))}return u.invert=function(n){return d(e((a||(a=i(o,r.map(t),wi)))(n)))},u.domain=function(t){return arguments.length?(r=Array.from(t,la),c()):r.slice()},u.range=function(t){return arguments.length?(o=Array.from(t),c()):o.slice()},u.rangeRound=function(t){return o=Array.from(t),s=Ui,c()},u.clamp=function(t){return arguments.length?(d=!!t||ra,c()):d!==ra},u.interpolate=function(t){return arguments.length?(s=t,c()):s},u.unknown=function(t){return arguments.length?(n=t,u):n},function(n,i){return t=n,e=i,c()}}function ha(){return ua()(ra,ra)}function pa(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function ma(t){return(t=pa(Math.abs(t)))?t[1]:NaN}var ba,fa=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ya(t){if(!(e=fa.exec(t)))throw new Error("invalid format: "+t);var e;return new Za({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Za(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Xa(t,e){var n=pa(t,e);if(!n)return t+"";var i=n[0],l=n[1];return l<0?"0."+new Array(-l).join("0")+i:i.length>l+1?i.slice(0,l+1)+"."+i.slice(l+1):i+new Array(l-i.length+2).join("0")}ya.prototype=Za.prototype,Za.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ga={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Xa(100*t,e),r:Xa,s:function(t,e){var n=pa(t,e);if(!n)return t+"";var i=n[0],l=n[1],a=l-(ba=3*Math.max(-8,Math.min(8,Math.floor(l/3))))+1,r=i.length;return a===r?i:a>r?i+new Array(a-r+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+pa(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Va(t){return t}var Wa,Ra,ga,va=Array.prototype.map,xa=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function _a(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Va:(e=va.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var l=t.length,a=[],r=0,o=e[0],s=0;l>0&&o>0&&(s+o+1>i&&(o=Math.max(1,i-s)),a.push(t.substring(l-=o,l+o)),!((s+=o+1)>i));)o=e[r=(r+1)%e.length];return a.reverse().join(n)}),l=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",r=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?Va:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(va.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",d=void 0===t.minus?"":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=ya(t)).fill,n=t.align,u=t.sign,h=t.symbol,p=t.zero,m=t.width,b=t.comma,f=t.precision,y=t.trim,Z=t.type;"n"===Z?(b=!0,Z="g"):Ga[Z]||(void 0===f&&(f=12),y=!0,Z="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var X="$"===h?l:"#"===h&&/[boxX]/.test(Z)?"0"+Z.toLowerCase():"",G="$"===h?a:/[%p]/.test(Z)?s:"",V=Ga[Z],W=/[defgprs%]/.test(Z);function R(t){var l,a,s,h=X,R=G;if("c"===Z)R=V(t)+R,t="";else{var g=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:V(Math.abs(t),f),y&&(t=function(t){t:for(var e,n=t.length,i=1,l=-1;i<n;++i)switch(t[i]){case".":l=e=i;break;case"0":0===l&&(l=i),e=i;break;default:if(!+t[i])break t;l>0&&(l=0)}return l>0?t.slice(0,l)+t.slice(e+1):t}(t)),g&&0==+t&&"+"!==u&&(g=!1),h=(g?"("===u?u:d:"-"===u||"("===u?"":u)+h,R=("s"===Z?xa[8+ba/3]:"")+R+(g&&"("===u?")":""),W)for(l=-1,a=t.length;++l<a;)if(48>(s=t.charCodeAt(l))||s>57){R=(46===s?r+t.slice(l+1):t.slice(l))+R,t=t.slice(0,l);break}}b&&!p&&(t=i(t,1/0));var v=h.length+t.length+R.length,x=v<m?new Array(m-v+1).join(e):"";switch(b&&p&&(t=i(x+t,x.length?m-R.length:1/0),x=""),n){case"<":t=h+t+R+x;break;case"=":t=h+x+t+R;break;case"^":t=x.slice(0,v=x.length>>1)+h+t+R+x.slice(v);break;default:t=x+h+t+R}return o(t)}return f=void 0===f?6:/[gprs]/.test(Z)?Math.max(1,Math.min(21,f)):Math.max(0,Math.min(20,f)),R.toString=function(){return t+""},R}return{format:u,formatPrefix:function(t,e){var n=u(((t=ya(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ma(e)/3))),l=Math.pow(10,-i),a=xa[8+i/3];return function(t){return n(l*t)+a}}}}function Ka(t,e,n,i){var l,a=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),l=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/l;return a>=xt?l*=10:a>=_t?l*=5:a>=Kt&&(l*=2),e<t?-l:l}(t,e,n);switch((i=ya(null==i?",f":i)).type){case"s":var r=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(l=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ma(e)/3)))-ma(Math.abs(t)))}(a,r))||(i.precision=l),ga(i,r);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(l=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ma(e)-ma(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=l-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(l=function(t){return Math.max(0,-ma(Math.abs(t)))}(a))||(i.precision=l-2*("%"===i.type))}return Ra(i)}function Sa(t){var e=t.domain;return t.ticks=function(t){var n=e();return St(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return Ka(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,l,a=e(),r=0,o=a.length-1,s=a[r],d=a[o],c=10;for(d<s&&(l=s,s=d,d=l,l=r,r=o,o=l);c-- >0;){if((l=Yt(s,d,n))===i)return a[r]=s,a[o]=d,e(a);if(l>0)s=Math.floor(s/l)*l,d=Math.ceil(d/l)*l;else{if(!(l<0))break;s=Math.ceil(s*l)/l,d=Math.floor(d*l)/l}i=l}return t},t}function Ya(){var t=ha();return t.copy=function(){return ca(t,Ya())},ta.apply(t,arguments),Sa(t)}function La(t){return Math.log(t)}function Ha(t){return Math.exp(t)}function Ca(t){return-Math.log(-t)}function Na(t){return-Math.exp(-t)}function Ja(t){return isFinite(t)?+("1e"+t):t<0?0:t}function ka(t){return(e,n)=>-t(-e,n)}function za(t){const e=t(La,Ha),n=e.domain;let i,l,a=10;function r(){return i=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(a),l=function(t){return 10===t?Ja:t===Math.E?Math.exp:e=>Math.pow(t,e)}(a),n()[0]<0?(i=ka(i),l=ka(l),t(Ca,Na)):t(La,Ha),e}return e.base=function(t){return arguments.length?(a=+t,r()):a},e.domain=function(t){return arguments.length?(n(t),r()):n()},e.ticks=t=>{const e=n();let r=e[0],o=e[e.length-1];const s=o<r;s&&([r,o]=[o,r]);let d,c,u=i(r),h=i(o);const p=null==t?10:+t;let m=[];if(!(a%1)&&h-u<p){if(u=Math.floor(u),h=Math.ceil(h),r>0){for(;u<=h;++u)for(d=1;d<a;++d)if(c=u<0?d/l(-u):d*l(u),!(c<r)){if(c>o)break;m.push(c)}}else for(;u<=h;++u)for(d=a-1;d>=1;--d)if(c=u>0?d/l(-u):d*l(u),!(c<r)){if(c>o)break;m.push(c)}2*m.length<p&&(m=St(r,o,p))}else m=St(u,h,Math.min(h-u,p)).map(l);return s?m.reverse():m},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===a?"s":","),"function"!=typeof n&&(a%1||null!=(n=ya(n)).precision||(n.trim=!0),n=Ra(n)),t===1/0)return n;const r=Math.max(1,a*t/e.ticks().length);return t=>{let e=t/l(Math.round(i(t)));return e*a<a-.5&&(e*=a),e<=r?n(t):""}},e.nice=()=>n(function(t,e){var n,i=0,l=(t=t.slice()).length-1,a=t[i],r=t[l];return r<a&&(n=i,i=l,l=n,n=a,a=r,r=n),t[i]=e.floor(a),t[l]=e.ceil(r),t}(n(),{floor:t=>l(Math.floor(i(t))),ceil:t=>l(Math.ceil(i(t)))})),e}function Ia(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function wa(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Ta(t){return t<0?-t*t:t*t}function Fa(t){var e=t(ra,ra),n=1;function i(){return 1===n?t(ra,ra):.5===n?t(wa,Ta):t(Ia(n),Ia(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},Sa(e)}function Qa(){var t=Fa(ua());return t.copy=function(){return ca(t,Qa()).exponent(t.exponent())},ta.apply(t,arguments),t}function Ma(){var t,e,n,i,l,a=0,r=1,o=ra,s=!1;function d(e){return null==e||isNaN(e=+e)?l:o(0===n?.5:(e=(i(e)-t)*n,s?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,i;return arguments.length?([n,i]=e,o=t(n,i),d):[o(0),o(1)]}}return d.domain=function(l){return arguments.length?([a,r]=l,t=i(a=+a),e=i(r=+r),n=t===e?0:1/(e-t),d):[a,r]},d.clamp=function(t){return arguments.length?(s=!!t,d):s},d.interpolator=function(t){return arguments.length?(o=t,d):o},d.range=c(Bi),d.rangeRound=c(Ui),d.unknown=function(t){return arguments.length?(l=t,d):l},function(l){return i=l,t=l(a),e=l(r),n=t===e?0:1/(e-t),d}}function Ba(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Ua(){var t=Sa(Ma()(ra));return t.copy=function(){return Ba(t,Ua())},ea.apply(t,arguments)}function ja(){var t=za(Ma()).domain([1,10]);return t.copy=function(){return Ba(t,ja()).base(t.base())},ea.apply(t,arguments)}function Pa(){var t=Fa(Ma());return t.copy=function(){return Ba(t,Pa()).exponent(t.exponent())},ea.apply(t,arguments)}Wa=_a({thousands:",",grouping:[3],currency:["$",""]}),Ra=Wa.format,ga=Wa.formatPrefix;class Ea{constructor(t,e){this.prefs=e,this.canvas=mt(t),this.width=+this.canvas.attr("width"),this.height=+this.canvas.attr("height"),this.renderers=new Map,this.renderers=new Map}attach_tiles(t){return this.tileSet=t,this.tileSet._zoom=this,this}attach_renderer(t,e){return this.renderers.set(t,e),e.bind_zoom(this),e.zoom.initialize_zoom(),this}zoom_to(t,e=null,n=null,i=4e3){const l=this.scales(),{canvas:a,zoomer:r,width:o,height:s}=this,d=Ul.translate(o/2,s/2).scale(t).translate(-l.x(e),-l.y(n));a.transition().duration(i).call(r.transform,d)}html_annotation(t){mt(this.canvas.node().parentNode.parentNode).selectAll("div.tooltip").data(t).join((t=>t.append("div").attr("class","tooltip").style("top",0).style("left",0).style("position","absolute").style("z-index",100).style("border-radius","8px").style("padding","10px").style("background","ivory").style("opacity",.75)),(t=>t.html((t=>this.tooltip_html(t.data)))),(t=>t.call((t=>t.remove())))).html((t=>this.tooltip_html(t.data))).style("transform",(t=>`translate(${+t.x+t.dx}px, ${+t.y+t.dy}px)`))}get tooltip_html(){return void 0===this._tooltip_html_function?Oa:this._tooltip_html_function}set tooltip_html(t){throw new Error("Don't set this directly; set on the parent scatterplot.")}zoom_to_bbox(t,e=4){const n=this.scales(),[i,l]=t.x.map(n.x),[a,r]=t.y.map(n.y),{canvas:o,zoomer:s,width:d,height:c}=this,u=Ul.translate(d/2,c/2).scale(.9/Math.max((l-i)/d,(r-a)/c)).translate(-(i+l)/2,-(a+r)/2);o.transition().duration(1e3*e).call(s.transform,u)}initialize_zoom(){const{width:t,height:e,canvas:n}=this;this.transform=Ul;const i=function(){var t,e,n,i=El,l=Ol,a=$l,r=Al,o=ql,s=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],c=250,u=tl,h=Ln("start","zoom","end"),p=500,m=0,b=10;function f(t){t.property("__zoom",Dl).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",g).on("dblclick.zoom",v).filter(o).on("touchstart.zoom",x).on("touchmove.zoom",_).on("touchend.zoom touchcancel.zoom",K).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new Bl(e,t.x,t.y)}function Z(t,e,n){var i=e[0]-n[0]*t.k,l=e[1]-n[1]*t.k;return i===t.x&&l===t.y?t:new Bl(t.k,i,l)}function X(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function G(t,e,n,i){t.on("start.zoom",(function(){V(this,arguments).event(i).start()})).on("interrupt.zoom end.zoom",(function(){V(this,arguments).event(i).end()})).tween("zoom",(function(){var t=this,a=arguments,r=V(t,a).event(i),o=l.apply(t,a),s=null==n?X(o):"function"==typeof n?n.apply(t,a):n,d=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),c=t.__zoom,h="function"==typeof e?e.apply(t,a):e,p=u(c.invert(s).concat(d/c.k),h.invert(s).concat(d/h.k));return function(t){if(1===t)t=h;else{var e=p(t),n=d/e[2];t=new Bl(n,s[0]-e[0]*n,s[1]-e[1]*n)}r.zoom(null,t)}}))}function V(t,e,n){return!n&&t.__zooming||new W(t,e)}function W(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=l.apply(t,e),this.taps=0}function R(t,...e){if(i.apply(this,arguments)){var n=V(this,e).event(t),l=this.__zoom,o=Math.max(s[0],Math.min(s[1],l.k*Math.pow(2,r.apply(this,arguments)))),c=bt(t);if(n.wheel)n.mouse[0][0]===c[0]&&n.mouse[0][1]===c[1]||(n.mouse[1]=l.invert(n.mouse[0]=c)),clearTimeout(n.wheel);else{if(l.k===o)return;n.mouse=[c,l.invert(c)],dl(this),n.start()}Pl(t),n.wheel=setTimeout(u,150),n.zoom("mouse",a(Z(y(l,o),n.mouse[0],n.mouse[1]),n.extent,d))}function u(){n.wheel=null,n.end()}}function g(t,...e){if(!n&&i.apply(this,arguments)){var l=t.currentTarget,r=V(this,e,!0).event(t),o=mt(t.view).on("mousemove.zoom",h,!0).on("mouseup.zoom",p,!0),s=bt(t,l),c=t.clientX,u=t.clientY;In(t.view),jl(t),r.mouse=[s,this.__zoom.invert(s)],dl(this),r.start()}function h(t){if(Pl(t),!r.moved){var e=t.clientX-c,n=t.clientY-u;r.moved=e*e+n*n>m}r.event(t).zoom("mouse",a(Z(r.that.__zoom,r.mouse[0]=bt(t,l),r.mouse[1]),r.extent,d))}function p(t){o.on("mousemove.zoom mouseup.zoom",null),wn(t.view,r.moved),Pl(t),r.event(t).end()}}function v(t,...e){if(i.apply(this,arguments)){var n=this.__zoom,r=bt(t.changedTouches?t.changedTouches[0]:t,this),o=n.invert(r),s=n.k*(t.shiftKey?.5:2),u=a(Z(y(n,s),r,o),l.apply(this,e),d);Pl(t),c>0?mt(this).transition().duration(c).call(G,u,r,t):mt(this).call(f.transform,u,r,t)}}function x(n,...l){if(i.apply(this,arguments)){var a,r,o,s,d=n.touches,c=d.length,u=V(this,l,n.changedTouches.length===c).event(n);for(jl(n),r=0;r<c;++r)s=[s=bt(o=d[r],this),this.__zoom.invert(s),o.identifier],u.touch0?u.touch1||u.touch0[2]===s[2]||(u.touch1=s,u.taps=0):(u.touch0=s,a=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),a&&(u.taps<2&&(e=s[0],t=setTimeout((function(){t=null}),p)),dl(this),u.start())}}function _(t,...e){if(this.__zooming){var n,i,l,r,o=V(this,e).event(t),s=t.changedTouches,c=s.length;for(Pl(t),n=0;n<c;++n)l=bt(i=s[n],this),o.touch0&&o.touch0[2]===i.identifier?o.touch0[0]=l:o.touch1&&o.touch1[2]===i.identifier&&(o.touch1[0]=l);if(i=o.that.__zoom,o.touch1){var u=o.touch0[0],h=o.touch0[1],p=o.touch1[0],m=o.touch1[1],b=(b=p[0]-u[0])*b+(b=p[1]-u[1])*b,f=(f=m[0]-h[0])*f+(f=m[1]-h[1])*f;i=y(i,Math.sqrt(b/f)),l=[(u[0]+p[0])/2,(u[1]+p[1])/2],r=[(h[0]+m[0])/2,(h[1]+m[1])/2]}else{if(!o.touch0)return;l=o.touch0[0],r=o.touch0[1]}o.zoom("touch",a(Z(i,l,r),o.extent,d))}}function K(t,...i){if(this.__zooming){var l,a,r=V(this,i).event(t),o=t.changedTouches,s=o.length;for(jl(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),p),l=0;l<s;++l)a=o[l],r.touch0&&r.touch0[2]===a.identifier?delete r.touch0:r.touch1&&r.touch1[2]===a.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps&&(a=bt(a,this),Math.hypot(e[0]-a[0],e[1]-a[1])<b)){var d=mt(this).on("dblclick.zoom");d&&d.apply(this,arguments)}}}return f.transform=function(t,e,n,i){var l=t.selection?t.selection():t;l.property("__zoom",Dl),t!==l?G(t,e,n,i):l.interrupt().each((function(){V(this,arguments).event(i).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},f.scaleBy=function(t,e,n,i){f.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),n,i)},f.scaleTo=function(t,e,n,i){f.transform(t,(function(){var t=l.apply(this,arguments),i=this.__zoom,r=null==n?X(t):"function"==typeof n?n.apply(this,arguments):n,o=i.invert(r),s="function"==typeof e?e.apply(this,arguments):e;return a(Z(y(i,s),r,o),t,d)}),n,i)},f.translateBy=function(t,e,n,i){f.transform(t,(function(){return a(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),l.apply(this,arguments),d)}),null,i)},f.translateTo=function(t,e,n,i,r){f.transform(t,(function(){var t=l.apply(this,arguments),r=this.__zoom,o=null==i?X(t):"function"==typeof i?i.apply(this,arguments):i;return a(Ul.translate(o[0],o[1]).scale(r.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,d)}),i,r)},W.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=mt(this.that).datum();h.call(t,this.that,new Ml(t,{sourceEvent:this.sourceEvent,target:f,type:t,transform:this.that.__zoom,dispatch:h}),e)}},f.wheelDelta=function(t){return arguments.length?(r="function"==typeof t?t:Ql(+t),f):r},f.filter=function(t){return arguments.length?(i="function"==typeof t?t:Ql(!!t),f):i},f.touchable=function(t){return arguments.length?(o="function"==typeof t?t:Ql(!!t),f):o},f.extent=function(t){return arguments.length?(l="function"==typeof t?t:Ql([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),f):l},f.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],f):[s[0],s[1]]},f.translateExtent=function(t){return arguments.length?(d[0][0]=+t[0][0],d[1][0]=+t[1][0],d[0][1]=+t[0][1],d[1][1]=+t[1][1],f):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},f.constrain=function(t){return arguments.length?(a=t,f):a},f.duration=function(t){return arguments.length?(c=+t,f):c},f.interpolate=function(t){return arguments.length?(u=t,f):u},f.on=function(){var t=h.on.apply(h,arguments);return t===h?f:t},f.clickDistance=function(t){return arguments.length?(m=(t=+t)*t,f):Math.sqrt(m)},f.tapDistance=function(t){return arguments.length?(b=+t,f):b},f}().scaleExtent([1/3,1e5]).extent([[0,0],[t,e]]).on("zoom",(t=>{this.transform=t.transform,this.restart_timer(1e4)}));n.call(i),this.add_mouseover(),this.zoomer=i}add_mouseover(){let t=0;const e=this.renderers.get("regl"),n=e.aes.dim("x").current,i=e.aes.dim("y").current;this.canvas.on("mousemove",(l=>{if(Date.now()-t<50)return;t=Date.now();const a=e.color_pick(l.layerX,l.layerY),r=a?[a]:[],o=r[0],s=o?[{x:l.layerX,y:l.layerY,data:o,dx:0,dy:30}]:[],{x_:d,y_:c}=this.scales();this.html_annotation(s),mt("#deepscatter-svg").selectAll("circle.label").data(r,(t=>t.ix)).join((t=>t.append("circle").attr("class","label").attr("stroke","#110022").attr("r",12).attr("fill",(t=>this.renderers.get("regl").aes.dim("color").current.apply(t))).attr("cx",(t=>d(n.value_for(t)))).attr("cy",(t=>c(i.value_for(t))))),(t=>t.attr("fill",(t=>this.renderers.get("regl").aes.dim("color").current.apply(t)))),(t=>t.call((t=>t.remove())))).on("click",((t,e)=>{this.renderers.get("regl").click_function(e,t)}))}))}current_corners(){const{width:t,height:e}=this,n=this.scales();if(void 0===n)return;const{x_:i,y_:l}=n;return{x:[i.invert(0),i.invert(t)],y:[l.invert(0),l.invert(e)]}}current_center(){const{x:t,y:e}=this.current_corners();return[(t[0]+t[1])/2,(e[0]+e[1])/2]}restart_timer(t=1e4){let e=Date.now()+t;this._timer&&(this._timer.stop_at>e&&(e=this._timer.stop_at),this._timer.stop());const n=vn(this.tick.bind(this));return this._timer=n,this._timer.stop_at=e,this._timer}data(t){return void 0===t?this.tileSet:(this.tileSet=t,this)}scales(t=!0){if(this._scales)return this._scales.x_=this.transform.rescaleX(this._scales.x),this._scales.y_=this.transform.rescaleY(this._scales.y),this._scales;const{width:e,height:n}=this;if(void 0===this.tileSet)throw new Error("Error--scales created before tileSet present.");const{extent:i}=this.tileSet,l={};if(void 0===i)throw new Error("Error--scales created before extent present.");const a={};for(const[u,h]of[["x",e],["y",n]]){const t=i[u],e=t[1]-t[0];a[u]={limits:t,size_range:e,pixels_per_unit:h/e}}const r=a.x.pixels_per_unit/a.y.pixels_per_unit;let o=0,s=0,d=e,c=n;return r>1?(d=e/r,o=(e-d)/2):(c=n*r,s=(n-c)/2),l.x=Ya().domain(a.x.limits).range([o,e-o]),l.y=Ya().domain(a.y.limits).range([s,n-s]),l.x_=this.transform.rescaleX(l.x),l.y_=this.transform.rescaleY(l.y),this._scales=l,l}webgl_scale(t=!0){const{x:e,y:n}=this.scales();return function(t,e){function n(t){return t[1]-t[0]}const i=Ct(t.domain()),l=Ct(e.domain()),a=n(t.range())/n(t.domain()),r=n(e.range())/n(e.domain());return[[a,0,-a*i+Ct(t.range())],[0,r,-r*l+Ct(e.range())],[0,0,1]]}(e,n).flat()}tick(t=!1){this._start=this._start||Date.now(),!0!==t&&this._timer&&this._timer.stop_at<=Date.now()&&this._timer.stop()}}function Oa(t,e=null){let n="<dl>";const i=new Set(["x","y","ix",null,"tile_key"]);for(const[l,a]of[...t]){if(null!==e){if(!e.has(l))continue}else{if(i.has(l))continue;if(l.match(/_dict_index/))continue;if(null===a)continue;if(""===a)continue}n+=`<dt>${l}</dt>`,n+=`<dd>${a}<dd>`}return`${n}</dl>`}var Da={exports:{}},Aa=Da.exports=function(){var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var n=Object.keys(e),i=0;i<n.length;++i)t[n[i]]=e[n[i]];return t},n="\n";function i(t){return"undefined"!=typeof atob?atob(t):"base64:"+t}function l(t){var e=new Error("(regl) "+t);throw console.error(e),e}function a(t,e){t||l(e)}function r(t){return t?": "+t:""}function o(t,e,n){t in e||l("unknown parameter ("+t+")"+r(n)+". possible values: "+Object.keys(e).join())}function s(e,n){t(e)||l("invalid parameter type"+r(n)+". must be a typed array")}function d(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return void 0===t;case"symbol":return"symbol"==typeof t}}function c(t,e,n){d(t,e)||l("invalid parameter type"+r(n)+". expected "+e+", got "+typeof t)}function u(t,e){t>=0&&(0|t)===t||l("invalid parameter type, ("+t+")"+r(e)+". must be a nonnegative integer")}function h(t,e,n){e.indexOf(t)<0&&l("invalid value"+r(n)+". must be one of: "+e)}var p=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function m(t){Object.keys(t).forEach((function(t){p.indexOf(t)<0&&l('invalid regl constructor argument "'+t+'". must be one of '+p)}))}function b(t,e){for(t+="";t.length<e;)t=" "+t;return t}function f(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function y(t,e){this.number=t,this.line=e,this.errors=[]}function Z(t,e,n){this.file=t,this.line=e,this.message=n}function X(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var i=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return i?i[1]:"unknown"}function G(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var i=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return i?i[1]:"unknown"}function V(t,e){var n=t.split("\n"),l=1,a=0,r={unknown:new f,0:new f};r.unknown.name=r[0].name=e||X(),r.unknown.lines.push(new y(0,""));for(var o=0;o<n.length;++o){var s=n[o],d=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(s);if(d)switch(d[1]){case"line":var c=/(\d+)(\s+\d+)?/.exec(d[2]);c&&(l=0|c[1],c[2]&&((a=0|c[2])in r||(r[a]=new f)));break;case"define":var u=/SHADER_NAME(_B64)?\s+(.*)$/.exec(d[2]);u&&(r[a].name=u[1]?i(u[2]):u[2])}r[a].lines.push(new y(l++,s))}return Object.keys(r).forEach((function(t){var e=r[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),r}function W(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);n?e.push(new Z(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new Z("unknown",0,t))}})),e}function R(t,e){e.forEach((function(e){var n=t[e.file];if(n){var i=n.index[e.line];if(i)return i.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))}function g(t,e,i,l,r){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(e),s=l===t.FRAGMENT_SHADER?"fragment":"vertex";L(i,"string",s+" shader source must be a string",r);var d=V(i,r),c=W(o);R(d,c),Object.keys(d).forEach((function(t){var e=d[t];if(e.hasErrors){var i=[""],l=[""];a("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){a(b(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),a(t.line+n,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(i){var l=i.message,r=/^\s*'(.*)'\s*:\s*(.*)$/.exec(l);if(r){var o=r[1];l=r[2],"assign"===o&&(o="="),e=Math.max(t.line.indexOf(o,e),0)}else e=0;a(b("| ",6)),a(b("^^^",e+3)+n,"font-weight:bold"),a(b("| ",6)),a(l+n,"font-weight:bold")})),a(b("| ",6)+n)}else a(b(t.number,4)+"|  "),a(t.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(i.join("")):(l[0]=i.join("%c"),console.log.apply(console,l))}function a(t,e){i.push(t),l.push(e||"")}})),a.raise("Error compiling "+s+" shader, "+d[0].name)}}function v(t,e,i,l,r){if(!t.getProgramParameter(e,t.LINK_STATUS)){var o=t.getProgramInfoLog(e),s=V(i,r),d='Error linking program with vertex shader, "'+V(l,r)[0].name+'", and fragment shader "'+s[0].name+'"';"undefined"!=typeof document?console.log("%c"+d+n+"%c"+o,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(d+n+o),a.raise(d)}}function x(t){t._commandRef=X()}function _(t,e,n,i){function l(t){return t?i.id(t):0}function a(t,e){Object.keys(e).forEach((function(e){t[i.id(e)]=!0}))}x(t),t._fragId=l(t.static.frag),t._vertId=l(t.static.vert);var r=t._uniformSet={};a(r,e.static),a(r,e.dynamic);var o=t._attributeSet={};a(o,n.static),a(o,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function K(t,e){var n=G();l(t+" in command "+(e||X())+("unknown"===n?"":" called from "+n))}function S(t,e,n){t||K(e,n||X())}function Y(t,e,n,i){t in e||K("unknown parameter ("+t+")"+r(n)+". possible values: "+Object.keys(e).join(),i||X())}function L(t,e,n,i){d(t,e)||K("invalid parameter type"+r(n)+". expected "+e+", got "+typeof t,i||X())}function H(t){t()}function C(t,e,n){t.texture?h(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):h(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var N=33071,J=9728,k=9984,z=9985,I=9986,w=9987,T=5121,F=5122,Q=5123,M=5124,B=5125,U=5126,j=32819,P=32820,E=33635,O=34042,D=36193,A={};function q(t,e){return t===P||t===j||t===E?2:t===O?4:A[t]*e}function $(t){return!(t&t-1||!t)}function tt(t,e,n){var i,l=e.width,r=e.height,o=e.channels;a(l>0&&l<=n.maxTextureSize&&r>0&&r<=n.maxTextureSize,"invalid texture shape"),t.wrapS===N&&t.wrapT===N||a($(l)&&$(r),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==l&&1!==r&&a(t.minFilter!==k&&t.minFilter!==I&&t.minFilter!==z&&t.minFilter!==w,"min filter requires mipmap"):(a($(l)&&$(r),"texture must be a square power of 2 to support mipmapping"),a(e.mipmask===(l<<1)-1,"missing or incomplete mipmap data")),e.type===U&&(n.extensions.indexOf("oes_texture_float_linear")<0&&a(t.minFilter===J&&t.magFilter===J,"filter not supported, must enable oes_texture_float_linear"),a(!t.genMipmaps,"mipmap generation not supported with float textures"));var s=e.images;for(i=0;i<16;++i)if(s[i]){var d=l>>i,c=r>>i;a(e.mipmask&1<<i,"missing mipmap data");var u=s[i];if(a(u.width===d&&u.height===c,"invalid shape for mip images"),a(u.format===e.format&&u.internalformat===e.internalformat&&u.type===e.type,"incompatible type for mip image"),u.compressed);else if(u.data){var h=Math.ceil(q(u.type,o)*d/u.unpackAlignment)*u.unpackAlignment;a(u.data.byteLength===h*c,"invalid data for image, buffer size is inconsistent with image format")}else u.element||u.copy}else t.genMipmaps||a(0==(e.mipmask&1<<i),"extra mipmap data");e.compressed&&a(!t.genMipmaps,"mipmap generation for compressed images not supported")}function et(t,e,n,i){var l=t.width,r=t.height,o=t.channels;a(l>0&&l<=i.maxTextureSize&&r>0&&r<=i.maxTextureSize,"invalid texture shape"),a(l===r,"cube map must be square"),a(e.wrapS===N&&e.wrapT===N,"wrap mode not supported by cube map");for(var s=0;s<n.length;++s){var d=n[s];a(d.width===l&&d.height===r,"inconsistent cube map face shape"),e.genMipmaps&&(a(!d.compressed,"can not generate mipmap for compressed textures"),a(1===d.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=d.images,u=0;u<16;++u){var h=c[u];if(h){var p=l>>u,m=r>>u;a(d.mipmask&1<<u,"missing mipmap data"),a(h.width===p&&h.height===m,"invalid shape for mip images"),a(h.format===t.format&&h.internalformat===t.internalformat&&h.type===t.type,"incompatible type for mip image"),h.compressed||(h.data?a(h.data.byteLength===p*m*Math.max(q(h.type,o),h.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):h.element||h.copy)}}}}A[5120]=A[T]=1,A[F]=A[Q]=A[D]=A[E]=A[j]=A[P]=2,A[M]=A[B]=A[U]=A[O]=4;var nt=e(a,{optional:H,raise:l,commandRaise:K,command:S,parameter:o,commandParameter:Y,constructor:m,type:c,commandType:L,isTypedArray:s,nni:u,oneOf:h,shaderError:g,linkError:v,callSite:G,saveCommandRef:x,saveDrawInfo:_,framebufferFormat:C,guessCommand:X,texture2D:tt,textureCube:et}),it=0,lt=0,at=5,rt=6;function ot(t,e){this.id=it++,this.type=t,this.data=e}function st(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function dt(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+st(t.substr(1,t.length-2))+'"'];var i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(i)return dt(t.substr(0,i.index)).concat(dt(i[1])).concat(dt(t.substr(i.index+i[0].length)));var l=t.split(".");if(1===l.length)return['"'+st(t)+'"'];for(var a=[],r=0;r<l.length;++r)a=a.concat(dt(l[r]));return a}function ct(t){return"["+dt(t).join("][")+"]"}function ut(t,e){return new ot(t,ct(e+""))}function ht(t){return"function"==typeof t&&!t._reglType||t instanceof ot}function pt(t,e){return"function"==typeof t?new ot(lt,t):"number"==typeof t||"boolean"==typeof t?new ot(at,t):Array.isArray(t)?new ot(rt,t.map((function(t,n){return pt(t,e+"["+n+"]")}))):t instanceof ot?t:void nt(!1,"invalid option type in uniform "+e)}var mt={DynamicVariable:ot,define:ut,isDynamic:ht,unbox:pt,accessor:ct},bt={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},ft="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function yt(){var t={"":0},e=[""];return{id:function(n){var i=t[n];return i||(i=t[n]=e.length,e.push(n),i)},str:function(t){return e[t]}}}function Zt(t,n,i){var l,a=document.createElement("canvas");function r(){var e=window.innerWidth,n=window.innerHeight;if(t!==document.body){var l=a.getBoundingClientRect();e=l.right-l.left,n=l.bottom-l.top}a.width=i*e,a.height=i*n}function o(){l?l.disconnect():window.removeEventListener("resize",r),t.removeChild(a)}return e(a.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),t.appendChild(a),t===document.body&&(a.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(l=new ResizeObserver((function(){setTimeout(r)}))).observe(t):window.addEventListener("resize",r,!1),r(),{canvas:a,onDestroy:o}}function Xt(t,e){function n(n){try{return t.getContext(n,e)}catch(i){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function Gt(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function Vt(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function Wt(t){return"string"==typeof t?t.split():(nt(Array.isArray(t),"invalid extension array"),t)}function Rt(t){return"string"==typeof t?(nt("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function gt(t){var e,n,i,l,a=t||{},r={},o=[],s=[],d="undefined"==typeof window?1:window.devicePixelRatio,c=!1,u=function(t){t&&nt.raise(t)},h=function(){};if("string"==typeof a?(nt("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),e=document.querySelector(a),nt(e,"invalid query string for element")):"object"==typeof a?Gt(a)?e=a:Vt(a)?i=(l=a).canvas:(nt.constructor(a),"gl"in a?l=a.gl:"canvas"in a?i=Rt(a.canvas):"container"in a&&(n=Rt(a.container)),"attributes"in a&&(r=a.attributes,nt.type(r,"object","invalid context attributes")),"extensions"in a&&(o=Wt(a.extensions)),"optionalExtensions"in a&&(s=Wt(a.optionalExtensions)),"onDone"in a&&(nt.type(a.onDone,"function","invalid or missing onDone callback"),u=a.onDone),"profile"in a&&(c=!!a.profile),"pixelRatio"in a&&(d=+a.pixelRatio,nt(d>0,"invalid pixel ratio"))):nt.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?i=e:n=e),!l){if(!i){nt("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var p=Zt(n||document.body,u,d);if(!p)return null;i=p.canvas,h=p.onDestroy}void 0===r.premultipliedAlpha&&(r.premultipliedAlpha=!0),l=Xt(i,r)}return l?{gl:l,canvas:i,container:n,extensions:o,optionalExtensions:s,pixelRatio:d,profile:c,onDone:u,onDestroy:h}:(h(),u("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function vt(t,e){var n={};function i(e){nt.type(e,"string","extension name must be string");var i,l=e.toLowerCase();try{i=n[l]=t.getExtension(l)}catch(a){}return!!i}for(var l=0;l<e.extensions.length;++l){var a=e.extensions[l];if(!i(a))return e.onDestroy(),e.onDone('"'+a+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(i),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!i(t))throw new Error("(regl): error restoring extension "+t)}))}}}function xt(t,e){for(var n=Array(t),i=0;i<t;++i)n[i]=e(i);return n}var _t=5120,Kt=5121,St=5122,Yt=5123,Lt=5124,Ht=5125,Ct=5126;function Nt(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function Jt(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1}function kt(){var t=xt(8,(function(){return[]}));function e(e){var n=Nt(e),i=t[Jt(n)>>2];return i.length>0?i.pop():new ArrayBuffer(n)}function n(e){t[Jt(e.byteLength)>>2].push(e)}function i(t,n){var i=null;switch(t){case _t:i=new Int8Array(e(n),0,n);break;case Kt:i=new Uint8Array(e(n),0,n);break;case St:i=new Int16Array(e(2*n),0,n);break;case Yt:i=new Uint16Array(e(2*n),0,n);break;case Lt:i=new Int32Array(e(4*n),0,n);break;case Ht:i=new Uint32Array(e(4*n),0,n);break;case Ct:i=new Float32Array(e(4*n),0,n);break;default:return null}return i.length!==n?i.subarray(0,n):i}function l(t){n(t.buffer)}return{alloc:e,free:n,allocType:i,freeType:l}}var zt=kt();zt.zero=kt();var It=3408,wt=3410,Tt=3411,Ft=3412,Qt=3413,Mt=3414,Bt=3415,Ut=33901,jt=33902,Pt=3379,Et=3386,Ot=34921,Dt=36347,At=36348,qt=35661,$t=35660,te=34930,ee=36349,ne=34076,ie=34024,le=7936,ae=7937,re=7938,oe=35724,se=34047,de=36063,ce=34852,ue=3553,he=34067,pe=34069,me=33984,be=6408,fe=5126,ye=5121,Ze=36160,Xe=36053,Ge=36064,Ve=16384,We=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(se));var i=1,l=1;e.webgl_draw_buffers&&(i=t.getParameter(ce),l=t.getParameter(de));var a=!!e.oes_texture_float;if(a){var r=t.createTexture();t.bindTexture(ue,r),t.texImage2D(ue,0,be,1,1,0,be,fe,null);var o=t.createFramebuffer();if(t.bindFramebuffer(Ze,o),t.framebufferTexture2D(Ze,Ge,ue,r,0),t.bindTexture(ue,null),t.checkFramebufferStatus(Ze)!==Xe)a=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(Ve);var s=zt.allocType(fe,4);t.readPixels(0,0,1,1,be,fe,s),t.getError()?a=!1:(t.deleteFramebuffer(o),t.deleteTexture(r),a=1===s[0]),zt.freeType(s)}}var d=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var c=t.createTexture(),u=zt.allocType(ye,36);t.activeTexture(me),t.bindTexture(he,c),t.texImage2D(pe,0,be,3,3,0,be,ye,u),zt.freeType(u),t.bindTexture(he,null),t.deleteTexture(c),d=!t.getError()}return{colorBits:[t.getParameter(wt),t.getParameter(Tt),t.getParameter(Ft),t.getParameter(Qt)],depthBits:t.getParameter(Mt),stencilBits:t.getParameter(Bt),subpixelBits:t.getParameter(It),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:i,maxColorAttachments:l,pointSizeDims:t.getParameter(Ut),lineWidthDims:t.getParameter(jt),maxViewportDims:t.getParameter(Et),maxCombinedTextureUnits:t.getParameter(qt),maxCubeMapSize:t.getParameter(ne),maxRenderbufferSize:t.getParameter(ie),maxTextureUnits:t.getParameter(te),maxTextureSize:t.getParameter(Pt),maxAttributes:t.getParameter(Ot),maxVertexUniforms:t.getParameter(Dt),maxVertexTextureUnits:t.getParameter($t),maxVaryingVectors:t.getParameter(At),maxFragmentUniforms:t.getParameter(ee),glsl:t.getParameter(oe),renderer:t.getParameter(ae),vendor:t.getParameter(le),version:t.getParameter(re),readFloat:a,npotTextureCube:d}};function Re(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var ge=function(t){return Object.keys(t).map((function(e){return t[e]}))},ve={shape:Le,flatten:Ye};function xe(t,e,n){for(var i=0;i<e;++i)n[i]=t[i]}function _e(t,e,n,i){for(var l=0,a=0;a<e;++a)for(var r=t[a],o=0;o<n;++o)i[l++]=r[o]}function Ke(t,e,n,i,l,a){for(var r=a,o=0;o<e;++o)for(var s=t[o],d=0;d<n;++d)for(var c=s[d],u=0;u<i;++u)l[r++]=c[u]}function Se(t,e,n,i,l){for(var a=1,r=n+1;r<e.length;++r)a*=e[r];var o=e[n];if(e.length-n==4){var s=e[n+1],d=e[n+2],c=e[n+3];for(r=0;r<o;++r)Ke(t[r],s,d,c,i,l),l+=a}else for(r=0;r<o;++r)Se(t[r],e,n+1,i,l),l+=a}function Ye(t,e,n,i){var l=1;if(e.length)for(var a=0;a<e.length;++a)l*=e[a];else l=0;var r=i||zt.allocType(n,l);switch(e.length){case 0:break;case 1:xe(t,e[0],r);break;case 2:_e(t,e[0],e[1],r);break;case 3:Ke(t,e[0],e[1],e[2],r,0);break;default:Se(t,e,0,r,0)}return r}function Le(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e}var He={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ce={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ne={dynamic:35048,stream:35040,static:35044},Je=ve.flatten,ke=ve.shape,ze=35044,Ie=35040,we=5121,Te=5126,Fe=[];function Qe(t){return 0|He[Object.prototype.toString.call(t)]}function Me(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function Be(t,e,n,i,l,a,r){for(var o=0,s=0;s<n;++s)for(var d=0;d<i;++d)t[o++]=e[l*s+a*d+r]}function Ue(e,n,i,l){var a=0,r={};function o(t){this.id=a++,this.buffer=e.createBuffer(),this.type=t,this.usage=ze,this.byteLength=0,this.dimension=1,this.dtype=we,this.persistentData=null,i.profile&&(this.stats={size:0})}o.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},o.prototype.destroy=function(){p(this)};var s=[];function d(t,e){var n=s.pop();return n||(n=new o(t)),n.bind(),h(n,e,Ie,0,1,!1),n}function c(t){s.push(t)}function u(t,n,i){t.byteLength=n.byteLength,e.bufferData(t.type,n,i)}function h(e,n,i,l,a,r){var o,s;if(e.usage=i,Array.isArray(n)){if(e.dtype=l||Te,n.length>0)if(Array.isArray(n[0])){o=ke(n);for(var d=1,c=1;c<o.length;++c)d*=o[c];e.dimension=d,u(e,s=Je(n,o,e.dtype),i),r?e.persistentData=s:zt.freeType(s)}else if("number"==typeof n[0]){e.dimension=a;var h=zt.allocType(e.dtype,n.length);Me(h,n),u(e,h,i),r?e.persistentData=h:zt.freeType(h)}else t(n[0])?(e.dimension=n[0].length,e.dtype=l||Qe(n[0])||Te,u(e,s=Je(n,[n.length,n[0].length],e.dtype),i),r?e.persistentData=s:zt.freeType(s)):nt.raise("invalid buffer data")}else if(t(n))e.dtype=l||Qe(n),e.dimension=a,u(e,n,i),r&&(e.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(Re(n)){o=n.shape;var p=n.stride,m=n.offset,b=0,f=0,y=0,Z=0;1===o.length?(b=o[0],f=1,y=p[0],Z=0):2===o.length?(b=o[0],f=o[1],y=p[0],Z=p[1]):nt.raise("invalid shape"),e.dtype=l||Qe(n.data)||Te,e.dimension=f;var X=zt.allocType(e.dtype,b*f);Be(X,n.data,b,f,y,Z,m),u(e,X,i),r?e.persistentData=X:zt.freeType(X)}else n instanceof ArrayBuffer?(e.dtype=we,e.dimension=a,u(e,n,i),r&&(e.persistentData=new Uint8Array(new Uint8Array(n)))):nt.raise("invalid buffer data")}function p(t){n.bufferCount--,l(t);var i=t.buffer;nt(i,"buffer must not be deleted already"),e.deleteBuffer(i),t.buffer=null,delete r[t.id]}function m(l,a,s,d){n.bufferCount++;var c=new o(a);function u(n){var l=ze,a=null,r=0,o=0,s=1;return Array.isArray(n)||t(n)||Re(n)||n instanceof ArrayBuffer?a=n:"number"==typeof n?r=0|n:n&&(nt.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(nt(null===a||Array.isArray(a)||t(a)||Re(a),"invalid data for buffer"),a=n.data),"usage"in n&&(nt.parameter(n.usage,Ne,"invalid buffer usage"),l=Ne[n.usage]),"type"in n&&(nt.parameter(n.type,Ce,"invalid buffer type"),o=Ce[n.type]),"dimension"in n&&(nt.type(n.dimension,"number","invalid dimension"),s=0|n.dimension),"length"in n&&(nt.nni(r,"buffer length must be a nonnegative integer"),r=0|n.length)),c.bind(),a?h(c,a,l,o,s,d):(r&&e.bufferData(c.type,r,l),c.dtype=o||we,c.usage=l,c.dimension=s,c.byteLength=r),i.profile&&(c.stats.size=c.byteLength*Fe[c.dtype]),u}function m(t,n){nt(n+t.byteLength<=c.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+c.byteLength),e.bufferSubData(c.type,n,t)}function b(e,n){var i,l=0|(n||0);if(c.bind(),t(e)||e instanceof ArrayBuffer)m(e,l);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var a=zt.allocType(c.dtype,e.length);Me(a,e),m(a,l),zt.freeType(a)}else if(Array.isArray(e[0])||t(e[0])){i=ke(e);var r=Je(e,i,c.dtype);m(r,l),zt.freeType(r)}else nt.raise("invalid buffer data")}else if(Re(e)){i=e.shape;var o=e.stride,s=0,d=0,h=0,p=0;1===i.length?(s=i[0],d=1,h=o[0],p=0):2===i.length?(s=i[0],d=i[1],h=o[0],p=o[1]):nt.raise("invalid shape");var b=Array.isArray(e.data)?c.dtype:Qe(e.data),f=zt.allocType(b,s*d);Be(f,e.data,s,d,h,p,e.offset),m(f,l),zt.freeType(f)}else nt.raise("invalid data for buffer subdata");return u}return r[c.id]=c,s||u(l),u._reglType="buffer",u._buffer=c,u.subdata=b,i.profile&&(u.stats=c.stats),u.destroy=function(){p(c)},u}function b(){ge(r).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))}return i.profile&&(n.getTotalBufferSize=function(){var t=0;return Object.keys(r).forEach((function(e){t+=r[e].stats.size})),t}),{create:m,createStream:d,destroyStream:c,clear:function(){ge(r).forEach(p),s.forEach(p)},getBuffer:function(t){return t&&t._buffer instanceof o?t._buffer:null},restore:b,_initBuffer:h}}Fe[5120]=1,Fe[5122]=2,Fe[5124]=4,Fe[5121]=1,Fe[5123]=2,Fe[5125]=4,Fe[5126]=4;var je={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Pe=0,Ee=1,Oe=4,De=5120,Ae=5121,qe=5122,$e=5123,tn=5124,en=5125,nn=34963,ln=35040,an=35044;function rn(e,n,i,l){var a={},r=0,o={uint8:Ae,uint16:$e};function s(t){this.id=r++,a[this.id]=this,this.buffer=t,this.primType=Oe,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(o.uint32=en),s.prototype.bind=function(){this.buffer.bind()};var d=[];function c(t){var e=d.pop();return e||(e=new s(i.create(null,nn,!0,!1)._buffer)),h(e,t,ln,-1,-1,0,0),e}function u(t){d.push(t)}function h(l,a,r,o,s,d,c){var u;if(l.buffer.bind(),a){var h=c;c||t(a)&&(!Re(a)||t(a.data))||(h=n.oes_element_index_uint?en:$e),i._initBuffer(l.buffer,a,r,h,3)}else e.bufferData(nn,d,r),l.buffer.dtype=u||Ae,l.buffer.usage=r,l.buffer.dimension=3,l.buffer.byteLength=d;if(u=c,!c){switch(l.buffer.dtype){case Ae:case De:u=Ae;break;case $e:case qe:u=$e;break;case en:case tn:u=en;break;default:nt.raise("unsupported type for element array")}l.buffer.dtype=u}l.type=u,nt(u!==en||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var p=s;p<0&&(p=l.buffer.byteLength,u===$e?p>>=1:u===en&&(p>>=2)),l.vertCount=p;var m=o;if(o<0){m=Oe;var b=l.buffer.dimension;1===b&&(m=Pe),2===b&&(m=Ee),3===b&&(m=Oe)}l.primType=m}function p(t){l.elementsCount--,nt(null!==t.buffer,"must not double destroy elements"),delete a[t.id],t.buffer.destroy(),t.buffer=null}function m(e,n){var a=i.create(null,nn,!0),r=new s(a._buffer);function d(e){if(e)if("number"==typeof e)a(e),r.primType=Oe,r.vertCount=0|e,r.type=Ae;else{var n=null,i=an,l=-1,s=-1,c=0,u=0;Array.isArray(e)||t(e)||Re(e)?n=e:(nt.type(e,"object","invalid arguments for elements"),"data"in e&&(n=e.data,nt(Array.isArray(n)||t(n)||Re(n),"invalid data for element buffer")),"usage"in e&&(nt.parameter(e.usage,Ne,"invalid element buffer usage"),i=Ne[e.usage]),"primitive"in e&&(nt.parameter(e.primitive,je,"invalid element buffer primitive"),l=je[e.primitive]),"count"in e&&(nt("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),s=0|e.count),"type"in e&&(nt.parameter(e.type,o,"invalid buffer type"),u=o[e.type]),"length"in e?c=0|e.length:(c=s,u===$e||u===qe?c*=2:u!==en&&u!==tn||(c*=4))),h(r,n,i,l,s,c,u)}else a(),r.primType=Oe,r.vertCount=0,r.type=Ae;return d}return l.elementsCount++,d(e),d._reglType="elements",d._elements=r,d.subdata=function(t,e){return a.subdata(t,e),d},d.destroy=function(){p(r)},d}return{create:m,createStream:c,destroyStream:u,getElements:function(t){return"function"==typeof t&&t._elements instanceof s?t._elements:null},clear:function(){ge(a).forEach(p)}}}var on=new Float32Array(1),sn=new Uint32Array(on.buffer),dn=5123;function cn(t){for(var e=zt.allocType(dn,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{on[0]=t[n];var i=sn[0],l=i>>>31<<15,a=(i<<1>>>24)-127,r=i>>13&1023;if(a<-24)e[n]=l;else if(a<-14){var o=-14-a;e[n]=l+(r+1024>>o)}else e[n]=a>15?l+31744:l+(a+15<<10)+r}return e}function un(e){return Array.isArray(e)||t(e)}var hn=function(t){return!(t&t-1||!t)},pn=34467,mn=3553,bn=34067,fn=34069,yn=6408,Zn=6406,Xn=6407,Gn=6409,Vn=6410,Wn=32854,Rn=32855,gn=36194,vn=32819,xn=32820,_n=33635,Kn=34042,Sn=6402,Yn=34041,Ln=35904,Hn=35906,Cn=36193,Nn=33776,Jn=33777,kn=33778,zn=33779,In=35986,wn=35987,Tn=34798,Fn=35840,Qn=35841,Mn=35842,Bn=35843,Un=36196,jn=5121,Pn=5123,En=5125,On=5126,Dn=10242,An=10243,qn=10497,$n=33071,ti=33648,ei=10240,ni=10241,ii=9728,li=9729,ai=9984,ri=9985,oi=9986,si=9987,di=33170,ci=4352,ui=4353,hi=4354,pi=34046,mi=3317,bi=37440,fi=37441,yi=37443,Zi=37444,Xi=33984,Gi=[ai,oi,ri,si],Vi=[0,Gn,Vn,Xn,yn],Wi={};function Ri(t){return"[object "+t+"]"}Wi[Gn]=Wi[Zn]=Wi[Sn]=1,Wi[Yn]=Wi[Vn]=2,Wi[Xn]=Wi[Ln]=3,Wi[yn]=Wi[Hn]=4;var gi=Ri("HTMLCanvasElement"),vi=Ri("OffscreenCanvas"),xi=Ri("CanvasRenderingContext2D"),_i=Ri("ImageBitmap"),Ki=Ri("HTMLImageElement"),Si=Ri("HTMLVideoElement"),Yi=Object.keys(He).concat([gi,vi,xi,_i,Ki,Si]),Li=[];Li[jn]=1,Li[On]=4,Li[Cn]=2,Li[Pn]=2,Li[En]=4;var Hi=[];function Ci(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function Ni(t){return!!Array.isArray(t)&&!(0===t.length||!un(t[0]))}function Ji(t){return Object.prototype.toString.call(t)}function ki(t){return Ji(t)===gi}function zi(t){return Ji(t)===vi}function Ii(t){return Ji(t)===xi}function wi(t){return Ji(t)===_i}function Ti(t){return Ji(t)===Ki}function Fi(t){return Ji(t)===Si}function Qi(t){if(!t)return!1;var e=Ji(t);return Yi.indexOf(e)>=0||Ci(t)||Ni(t)||Re(t)}function Mi(t){return 0|He[Object.prototype.toString.call(t)]}function Bi(t,e){var n=e.length;switch(t.type){case jn:case Pn:case En:case On:var i=zt.allocType(t.type,n);i.set(e),t.data=i;break;case Cn:t.data=cn(e);break;default:nt.raise("unsupported texture type, must specify a typed array")}}function Ui(t,e){return zt.allocType(t.type===Cn?On:t.type,e)}function ji(t,e){t.type===Cn?(t.data=cn(e),zt.freeType(e)):t.data=e}function Pi(t,e,n,i,l,a){for(var r=t.width,o=t.height,s=t.channels,d=Ui(t,r*o*s),c=0,u=0;u<o;++u)for(var h=0;h<r;++h)for(var p=0;p<s;++p)d[c++]=e[n*h+i*u+l*p+a];ji(t,d)}function Ei(t,e,n,i,l,a){var r;if(r=void 0!==Hi[t]?Hi[t]:Wi[t]*Li[e],a&&(r*=6),l){for(var o=0,s=n;s>=1;)o+=r*s*s,s/=2;return o}return r*n*i}function Oi(n,i,l,a,r,o,s){var d={"don't care":ci,"dont care":ci,nice:hi,fast:ui},c={repeat:qn,clamp:$n,mirror:ti},u={nearest:ii,linear:li},h=e({mipmap:si,"nearest mipmap nearest":ai,"linear mipmap nearest":ri,"nearest mipmap linear":oi,"linear mipmap linear":si},u),p={none:0,browser:Zi},m={uint8:jn,rgba4:vn,rgb565:_n,"rgb5 a1":xn},b={alpha:Zn,luminance:Gn,"luminance alpha":Vn,rgb:Xn,rgba:yn,rgba4:Wn,"rgb5 a1":Rn,rgb565:gn},f={};i.ext_srgb&&(b.srgb=Ln,b.srgba=Hn),i.oes_texture_float&&(m.float32=m.float=On),i.oes_texture_half_float&&(m.float16=m["half float"]=Cn),i.webgl_depth_texture&&(e(b,{depth:Sn,"depth stencil":Yn}),e(m,{uint16:Pn,uint32:En,"depth stencil":Kn})),i.webgl_compressed_texture_s3tc&&e(f,{"rgb s3tc dxt1":Nn,"rgba s3tc dxt1":Jn,"rgba s3tc dxt3":kn,"rgba s3tc dxt5":zn}),i.webgl_compressed_texture_atc&&e(f,{"rgb atc":In,"rgba atc explicit alpha":wn,"rgba atc interpolated alpha":Tn}),i.webgl_compressed_texture_pvrtc&&e(f,{"rgb pvrtc 4bppv1":Fn,"rgb pvrtc 2bppv1":Qn,"rgba pvrtc 4bppv1":Mn,"rgba pvrtc 2bppv1":Bn}),i.webgl_compressed_texture_etc1&&(f["rgb etc1"]=Un);var y=Array.prototype.slice.call(n.getParameter(pn));Object.keys(f).forEach((function(t){var e=f[t];y.indexOf(e)>=0&&(b[t]=e)}));var Z=Object.keys(b);l.textureFormats=Z;var X=[];Object.keys(b).forEach((function(t){var e=b[t];X[e]=t}));var G=[];Object.keys(m).forEach((function(t){var e=m[t];G[e]=t}));var V=[];Object.keys(u).forEach((function(t){var e=u[t];V[e]=t}));var W=[];Object.keys(h).forEach((function(t){var e=h[t];W[e]=t}));var R=[];Object.keys(c).forEach((function(t){var e=c[t];R[e]=t}));var g=Z.reduce((function(t,e){var n=b[e];return n===Gn||n===Zn||n===Gn||n===Vn||n===Sn||n===Yn||i.ext_srgb&&(n===Ln||n===Hn)?t[n]=n:n===Rn||e.indexOf("rgba")>=0?t[n]=yn:t[n]=Xn,t}),{});function v(){this.internalformat=yn,this.format=yn,this.type=jn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Zi,this.width=0,this.height=0,this.channels=0}function x(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function _(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(nt.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(nt.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(nt.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(nt.parameter(e.colorSpace,p,"invalid colorSpace"),t.colorSpace=p[e.colorSpace]),"type"in e){var n=e.type;nt(i.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),nt(i.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),nt(i.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),nt.parameter(n,m,"invalid texture type"),t.type=m[n]}var a=t.width,r=t.height,o=t.channels,s=!1;"shape"in e?(nt(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),a=e.shape[0],r=e.shape[1],3===e.shape.length&&(o=e.shape[2],nt(o>0&&o<=4,"invalid number of channels"),s=!0),nt(a>=0&&a<=l.maxTextureSize,"invalid width"),nt(r>=0&&r<=l.maxTextureSize,"invalid height")):("radius"in e&&(a=r=e.radius,nt(a>=0&&a<=l.maxTextureSize,"invalid radius")),"width"in e&&(a=e.width,nt(a>=0&&a<=l.maxTextureSize,"invalid width")),"height"in e&&(r=e.height,nt(r>=0&&r<=l.maxTextureSize,"invalid height")),"channels"in e&&(o=e.channels,nt(o>0&&o<=4,"invalid number of channels"),s=!0)),t.width=0|a,t.height=0|r,t.channels=0|o;var d=!1;if("format"in e){var c=e.format;nt(i.webgl_depth_texture||!("depth"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),nt.parameter(c,b,"invalid texture format");var u=t.internalformat=b[c];t.format=g[u],c in m&&("type"in e||(t.type=m[c])),c in f&&(t.compressed=!0),d=!0}!s&&d?t.channels=Wi[t.format]:s&&!d?t.channels!==Vi[t.format]&&(t.format=t.internalformat=Vi[t.channels]):d&&s&&nt(t.channels===Wi[t.format],"number of channels inconsistent with specified format")}}function K(t){n.pixelStorei(bi,t.flipY),n.pixelStorei(fi,t.premultiplyAlpha),n.pixelStorei(yi,t.colorSpace),n.pixelStorei(mi,t.unpackAlignment)}function S(){v.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Y(e,n){var i=null;if(Qi(n)?i=n:n&&(nt.type(n,"object","invalid pixel data type"),_(e,n),"x"in n&&(e.xOffset=0|n.x),"y"in n&&(e.yOffset=0|n.y),Qi(n.data)&&(i=n.data)),nt(!e.compressed||i instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){nt(!i,"can not specify copy and data field for the same texture");var a=r.viewportWidth,o=r.viewportHeight;e.width=e.width||a-e.xOffset,e.height=e.height||o-e.yOffset,e.needsCopy=!0,nt(e.xOffset>=0&&e.xOffset<a&&e.yOffset>=0&&e.yOffset<o&&e.width>0&&e.width<=a&&e.height>0&&e.height<=o,"copy texture read out of bounds")}else if(i){if(t(i))e.channels=e.channels||4,e.data=i,"type"in n||e.type!==jn||(e.type=Mi(i));else if(Ci(i))e.channels=e.channels||4,Bi(e,i),e.alignment=1,e.needsFree=!0;else if(Re(i)){var s=i.data;Array.isArray(s)||e.type!==jn||(e.type=Mi(s));var d,c,u,h,p,m,b=i.shape,f=i.stride;3===b.length?(u=b[2],m=f[2]):(nt(2===b.length,"invalid ndarray pixel data, must be 2 or 3D"),u=1,m=1),d=b[0],c=b[1],h=f[0],p=f[1],e.alignment=1,e.width=d,e.height=c,e.channels=u,e.format=e.internalformat=Vi[u],e.needsFree=!0,Pi(e,s,h,p,m,i.offset)}else if(ki(i)||zi(i)||Ii(i))ki(i)||zi(i)?e.element=i:e.element=i.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(wi(i))e.element=i,e.width=i.width,e.height=i.height,e.channels=4;else if(Ti(i))e.element=i,e.width=i.naturalWidth,e.height=i.naturalHeight,e.channels=4;else if(Fi(i))e.element=i,e.width=i.videoWidth,e.height=i.videoHeight,e.channels=4;else if(Ni(i)){var y=e.width||i[0].length,Z=e.height||i.length,X=e.channels;X=un(i[0][0])?X||i[0][0].length:X||1;for(var G=ve.shape(i),V=1,W=0;W<G.length;++W)V*=G[W];var R=Ui(e,V);ve.flatten(i,G,"",R),ji(e,R),e.alignment=1,e.width=y,e.height=Z,e.channels=X,e.format=e.internalformat=Vi[X],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===On?nt(l.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===Cn&&nt(l.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function L(t,e,i){var l=t.element,r=t.data,o=t.internalformat,s=t.format,d=t.type,c=t.width,u=t.height;K(t),l?n.texImage2D(e,i,s,s,d,l):t.compressed?n.compressedTexImage2D(e,i,o,c,u,0,r):t.needsCopy?(a(),n.copyTexImage2D(e,i,s,t.xOffset,t.yOffset,c,u,0)):n.texImage2D(e,i,s,c,u,0,s,d,r||null)}function H(t,e,i,l,r){var o=t.element,s=t.data,d=t.internalformat,c=t.format,u=t.type,h=t.width,p=t.height;K(t),o?n.texSubImage2D(e,r,i,l,c,u,o):t.compressed?n.compressedTexSubImage2D(e,r,i,l,d,h,p,s):t.needsCopy?(a(),n.copyTexSubImage2D(e,r,i,l,t.xOffset,t.yOffset,h,p)):n.texSubImage2D(e,r,i,l,h,p,c,u,s)}var C=[];function N(){return C.pop()||new S}function J(t){t.needsFree&&zt.freeType(t.data),S.call(t),C.push(t)}function k(){v.call(this),this.genMipmaps=!1,this.mipmapHint=ci,this.mipmask=0,this.images=Array(16)}function z(t,e,n){var i=t.images[0]=N();t.mipmask=1,i.width=t.width=e,i.height=t.height=n,i.channels=t.channels=4}function I(t,e){var n=null;if(Qi(e))x(n=t.images[0]=N(),t),Y(n,e),t.mipmask=1;else if(_(t,e),Array.isArray(e.mipmap))for(var i=e.mipmap,l=0;l<i.length;++l)x(n=t.images[l]=N(),t),n.width>>=l,n.height>>=l,Y(n,i[l]),t.mipmask|=1<<l;else x(n=t.images[0]=N(),t),Y(n,e),t.mipmask=1;x(t,t.images[0]),!t.compressed||t.internalformat!==Nn&&t.internalformat!==Jn&&t.internalformat!==kn&&t.internalformat!==zn||nt(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function w(t,e){for(var n=t.images,i=0;i<n.length;++i){if(!n[i])return;L(n[i],e,i)}}var T=[];function F(){var t=T.pop()||new k;v.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function Q(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&J(e[n]),e[n]=null;T.push(t)}function M(){this.minFilter=ii,this.magFilter=ii,this.wrapS=$n,this.wrapT=$n,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ci}function B(t,e){if("min"in e){var n=e.min;nt.parameter(n,h),t.minFilter=h[n],Gi.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var i=e.mag;nt.parameter(i,u),t.magFilter=u[i]}var a=t.wrapS,r=t.wrapT;if("wrap"in e){var o=e.wrap;"string"==typeof o?(nt.parameter(o,c),a=r=c[o]):Array.isArray(o)&&(nt.parameter(o[0],c),nt.parameter(o[1],c),a=c[o[0]],r=c[o[1]])}else{if("wrapS"in e){var s=e.wrapS;nt.parameter(s,c),a=c[s]}if("wrapT"in e){var p=e.wrapT;nt.parameter(p,c),r=c[p]}}if(t.wrapS=a,t.wrapT=r,"anisotropic"in e){var m=e.anisotropic;nt("number"==typeof m&&m>=1&&m<=l.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var b=!1;switch(typeof e.mipmap){case"string":nt.parameter(e.mipmap,d,"invalid mipmap hint"),t.mipmapHint=d[e.mipmap],t.genMipmaps=!0,b=!0;break;case"boolean":b=t.genMipmaps=e.mipmap;break;case"object":nt(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,b=!0;break;default:nt.raise("invalid mipmap type")}b&&!("min"in e)&&(t.minFilter=ai)}}function U(t,e){n.texParameteri(e,ni,t.minFilter),n.texParameteri(e,ei,t.magFilter),n.texParameteri(e,Dn,t.wrapS),n.texParameteri(e,An,t.wrapT),i.ext_texture_filter_anisotropic&&n.texParameteri(e,pi,t.anisotropic),t.genMipmaps&&(n.hint(di,t.mipmapHint),n.generateMipmap(e))}var j=0,P={},E=l.maxTextureUnits,O=Array(E).map((function(){return null}));function D(t){v.call(this),this.mipmask=0,this.internalformat=yn,this.id=j++,this.refCount=1,this.target=t,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new M,s.profile&&(this.stats={size:0})}function A(t){n.activeTexture(Xi),n.bindTexture(t.target,t.texture)}function q(){var t=O[0];t?n.bindTexture(t.target,t.texture):n.bindTexture(mn,null)}function $(t){var e=t.texture;nt(e,"must not double destroy texture");var i=t.unit,l=t.target;i>=0&&(n.activeTexture(Xi+i),n.bindTexture(l,null),O[i]=null),n.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete P[t.id],o.textureCount--}function tt(t,e){var i=new D(mn);function a(t,e){var n=i.texInfo;M.call(n);var r=F();return"number"==typeof t?z(r,0|t,"number"==typeof e?0|e:0|t):t?(nt.type(t,"object","invalid arguments to regl.texture"),B(n,t),I(r,t)):z(r,1,1),n.genMipmaps&&(r.mipmask=(r.width<<1)-1),i.mipmask=r.mipmask,x(i,r),nt.texture2D(n,r,l),i.internalformat=r.internalformat,a.width=r.width,a.height=r.height,A(i),w(r,mn),U(n,mn),q(),Q(r),s.profile&&(i.stats.size=Ei(i.internalformat,i.type,r.width,r.height,n.genMipmaps,!1)),a.format=X[i.internalformat],a.type=G[i.type],a.mag=V[n.magFilter],a.min=W[n.minFilter],a.wrapS=R[n.wrapS],a.wrapT=R[n.wrapT],a}function r(t,e,n,l){nt(!!t,"must specify image data");var r=0|e,o=0|n,s=0|l,d=N();return x(d,i),d.width=0,d.height=0,Y(d,t),d.width=d.width||(i.width>>s)-r,d.height=d.height||(i.height>>s)-o,nt(i.type===d.type&&i.format===d.format&&i.internalformat===d.internalformat,"incompatible format for texture.subimage"),nt(r>=0&&o>=0&&r+d.width<=i.width&&o+d.height<=i.height,"texture.subimage write out of bounds"),nt(i.mipmask&1<<s,"missing mipmap data"),nt(d.data||d.element||d.needsCopy,"missing image data"),A(i),H(d,mn,r,o,s),q(),J(d),a}function d(t,e){var l=0|t,r=0|e||l;if(l===i.width&&r===i.height)return a;a.width=i.width=l,a.height=i.height=r,A(i);for(var o=0;i.mipmask>>o;++o){var d=l>>o,c=r>>o;if(!d||!c)break;n.texImage2D(mn,o,i.format,d,c,0,i.format,i.type,null)}return q(),s.profile&&(i.stats.size=Ei(i.internalformat,i.type,l,r,!1,!1)),a}return P[i.id]=i,o.textureCount++,a(t,e),a.subimage=r,a.resize=d,a._reglType="texture2d",a._texture=i,s.profile&&(a.stats=i.stats),a.destroy=function(){i.decRef()},a}function et(t,e,i,a,r,d){var c=new D(bn);P[c.id]=c,o.cubeCount++;var u=new Array(6);function h(t,e,n,i,a,r){var o,d=c.texInfo;for(M.call(d),o=0;o<6;++o)u[o]=F();if("number"!=typeof t&&t)if("object"==typeof t)if(e)I(u[0],t),I(u[1],e),I(u[2],n),I(u[3],i),I(u[4],a),I(u[5],r);else if(B(d,t),_(c,t),"faces"in t){var p=t.faces;for(nt(Array.isArray(p)&&6===p.length,"cube faces must be a length 6 array"),o=0;o<6;++o)nt("object"==typeof p[o]&&!!p[o],"invalid input for cube map face"),x(u[o],c),I(u[o],p[o])}else for(o=0;o<6;++o)I(u[o],t);else nt.raise("invalid arguments to cube map");else{var m=0|t||1;for(o=0;o<6;++o)z(u[o],m,m)}for(x(c,u[0]),nt.optional((function(){l.npotTextureCube||nt(hn(c.width)&&hn(c.height),"your browser does not support non power or two texture dimensions")})),d.genMipmaps?c.mipmask=(u[0].width<<1)-1:c.mipmask=u[0].mipmask,nt.textureCube(c,d,u,l),c.internalformat=u[0].internalformat,h.width=u[0].width,h.height=u[0].height,A(c),o=0;o<6;++o)w(u[o],fn+o);for(U(d,bn),q(),s.profile&&(c.stats.size=Ei(c.internalformat,c.type,h.width,h.height,d.genMipmaps,!0)),h.format=X[c.internalformat],h.type=G[c.type],h.mag=V[d.magFilter],h.min=W[d.minFilter],h.wrapS=R[d.wrapS],h.wrapT=R[d.wrapT],o=0;o<6;++o)Q(u[o]);return h}function p(t,e,n,i,l){nt(!!e,"must specify image data"),nt("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var a=0|n,r=0|i,o=0|l,s=N();return x(s,c),s.width=0,s.height=0,Y(s,e),s.width=s.width||(c.width>>o)-a,s.height=s.height||(c.height>>o)-r,nt(c.type===s.type&&c.format===s.format&&c.internalformat===s.internalformat,"incompatible format for texture.subimage"),nt(a>=0&&r>=0&&a+s.width<=c.width&&r+s.height<=c.height,"texture.subimage write out of bounds"),nt(c.mipmask&1<<o,"missing mipmap data"),nt(s.data||s.element||s.needsCopy,"missing image data"),A(c),H(s,fn+t,a,r,o),q(),J(s),h}function m(t){var e=0|t;if(e!==c.width){h.width=c.width=e,h.height=c.height=e,A(c);for(var i=0;i<6;++i)for(var l=0;c.mipmask>>l;++l)n.texImage2D(fn+i,l,c.format,e>>l,e>>l,0,c.format,c.type,null);return q(),s.profile&&(c.stats.size=Ei(c.internalformat,c.type,h.width,h.height,!1,!0)),h}}return h(t,e,i,a,r,d),h.subimage=p,h.resize=m,h._reglType="textureCube",h._texture=c,s.profile&&(h.stats=c.stats),h.destroy=function(){c.decRef()},h}function it(){for(var t=0;t<E;++t)n.activeTexture(Xi+t),n.bindTexture(mn,null),O[t]=null;ge(P).forEach($),o.cubeCount=0,o.textureCount=0}function lt(){for(var t=0;t<E;++t){var e=O[t];e&&(e.bindCount=0,e.unit=-1,O[t]=null)}ge(P).forEach((function(t){t.texture=n.createTexture(),n.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!=(t.mipmask&1<<e))if(t.target===mn)n.texImage2D(mn,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var i=0;i<6;++i)n.texImage2D(fn+i,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);U(t.texInfo,t.target)}))}function at(){for(var t=0;t<E;++t){var e=O[t];e&&(e.bindCount=0,e.unit=-1,O[t]=null),n.activeTexture(Xi+t),n.bindTexture(mn,null),n.bindTexture(bn,null)}}return e(D.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var i=0;i<E;++i){var l=O[i];if(l){if(l.bindCount>0)continue;l.unit=-1}O[i]=t,e=i;break}e>=E&&nt.raise("insufficient number of texture units"),s.profile&&o.maxTextureUnits<e+1&&(o.maxTextureUnits=e+1),t.unit=e,n.activeTexture(Xi+e),n.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&$(this)}}),s.profile&&(o.getTotalTextureSize=function(){var t=0;return Object.keys(P).forEach((function(e){t+=P[e].stats.size})),t}),{create2D:tt,createCube:et,clear:it,getTexture:function(t){return null},restore:lt,refresh:at}}Hi[Wn]=2,Hi[Rn]=2,Hi[gn]=2,Hi[Yn]=4,Hi[Nn]=.5,Hi[Jn]=.5,Hi[kn]=1,Hi[zn]=1,Hi[In]=.5,Hi[wn]=1,Hi[Tn]=1,Hi[Fn]=.5,Hi[Qn]=.25,Hi[Mn]=.5,Hi[Bn]=.25,Hi[Un]=.5;var Di=36161,Ai=32854,qi=32855,$i=36194,tl=33189,el=36168,nl=34041,il=35907,ll=34836,al=34842,rl=34843,ol=[];function sl(t,e,n){return ol[t]*e*n}ol[Ai]=2,ol[qi]=2,ol[$i]=2,ol[tl]=2,ol[el]=1,ol[nl]=4,ol[il]=4,ol[ll]=16,ol[al]=8,ol[rl]=6;var dl=function(t,e,n,i,l){var a={rgba4:Ai,rgb565:$i,"rgb5 a1":qi,depth:tl,stencil:el,"depth stencil":nl};e.ext_srgb&&(a.srgba=il),e.ext_color_buffer_half_float&&(a.rgba16f=al,a.rgb16f=rl),e.webgl_color_buffer_float&&(a.rgba32f=ll);var r=[];Object.keys(a).forEach((function(t){var e=a[t];r[e]=t}));var o=0,s={};function d(t){this.id=o++,this.refCount=1,this.renderbuffer=t,this.format=Ai,this.width=0,this.height=0,l.profile&&(this.stats={size:0})}function c(e){var n=e.renderbuffer;nt(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(Di,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete s[e.id],i.renderbufferCount--}function u(e,o){var c=new d(t.createRenderbuffer());function u(e,i){var o=0,s=0,d=Ai;if("object"==typeof e&&e){var h=e;if("shape"in h){var p=h.shape;nt(Array.isArray(p)&&p.length>=2,"invalid renderbuffer shape"),o=0|p[0],s=0|p[1]}else"radius"in h&&(o=s=0|h.radius),"width"in h&&(o=0|h.width),"height"in h&&(s=0|h.height);"format"in h&&(nt.parameter(h.format,a,"invalid renderbuffer format"),d=a[h.format])}else"number"==typeof e?(o=0|e,s="number"==typeof i?0|i:o):e?nt.raise("invalid arguments to renderbuffer constructor"):o=s=1;if(nt(o>0&&s>0&&o<=n.maxRenderbufferSize&&s<=n.maxRenderbufferSize,"invalid renderbuffer size"),o!==c.width||s!==c.height||d!==c.format)return u.width=c.width=o,u.height=c.height=s,c.format=d,t.bindRenderbuffer(Di,c.renderbuffer),t.renderbufferStorage(Di,d,o,s),nt(0===t.getError(),"invalid render buffer format"),l.profile&&(c.stats.size=sl(c.format,c.width,c.height)),u.format=r[c.format],u}function h(e,i){var a=0|e,r=0|i||a;return a===c.width&&r===c.height||(nt(a>0&&r>0&&a<=n.maxRenderbufferSize&&r<=n.maxRenderbufferSize,"invalid renderbuffer size"),u.width=c.width=a,u.height=c.height=r,t.bindRenderbuffer(Di,c.renderbuffer),t.renderbufferStorage(Di,c.format,a,r),nt(0===t.getError(),"invalid render buffer format"),l.profile&&(c.stats.size=sl(c.format,c.width,c.height))),u}return s[c.id]=c,i.renderbufferCount++,u(e,o),u.resize=h,u._reglType="renderbuffer",u._renderbuffer=c,l.profile&&(u.stats=c.stats),u.destroy=function(){c.decRef()},u}function h(){ge(s).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(Di,e.renderbuffer),t.renderbufferStorage(Di,e.format,e.width,e.height)})),t.bindRenderbuffer(Di,null)}return d.prototype.decRef=function(){--this.refCount<=0&&c(this)},l.profile&&(i.getTotalRenderbufferSize=function(){var t=0;return Object.keys(s).forEach((function(e){t+=s[e].stats.size})),t}),{create:u,clear:function(){ge(s).forEach(c)},restore:h}},cl=36160,ul=36161,hl=3553,pl=34069,ml=36064,bl=36096,fl=36128,yl=33306,Zl=36053,Xl=36054,Gl=36055,Vl=36057,Wl=36061,Rl=36193,gl=5121,vl=5126,xl=6407,_l=6408,Kl=6402,Sl=[xl,_l],Yl=[];Yl[_l]=4,Yl[xl]=3;var Ll=[];Ll[gl]=1,Ll[vl]=4,Ll[Rl]=2;var Hl=33189,Cl=36168,Nl=34041,Jl=[32854,32855,36194,35907,34842,34843,34836],kl={};function zl(t,n,i,l,a,r){var o={cur:null,next:null,dirty:!1,setFBO:null},s=["rgba"],d=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&d.push("srgba"),n.ext_color_buffer_half_float&&d.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&d.push("rgba32f");var c=["uint8"];function u(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var i=0,l=0;e?(i=e.width,l=e.height):n&&(i=n.width,l=n.height),this.width=i,this.height=l}function h(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function p(t,e,n){if(t)if(t.texture){var i=t.texture._texture,l=Math.max(1,i.width),a=Math.max(1,i.height);nt(l===e&&a===n,"inconsistent width/height for supplied texture"),i.refCount+=1}else{var r=t.renderbuffer._renderbuffer;nt(r.width===e&&r.height===n,"inconsistent width/height for renderbuffer"),r.refCount+=1}}function m(e,n){n&&(n.texture?t.framebufferTexture2D(cl,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(cl,e,ul,n.renderbuffer._renderbuffer.renderbuffer))}function b(t){var e=hl,n=null,i=null,l=t;"object"==typeof t&&(l=t.data,"target"in t&&(e=0|t.target)),nt.type(l,"function","invalid attachment data");var a=l._reglType;return"texture2d"===a?(n=l,nt(e===hl)):"textureCube"===a?(n=l,nt(e>=pl&&e<pl+6,"invalid cube map target")):"renderbuffer"===a?(i=l,e=ul):nt.raise("invalid regl object for attachment"),new u(e,n,i)}function f(t,e,n,i,r){if(n){var o=l.create2D({width:t,height:e,format:i,type:r});return o._texture.refCount=0,new u(hl,o,null)}var s=a.create({width:t,height:e,format:i});return s._renderbuffer.refCount=0,new u(ul,null,s)}function y(t){return t&&(t.texture||t.renderbuffer)}function Z(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}n.oes_texture_half_float&&c.push("half float","float16"),n.oes_texture_float&&c.push("float","float32");var X=0,G={};function V(){this.id=X++,G[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function W(t){t.colorAttachments.forEach(h),h(t.depthAttachment),h(t.stencilAttachment),h(t.depthStencilAttachment)}function R(e){var n=e.framebuffer;nt(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,r.framebufferCount--,delete G[e.id]}function g(e){var n;t.bindFramebuffer(cl,e.framebuffer);var l=e.colorAttachments;for(n=0;n<l.length;++n)m(ml+n,l[n]);for(n=l.length;n<i.maxColorAttachments;++n)t.framebufferTexture2D(cl,ml+n,hl,null,0);t.framebufferTexture2D(cl,yl,hl,null,0),t.framebufferTexture2D(cl,bl,hl,null,0),t.framebufferTexture2D(cl,fl,hl,null,0),m(bl,e.depthAttachment),m(fl,e.stencilAttachment),m(yl,e.depthStencilAttachment);var a=t.checkFramebufferStatus(cl);t.isContextLost()||a===Zl||nt.raise("framebuffer configuration not supported, status = "+kl[a]),t.bindFramebuffer(cl,o.next?o.next.framebuffer:null),o.cur=o.next,t.getError()}function v(t,l){var a=new V;function u(t,e){var l;nt(o.next!==a,"can not update framebuffer which is currently in use");var r=0,h=0,m=!0,Z=!0,X=null,G=!0,V="rgba",R="uint8",v=1,x=null,_=null,K=null,S=!1;if("number"==typeof t)r=0|t,h=0|e||r;else if(t){nt.type(t,"object","invalid arguments for framebuffer");var Y=t;if("shape"in Y){var L=Y.shape;nt(Array.isArray(L)&&L.length>=2,"invalid shape for framebuffer"),r=L[0],h=L[1]}else"radius"in Y&&(r=h=Y.radius),"width"in Y&&(r=Y.width),"height"in Y&&(h=Y.height);("color"in Y||"colors"in Y)&&(X=Y.color||Y.colors,Array.isArray(X)&&nt(1===X.length||n.webgl_draw_buffers,"multiple render targets not supported")),X||("colorCount"in Y&&(v=0|Y.colorCount,nt(v>0,"invalid color buffer count")),"colorTexture"in Y&&(G=!!Y.colorTexture,V="rgba4"),"colorType"in Y&&(R=Y.colorType,G?(nt(n.oes_texture_float||!("float"===R||"float32"===R),"you must enable OES_texture_float in order to use floating point framebuffer objects"),nt(n.oes_texture_half_float||!("half float"===R||"float16"===R),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===R||"float16"===R?(nt(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),V="rgba16f"):"float"!==R&&"float32"!==R||(nt(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),V="rgba32f"),nt.oneOf(R,c,"invalid color type")),"colorFormat"in Y&&(V=Y.colorFormat,s.indexOf(V)>=0?G=!0:d.indexOf(V)>=0?G=!1:nt.optional((function(){G?nt.oneOf(Y.colorFormat,s,"invalid color format for texture"):nt.oneOf(Y.colorFormat,d,"invalid color format for renderbuffer")})))),("depthTexture"in Y||"depthStencilTexture"in Y)&&(S=!(!Y.depthTexture&&!Y.depthStencilTexture),nt(!S||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Y&&("boolean"==typeof Y.depth?m=Y.depth:(x=Y.depth,Z=!1)),"stencil"in Y&&("boolean"==typeof Y.stencil?Z=Y.stencil:(_=Y.stencil,m=!1)),"depthStencil"in Y&&("boolean"==typeof Y.depthStencil?m=Z=Y.depthStencil:(K=Y.depthStencil,m=!1,Z=!1))}else r=h=1;var H=null,C=null,N=null,J=null;if(Array.isArray(X))H=X.map(b);else if(X)H=[b(X)];else for(H=new Array(v),l=0;l<v;++l)H[l]=f(r,h,G,V,R);nt(n.webgl_draw_buffers||H.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),nt(H.length<=i.maxColorAttachments,"too many color attachments, not supported"),r=r||H[0].width,h=h||H[0].height,x?C=b(x):m&&!Z&&(C=f(r,h,S,"depth","uint32")),_?N=b(_):Z&&!m&&(N=f(r,h,!1,"stencil","uint8")),K?J=b(K):!x&&!_&&Z&&m&&(J=f(r,h,S,"depth stencil","depth stencil")),nt(!!x+!!_+!!K<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var k=null;for(l=0;l<H.length;++l)if(p(H[l],r,h),nt(!H[l]||H[l].texture&&Sl.indexOf(H[l].texture._texture.format)>=0||H[l].renderbuffer&&Jl.indexOf(H[l].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+l+" is invalid"),H[l]&&H[l].texture){var z=Yl[H[l].texture._texture.format]*Ll[H[l].texture._texture.type];null===k?k=z:nt(k===z,"all color attachments much have the same number of bits per pixel.")}return p(C,r,h),nt(!C||C.texture&&C.texture._texture.format===Kl||C.renderbuffer&&C.renderbuffer._renderbuffer.format===Hl,"invalid depth attachment for framebuffer object"),p(N,r,h),nt(!N||N.renderbuffer&&N.renderbuffer._renderbuffer.format===Cl,"invalid stencil attachment for framebuffer object"),p(J,r,h),nt(!J||J.texture&&J.texture._texture.format===Nl||J.renderbuffer&&J.renderbuffer._renderbuffer.format===Nl,"invalid depth-stencil attachment for framebuffer object"),W(a),a.width=r,a.height=h,a.colorAttachments=H,a.depthAttachment=C,a.stencilAttachment=N,a.depthStencilAttachment=J,u.color=H.map(y),u.depth=y(C),u.stencil=y(N),u.depthStencil=y(J),u.width=a.width,u.height=a.height,g(a),u}function h(t,e){nt(o.next!==a,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),i=Math.max(0|e||n,1);if(n===a.width&&i===a.height)return u;for(var l=a.colorAttachments,r=0;r<l.length;++r)Z(l[r],n,i);return Z(a.depthAttachment,n,i),Z(a.stencilAttachment,n,i),Z(a.depthStencilAttachment,n,i),a.width=u.width=n,a.height=u.height=i,g(a),u}return r.framebufferCount++,u(t,l),e(u,{resize:h,_reglType:"framebuffer",_framebuffer:a,destroy:function(){R(a),W(a)},use:function(t){o.setFBO({framebuffer:u},t)}})}function x(t){var a=Array(6);function r(t){var i;nt(a.indexOf(o.next)<0,"can not update framebuffer which is currently in use");var d,u={color:null},h=0,p=null,m="rgba",b="uint8",f=1;if("number"==typeof t)h=0|t;else if(t){nt.type(t,"object","invalid arguments for framebuffer");var y=t;if("shape"in y){var Z=y.shape;nt(Array.isArray(Z)&&Z.length>=2,"invalid shape for framebuffer"),nt(Z[0]===Z[1],"cube framebuffer must be square"),h=Z[0]}else"radius"in y&&(h=0|y.radius),"width"in y?(h=0|y.width,"height"in y&&nt(y.height===h,"must be square")):"height"in y&&(h=0|y.height);("color"in y||"colors"in y)&&(p=y.color||y.colors,Array.isArray(p)&&nt(1===p.length||n.webgl_draw_buffers,"multiple render targets not supported")),p||("colorCount"in y&&(f=0|y.colorCount,nt(f>0,"invalid color buffer count")),"colorType"in y&&(nt.oneOf(y.colorType,c,"invalid color type"),b=y.colorType),"colorFormat"in y&&(m=y.colorFormat,nt.oneOf(y.colorFormat,s,"invalid color format for texture"))),"depth"in y&&(u.depth=y.depth),"stencil"in y&&(u.stencil=y.stencil),"depthStencil"in y&&(u.depthStencil=y.depthStencil)}else h=1;if(p)if(Array.isArray(p))for(d=[],i=0;i<p.length;++i)d[i]=p[i];else d=[p];else{d=Array(f);var X={radius:h,format:m,type:b};for(i=0;i<f;++i)d[i]=l.createCube(X)}for(u.color=Array(d.length),i=0;i<d.length;++i){var G=d[i];nt("function"==typeof G&&"textureCube"===G._reglType,"invalid cube map"),h=h||G.width,nt(G.width===h&&G.height===h,"invalid cube map shape"),u.color[i]={target:pl,data:d[i]}}for(i=0;i<6;++i){for(var V=0;V<d.length;++V)u.color[V].target=pl+i;i>0&&(u.depth=a[0].depth,u.stencil=a[0].stencil,u.depthStencil=a[0].depthStencil),a[i]?a[i](u):a[i]=v(u)}return e(r,{width:h,height:h,color:d})}function d(t){var e,n=0|t;if(nt(n>0&&n<=i.maxCubeMapSize,"invalid radius for cube fbo"),n===r.width)return r;var l=r.color;for(e=0;e<l.length;++e)l[e].resize(n);for(e=0;e<6;++e)a[e].resize(n);return r.width=r.height=n,r}return r(t),e(r,{faces:a,resize:d,_reglType:"framebufferCube",destroy:function(){a.forEach((function(t){t.destroy()}))}})}function _(){o.cur=null,o.next=null,o.dirty=!0,ge(G).forEach((function(e){e.framebuffer=t.createFramebuffer(),g(e)}))}return e(o,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof V)return e}return null},create:v,createCube:x,clear:function(){ge(G).forEach(R)},restore:_})}kl[Zl]="complete",kl[Xl]="incomplete attachment",kl[Vl]="incomplete dimensions",kl[Gl]="incomplete, missing attachment",kl[Wl]="unsupported";var Il=5126,wl=34962,Tl=34963,Fl=["attributes","elements","offset","count","primitive","instances"];function Ql(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Il,this.offset=0,this.stride=0,this.divisor=0}function Ml(e,n,i,l,a,r,o){for(var s=i.maxAttributes,d=new Array(s),c=0;c<s;++c)d[c]=new Ql;var u=0,h={},p={Record:Ql,scope:{},state:d,currentVAO:null,targetVAO:null,restore:b()?W:function(){},createVAO:R,getVAO:y,destroyBuffer:m,setVAO:b()?Z:X,clear:b()?G:function(){}};function m(t){for(var n=0;n<d.length;++n){var i=d[n];i.buffer===t&&(e.disableVertexAttribArray(n),i.buffer=null)}}function b(){return n.oes_vertex_array_object}function f(){return n.angle_instanced_arrays}function y(t){return"function"==typeof t&&t._vao?t._vao:null}function Z(t){if(t!==p.currentVAO){var e=b();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),p.currentVAO=t}}function X(t){if(t!==p.currentVAO){if(t)t.bindAttrs();else{for(var n=f(),i=0;i<d.length;++i){var l=d[i];l.buffer?(e.enableVertexAttribArray(i),l.buffer.bind(),e.vertexAttribPointer(i,l.size,l.type,l.normalized,l.stride,l.offfset),n&&l.divisor&&n.vertexAttribDivisorANGLE(i,l.divisor)):(e.disableVertexAttribArray(i),e.vertexAttrib4f(i,l.x,l.y,l.z,l.w))}o.elements?e.bindBuffer(Tl,o.elements.buffer.buffer):e.bindBuffer(Tl,null)}p.currentVAO=t}}function G(){ge(h).forEach((function(t){t.destroy()}))}function V(){this.id=++u,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var t=b();this.vao=t?t.createVertexArrayOES():null,h[this.id]=this,this.buffers=[]}function W(){b()&&ge(h).forEach((function(t){t.refresh()}))}function R(e){var i=new V;function o(e){var l;if(Array.isArray(e))l=e,i.elements&&i.ownsElements&&i.elements.destroy(),i.elements=null,i.ownsElements=!1,i.offset=0,i.count=0,i.instances=-1,i.primitive=4;else{if(nt("object"==typeof e,"invalid arguments for create vao"),nt("attributes"in e,"must specify attributes for vao"),e.elements){var d=e.elements;i.ownsElements?"function"==typeof d&&"elements"===d._reglType?(i.elements.destroy(),i.ownsElements=!1):(i.elements(d),i.ownsElements=!1):r.getElements(e.elements)?(i.elements=e.elements,i.ownsElements=!1):(i.elements=r.create(e.elements),i.ownsElements=!0)}else i.elements=null,i.ownsElements=!1;l=e.attributes,i.offset=0,i.count=-1,i.instances=-1,i.primitive=4,i.elements&&(i.count=i.elements._elements.vertCount,i.primitive=i.elements._elements.primType),"offset"in e&&(i.offset=0|e.offset),"count"in e&&(i.count=0|e.count),"instances"in e&&(i.instances=0|e.instances),"primitive"in e&&(nt(e.primitive in je,"bad primitive type: "+e.primitive),i.primitive=je[e.primitive]),nt.optional((()=>{for(var t=Object.keys(e),n=0;n<t.length;++n)nt(Fl.indexOf(t[n])>=0,'invalid option for vao: "'+t[n]+'" valid options are '+Fl)})),nt(Array.isArray(l),"attributes must be an array")}nt(l.length<s,"too many attributes"),nt(l.length>0,"must specify at least one attribute");var c={},u=i.attributes;u.length=l.length;for(var h=0;h<l.length;++h){var p,m=l[h],b=u[h]=new Ql,f=m.data||m;Array.isArray(f)||t(f)||Re(f)?(i.buffers[h]&&(p=i.buffers[h],t(f)&&p._buffer.byteLength>=f.byteLength?p.subdata(f):(p.destroy(),i.buffers[h]=null)),i.buffers[h]||(p=i.buffers[h]=a.create(m,wl,!1,!0)),b.buffer=a.getBuffer(p),b.size=0|b.buffer.dimension,b.normalized=!1,b.type=b.buffer.dtype,b.offset=0,b.stride=0,b.divisor=0,b.state=1,c[h]=1):a.getBuffer(m)?(b.buffer=a.getBuffer(m),b.size=0|b.buffer.dimension,b.normalized=!1,b.type=b.buffer.dtype,b.offset=0,b.stride=0,b.divisor=0,b.state=1):a.getBuffer(m.buffer)?(b.buffer=a.getBuffer(m.buffer),b.size=0|(+m.size||b.buffer.dimension),b.normalized=!!m.normalized||!1,"type"in m?(nt.parameter(m.type,Ce,"invalid buffer type"),b.type=Ce[m.type]):b.type=b.buffer.dtype,b.offset=0|(m.offset||0),b.stride=0|(m.stride||0),b.divisor=0|(m.divisor||0),b.state=1,nt(b.size>=1&&b.size<=4,"size must be between 1 and 4"),nt(b.offset>=0,"invalid offset"),nt(b.stride>=0&&b.stride<=255,"stride must be between 0 and 255"),nt(b.divisor>=0,"divisor must be positive"),nt(!b.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in m?(nt(h>0,"first attribute must not be a constant"),b.x=+m.x||0,b.y=+m.y||0,b.z=+m.z||0,b.w=+m.w||0,b.state=2):nt(!1,"invalid attribute spec for location "+h)}for(var y=0;y<i.buffers.length;++y)!c[y]&&i.buffers[y]&&(i.buffers[y].destroy(),i.buffers[y]=null);return i.refresh(),o}return l.vaoCount+=1,o.destroy=function(){for(var t=0;t<i.buffers.length;++t)i.buffers[t]&&i.buffers[t].destroy();i.buffers.length=0,i.ownsElements&&(i.elements.destroy(),i.elements=null,i.ownsElements=!1),i.destroy()},o._vao=i,o._reglType="vao",o(e)}return V.prototype.bindAttrs=function(){for(var t=f(),n=this.attributes,i=0;i<n.length;++i){var l=n[i];l.buffer?(e.enableVertexAttribArray(i),e.bindBuffer(wl,l.buffer.buffer),e.vertexAttribPointer(i,l.size,l.type,l.normalized,l.stride,l.offset),t&&l.divisor&&t.vertexAttribDivisorANGLE(i,l.divisor)):(e.disableVertexAttribArray(i),e.vertexAttrib4f(i,l.x,l.y,l.z,l.w))}for(var a=n.length;a<s;++a)e.disableVertexAttribArray(a);var o=r.getElements(this.elements);o?e.bindBuffer(Tl,o.buffer.buffer):e.bindBuffer(Tl,null)},V.prototype.refresh=function(){var t=b();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),p.currentVAO=null,t.bindVertexArrayOES(null))},V.prototype.destroy=function(){if(this.vao){var t=b();this===p.currentVAO&&(p.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),h[this.id]&&(delete h[this.id],l.vaoCount-=1)},p}var Bl=35632,Ul=35633,jl=35718,Pl=35721;function El(t,n,i,l){var a={},r={};function o(t,e,n,i){this.name=t,this.id=e,this.location=n,this.info=i}function s(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function d(e,i,l){var o=e===Bl?a:r,s=o[i];if(!s){var d=n.str(i);s=t.createShader(e),t.shaderSource(s,d),t.compileShader(s),nt.shaderError(t,s,d,e,l),o[i]=s}return s}var c={},u=[],h=0;function p(t,e){this.id=h++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,l.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function m(e,i,a){var r,c,u=d(Bl,e.fragId),h=d(Ul,e.vertId),p=e.program=t.createProgram();if(t.attachShader(p,u),t.attachShader(p,h),a)for(r=0;r<a.length;++r){var m=a[r];t.bindAttribLocation(p,m[0],m[1])}t.linkProgram(p),nt.linkError(t,p,n.str(e.fragId),n.str(e.vertId),i);var b=t.getProgramParameter(p,jl);l.profile&&(e.stats.uniformsCount=b);var f=e.uniforms;for(r=0;r<b;++r)if(c=t.getActiveUniform(p,r)){if(c.size>1)for(var y=0;y<c.size;++y){var Z=c.name.replace("[0]","["+y+"]");s(f,new o(Z,n.id(Z),t.getUniformLocation(p,Z),c))}var X=c.name;c.size>1&&(X=X.replace("[0]","")),s(f,new o(X,n.id(X),t.getUniformLocation(p,X),c))}var G=t.getProgramParameter(p,Pl);l.profile&&(e.stats.attributesCount=G);var V=e.attributes;for(r=0;r<G;++r)(c=t.getActiveAttrib(p,r))&&s(V,new o(c.name,n.id(c.name),t.getAttribLocation(p,c.name),c))}function b(){a={},r={};for(var t=0;t<u.length;++t)m(u[t],null,u[t].attributes.map((function(t){return[t.location,t.name]})))}return l.profile&&(i.getMaxUniformsCount=function(){var t=0;return u.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},i.getMaxAttributesCount=function(){var t=0;return u.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);ge(a).forEach(e),a={},ge(r).forEach(e),r={},u.forEach((function(e){t.deleteProgram(e.program)})),u.length=0,c={},i.shaderCount=0},program:function(n,l,o,s){nt.command(n>=0,"missing vertex shader",o),nt.command(l>=0,"missing fragment shader",o);var d=c[l];d||(d=c[l]={});var h=d[n];if(h&&(h.refCount++,!s))return h;var b=new p(l,n);return i.shaderCount++,m(b,o,s),h||(d[n]=b),u.push(b),e(b,{destroy:function(){if(b.refCount--,b.refCount<=0){t.deleteProgram(b.program);var e=u.indexOf(b);u.splice(e,1),i.shaderCount--}d[b.vertId].refCount<=0&&(t.deleteShader(r[b.vertId]),delete r[b.vertId],delete c[b.fragId][b.vertId]),Object.keys(c[b.fragId]).length||(t.deleteShader(a[b.fragId]),delete a[b.fragId],delete c[b.fragId])}})},restore:b,shader:d,frag:-1,vert:-1}}var Ol=6408,Dl=5121,Al=3333,ql=5126;function $l(e,n,i,l,a,r,o){function s(s){var d;null===n.next?(nt(a.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),d=Dl):(nt(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),d=n.next.colorAttachments[0].texture._texture.type,nt.optional((function(){r.oes_texture_float?(nt(d===Dl||d===ql,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),d===ql&&nt(o.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):nt(d===Dl,"Reading from a framebuffer is only allowed for the type 'uint8'")})));var c=0,u=0,h=l.framebufferWidth,p=l.framebufferHeight,m=null;t(s)?m=s:s&&(nt.type(s,"object","invalid arguments to regl.read()"),c=0|s.x,u=0|s.y,nt(c>=0&&c<l.framebufferWidth,"invalid x offset for regl.read"),nt(u>=0&&u<l.framebufferHeight,"invalid y offset for regl.read"),h=0|(s.width||l.framebufferWidth-c),p=0|(s.height||l.framebufferHeight-u),m=s.data||null),m&&(d===Dl?nt(m instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):d===ql&&nt(m instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),nt(h>0&&h+c<=l.framebufferWidth,"invalid width for read pixels"),nt(p>0&&p+u<=l.framebufferHeight,"invalid height for read pixels"),i();var b=h*p*4;return m||(d===Dl?m=new Uint8Array(b):d===ql&&(m=m||new Float32Array(b))),nt.isTypedArray(m,"data buffer for regl.read() must be a typedarray"),nt(m.byteLength>=b,"data buffer for regl.read() too small"),e.pixelStorei(Al,4),e.readPixels(c,u,h,p,Ol,d,m),m}function d(t){var e;return n.setFBO({framebuffer:t.framebuffer},(function(){e=s(t)})),e}function c(t){return t&&"framebuffer"in t?d(t):s(t)}return c}function ta(t){return Array.prototype.slice.call(t)}function ea(t){return ta(t).join("")}function na(){var t=0,n=[],i=[];function l(e){for(var l=0;l<i.length;++l)if(i[l]===e)return n[l];var a="g"+t++;return n.push(a),i.push(e),a}function a(){var n=[];function i(){n.push.apply(n,ta(arguments))}var l=[];function a(){var e="v"+t++;return l.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,ta(arguments)),n.push(";")),e}return e(i,{def:a,toString:function(){return ea([l.length>0?"var "+l.join(",")+";":"",ea(n)])}})}function r(){var t=a(),n=a(),i=t.toString,l=n.toString;function r(e,i){n(e,i,"=",t.def(e,i),";")}return e((function(){t.apply(t,ta(arguments))}),{def:t.def,entry:t,exit:n,save:r,set:function(e,n,i){r(e,n),t(e,n,"=",i,";")},toString:function(){return i()+l()}})}function o(){var t=ea(arguments),n=r(),i=r(),l=n.toString,a=i.toString;return e(n,{then:function(){return n.apply(n,ta(arguments)),this},else:function(){return i.apply(i,ta(arguments)),this},toString:function(){var e=a();return e&&(e="else{"+e+"}"),ea(["if(",t,"){",l(),"}",e])}})}var s=a(),d={};function c(t,n){var i=[];function l(){var t="a"+i.length;return i.push(t),t}n=n||0;for(var a=0;a<n;++a)l();var o=r(),s=o.toString;return d[t]=e(o,{arg:l,toString:function(){return ea(["function(",i.join(),"){",s(),"}"])}})}function u(){var t=['"use strict";',s,"return {"];Object.keys(d).forEach((function(e){t.push('"',e,'":',d[e].toString(),",")})),t.push("}");var e=ea(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,i)}return{global:s,link:l,block:a,proc:c,scope:r,cond:o,compile:u}}var ia="xyzw".split(""),la=5121,aa=1,ra=2,oa=0,sa=1,da=2,ca=3,ua=4,ha=5,pa=6,ma="dither",ba="blend.enable",fa="blend.color",ya="blend.equation",Za="blend.func",Xa="depth.enable",Ga="depth.func",Va="depth.range",Wa="depth.mask",Ra="colorMask",ga="cull.enable",va="cull.face",xa="frontFace",_a="lineWidth",Ka="polygonOffset.enable",Sa="polygonOffset.offset",Ya="sample.alpha",La="sample.enable",Ha="sample.coverage",Ca="stencil.enable",Na="stencil.mask",Ja="stencil.func",ka="stencil.opFront",za="stencil.opBack",Ia="scissor.enable",wa="scissor.box",Ta="viewport",Fa="profile",Qa="framebuffer",Ma="vert",Ba="frag",Ua="elements",ja="primitive",Pa="count",Ea="offset",Oa="instances",Da="vao",Aa="Width",qa="Height",$a=Qa+Aa,tr=Qa+qa,er=Ta+Aa,nr=Ta+qa,ir="drawingBuffer",lr=ir+Aa,ar=ir+qa,rr=[Za,ya,Ja,ka,za,Ha,Ta,wa,Sa],or=34962,sr=34963,dr=3553,cr=34067,ur=2884,hr=3042,pr=3024,mr=2960,br=2929,fr=3089,yr=32823,Zr=32926,Xr=32928,Gr=5126,Vr=35664,Wr=35665,Rr=35666,gr=5124,vr=35667,xr=35668,_r=35669,Kr=35670,Sr=35671,Yr=35672,Lr=35673,Hr=35674,Cr=35675,Nr=35676,Jr=35678,kr=35680,zr=4,Ir=1028,wr=1029,Tr=2304,Fr=2305,Qr=32775,Mr=32776,Br=519,Ur=7680,jr=0,Pr=1,Er=32774,Or=513,Dr=36160,Ar=36064,qr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},$r=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],to={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},eo={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},no={frag:35632,vert:35633},io={cw:Tr,ccw:Fr};function lo(e){return Array.isArray(e)||t(e)||Re(e)}function ao(t){return t.sort((function(t,e){return t===Ta?-1:e===Ta?1:t<e?-1:1}))}function ro(t,e,n,i){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=i}function oo(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function so(t){return new ro(!1,!1,!1,t)}function co(t,e){var n=t.type;if(n===oa){var i=t.data.length;return new ro(!0,i>=1,i>=2,e)}if(n===ua){var l=t.data;return new ro(l.thisDep,l.contextDep,l.propDep,e)}if(n===ha)return new ro(!1,!1,!1,e);if(n===pa){for(var a=!1,r=!1,o=!1,s=0;s<t.data.length;++s){var d=t.data[s];if(d.type===sa)o=!0;else if(d.type===da)r=!0;else if(d.type===ca)a=!0;else if(d.type===oa){a=!0;var c=d.data;c>=1&&(r=!0),c>=2&&(o=!0)}else d.type===ua&&(a=a||d.data.thisDep,r=r||d.data.contextDep,o=o||d.data.propDep)}return new ro(a,r,o,e)}return new ro(n===ca,n===da,n===sa,e)}var uo=new ro(!1,!1,!1,(function(){}));function ho(t,n,i,l,a,r,o,s,d,c,u,h,p,m,b){var f=c.Record,y={add:32774,subtract:32778,"reverse subtract":32779};i.ext_blend_minmax&&(y.min=Qr,y.max=Mr);var Z=i.angle_instanced_arrays,X=i.webgl_draw_buffers,G=i.oes_vertex_array_object,V={dirty:!0,profile:b.profile},W={},R=[],g={},v={};function x(t){return t.replace(".","_")}function _(t,e,n){var i=x(t);R.push(t),W[i]=V[i]=!!n,g[i]=e}function K(t,e,n){var i=x(t);R.push(t),Array.isArray(n)?(V[i]=n.slice(),W[i]=n.slice()):V[i]=W[i]=n,v[i]=e}_(ma,pr),_(ba,hr),K(fa,"blendColor",[0,0,0,0]),K(ya,"blendEquationSeparate",[Er,Er]),K(Za,"blendFuncSeparate",[Pr,jr,Pr,jr]),_(Xa,br,!0),K(Ga,"depthFunc",Or),K(Va,"depthRange",[0,1]),K(Wa,"depthMask",!0),K(Ra,Ra,[!0,!0,!0,!0]),_(ga,ur),K(va,"cullFace",wr),K(xa,xa,Fr),K(_a,_a,1),_(Ka,yr),K(Sa,"polygonOffset",[0,0]),_(Ya,Zr),_(La,Xr),K(Ha,"sampleCoverage",[1,!1]),_(Ca,mr),K(Na,"stencilMask",-1),K(Ja,"stencilFunc",[Br,0,-1]),K(ka,"stencilOpSeparate",[Ir,Ur,Ur,Ur]),K(za,"stencilOpSeparate",[wr,Ur,Ur,Ur]),_(Ia,fr),K(wa,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),K(Ta,Ta,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var S={gl:t,context:p,strings:n,next:W,current:V,draw:h,elements:r,buffer:a,shader:u,attributes:c.state,vao:c,uniforms:d,framebuffer:s,extensions:i,timer:m,isBufferArgs:lo},Y={primTypes:je,compareFuncs:to,blendFuncs:qr,blendEquations:y,stencilOps:eo,glTypes:Ce,orientationType:io};nt.optional((function(){S.isArrayLike=un})),X&&(Y.backBuffer=[wr],Y.drawBuffer=xt(l.maxDrawbuffers,(function(t){return 0===t?[0]:xt(t,(function(t){return Ar+t}))})));var L=0;function H(){var t=na(),e=t.link,i=t.global;t.id=L++,t.batchId="0";var l=e(S),a=t.shared={props:"a0"};Object.keys(S).forEach((function(t){a[t]=i.def(l,".",t)})),nt.optional((function(){t.CHECK=e(nt),t.commandStr=nt.guessCommand(),t.command=e(t.commandStr),t.assert=function(t,n,i){t("if(!(",n,"))",this.CHECK,".commandRaise(",e(i),",",this.command,");")},Y.invalidBlendCombinations=$r}));var r=t.next={},o=t.current={};Object.keys(v).forEach((function(t){Array.isArray(V[t])&&(r[t]=i.def(a.next,".",t),o[t]=i.def(a.current,".",t))}));var s=t.constants={};Object.keys(Y).forEach((function(t){s[t]=i.def(JSON.stringify(Y[t]))})),t.invoke=function(n,i){switch(i.type){case oa:var l=["this",a.context,a.props,t.batchId];return n.def(e(i.data),".call(",l.slice(0,Math.max(i.data.length+1,4)),")");case sa:return n.def(a.props,i.data);case da:return n.def(a.context,i.data);case ca:return n.def("this",i.data);case ua:return i.data.append(t,n),i.data.ref;case ha:return i.data.toString();case pa:return i.data.map((function(e){return t.invoke(n,e)}))}},t.attribCache={};var d={};return t.scopeAttrib=function(t){var i=n.id(t);if(i in d)return d[i];var l=c.scope[i];return l||(l=c.scope[i]=new f),d[i]=e(l)},t}function C(t){var e,n=t.static,i=t.dynamic;if(Fa in n){var l=!!n[Fa];(e=so((function(t,e){return l}))).enable=l}else if(Fa in i){var a=i[Fa];e=co(a,(function(t,e){return t.invoke(e,a)}))}return e}function N(t,e){var n=t.static,i=t.dynamic;if(Qa in n){var l=n[Qa];return l?(l=s.getFramebuffer(l),nt.command(l,"invalid framebuffer object"),so((function(t,e){var n=t.link(l),i=t.shared;e.set(i.framebuffer,".next",n);var a=i.context;return e.set(a,"."+$a,n+".width"),e.set(a,"."+tr,n+".height"),n}))):so((function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var i=n.context;return e.set(i,"."+$a,i+"."+lr),e.set(i,"."+tr,i+"."+ar),"null"}))}if(Qa in i){var a=i[Qa];return co(a,(function(t,e){var n=t.invoke(e,a),i=t.shared,l=i.framebuffer,r=e.def(l,".getFramebuffer(",n,")");nt.optional((function(){t.assert(e,"!"+n+"||"+r,"invalid framebuffer object")})),e.set(l,".next",r);var o=i.context;return e.set(o,"."+$a,r+"?"+r+".width:"+o+"."+lr),e.set(o,"."+tr,r+"?"+r+".height:"+o+"."+ar),r}))}return null}function J(t,e,n){var i=t.static,l=t.dynamic;function a(t){if(t in i){var a=i[t];nt.commandType(a,"object","invalid "+t,n.commandStr);var r,o,s=!0,d=0|a.x,c=0|a.y;return"width"in a?(r=0|a.width,nt.command(r>=0,"invalid "+t,n.commandStr)):s=!1,"height"in a?(o=0|a.height,nt.command(o>=0,"invalid "+t,n.commandStr)):s=!1,new ro(!s&&e&&e.thisDep,!s&&e&&e.contextDep,!s&&e&&e.propDep,(function(t,e){var n=t.shared.context,i=r;"width"in a||(i=e.def(n,".",$a,"-",d));var l=o;return"height"in a||(l=e.def(n,".",tr,"-",c)),[d,c,i,l]}))}if(t in l){var u=l[t],h=co(u,(function(e,n){var i=e.invoke(n,u);nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)}));var l=e.shared.context,a=n.def(i,".x|0"),r=n.def(i,".y|0"),o=n.def('"width" in ',i,"?",i,".width|0:","(",l,".",$a,"-",a,")"),s=n.def('"height" in ',i,"?",i,".height|0:","(",l,".",tr,"-",r,")");return nt.optional((function(){e.assert(n,o+">=0&&"+s+">=0","invalid "+t)})),[a,r,o,s]}));return e&&(h.thisDep=h.thisDep||e.thisDep,h.contextDep=h.contextDep||e.contextDep,h.propDep=h.propDep||e.propDep),h}return e?new ro(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",$a),e.def(n,".",tr)]})):null}var r=a(Ta);if(r){var o=r;r=new ro(r.thisDep,r.contextDep,r.propDep,(function(t,e){var n=o.append(t,e),i=t.shared.context;return e.set(i,"."+er,n[2]),e.set(i,"."+nr,n[3]),n}))}return{viewport:r,scissor_box:a(wa)}}function k(t,e){var n=t.static;if("string"==typeof n[Ba]&&"string"==typeof n[Ma]){if(Object.keys(e.dynamic).length>0)return null;var i=e.static,l=Object.keys(i);if(l.length>0&&"number"==typeof i[l[0]]){for(var a=[],r=0;r<l.length;++r)nt("number"==typeof i[l[r]],"must specify all vertex attribute locations when using vaos"),a.push([0|i[l[r]],l[r]]);return a}}return null}function z(t,e,i){var l=t.static,a=t.dynamic;function r(t){if(t in l){var e=n.id(l[t]);nt.optional((function(){u.shader(no[t],e,nt.guessCommand())}));var i=so((function(){return e}));return i.id=e,i}if(t in a){var r=a[t];return co(r,(function(e,n){var i=e.invoke(n,r),l=n.def(e.shared.strings,".id(",i,")");return nt.optional((function(){n(e.shared.shader,".shader(",no[t],",",l,",",e.command,");")})),l}))}return null}var o,s=r(Ba),d=r(Ma),c=null;return oo(s)&&oo(d)?(c=u.program(d.id,s.id,null,i),o=so((function(t,e){return t.link(c)}))):o=new ro(s&&s.thisDep||d&&d.thisDep,s&&s.contextDep||d&&d.contextDep,s&&s.propDep||d&&d.propDep,(function(t,e){var n,i=t.shared.shader;n=s?s.append(t,e):e.def(i,".",Ba);var l=i+".program("+(d?d.append(t,e):e.def(i,".",Ma))+","+n;return nt.optional((function(){l+=","+t.command})),e.def(l+")")})),{frag:s,vert:d,progVar:o,program:c}}function I(t,e){var n=t.static,i=t.dynamic,l={},a=!1;function o(){if(Da in n){var t=n[Da];return null!==t&&null===c.getVAO(t)&&(t=c.createVAO(t)),a=!0,l.vao=t,so((function(e){var n=c.getVAO(t);return n?e.link(n):"null"}))}if(Da in i){a=!0;var e=i[Da];return co(e,(function(t,n){var i=t.invoke(n,e);return n.def(t.shared.vao+".getVAO("+i+")")}))}return null}var s=o(),d=!1;function u(){if(Ua in n){var t=n[Ua];if(l.elements=t,lo(t)){var o=l.elements=r.create(t,!0);t=r.getElements(o),d=!0}else t&&(t=r.getElements(t),d=!0,nt.command(t,"invalid elements",e.commandStr));var c=so((function(e,n){if(t){var i=e.link(t);return e.ELEMENTS=i,i}return e.ELEMENTS=null,null}));return c.value=t,c}if(Ua in i){d=!0;var u=i[Ua];return co(u,(function(t,e){var n=t.shared,i=n.isBufferArgs,l=n.elements,a=t.invoke(e,u),r=e.def("null"),o=e.def(i,"(",a,")"),s=t.cond(o).then(r,"=",l,".createStream(",a,");").else(r,"=",l,".getElements(",a,");");return nt.optional((function(){t.assert(s.else,"!"+a+"||"+r,"invalid elements")})),e.entry(s),e.exit(t.cond(o).then(l,".destroyStream(",r,");")),t.ELEMENTS=r,r}))}return a?new ro(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.elements+".getElements("+t.shared.vao+".currentVAO.elements):null")})):null}var h=u();function p(){if(ja in n){var t=n[ja];return l.primitive=t,nt.commandParameter(t,je,"invalid primitve",e.commandStr),so((function(e,n){return je[t]}))}if(ja in i){var r=i[ja];return co(r,(function(t,e){var n=t.constants.primTypes,i=t.invoke(e,r);return nt.optional((function(){t.assert(e,i+" in "+n,"invalid primitive, must be one of "+Object.keys(je))})),e.def(n,"[",i,"]")}))}return d?oo(h)?h.value?so((function(t,e){return e.def(t.ELEMENTS,".primType")})):so((function(){return zr})):new ro(h.thisDep,h.contextDep,h.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",zr)})):a?new ro(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.primitive:"+zr)})):null}function m(t,r){if(t in n){var o=0|n[t];return r?l.offset=o:l.instances=o,nt.command(!r||o>=0,"invalid "+t,e.commandStr),so((function(t,e){return r&&(t.OFFSET=o),o}))}if(t in i){var c=i[t];return co(c,(function(e,n){var i=e.invoke(n,c);return r&&(e.OFFSET=i,nt.optional((function(){e.assert(n,i+">=0","invalid "+t)}))),i}))}if(r){if(d)return so((function(t,e){return t.OFFSET=0,0}));if(a)return new ro(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.offset:0")}))}else if(a)return new ro(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.instances:-1")}));return null}var b=m(Ea,!0);function f(){if(Pa in n){var t=0|n[Pa];return l.count=t,nt.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),so((function(){return t}))}if(Pa in i){var r=i[Pa];return co(r,(function(t,e){var n=t.invoke(e,r);return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(d){if(oo(h)){if(h)return b?new ro(b.thisDep,b.contextDep,b.propDep,(function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return nt.optional((function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")})),n})):so((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var o=so((function(){return-1}));return nt.optional((function(){o.MISSING=!0})),o}var c=new ro(h.thisDep||b.thisDep,h.contextDep||b.contextDep,h.propDep||b.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")}));return nt.optional((function(){c.DYNAMIC=!0})),c}return a?new ro(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao,".currentVAO?",t.shared.vao,".currentVAO.count:-1")})):null}var y=p(),Z=f(),X=m(Oa,!1);return{elements:h,primitive:y,count:Z,instances:X,offset:b,vao:s,vaoActive:a,elementsActive:d,static:l}}function w(t,e){var n=t.static,i=t.dynamic,a={};return R.forEach((function(t){var r=x(t);function o(e,l){if(t in n){var o=e(n[t]);a[r]=so((function(){return o}))}else if(t in i){var s=i[t];a[r]=co(s,(function(t,e){return l(t,e,t.invoke(e,s))}))}}switch(t){case ga:case ba:case ma:case Ca:case Xa:case Ia:case Ka:case Ya:case La:case Wa:return o((function(n){return nt.commandType(n,"boolean",t,e.commandStr),n}),(function(e,n,i){return nt.optional((function(){e.assert(n,"typeof "+i+'==="boolean"',"invalid flag "+t,e.commandStr)})),i}));case Ga:return o((function(n){return nt.commandParameter(n,to,"invalid "+t,e.commandStr),to[n]}),(function(e,n,i){var l=e.constants.compareFuncs;return nt.optional((function(){e.assert(n,i+" in "+l,"invalid "+t+", must be one of "+Object.keys(to))})),n.def(l,"[",i,"]")}));case Va:return o((function(t){return nt.command(un(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[e.def("+",n,"[0]"),e.def("+",n,"[1]")]}));case Za:return o((function(t){nt.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,i="srcAlpha"in t?t.srcAlpha:t.src,l="dstRGB"in t?t.dstRGB:t.dst,a="dstAlpha"in t?t.dstAlpha:t.dst;return nt.commandParameter(n,qr,r+".srcRGB",e.commandStr),nt.commandParameter(i,qr,r+".srcAlpha",e.commandStr),nt.commandParameter(l,qr,r+".dstRGB",e.commandStr),nt.commandParameter(a,qr,r+".dstAlpha",e.commandStr),nt.command(-1===$r.indexOf(n+", "+l),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+l+")",e.commandStr),[qr[n],qr[l],qr[i],qr[a]]}),(function(e,n,i){var l=e.constants.blendFuncs;function a(a,r){var o=n.def('"',a,r,'" in ',i,"?",i,".",a,r,":",i,".",a);return nt.optional((function(){e.assert(n,o+" in "+l,"invalid "+t+"."+a+r+", must be one of "+Object.keys(qr))})),o}nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid blend func, must be an object")}));var r=a("src","RGB"),o=a("dst","RGB");nt.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+r+'+", "+'+o+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var s=n.def(l,"[",r,"]"),d=n.def(l,"[",a("src","Alpha"),"]");return[s,n.def(l,"[",o,"]"),d,n.def(l,"[",a("dst","Alpha"),"]")]}));case ya:return o((function(n){return"string"==typeof n?(nt.commandParameter(n,y,"invalid "+t,e.commandStr),[y[n],y[n]]):"object"==typeof n?(nt.commandParameter(n.rgb,y,t+".rgb",e.commandStr),nt.commandParameter(n.alpha,y,t+".alpha",e.commandStr),[y[n.rgb],y[n.alpha]]):void nt.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,n,i){var l=e.constants.blendEquations,a=n.def(),r=n.def(),o=e.cond("typeof ",i,'==="string"');return nt.optional((function(){function n(t,n,i){e.assert(t,i+" in "+l,"invalid "+n+", must be one of "+Object.keys(y))}n(o.then,t,i),e.assert(o.else,i+"&&typeof "+i+'==="object"',"invalid "+t),n(o.else,t+".rgb",i+".rgb"),n(o.else,t+".alpha",i+".alpha")})),o.then(a,"=",r,"=",l,"[",i,"];"),o.else(a,"=",l,"[",i,".rgb];",r,"=",l,"[",i,".alpha];"),n(o),[a,r]}));case fa:return o((function(t){return nt.command(un(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),xt(4,(function(e){return+t[e]}))}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),xt(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case Na:return o((function(t){return nt.commandType(t,"number",r,e.commandStr),0|t}),(function(t,e,n){return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")})),e.def(n,"|0")}));case Ja:return o((function(n){nt.commandType(n,"object",r,e.commandStr);var i=n.cmp||"keep",l=n.ref||0,a="mask"in n?n.mask:-1;return nt.commandParameter(i,to,t+".cmp",e.commandStr),nt.commandType(l,"number",t+".ref",e.commandStr),nt.commandType(a,"number",t+".mask",e.commandStr),[to[i],l,a]}),(function(t,e,n){var i=t.constants.compareFuncs;return nt.optional((function(){function l(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}l(n+"&&typeof ",n,'==="object"'),l('!("cmp" in ',n,")||(",n,".cmp in ",i,")")})),[e.def('"cmp" in ',n,"?",i,"[",n,".cmp]",":",Ur),e.def(n,".ref|0"),e.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case ka:case za:return o((function(n){nt.commandType(n,"object",r,e.commandStr);var i=n.fail||"keep",l=n.zfail||"keep",a=n.zpass||"keep";return nt.commandParameter(i,eo,t+".fail",e.commandStr),nt.commandParameter(l,eo,t+".zfail",e.commandStr),nt.commandParameter(a,eo,t+".zpass",e.commandStr),[t===za?wr:Ir,eo[i],eo[l],eo[a]]}),(function(e,n,i){var l=e.constants.stencilOps;function a(a){return nt.optional((function(){e.assert(n,'!("'+a+'" in '+i+")||("+i+"."+a+" in "+l+")","invalid "+t+"."+a+", must be one of "+Object.keys(eo))})),n.def('"',a,'" in ',i,"?",l,"[",i,".",a,"]:",Ur)}return nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)})),[t===za?wr:Ir,a("fail"),a("zfail"),a("zpass")]}));case Sa:return o((function(t){nt.commandType(t,"object",r,e.commandStr);var n=0|t.factor,i=0|t.units;return nt.commandType(n,"number",r+".factor",e.commandStr),nt.commandType(i,"number",r+".units",e.commandStr),[n,i]}),(function(e,n,i){return nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)})),[n.def(i,".factor|0"),n.def(i,".units|0")]}));case va:return o((function(t){var n=0;return"front"===t?n=Ir:"back"===t&&(n=wr),nt.command(!!n,r,e.commandStr),n}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),e.def(n,'==="front"?',Ir,":",wr)}));case _a:return o((function(t){return nt.command("number"==typeof t&&t>=l.lineWidthDims[0]&&t<=l.lineWidthDims[1],"invalid line width, must be a positive number between "+l.lineWidthDims[0]+" and "+l.lineWidthDims[1],e.commandStr),t}),(function(t,e,n){return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+l.lineWidthDims[0]+"&&"+n+"<="+l.lineWidthDims[1],"invalid line width")})),n}));case xa:return o((function(t){return nt.commandParameter(t,io,r,e.commandStr),io[t]}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(n+'==="cw"?'+Tr+":"+Fr)}));case Ra:return o((function(t){return nt.command(un(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),xt(4,(function(t){return"!!"+n+"["+t+"]"}))}));case Ha:return o((function(t){nt.command("object"==typeof t&&t,r,e.commandStr);var n="value"in t?t.value:1,i=!!t.invert;return nt.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,i]}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',n,"?+",n,".value:1"),e.def("!!",n,".invert")]}))}})),a}function T(t,e){var n=t.static,i=t.dynamic,l={};return Object.keys(n).forEach((function(t){var i,a=n[t];if("number"==typeof a||"boolean"==typeof a)i=so((function(){return a}));else if("function"==typeof a){var r=a._reglType;"texture2d"===r||"textureCube"===r?i=so((function(t){return t.link(a)})):"framebuffer"===r||"framebufferCube"===r?(nt.command(a.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),i=so((function(t){return t.link(a.color[0])}))):nt.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else un(a)?i=so((function(e){return e.global.def("[",xt(a.length,(function(n){return nt.command("number"==typeof a[n]||"boolean"==typeof a[n],"invalid uniform "+t,e.commandStr),a[n]})),"]")})):nt.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);i.value=a,l[t]=i})),Object.keys(i).forEach((function(t){var e=i[t];l[t]=co(e,(function(t,n){return t.invoke(n,e)}))})),l}function F(t,e){var i=t.static,l=t.dynamic,r={};return Object.keys(i).forEach((function(t){var l=i[t],o=n.id(t),s=new f;if(lo(l))s.state=aa,s.buffer=a.getBuffer(a.create(l,or,!1,!0)),s.type=0;else{var d=a.getBuffer(l);if(d)s.state=aa,s.buffer=d,s.type=0;else if(nt.command("object"==typeof l&&l,"invalid data for attribute "+t,e.commandStr),"constant"in l){var c=l.constant;s.buffer="null",s.state=ra,"number"==typeof c?s.x=c:(nt.command(un(c)&&c.length>0&&c.length<=4,"invalid constant for attribute "+t,e.commandStr),ia.forEach((function(t,e){e<c.length&&(s[t]=c[e])})))}else{d=lo(l.buffer)?a.getBuffer(a.create(l.buffer,or,!1,!0)):a.getBuffer(l.buffer),nt.command(!!d,'missing buffer for attribute "'+t+'"',e.commandStr);var u=0|l.offset;nt.command(u>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var h=0|l.stride;nt.command(h>=0&&h<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var p=0|l.size;nt.command(!("size"in l)||p>0&&p<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var m=!!l.normalized,b=0;"type"in l&&(nt.commandParameter(l.type,Ce,"invalid type for attribute "+t,e.commandStr),b=Ce[l.type]);var y=0|l.divisor;nt.optional((function(){"divisor"in l&&(nt.command(0===y||Z,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),nt.command(y>=0,'invalid divisor for attribute "'+t+'"',e.commandStr));var n=e.commandStr,i=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(l).forEach((function(e){nt.command(i.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+i+")",n)}))})),s.buffer=d,s.state=aa,s.size=p,s.normalized=m,s.type=b||d.dtype,s.offset=u,s.stride=h,s.divisor=y}}r[t]=so((function(t,e){var n=t.attribCache;if(o in n)return n[o];var i={isStream:!1};return Object.keys(s).forEach((function(t){i[t]=s[t]})),s.buffer&&(i.buffer=t.link(s.buffer),i.type=i.type||i.buffer+".dtype"),n[o]=i,i}))})),Object.keys(l).forEach((function(t){var e=l[t];function n(n,i){var l=n.invoke(i,e),a=n.shared,r=n.constants,o=a.isBufferArgs,s=a.buffer;nt.optional((function(){n.assert(i,l+"&&(typeof "+l+'==="object"||typeof '+l+'==="function")&&('+o+"("+l+")||"+s+".getBuffer("+l+")||"+s+".getBuffer("+l+".buffer)||"+o+"("+l+'.buffer)||("constant" in '+l+"&&(typeof "+l+'.constant==="number"||'+a.isArrayLike+"("+l+".constant))))",'invalid dynamic attribute "'+t+'"')}));var d={isStream:i.def(!1)},c=new f;c.state=aa,Object.keys(c).forEach((function(t){d[t]=i.def(""+c[t])}));var u=d.buffer,h=d.type;function p(t){i(d[t],"=",l,".",t,"|0;")}return i("if(",o,"(",l,")){",d.isStream,"=true;",u,"=",s,".createStream(",or,",",l,");",h,"=",u,".dtype;","}else{",u,"=",s,".getBuffer(",l,");","if(",u,"){",h,"=",u,".dtype;",'}else if("constant" in ',l,"){",d.state,"=",ra,";","if(typeof "+l+'.constant === "number"){',d[ia[0]],"=",l,".constant;",ia.slice(1).map((function(t){return d[t]})).join("="),"=0;","}else{",ia.map((function(t,e){return d[t]+"="+l+".constant.length>"+e+"?"+l+".constant["+e+"]:0;"})).join(""),"}}else{","if(",o,"(",l,".buffer)){",u,"=",s,".createStream(",or,",",l,".buffer);","}else{",u,"=",s,".getBuffer(",l,".buffer);","}",h,'="type" in ',l,"?",r.glTypes,"[",l,".type]:",u,".dtype;",d.normalized,"=!!",l,".normalized;"),p("size"),p("offset"),p("stride"),p("divisor"),i("}}"),i.exit("if(",d.isStream,"){",s,".destroyStream(",u,");","}"),d}r[t]=co(e,n)})),r}function Q(t){var e=t.static,n=t.dynamic,i={};return Object.keys(e).forEach((function(t){var n=e[t];i[t]=so((function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];i[t]=co(e,(function(t,n){return t.invoke(n,e)}))})),i}function M(t,e,n,l,a){var r=t.static,o=t.dynamic;nt.optional((function(){var t=[Qa,Ma,Ba,Ua,ja,Ea,Pa,Oa,Fa,Da].concat(R);function e(e){Object.keys(e).forEach((function(e){nt.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',a.commandStr)}))}e(r),e(o)}));var s=k(t,e),d=N(t),u=J(t,d,a),h=I(t,a),p=w(t,a),m=z(t,a,s);function b(t){var e=u[t];e&&(p[t]=e)}b(Ta),b(x(wa));var f=Object.keys(p).length>0,y={framebuffer:d,draw:h,shader:m,state:p,dirty:f,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(y.profile=C(t),y.uniforms=T(n,a),y.drawVAO=y.scopeVAO=h.vao,!y.drawVAO&&m.program&&!s&&i.angle_instanced_arrays&&h.static.elements){var Z=!0,X=m.program.attributes.map((function(t){var n=e.static[t];return Z=Z&&!!n,n}));if(Z&&X.length>0){var G=c.getVAO(c.createVAO({attributes:X,elements:h.static.elements}));y.drawVAO=new ro(null,null,null,(function(t,e){return t.link(G)})),y.useVAO=!0}}return s?y.useVAO=!0:y.attributes=F(e,a),y.context=Q(l),y}function B(t,e,n){var i=t.shared.context,l=t.scope();Object.keys(n).forEach((function(a){e.save(i,"."+a);var r=n[a].append(t,e);Array.isArray(r)?l(i,".",a,"=[",r.join(),"];"):l(i,".",a,"=",r,";")})),e(l)}function U(t,e,n,i){var l,a=t.shared,r=a.gl,o=a.framebuffer;X&&(l=e.def(a.extensions,".webgl_draw_buffers"));var s,d=t.constants,c=d.drawBuffer,u=d.backBuffer;s=n?n.append(t,e):e.def(o,".next"),i||e("if(",s,"!==",o,".cur){"),e("if(",s,"){",r,".bindFramebuffer(",Dr,",",s,".framebuffer);"),X&&e(l,".drawBuffersWEBGL(",c,"[",s,".colorAttachments.length]);"),e("}else{",r,".bindFramebuffer(",Dr,",null);"),X&&e(l,".drawBuffersWEBGL(",u,");"),e("}",o,".cur=",s,";"),i||e("}")}function j(t,e,n){var i=t.shared,l=i.gl,a=t.current,r=t.next,o=i.current,s=i.next,d=t.cond(o,".dirty");R.forEach((function(e){var i,c,u=x(e);if(!(u in n.state))if(u in r){i=r[u],c=a[u];var h=xt(V[u].length,(function(t){return d.def(i,"[",t,"]")}));d(t.cond(h.map((function(t,e){return t+"!=="+c+"["+e+"]"})).join("||")).then(l,".",v[u],"(",h,");",h.map((function(t,e){return c+"["+e+"]="+t})).join(";"),";"))}else{i=d.def(s,".",u);var p=t.cond(i,"!==",o,".",u);d(p),u in g?p(t.cond(i).then(l,".enable(",g[u],");").else(l,".disable(",g[u],");"),o,".",u,"=",i,";"):p(l,".",v[u],"(",i,");",o,".",u,"=",i,";")}})),0===Object.keys(n.state).length&&d(o,".dirty=false;"),e(d)}function P(t,e,n,i){var l=t.shared,a=t.current,r=l.current,o=l.gl;ao(Object.keys(n)).forEach((function(l){var s=n[l];if(!i||i(s)){var d=s.append(t,e);if(g[l]){var c=g[l];oo(s)?e(o,d?".enable(":".disable(",c,");"):e(t.cond(d).then(o,".enable(",c,");").else(o,".disable(",c,");")),e(r,".",l,"=",d,";")}else if(un(d)){var u=a[l];e(o,".",v[l],"(",d,");",d.map((function(t,e){return u+"["+e+"]="+t})).join(";"),";")}else e(o,".",v[l],"(",d,");",r,".",l,"=",d,";")}}))}function E(t,e){Z&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function O(t,e,n,i,l){var a,r,o,s=t.shared,d=t.stats,c=s.current,u=s.timer,h=n.profile;function p(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function b(t){t(a=e.def(),"=",p(),";"),"string"==typeof l?t(d,".count+=",l,";"):t(d,".count++;"),m&&(i?t(r=e.def(),"=",u,".getNumPendingQueries();"):t(u,".beginQuery(",d,");"))}function f(t){t(d,".cpuTime+=",p(),"-",a,";"),m&&(i?t(u,".pushScopeStats(",r,",",u,".getNumPendingQueries(),",d,");"):t(u,".endQuery();"))}function y(t){var n=e.def(c,".profile");e(c,".profile=",t,";"),e.exit(c,".profile=",n,";")}if(h){if(oo(h))return void(h.enable?(b(e),f(e.exit),y("true")):y("false"));y(o=h.append(t,e))}else o=e.def(c,".profile");var Z=t.block();b(Z),e("if(",o,"){",Z,"}");var X=t.block();f(X),e.exit("if(",o,"){",X,"}")}function D(t,e,n,i,l){var a=t.shared;function r(t){switch(t){case Vr:case vr:case Sr:return 2;case Wr:case xr:case Yr:return 3;case Rr:case _r:case Lr:return 4;default:return 1}}function o(n,i,l){var r=a.gl,o=e.def(n,".location"),s=e.def(a.attributes,"[",o,"]"),d=l.state,c=l.buffer,u=[l.x,l.y,l.z,l.w],h=["buffer","normalized","offset","stride"];function p(){e("if(!",s,".buffer){",r,".enableVertexAttribArray(",o,");}");var n,a=l.type;if(n=l.size?e.def(l.size,"||",i):i,e("if(",s,".type!==",a,"||",s,".size!==",n,"||",h.map((function(t){return s+"."+t+"!=="+l[t]})).join("||"),"){",r,".bindBuffer(",or,",",c,".buffer);",r,".vertexAttribPointer(",[o,n,a,l.normalized,l.stride,l.offset],");",s,".type=",a,";",s,".size=",n,";",h.map((function(t){return s+"."+t+"="+l[t]+";"})).join(""),"}"),Z){var d=l.divisor;e("if(",s,".divisor!==",d,"){",t.instancing,".vertexAttribDivisorANGLE(",[o,d],");",s,".divisor=",d,";}")}}function m(){e("if(",s,".buffer){",r,".disableVertexAttribArray(",o,");",s,".buffer=null;","}if(",ia.map((function(t,e){return s+"."+t+"!=="+u[e]})).join("||"),"){",r,".vertexAttrib4f(",o,",",u,");",ia.map((function(t,e){return s+"."+t+"="+u[e]+";"})).join(""),"}")}d===aa?p():d===ra?m():(e("if(",d,"===",aa,"){"),p(),e("}else{"),m(),e("}"))}i.forEach((function(i){var a,s=i.name,d=n.attributes[s];if(d){if(!l(d))return;a=d.append(t,e)}else{if(!l(uo))return;var c=t.scopeAttrib(s);nt.optional((function(){t.assert(e,c+".state","missing attribute "+s)})),a={},Object.keys(new f).forEach((function(t){a[t]=e.def(c,".",t)}))}o(t.link(i),r(i.info.type),a)}))}function A(t,e,i,l,a,r){for(var o,s=t.shared,d=s.gl,c={},u=0;u<l.length;++u){var h=l[u],p=h.name,m=h.info.type,b=h.info.size,f=i.uniforms[p];if(b>1){if(!f)continue;var y=p.replace("[0]","");if(c[y])continue;c[y]=1}var Z,X=t.link(h)+".location";if(f){if(!a(f))continue;if(oo(f)){var G=f.value;if(nt.command(null!=G,'missing uniform "'+p+'"',t.commandStr),m===Jr||m===kr){nt.command("function"==typeof G&&(m===Jr&&("texture2d"===G._reglType||"framebuffer"===G._reglType)||m===kr&&("textureCube"===G._reglType||"framebufferCube"===G._reglType)),"invalid texture for uniform "+p,t.commandStr);var V=t.link(G._texture||G.color[0]._texture);e(d,".uniform1i(",X,",",V+".bind());"),e.exit(V,".unbind();")}else if(m===Hr||m===Cr||m===Nr){nt.optional((function(){nt.command(un(G),"invalid matrix for uniform "+p,t.commandStr),nt.command(m===Hr&&4===G.length||m===Cr&&9===G.length||m===Nr&&16===G.length,"invalid length for matrix uniform "+p,t.commandStr)}));var W=t.global.def("new Float32Array(["+Array.prototype.slice.call(G)+"])"),R=2;m===Cr?R=3:m===Nr&&(R=4),e(d,".uniformMatrix",R,"fv(",X,",false,",W,");")}else{switch(m){case Gr:1===b?nt.commandType(G,"number","uniform "+p,t.commandStr):nt.command(un(G)&&G.length===b,"uniform "+p,t.commandStr),o="1f";break;case Vr:nt.command(un(G)&&G.length&&G.length%2==0&&G.length<=2*b,"uniform "+p,t.commandStr),o="2f";break;case Wr:nt.command(un(G)&&G.length&&G.length%3==0&&G.length<=3*b,"uniform "+p,t.commandStr),o="3f";break;case Rr:nt.command(un(G)&&G.length&&G.length%4==0&&G.length<=4*b,"uniform "+p,t.commandStr),o="4f";break;case Kr:1===b?nt.commandType(G,"boolean","uniform "+p,t.commandStr):nt.command(un(G)&&G.length===b,"uniform "+p,t.commandStr),o="1i";break;case gr:1===b?nt.commandType(G,"number","uniform "+p,t.commandStr):nt.command(un(G)&&G.length===b,"uniform "+p,t.commandStr),o="1i";break;case Sr:case vr:nt.command(un(G)&&G.length&&G.length%2==0&&G.length<=2*b,"uniform "+p,t.commandStr),o="2i";break;case Yr:case xr:nt.command(un(G)&&G.length&&G.length%3==0&&G.length<=3*b,"uniform "+p,t.commandStr),o="3i";break;case Lr:case _r:nt.command(un(G)&&G.length&&G.length%4==0&&G.length<=4*b,"uniform "+p,t.commandStr),o="4i"}b>1?(o+="v",G=t.global.def("["+Array.prototype.slice.call(G)+"]")):G=un(G)?Array.prototype.slice.call(G):G,e(d,".uniform",o,"(",X,",",G,");")}continue}Z=f.append(t,e)}else{if(!a(uo))continue;Z=e.def(s.uniforms,"[",n.id(p),"]")}m===Jr?(nt(!Array.isArray(Z),"must specify a scalar prop for textures"),e("if(",Z,"&&",Z,'._reglType==="framebuffer"){',Z,"=",Z,".color[0];","}")):m===kr&&(nt(!Array.isArray(Z),"must specify a scalar prop for cube maps"),e("if(",Z,"&&",Z,'._reglType==="framebufferCube"){',Z,"=",Z,".color[0];","}")),nt.optional((function(){function n(n,i){t.assert(e,n,'bad data or missing for uniform "'+p+'".  '+i)}function i(t,e){1===e&&nt(!Array.isArray(Z),"must not specify an array type for uniform"),n("Array.isArray("+Z+") && typeof "+Z+'[0]===" '+t+'" || typeof '+Z+'==="'+t+'"',"invalid type, expected "+t)}function l(e,i,l){Array.isArray(Z)?nt(Z.length&&Z.length%e==0&&Z.length<=e*l,"must have length of "+(1===l?"":"n * ")+e):n(s.isArrayLike+"("+Z+")&&"+Z+".length && "+Z+".length % "+e+" === 0 && "+Z+".length<="+e*l,"invalid vector, should have length of "+(1===l?"":"n * ")+e,t.commandStr)}function a(e){nt(!Array.isArray(Z),"must not specify a value type"),n("typeof "+Z+'==="function"&&'+Z+'._reglType==="texture'+(e===dr?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(m){case gr:i("number",b);break;case vr:l(2,"number",b);break;case xr:l(3,"number",b);break;case _r:l(4,"number",b);break;case Gr:i("number",b);break;case Vr:l(2,"number",b);break;case Wr:l(3,"number",b);break;case Rr:l(4,"number",b);break;case Kr:i("boolean",b);break;case Sr:l(2,"boolean",b);break;case Yr:l(3,"boolean",b);break;case Lr:l(4,"boolean",b);break;case Hr:l(4,"number",b);break;case Cr:l(9,"number",b);break;case Nr:l(16,"number",b);break;case Jr:a(dr);break;case kr:a(cr)}}));var g=1;switch(m){case Jr:case kr:var v=e.def(Z,"._texture");e(d,".uniform1i(",X,",",v,".bind());"),e.exit(v,".unbind();");continue;case gr:case Kr:o="1i";break;case vr:case Sr:o="2i",g=2;break;case xr:case Yr:o="3i",g=3;break;case _r:case Lr:o="4i",g=4;break;case Gr:o="1f";break;case Vr:o="2f",g=2;break;case Wr:o="3f",g=3;break;case Rr:o="4f",g=4;break;case Hr:o="Matrix2fv";break;case Cr:o="Matrix3fv";break;case Nr:o="Matrix4fv"}if(-1===o.indexOf("Matrix")&&b>1&&(o+="v",g=1),"M"===o.charAt(0)){e(d,".uniform",o,"(",X,",");var x=Math.pow(m-Hr+2,2),_=t.global.def("new Float32Array(",x,")");Array.isArray(Z)?e("false,(",xt(x,(function(t){return _+"["+t+"]="+Z[t]})),",",_,")"):e("false,(Array.isArray(",Z,")||",Z," instanceof Float32Array)?",Z,":(",xt(x,(function(t){return _+"["+t+"]="+Z+"["+t+"]"})),",",_,")"),e(");")}else if(g>1){for(var K=[],S=[],Y=0;Y<g;++Y)Array.isArray(Z)?S.push(Z[Y]):S.push(e.def(Z+"["+Y+"]")),r&&K.push(e.def());r&&e("if(!",t.batchId,"||",K.map((function(t,e){return t+"!=="+S[e]})).join("||"),"){",K.map((function(t,e){return t+"="+S[e]+";"})).join("")),e(d,".uniform",o,"(",X,",",S.join(","),");"),r&&e("}")}else{if(nt(!Array.isArray(Z),"uniform value must not be an array"),r){var L=e.def();e("if(!",t.batchId,"||",L,"!==",Z,"){",L,"=",Z,";")}e(d,".uniform",o,"(",X,",",Z,");"),r&&e("}")}}}function q(t,e,n,i){var l=t.shared,a=l.gl,r=l.draw,o=i.draw;function s(){var s,d=o.elements,c=e;return d?((d.contextDep&&i.contextDynamic||d.propDep)&&(c=n),s=d.append(t,c),o.elementsActive&&c("if("+s+")"+a+".bindBuffer("+sr+","+s+".buffer.buffer);")):(s=c.def(),c(s,"=",r,".",Ua,";","if(",s,"){",a,".bindBuffer(",sr,",",s,".buffer.buffer);}","else if(",l.vao,".currentVAO){",s,"=",t.shared.elements+".getElements("+l.vao,".currentVAO.elements);",G?"":"if("+s+")"+a+".bindBuffer("+sr+","+s+".buffer.buffer);","}")),s}function d(){var l,a=o.count,s=e;return a?((a.contextDep&&i.contextDynamic||a.propDep)&&(s=n),l=a.append(t,s),nt.optional((function(){a.MISSING&&t.assert(e,"false","missing vertex count"),a.DYNAMIC&&t.assert(s,l+">=0","missing vertex count")}))):(l=s.def(r,".",Pa),nt.optional((function(){t.assert(s,l+">=0","missing vertex count")}))),l}var c=s();function u(l){var a=o[l];return a?a.contextDep&&i.contextDynamic||a.propDep?a.append(t,n):a.append(t,e):e.def(r,".",l)}var h,p,m=u(ja),b=u(Ea),f=d();if("number"==typeof f){if(0===f)return}else n("if(",f,"){"),n.exit("}");Z&&(h=u(Oa),p=t.instancing);var y=c+".type",X=o.elements&&oo(o.elements)&&!o.vaoActive;function V(){function t(){n(p,".drawElementsInstancedANGLE(",[m,f,y,b+"<<(("+y+"-"+la+")>>1)",h],");")}function e(){n(p,".drawArraysInstancedANGLE(",[m,b,f,h],");")}c&&"null"!==c?X?t():(n("if(",c,"){"),t(),n("}else{"),e(),n("}")):e()}function W(){function t(){n(a+".drawElements("+[m,f,y,b+"<<(("+y+"-"+la+")>>1)"]+");")}function e(){n(a+".drawArrays("+[m,b,f]+");")}c&&"null"!==c?X?t():(n("if(",c,"){"),t(),n("}else{"),e(),n("}")):e()}Z&&("number"!=typeof h||h>=0)?"string"==typeof h?(n("if(",h,">0){"),V(),n("}else if(",h,"<0){"),W(),n("}")):V():W()}function $(t,e,n,i,l){var a=H(),r=a.proc("body",l);return nt.optional((function(){a.commandStr=e.commandStr,a.command=a.link(e.commandStr)})),Z&&(a.instancing=r.def(a.shared.extensions,".angle_instanced_arrays")),t(a,r,n,i),a.compile().body}function tt(t,e,n,i){E(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),D(t,e,n,i.attributes,(function(){return!0}))),A(t,e,n,i.uniforms,(function(){return!0}),!1),q(t,e,e,n)}function et(t,e){var n=t.proc("draw",1);E(t,n),B(t,n,e.context),U(t,n,e.framebuffer),j(t,n,e),P(t,n,e.state),O(t,n,e,!1,!0);var i=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",i,".program);"),e.shader.program)tt(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var l=t.global.def("{}"),a=n.def(i,".id"),r=n.def(l,"[",a,"]");n(t.cond(r).then(r,".call(this,a0);").else(r,"=",l,"[",a,"]=",t.link((function(n){return $(tt,t,e,n,1)})),"(",i,");",r,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}function it(t,e,n,i){function l(){return!0}t.batchId="a1",E(t,e),D(t,e,n,i.attributes,l),A(t,e,n,i.uniforms,l,!1),q(t,e,e,n)}function lt(t,e,n,i){E(t,e);var l=n.contextDep,a=e.def(),r="a0",o="a1",s=e.def();t.shared.props=s,t.batchId=a;var d=t.scope(),c=t.scope();function u(t){return t.contextDep&&l||t.propDep}function h(t){return!u(t)}if(e(d.entry,"for(",a,"=0;",a,"<",o,";++",a,"){",s,"=",r,"[",a,"];",c,"}",d.exit),n.needsContext&&B(t,c,n.context),n.needsFramebuffer&&U(t,c,n.framebuffer),P(t,c,n.state,u),n.profile&&u(n.profile)&&O(t,c,n,!1,!0),i)n.useVAO?n.drawVAO?u(n.drawVAO)?c(t.shared.vao,".setVAO(",n.drawVAO.append(t,c),");"):d(t.shared.vao,".setVAO(",n.drawVAO.append(t,d),");"):d(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(d(t.shared.vao,".setVAO(null);"),D(t,d,n,i.attributes,h),D(t,c,n,i.attributes,u)),A(t,d,n,i.uniforms,h,!1),A(t,c,n,i.uniforms,u,!0),q(t,d,c,n);else{var p=t.global.def("{}"),m=n.shader.progVar.append(t,c),b=c.def(m,".id"),f=c.def(p,"[",b,"]");c(t.shared.gl,".useProgram(",m,".program);","if(!",f,"){",f,"=",p,"[",b,"]=",t.link((function(e){return $(it,t,n,e,2)})),"(",m,");}",f,".call(this,a0[",a,"],",a,");")}}function at(t,e){var n=t.proc("batch",2);t.batchId="0",E(t,n);var i=!1,l=!0;Object.keys(e.context).forEach((function(t){i=i||e.context[t].propDep})),i||(B(t,n,e.context),l=!1);var a=e.framebuffer,r=!1;function o(t){return t.contextDep&&i||t.propDep}a?(a.propDep?i=r=!0:a.contextDep&&i&&(r=!0),r||U(t,n,a)):U(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(i=!0),j(t,n,e),P(t,n,e.state,(function(t){return!o(t)})),e.profile&&o(e.profile)||O(t,n,e,!1,"a1"),e.contextDep=i,e.needsContext=l,e.needsFramebuffer=r;var s=e.shader.progVar;if(s.contextDep&&i||s.propDep)lt(t,n,e,null);else{var d=s.append(t,n);if(n(t.shared.gl,".useProgram(",d,".program);"),e.shader.program)lt(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var c=t.global.def("{}"),u=n.def(d,".id"),h=n.def(c,"[",u,"]");n(t.cond(h).then(h,".call(this,a0,a1);").else(h,"=",c,"[",u,"]=",t.link((function(n){return $(lt,t,e,n,2)})),"(",d,");",h,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}function rt(t,e){var i=t.proc("scope",3);t.batchId="a2";var l=t.shared,a=l.current;function r(n){var a=e.shader[n];a&&i.set(l.shader,"."+n,a.append(t,i))}B(t,i,e.context),e.framebuffer&&e.framebuffer.append(t,i),ao(Object.keys(e.state)).forEach((function(n){var a=e.state[n].append(t,i);un(a)?a.forEach((function(e,l){i.set(t.next[n],"["+l+"]",e)})):i.set(l.next,"."+n,a)})),O(t,i,e,!0,!0),[Ua,Ea,Pa,Oa,ja].forEach((function(n){var a=e.draw[n];a&&i.set(l.draw,"."+n,""+a.append(t,i))})),Object.keys(e.uniforms).forEach((function(a){var r=e.uniforms[a].append(t,i);Array.isArray(r)&&(r="["+r.join()+"]"),i.set(l.uniforms,"["+n.id(a)+"]",r)})),Object.keys(e.attributes).forEach((function(n){var l=e.attributes[n].append(t,i),a=t.scopeAttrib(n);Object.keys(new f).forEach((function(t){i.set(a,"."+t,l[t])}))})),e.scopeVAO&&i.set(l.vao,".targetVAO",e.scopeVAO.append(t,i)),r(Ma),r(Ba),Object.keys(e.state).length>0&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",t.shared.context,",a0,",t.batchId,");")}function ot(t){if("object"==typeof t&&!un(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(mt.isDynamic(t[e[n]]))return!0;return!1}}function st(t,e,n){var i=e.static[n];if(i&&ot(i)){var l=t.global,a=Object.keys(i),r=!1,o=!1,s=!1,d=t.global.def("{}");a.forEach((function(e){var n=i[e];if(mt.isDynamic(n)){"function"==typeof n&&(n=i[e]=mt.unbox(n));var a=co(n,null);r=r||a.thisDep,s=s||a.propDep,o=o||a.contextDep}else{switch(l(d,".",e,"="),typeof n){case"number":l(n);break;case"string":l('"',n,'"');break;case"object":Array.isArray(n)&&l("[",n.join(),"]");break;default:l(t.link(n))}l(";")}})),e.dynamic[n]=new mt.DynamicVariable(ua,{thisDep:r,contextDep:o,propDep:s,ref:d,append:c}),delete e.static[n]}function c(t,e){a.forEach((function(n){var l=i[n];if(mt.isDynamic(l)){var a=t.invoke(e,l);e(d,".",n,"=",a,";")}}))}}function dt(t,n,i,l,a){var r=H();r.stats=r.link(a),Object.keys(n.static).forEach((function(t){st(r,n,t)})),rr.forEach((function(e){st(r,t,e)}));var o=M(t,n,i,l,r);return et(r,o),rt(r,o),at(r,o),e(r.compile(),{destroy:function(){o.shader.program.destroy()}})}return{next:W,current:V,procs:function(){var t=H(),e=t.proc("poll"),n=t.proc("refresh"),a=t.block();e(a),n(a);var r,o=t.shared,s=o.gl,d=o.next,c=o.current;a(c,".dirty=false;"),U(t,e),U(t,n,null,!0),Z&&(r=t.link(Z)),i.oes_vertex_array_object&&n(t.link(i.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var u=0;u<l.maxAttributes;++u){var h=n.def(o.attributes,"[",u,"]"),p=t.cond(h,".buffer");p.then(s,".enableVertexAttribArray(",u,");",s,".bindBuffer(",or,",",h,".buffer.buffer);",s,".vertexAttribPointer(",u,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);").else(s,".disableVertexAttribArray(",u,");",s,".vertexAttrib4f(",u,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;"),n(p),Z&&n(r,".vertexAttribDivisorANGLE(",u,",",h,".divisor);")}return n(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(g).forEach((function(i){var l=g[i],r=a.def(d,".",i),o=t.block();o("if(",r,"){",s,".enable(",l,")}else{",s,".disable(",l,")}",c,".",i,"=",r,";"),n(o),e("if(",r,"!==",c,".",i,"){",o,"}")})),Object.keys(v).forEach((function(i){var l,r,o=v[i],u=V[i],h=t.block();if(h(s,".",o,"("),un(u)){var p=u.length;l=t.global.def(d,".",i),r=t.global.def(c,".",i),h(xt(p,(function(t){return l+"["+t+"]"})),");",xt(p,(function(t){return r+"["+t+"]="+l+"["+t+"];"})).join("")),e("if(",xt(p,(function(t){return l+"["+t+"]!=="+r+"["+t+"]"})).join("||"),"){",h,"}")}else l=a.def(d,".",i),r=a.def(c,".",i),h(l,");",c,".",i,"=",l,";"),e("if(",l,"!==",r,"){",h,"}");n(h)})),t.compile()}(),compile:dt}}function po(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var mo=34918,bo=34919,fo=35007,yo=function(t,e){if(!e.ext_disjoint_timer_query)return null;var n=[];function i(){return n.pop()||e.ext_disjoint_timer_query.createQueryEXT()}function l(t){n.push(t)}var a=[];function r(t){var n=i();e.ext_disjoint_timer_query.beginQueryEXT(fo,n),a.push(n),p(a.length-1,a.length,t)}function o(){e.ext_disjoint_timer_query.endQueryEXT(fo)}function s(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var d=[];function c(){return d.pop()||new s}function u(t){d.push(t)}var h=[];function p(t,e,n){var i=c();i.startQueryIndex=t,i.endQueryIndex=e,i.sum=0,i.stats=n,h.push(i)}var m=[],b=[];function f(){var t,n,i=a.length;if(0!==i){b.length=Math.max(b.length,i+1),m.length=Math.max(m.length,i+1),m[0]=0,b[0]=0;var r=0;for(t=0,n=0;n<a.length;++n){var o=a[n];e.ext_disjoint_timer_query.getQueryObjectEXT(o,bo)?(r+=e.ext_disjoint_timer_query.getQueryObjectEXT(o,mo),l(o)):a[t++]=o,m[n+1]=r,b[n+1]=t}for(a.length=t,t=0,n=0;n<h.length;++n){var s=h[n],d=s.startQueryIndex,c=s.endQueryIndex;s.sum+=m[c]-m[d];var p=b[d],f=b[c];f===p?(s.stats.gpuTime+=s.sum/1e6,u(s)):(s.startQueryIndex=p,s.endQueryIndex=f,h[t++]=s)}h.length=t}}return{beginQuery:r,endQuery:o,pushScopeStats:p,update:f,getNumPendingQueries:function(){return a.length},clear:function(){n.push.apply(n,a);for(var t=0;t<n.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(n[t]);a.length=0,n.length=0},restore:function(){a.length=0,n.length=0}}},Zo=16384,Xo=256,Go=1024,Vo=34962,Wo="webglcontextlost",Ro="webglcontextrestored",go=1,vo=2,xo=3;function _o(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function Ko(t){var n=gt(t);if(!n)return null;var i=n.gl,l=i.getContextAttributes(),a=i.isContextLost(),r=vt(i,n);if(!r)return null;var o=yt(),s=po(),d=r.extensions,c=yo(i,d),u=ft(),h=i.drawingBufferWidth,p=i.drawingBufferHeight,m={tick:0,time:0,viewportWidth:h,viewportHeight:p,framebufferWidth:h,framebufferHeight:p,drawingBufferWidth:h,drawingBufferHeight:p,pixelRatio:n.pixelRatio},b={},f={elements:null,primitive:4,count:-1,offset:0,instances:-1},y=We(i,d),Z=Ue(i,s,n,V),X=rn(i,d,Z,s),G=Ml(i,d,y,s,Z,X,f);function V(t){return G.destroyBuffer(t)}var W=El(i,o,s,n),R=Oi(i,d,y,(function(){x.procs.poll()}),m,s,n),g=dl(i,d,y,s,n),v=zl(i,d,y,R,g,s),x=ho(i,o,d,y,Z,X,R,v,b,G,W,f,m,c,n),_=$l(i,v,x.procs.poll,m,l,d,y),K=x.next,S=i.canvas,Y=[],L=[],H=[],C=[n.onDestroy],N=null;function J(){if(0===Y.length)return c&&c.update(),void(N=null);N=bt.next(J),P();for(var t=Y.length-1;t>=0;--t){var e=Y[t];e&&e(m,null,0)}i.flush(),c&&c.update()}function k(){!N&&Y.length>0&&(N=bt.next(J))}function z(){N&&(bt.cancel(J),N=null)}function I(t){t.preventDefault(),a=!0,z(),L.forEach((function(t){t()}))}function w(t){i.getError(),a=!1,r.restore(),W.restore(),Z.restore(),R.restore(),g.restore(),v.restore(),G.restore(),c&&c.restore(),x.procs.refresh(),k(),H.forEach((function(t){t()}))}function T(){Y.length=0,z(),S&&(S.removeEventListener(Wo,I),S.removeEventListener(Ro,w)),W.clear(),v.clear(),g.clear(),G.clear(),R.clear(),X.clear(),Z.clear(),c&&c.clear(),C.forEach((function(t){t()}))}function F(t){function n(t){var n=e({},t);function i(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach((function(i){n[t+"."+i]=e[i]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),i("blend"),i("depth"),i("cull"),i("stencil"),i("polygonOffset"),i("scissor"),i("sample"),"vao"in t&&(n.vao=t.vao),n}function i(t,e){var n={},i={};return Object.keys(t).forEach((function(l){var a=t[l];if(mt.isDynamic(a))i[l]=mt.unbox(a,l);else{if(e&&Array.isArray(a))for(var r=0;r<a.length;++r)if(mt.isDynamic(a[r]))return void(i[l]=mt.unbox(a,l));n[l]=a}})),{dynamic:i,static:n}}nt(!!t,"invalid args to regl({...})"),nt.type(t,"object","invalid args to regl({...})");var l=i(t.context||{},!0),r=i(t.uniforms||{},!0),o=i(t.attributes||{},!1),s=i(n(t),!1),d={gpuTime:0,cpuTime:0,count:0},c=x.compile(s,o,r,l,d),u=c.draw,h=c.batch,p=c.scope,m=[];function b(t){for(;m.length<t;)m.push(null);return m}function f(t,e){var n;if(a&&nt.raise("context lost"),"function"==typeof t)return p.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(n=0;n<t;++n)p.call(this,null,e,n);else{if(!Array.isArray(t))return p.call(this,t,e,0);for(n=0;n<t.length;++n)p.call(this,t[n],e,n)}else if("number"==typeof t){if(t>0)return h.call(this,b(0|t),0|t)}else{if(!Array.isArray(t))return u.call(this,t);if(t.length)return h.call(this,t,t.length)}}return e(f,{stats:d,destroy:function(){c.destroy()}})}S&&(S.addEventListener(Wo,I,!1),S.addEventListener(Ro,w,!1));var Q=v.setFBO=F({framebuffer:mt.define.call(null,go,"framebuffer")});function M(t,e){var n=0;x.procs.poll();var l=e.color;l&&(i.clearColor(+l[0]||0,+l[1]||0,+l[2]||0,+l[3]||0),n|=Zo),"depth"in e&&(i.clearDepth(+e.depth),n|=Xo),"stencil"in e&&(i.clearStencil(0|e.stencil),n|=Go),nt(!!n,"called regl.clear with no buffer specified"),i.clear(n)}function B(t){if(nt("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var n=0;n<6;++n)Q(e({framebuffer:t.framebuffer.faces[n]},t),M);else Q(t,M);else M(null,t)}function U(t){function e(){var e=_o(Y,t);function n(){var t=_o(Y,n);Y[t]=Y[Y.length-1],Y.length-=1,Y.length<=0&&z()}nt(e>=0,"cannot cancel a frame twice"),Y[e]=n}return nt.type(t,"function","regl.frame() callback must be a function"),Y.push(t),k(),{cancel:e}}function j(){var t=K.viewport,e=K.scissor_box;t[0]=t[1]=e[0]=e[1]=0,m.viewportWidth=m.framebufferWidth=m.drawingBufferWidth=t[2]=e[2]=i.drawingBufferWidth,m.viewportHeight=m.framebufferHeight=m.drawingBufferHeight=t[3]=e[3]=i.drawingBufferHeight}function P(){m.tick+=1,m.time=O(),j(),x.procs.poll()}function E(){R.refresh(),j(),x.procs.refresh(),c&&c.update()}function O(){return(ft()-u)/1e3}function D(t,e){var n;switch(nt.type(e,"function","listener callback must be a function"),t){case"frame":return U(e);case"lost":n=L;break;case"restore":n=H;break;case"destroy":n=C;break;default:nt.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}}E();var A=e(F,{clear:B,prop:mt.define.bind(null,go),context:mt.define.bind(null,vo),this:mt.define.bind(null,xo),draw:F({}),buffer:function(t){return Z.create(t,Vo,!1,!1)},elements:function(t){return X.create(t,!1)},texture:R.create2D,cube:R.createCube,renderbuffer:g.create,framebuffer:v.create,framebufferCube:v.createCube,vao:G.createVAO,attributes:l,frame:U,on:D,limits:y,hasExtension:function(t){return y.extensions.indexOf(t.toLowerCase())>=0},read:_,destroy:T,_gl:i,_refresh:E,poll:function(){P(),c&&c.update()},now:O,stats:s});return n.onDone(null,A),A}return Ko}(),qa=function(t,e,n,i){return $a[0]=i,$a[1]=n,$a[2]=e,$a[3]=t,tr[0]},$a=new Uint8Array(4),tr=new Float32Array($a.buffer);function er(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}var nr=er("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),ir=er("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),lr=er("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),ar=er("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),rr=er("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),or=er("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),sr=er("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),dr=er("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),cr=er("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),ur=er("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),hr=t=>Ji(t[t.length-1]),pr=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(er),mr=hr(pr),br=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(er),fr=hr(br),yr=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(er),Zr=hr(yr),Xr=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(er),Gr=hr(Xr),Vr=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(er),Wr=hr(Vr),Rr=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(er),gr=hr(Rr),vr=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(er),xr=hr(vr),_r=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(er),Kr=hr(_r),Sr=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(er),Yr=hr(Sr),Lr=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(er),Hr=hr(Lr),Cr=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(er),Nr=hr(Cr),Jr=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(er),kr=hr(Jr),zr=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(er),Ir=hr(zr),wr=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(er),Tr=hr(wr),Fr=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(er),Qr=hr(Fr),Mr=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(er),Br=hr(Mr),Ur=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(er),jr=hr(Ur),Pr=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(er),Er=hr(Pr),Or=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(er),Dr=hr(Or),Ar=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(er),qr=hr(Ar),$r=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(er),to=hr($r),eo=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(er),no=hr(eo),io=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(er),lo=hr(io),ao=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(er),ro=hr(ao),oo=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(er),so=hr(oo),co=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(er),uo=hr(co),ho=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(er),po=hr(ho);var mo=nl(_i(300,.5,0),_i(-240,.5,1)),bo=nl(_i(-100,.75,.35),_i(80,1.5,.8)),fo=nl(_i(260,.75,.35),_i(80,1.5,.8)),yo=_i();var Zo=oi(),Xo=Math.PI/3,Go=2*Math.PI/3;function Vo(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var Wo=Vo(er("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Ro=Vo(er("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),go=Vo(er("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),vo=Vo(er("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),xo=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",schemeCategory10:nr,schemeAccent:ir,schemeDark2:lr,schemePaired:ar,schemePastel1:rr,schemePastel2:or,schemeSet1:sr,schemeSet2:dr,schemeSet3:cr,schemeTableau10:ur,interpolateBrBG:mr,schemeBrBG:pr,interpolatePRGn:fr,schemePRGn:br,interpolatePiYG:Zr,schemePiYG:yr,interpolatePuOr:Gr,schemePuOr:Xr,interpolateRdBu:Wr,schemeRdBu:Vr,interpolateRdGy:gr,schemeRdGy:Rr,interpolateRdYlBu:xr,schemeRdYlBu:vr,interpolateRdYlGn:Kr,schemeRdYlGn:_r,interpolateSpectral:Yr,schemeSpectral:Sr,interpolateBuGn:Hr,schemeBuGn:Lr,interpolateBuPu:Nr,schemeBuPu:Cr,interpolateGnBu:kr,schemeGnBu:Jr,interpolateOrRd:Ir,schemeOrRd:zr,interpolatePuBuGn:Tr,schemePuBuGn:wr,interpolatePuBu:Qr,schemePuBu:Fr,interpolatePuRd:Br,schemePuRd:Mr,interpolateRdPu:jr,schemeRdPu:Ur,interpolateYlGnBu:Er,schemeYlGnBu:Pr,interpolateYlGn:Dr,schemeYlGn:Or,interpolateYlOrBr:qr,schemeYlOrBr:Ar,interpolateYlOrRd:to,schemeYlOrRd:$r,interpolateBlues:no,schemeBlues:eo,interpolateGreens:lo,schemeGreens:io,interpolateGreys:ro,schemeGreys:ao,interpolatePurples:so,schemePurples:oo,interpolateReds:uo,schemeReds:co,interpolateOranges:po,schemeOranges:ho,interpolateCividis:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},interpolateCubehelixDefault:mo,interpolateRainbow:function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return yo.h=360*t-100,yo.s=1.5-1.5*e,yo.l=.8-.9*e,yo+""},interpolateWarm:bo,interpolateCool:fo,interpolateSinebow:function(t){var e;return t=(.5-t)*Math.PI,Zo.r=255*(e=Math.sin(t))*e,Zo.g=255*(e=Math.sin(t+Xo))*e,Zo.b=255*(e=Math.sin(t+Go))*e,Zo+""},interpolateTurbo:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},interpolateViridis:Wo,interpolateMagma:Ro,interpolateInferno:go,interpolatePlasma:vo});function _o(t){return void 0!==t.op}function Ko(t){return void 0!==t.constant}const So={sqrt:function(){return Qa.apply(null,arguments).exponent(.5)},log:function t(){const e=za(ua()).domain([1,10]);return e.copy=()=>ca(e,t()).base(e.base()),ta.apply(e,arguments),e},linear:Ya,literal:function t(e){var n;function i(t){return null==t||isNaN(t=+t)?n:t}return i.invert=i,i.domain=i.range=function(t){return arguments.length?(e=Array.from(t,la),i):e.slice()},i.unknown=function(t){return arguments.length?(n=t,i):n},i.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,la):[0,1],Sa(i)}};function Yo(t){const e=new Uint8Array(16384);return e.set(t.flat()),e}function Lo(t){return Yo(Nt(4096).map((e=>{const n=oi(t(e/4096));return[n.r,n.g,n.b,255]})))}const Ho={white:Yo(Nt(4096).map((()=>[.5,.5,.5,.5])))},Co={};for(const[Wb,Rb]of Object.entries(xo)){if(Wb.startsWith("scheme")&&"string"==typeof Rb[0]){const t=new Array(4096),e=Rb.map((t=>{const e=oi(t);return[e.r,e.g,e.b,255]}));for(const i of Nt(4096))t[i]=e[i%Rb.length];const n=Wb.replace("scheme","").toLowerCase();Ho[n]=Yo(t),Co[n]=Rb}if(Wb.startsWith("interpolate")){const t=Wb.replace("interpolate","").toLowerCase();Ho[t]=Lo(Rb),"rainbow"===t&&(Ho.shufbow=kt(Ho[t]))}}!function(){const t=["#E69F00","#CC79A7","#56B4E9","#009E73","#0072B2","#D55E00","#F0E442"],e=new Array(4096),n=t.map((t=>{const e=oi(t);return[e.r,e.g,e.b,255]}));for(const i of Nt(4096))e[i]=n[i%t.length];Ho.okabe=Yo(e),Co.okabe=t}();class No{constructor(t,e,n,i){if(this.field=null,this._texture_buffer=null,this.partner=null,this._textures={},this._scale=t=>1,this.aesthetic_map=i,void 0===this.aesthetic_map)throw new Error("Aesthetic map is undefined");this.scatterplot=t,this.regl=e,this._domain=this.default_domain,this._range=[0,1],this.tileSet=n,this._domains={},this.id=""+Math.random(),this.current_encoding={constant:1}}apply(t){return this.scale(this.value_for(t))}get transform(){return this._transform?this._transform:this.default_transform}set transform(t){this._transform=t}get scale(){let t=So[this.transform]().domain(this.domain).range(this.range);const e=this.range;if("string"==typeof e){const t=xo["interpolate"+(n=e,n.charAt(0).toUpperCase()+n.slice(1))];if(void 0!==t)return"sqrt"===this.transform?Pa(t).exponent(.5).domain(this.domain):"log"===this.transform?ja(t).domain(this.domain):Ua(t).domain(this.domain)}var n;if(this.is_dictionary())if(t=ia().domain(this.domain),"string"==typeof e&&Co[e]){if(null===this.column.data[0].dictionary)throw new Error("Dictionary is null");t.range(Co[e]).domain(this.column.data[0].dictionary.toArray())}else t.range(this.range);return t}get column(){if(null===this.field)throw new Error("Can't retrieve column for aesthetic without a field");if(this.tileSet.table){const t=this.tileSet.table.getChild(this.field);if(null==t)throw new Error("Can't find column "+this.field);return t}throw new Error("Table is null")}get default_domain(){if(null==this.field)return[1,1];if(this._domains[this.field])return this._domains[this.field];if(!this.tileSet.table)return[1,1];const{column:t}=this;return t?(t.type.dictionary?this._domains[this.field]=[0,this.aesthetic_map.texture_size-1]:this._domains[this.field]=Vt(t.toArray()),this._domains[this.field]):[1,1]}default_data(){return Array(this.aesthetic_map.texture_size).fill(this.default_constant)}get domain(){return this._domain||this.default_domain}get range(){return this._range||this.default_range}value_for(t){return t[this.field]}get map_position(){return 0===this.use_map_on_regl?0:this.aesthetic_map.get_position(this.id)}get texture_buffer(){return this._texture_buffer||(this._texture_buffer=new Float32Array(this.aesthetic_map.texture_size),this._texture_buffer.set(this.default_data())),this._texture_buffer}key(){return this.field+this.domain+this.range+this.transform}post_to_regl_buffer(){this.aesthetic_map.set_one_d(this.id,this.texture_buffer)}convert_string_encoding(t){return{field:t,domain:this.default_domain,range:this.default_range}}complete_domain(t){return t.domain=t.domain||this.default_domain,t}update(t){if("null"===t&&(t=null),null!==t){if(void 0!==t)if("string"==typeof t&&(t=this.convert_string_encoding(t)),"object"==typeof t){if(this.current_encoding=t,!Ko(t)&&(this.field=t.field,!_o(t)))if(void 0===t.lambda){void 0===t.domain&&(t.domain=this.default_domain),t.range&&(this._domain=t.domain,this._range=t.range),this._transform=t.transform||void 0,("color"===this.label||t.range&&"string"==typeof t.range[0])&&(this.encode_for_textures(t.range),this.post_to_regl_buffer())}else{const{lambda:e,field:n}=t;e?(this.apply_function_for_textures(n,this.domain,e),this.post_to_regl_buffer()):t.range&&(this.encode_for_textures(this.range),this.post_to_regl_buffer())}}else{let e={constant:t};this.current_encoding=e}}else this.current_encoding={constant:this.default_constant}}encode_for_textures(t){const{texture_size:e}=this.aesthetic_map,n=new Array(e);this.scaleFunc=So[this.transform]().range(t).domain([0,e-1]);for(let i=0;i<e;i+=1)n[i]=this.scaleFunc(i)}arrow_column(){const t=this.tileSet.table.getChild(this.field);if(null===t)throw`No column ${this.field} on arrow table for aesthetic ${this.label}`;return t}is_dictionary(){return null!=this.field&&this.arrow_column().type.dictionary}get constant(){return Ko(this.current_encoding)?this.current_encoding.constant:this.default_constant}get use_map_on_regl(){return this.is_dictionary()&&-2047===this.domain[0]&&2047==this.domain[1]||"color"===this.label?1:0}apply_function_for_textures(t,e,n){const{texture_size:i}=this.aesthetic_map;let l;l="string"==typeof n?function(t){if("function"==typeof t.lambda)throw"Must pass a string to lambda, not a function.";const{lambda:e,field:n}=t;if(void 0===n)throw"Must pass a field to lambda.";const i=Ao(e).lambda,[l,a]=i.split("=>",2).map((t=>t.trim()));return new Function(l,a)}(Ao(n)):n,this.scaleFunc=Ya().range(e).domain([0,i-1]);let a=Nt(i);if(void 0===t||void 0===this.tileSet.table)return console.warn("SETTING EMPTY FIELD"),void this.texture_buffer.set(Nt(i).map((t=>1)));const{column:r}=this;if(!r)throw`Column ${t} does not exist on table.`;if(r.type.dictionary){a.fill(void 0);r.data[0].dictionary.toArray().forEach(((t,e)=>{a[e]=t}))}else a=a.map((t=>this.scale(t)));const o=a.map((t=>l(t)));this.texture_buffer.set(o)}}class Jo extends No{static get default_constant(){return 1.5}static get_default_domain(){return[0,1]}get default_domain(){return[0,1]}}class ko extends No{}class zo extends Jo{constructor(){super(...arguments),this.default_constant=1,this.label="size",this.default_transform="sqrt"}static get default_constant(){return 1.5}static get_default_domain(){return[0,10]}get default_domain(){return[0,10]}}zo.default_range=[0,1];class Io extends Jo{constructor(t,e,n,i){super(t,e,n,i),this.default_range=[-1,1],this.default_constant=0,this.default_transform="literal",this._transform="literal"}get range(){return this.tileSet.extent&&this.tileSet.extent[this.label]?this.tileSet.extent[this.label]:[-20,20]}static get default_constant(){return 0}}class wo extends Io{constructor(){super(...arguments),this.label="x",this.field="x"}}class To extends wo{constructor(){super(...arguments),this.label="x0"}}class Fo extends Io{constructor(){super(...arguments),this.label="y",this.field="y"}}class Qo extends Fo{constructor(){super(...arguments),this.label="y0"}}class Mo extends ko{constructor(t,e,n,i){super(t,e,n,i),this.default_transform="literal",this.default_constant=1,this.default_range=[0,1],this.current_encoding={constant:1}}get default_domain(){return[0,1]}get domain(){return this.is_dictionary()?[-2047,2047]:[0,1]}update(t){super.update(t)}post_to_regl_buffer(){super.post_to_regl_buffer()}ops_to_array(){const t=this.current_encoding;if(null===t)return[0,0,0];if(void 0===t)return[0,0,0];if(!_o(t))return[0,0,0];if("within"===t.op)return[4,t.a,t.b];return[[null,"lt","gt","eq"].indexOf(t.op),t.a,0]}}class Bo extends Mo{constructor(){super(...arguments),this.label="filter"}}class Uo extends Mo{constructor(){super(...arguments),this.label="filter2"}}class jo extends No{constructor(){super(...arguments),this.label="jitter_speed",this.default_transform="linear",this.default_constant=.5}get default_domain(){return[0,1]}}jo.default_range=[0,1];class Po extends No{constructor(){super(...arguments),this.jitter_int_formatted=0,this.default_transform="linear",this._method="None",this.label="jitter_radius"}get default_constant(){return 0}get default_domain(){return[0,1]}get default_range(){return[0,1]}get method(){return this.current_encoding&&this.current_encoding.method?this.current_encoding.method:"None"}set method(t){this._method=t}get jitter_int_format(){return"spiral"===(t=this.method)?1:"uniform"===t?2:"normal"===t?3:"circle"===t?4:"time"===t?5:0;var t}}class Eo extends No{constructor(){super(...arguments),this.label="color",this.texture_type="uint8",this.default_constant=[.7,0,.5],this.default_transform="linear",this.current_encoding={constant:[.7,0,.5]}}get default_range(){return[0,1]}default_data(){return Ho.viridis}get texture_buffer(){return this._texture_buffer||(this._texture_buffer=new Uint8Array(4*this.aesthetic_map.texture_size),this._texture_buffer.set(this.default_data())),this._texture_buffer}static convert_color(t){const{r:e,g:n,b:i}=oi(t);return[e/255,n/255,i/255]}post_to_regl_buffer(){this.aesthetic_map.set_color(this.id,this.texture_buffer)}update(t){this.current_encoding=t,Ko(t)&&"string"==typeof t.constant&&(t.constant=Eo.convert_color(t.constant)),super.update(t)}encode_for_textures(t){if(this._scale=So[this.transform]().range(t).domain(this.domain),Ho[t])this.texture_buffer.set(Ho[t]);else if(t.length===4*this.aesthetic_map.texture_size)this.texture_buffer.set(t);else if(t.length&&t[0].length&&3===t[0].length){const e=Nt(4096).map((e=>{const[n,i,l]=t[e%t.length];return[n,i,l,255]}));this.texture_buffer.set(e.flat())}else console.warn(`request range of ${t} for color ${this.field} unknown`)}}class Oo{constructor(t,e,n,i){if(this.needs_transitions=!1,void 0===i)throw new Error("Aesthetic map is undefined.");this.scatterplot=t,this.regl=e,this.tile=n,this.aesthetic_map=i,this.aesthetic_map=i,this.current_encoding={constant:1}}get current(){return this.states[0]}get last(){return this.states[1]}get states(){return void 0!==this._states||(this._states=[new this.Factory(this.scatterplot,this.regl,this.tile,this.aesthetic_map),new this.Factory(this.scatterplot,this.regl,this.tile,this.aesthetic_map)]),this._states}update(t){JSON.stringify(t)==JSON.stringify(this.current_encoding)||void 0===t?(this.needs_transitions&&this.states[1].update(this.current_encoding),this.needs_transitions=!1):(this.states.reverse(),this.states[0].update(t),this.needs_transitions=!0,this.current_encoding=t)}}const Do={x:class extends Oo{get Factory(){return wo}get label(){return"x"}},x0:class extends Oo{get Factory(){return To}get label(){return"x0"}},y:class extends Oo{get Factory(){return Fo}get label(){return"y"}},y0:class extends Oo{get Factory(){return Qo}get label(){return"y0"}},size:class extends Oo{get Factory(){return zo}get label(){return"size"}},jitter_speed:class extends Oo{get Factory(){return jo}get label(){return"jitter_speed"}},jitter_radius:class extends Oo{get Factory(){return Po}get label(){return"jitter_radius"}},color:class extends Oo{get Factory(){return Eo}get label(){return"color"}},filter:class extends Oo{get Factory(){return Bo}get label(){return"filter"}},filter2:class extends Oo{get Factory(){return Uo}get label(){return"filter2"}}};function Ao(t){let[e,n]=t.split("=>").map((t=>t.trim()));if(void 0===n)throw`Couldn't parse ${t} into a function`;"{"!==n.slice(0,1)&&"return"!==n.slice(0,6)&&(n=`return ${n}`);return{field:e,lambda:`${e} => ${n}`}}class qo{constructor(t,e,n){return this.scatterplot=t,this.store={},this.regl=e,this.tileSet=n,this.position_interpolation=!1,this.aesthetic_map=new $o(this.regl),this}dim(t){if(this.store[t])return this.store[t];if(void 0!==Do[t])return this.store[t]=new Do[t](this.scatterplot,this.regl,this.tileSet,this.aesthetic_map),this.store[t];throw new Error(`Unknown aesthetic ${t}`)}*[Symbol.iterator](){for(let[t,e]of Object.entries(this.store))yield[t,e]}interpret_position(t){if(t){t.x0||t.position0?this.position_interpolation=!0:(t.x||t.position)&&(this.position_interpolation=!1);for(const e of["position","position0"]){const n=e.replace("position","");if(t[e]){if("literal"===t[e])t[`x${n}`]={field:"x",transform:"literal"},t[`y${n}`]={field:"y",transform:"literal"};else{const i=t[e];t[`x${n}`]={field:`${i}.x`,transform:"literal"},t[`y${n}`]={field:`${i}.y`,transform:"literal"}}delete t[e]}}}delete t.position,delete t.position0}apply_encoding(t){void 0===t&&(t={}),t.filter1&&(t.filter=t.filter1,delete t.filter1),this.interpret_position(t);for(const e of Object.keys(Do))this.dim(e).update(t[e])}}class $o{constructor(t,e=4096,n=32){this.id_locs={},this.offsets={},this.texture_size=e,this.texture_widths=n,this.regl=t,this._one_d_position=1,this._color_position=-1}get_position(t){return this.offsets[t]||0}set_one_d(t,e){let n;const{offsets:i}=this;i[t]?n=i[t]:(n=this._one_d_position++,i[t]=n),this.one_d_texture.subimage({data:e,width:1,height:this.texture_size},n-1,0)}set_color(t,e){let n;const{offsets:i}=this;i[t]?n=i[t]:(n=this._color_position--,i[t]=n),this.color_texture.subimage({data:e,width:1,height:this.texture_size},-n-1,0)}get one_d_texture(){if(this._one_d_texture)return this._one_d_texture;const t=this.regl.hasExtension("OES_texture_float")?"float":this.regl.hasExtension("OES_texture_half_float")?"half float":"uint8",e="uint8"===t?"rgba":"alpha",n={width:this.texture_widths,height:this.texture_size,type:t,format:e};return this._one_d_texture=this.regl.texture(n),this._one_d_texture}get color_texture(){return this._color_texture||(this._color_texture=this.regl.texture({width:this.texture_widths,height:this.texture_size,type:"uint8",format:"rgba"})),this._color_texture}}class ts extends class{constructor(t,e,n){this._use_scale_to_download_tiles=!0,this.scatterplot=n,this.holder=mt(t),this.canvas=mt(this.holder.node().firstElementChild),this.tileSet=e,this.prefs=n.prefs,this.width=+this.canvas.attr("width"),this.height=+this.canvas.attr("height"),this.deferred_functions=[],this._use_scale_to_download_tiles=!0}get discard_share(){return 0}get optimal_alpha(){let{zoom_balance:t,alpha:e,point_size:n}=this.prefs;const{max_ix:i,width:l,discard_share:a,height:r}=this,{k:o}=this.zoom.transform;e=void 0===e?.25:e;const s=1/o**2,d=e*(l*r)/(Ht([i,this.tileSet.highest_known_ix])*(1-a)*s*(Math.PI*Math.exp(Math.log(1*o)*t)*n)**2);return d>1?1:d<1/255?1/255:d}get max_ix(){const{prefs:t}=this;if(!this._use_scale_to_download_tiles)return t.max_points;const{k:e}=this.zoom.transform,n=Math.exp(Math.log(e)*t.zoom_balance);return t.max_points*e*e/n/n}visible_tiles(){const{max_ix:t}=this,{tileSet:e}=this;let n;return n="x"==this.aes.dim("x").current.field&&"y"==this.aes.dim("y").current.field&&"x"==this.aes.dim("x").last.field&&"y"==this.aes.dim("y").last.field?e.map((t=>t)).filter((e=>e.is_visible(t,this.zoom.current_corners()))):e.map((t=>t)).filter((t=>t.min_ix<this.max_ix)),n.sort(((t,e)=>t.min_ix-e.min_ix)),n}bind_zoom(t){return this.zoom=t,this}_click_function_from_string(){return Function("datum",this.scatterplot.prefs.click_function)}_click_function_matches_prefs(){return"string"==this._click_function_type&&this._click_function==this._click_function_from_string()||"function"==this._click_function_type&&this._click_function==this.scatterplot.prefs.click_function}set click_function(t){"function"==typeof this.scatterplot.prefs.click_function?(this._click_function_type="function",this._click_function=this.scatterplot.prefs.click_function):"string"==typeof this.scatterplot.prefs.click_function?(this._click_function_type="string",this._click_function=this._click_function_from_string()):(console.warn("Unrecognized click_function type; should be string or function."),this._click_function_type=null,this._click_function=function(){})}get click_function(){return this._click_function&&this._click_function_matches_prefs()||(this.click_function=this.scatterplot.prefs.click_function),this._click_function}*initialize(){return Promise.all(this._initializations).then((t=>{this.zoom.restart_timer(5e5)}))}}{constructor(t,e,n){super(t,e,n),this.buffer_size=67108864,this.textures={},this.regl=Aa({optionalExtensions:["OES_standard_derivatives","OES_element_index_uint","OES_texture_float","OES_texture_half_float"],canvas:this.canvas.node()}),this.aes=new qo(n,this.regl,e),this.initialize_textures(),this._initializations=[this.tileSet.promise.then((()=>{this.remake_renderer(),this._webgl_scale_history=[this.default_webgl_scale,this.default_webgl_scale]}))],this.initialize(),this._buffers=new ns(this.regl,this.buffer_size)}get buffers(){return this._buffers=this._buffers||new ns(this.regl,this.buffer_size),this._buffers}data(t){return void 0===t?this.tileSet:(this.tileSet=t,this)}get props(){const{prefs:t}=this,{transform:e}=this.zoom,{aes_to_buffer_num:n,buffer_num_to_variable:i,variable_to_buffer_num:l}=this.allocate_aesthetic_buffers(),a={aes:{encoding:this.aes.encoding},colors_as_grid:0,corners:this.zoom.current_corners(),zoom_balance:t.zoom_balance,transform:e,max_ix:this.max_ix,time:(Date.now()-this.zoom._start)/1e3,update_time:(Date.now()-this.most_recent_restart)/1e3,string_index:0,prefs:JSON.parse(JSON.stringify(t)),color_type:void 0,start_time:this.most_recent_restart,webgl_scale:this._webgl_scale_history[0],last_webgl_scale:this._webgl_scale_history[1],use_scale_for_tiles:this._use_scale_to_download_tiles,grid_mode:0,buffer_num_to_variable:i,aes_to_buffer_num:n,variable_to_buffer_num:l,color_picker_mode:0,zoom_matrix:[[e.k,0,e.x],[0,e.k,e.y],[0,0,1]].flat()};return JSON.parse(JSON.stringify(a))}get default_webgl_scale(){return this._default_webgl_scale||(this._default_webgl_scale=this.zoom.webgl_scale()),this._default_webgl_scale}render_points(t){const e=[];for(const n of this.visible_tiles()){const i=new es(this.regl,n,this);if(!i.ready(t.prefs,t.block_for_buffers))continue;const l={manager:i,image_locations:i.image_locations,sprites:this.sprites};Object.assign(l,t),e.push(l)}e.reverse(),this._renderer(e)}tick(){const{prefs:t}=this,{regl:e,tileSet:n}=this,{props:i}=this;this.tick_num=this.tick_num||0,this.tick_num++,this._use_scale_to_download_tiles?n.download_most_needed_tiles(this.zoom.current_corners(),this.props.max_ix):n.download_to_depth(t.max_points),e.clear({color:[.9,.9,.93,0],depth:1});const l=Date.now();let a=()=>{};for(;Date.now()-l<10&&this.deferred_functions.length;){a=this.deferred_functions.shift();try{a()}catch(r){console.warn(r,a)}}try{this.render_all(i)}catch(r){throw console.log("ERROR NOTED"),this.reglframe.cancel(),r}}render_jpeg(t){}single_blur_pass(t,e,n){const{regl:i}=this;e.use((()=>{i.clear({color:[0,0,0,0]}),i({frag:"precision mediump float;\n#define GLSLIFY 1\n\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.411764705882353) * direction;\n  vec2 off2 = vec2(3.2941176470588234) * direction;\n  vec2 off3 = vec2(5.176470588235294) * direction;\n  color += texture2D(image, uv) * 0.1964825501511404;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n  color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n  color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n  return color;\n}\n\nuniform vec2 iResolution;\nuniform sampler2D iChannel0;\nuniform vec2 direction;\n\nvoid main() {\n  vec2 uv = vec2(gl_FragCoord.xy / iResolution.xy);\n  gl_FragColor = blur13(iChannel0, uv, iResolution.xy, direction);\n}\n",uniforms:{iResolution:({viewportWidth:t,viewportHeight:e})=>[t,e],iChannel0:t,direction:n},vert:"\n        precision mediump float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n          uv = 0.5 * (position + 1.0);\n          gl_Position = vec4(position, 0, 1);\n        }",attributes:{position:[-4,-4,4,-4,0,4]},depth:{enable:!1},count:3})()}))}blur(t,e,n=3){let i=n-1;for(;i>-1;)this.single_blur_pass(t,e,[2**i,0]),this.single_blur_pass(e,t,[0,2**i]),i-=1}render_all(t){const{regl:e}=this;this.fbos.points.use((()=>{e.clear({color:[0,0,0,0]}),this.render_points(t)})),e.clear({color:[0,0,0,0]}),this.fbos.lines.use((()=>e.clear({color:[0,0,0,0]}))),this.scatterplot.trimap&&this.fbos.lines.use((()=>{this.scatterplot.trimap.zoom=this.zoom,this.scatterplot.trimap.tick("polygon")}));for(const n of[this.fbos.lines,this.fbos.points])e({profile:!0,blend:{enable:!0,func:{srcRGB:"one",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},frag:"\n        precision mediump float;\n        varying vec2 uv;\n        uniform sampler2D tex;\n        uniform float wRcp, hRcp;\n        void main() {\n          gl_FragColor = texture2D(tex, uv);\n        }\n      ",vert:"\n        precision mediump float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n          uv = 0.5 * (position + 1.0);\n          gl_Position = vec4(position, 0., 1.);\n        }\n      ",attributes:{position:this.fill_buffer},depth:{enable:!1},count:3,uniforms:{tex:()=>n,wRcp:({viewportWidth:t})=>1/t,hRcp:({viewportHeight:t})=>1/t}})()}initialize_textures(){const{regl:t}=this;this.fbos=this.fbos||{},this.textures=this.textures||{},this.textures.empty_texture=t.texture(Nt(128).map((t=>Nt(128).map((t=>[0,0,0]))))),this.fbos.minicounter=t.framebuffer({width:512,height:512,depth:!1}),this.fbos.lines=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.points=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.ping=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.pong=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.contour=this.fbos.contour||t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.colorpicker=this.fbos.colorpicker||t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.dummy=this.fbos.dummy||t.framebuffer({width:1,height:1,depth:!1})}get_image_texture(t){const{regl:e}=this;if(this.textures=this.textures||{},this.textures[t])return this.textures[t];const n=new Image;return n.src=t,n.onload=()=>{this.textures[t]=e.texture(n)},this.textures[t]}n_visible(t=-1){let{width:e,height:n}=this;e=Math.floor(e),n=Math.floor(n),this.contour_vals=this.contour_vals||new Uint8Array(4*e*n);const{props:i}=this;let l;return i.only_color=t,this.fbos.contour.use((()=>{this.regl.clear({color:[0,0,0,0]}),this.render_points(i),this.regl.read(this.contour_vals),l=function(t,e){let n=0;if(void 0===e)for(let i of t)(i=+i)&&(n+=i);else{let i=-1;for(let l of t)(l=+e(l,++i,t))&&(n+=l)}return n}(this.contour_vals)})),l}color_pick(t,e){const{props:n,height:i}=this;let l;n.color_picker_mode=1,this.fbos.colorpicker.use((()=>{this.regl.clear({color:[0,0,0,0]}),this.render_points(n);try{l=this.regl.read({x:t,y:i-e,width:1,height:1})}catch(a){console.warn("Read bad data from",{x:t,y:e,height:i,attempted:i-e}),l=[0,0,0,0]}}));const a=qa(...l)-1,r=Math.round(a),o=this.tileSet.findPoint(r);if(0!==o.length)return o[0]}get fill_buffer(){if(!this._fill_buffer){const{regl:t}=this;this._fill_buffer=t.buffer({data:[-4,-4,4,-4,0,4]})}return this._fill_buffer}draw_contour_buffer(t,e){let{width:n,height:i}=this;n=Math.floor(n),i=Math.floor(i),this.contour_vals=this.contour_vals||new Uint8Array(4*n*i),this.contour_alpha_vals=this.contour_alpha_vals||new Uint16Array(n*i);const{props:l}=this;l.aes.encoding.color={field:t},l.only_color=e,this.fbos.contour.use((()=>{this.regl.clear({color:[0,0,0,0]}),this.render_points(l),this.regl.read(this.contour_vals)})),this.blur(this.fbos.contour,this.fbos.ping,3),this.fbos.contour.use((()=>{this.regl.read(this.contour_vals)}));let a=0;for(;a<n*i*4;)this.contour_alpha_vals[a/4]=255*this.contour_vals[a+3],a+=4;return this.contour_alpha_vals}remake_renderer(){const{regl:t}=this,e={depth:{enable:!1},stencil:{enable:!1},blend:{enable:(t,{color_picker_mode:e})=>e<.5,func:{srcRGB:"one",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},primitive:"points",frag:"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\nprecision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fill;\nvarying vec2 letter_pos;\nvarying float point_size;\n\nuniform float u_only_color;\nuniform float u_color_picker_mode;\n//uniform float u_use_glyphset;\n//uniform sampler2D u_glyphset;\n\nfloat delta = 0.0, alpha = 1.0;\n\nbool out_of_circle(in vec2 coord) {\n  vec2 cxy = 2.0 * coord - 1.0;\n  float r_sq = dot(cxy, cxy);\n  if (r_sq > 1.03) {return true;}\n  return false;\n}\n\nbool out_of_hollow_circle(in vec2 coord) {\n  vec2 cxy = 2.0 * coord - 1.0;\n  float r_sq = dot(cxy, cxy);\n  if (r_sq > 1.01) {return true;}\n  float distance_from_edge = (1.0 - r_sq) * point_size;\n  if (distance_from_edge > 4.0) {return true;}\n  return false;\n}\n\nbool out_of_triangle(in vec2 coord) {\n  if (coord.y > (2. * abs(coord.x - .5))) {\n    return false;\n  }\n  return true;\n}\n\nvoid main() {\n  if (u_only_color >= -1.5) {\n    gl_FragColor = vec4(0., 0., 0., 1./255.);\n    return;\n  }\n\n  float alpha = fill.a;\n//  if (u_use_glyphset == 0. || point_size < 5.0) {\n    if (out_of_circle(gl_PointCoord)) {\n      discard;\n      return;\n    }\n    vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n    float r = dot(cxy, cxy);\n    #ifdef GL_OES_standard_derivatives\n      delta = fwidth(r);\n      alpha *= (1.0 - smoothstep(1.0 - delta, 1.0 + delta, r));\n    #endif\n/*  } else {\n    vec2 coords = letter_pos + gl_PointCoord/8.;\n//    vec2 coords = vec2(.2, .2);\n    vec4 sprite = texture2D(u_glyphset, coords);\n    alpha *= (sprite.a);  \n//    fill = vec4(1.0, 1.0, 1.0, alpha);  \n    if (alpha <= 0.03) discard;\n  }*/\n  // Pre-blend the alpha channel.\n  if (u_color_picker_mode == 1.) {\n    // no alpha when color picking; we use all four channels for that.\n    gl_FragColor = fill;\n  } else {\n    gl_FragColor = vec4(fill.rgb * alpha, alpha);\n  }\n\n}\n",vert:'precision mediump float;\n#define GLSLIFY 1\n\nuniform float u_zoom_balance;\n\nuniform float u_update_time;\nuniform float u_transition_duration;\n\n// Type of jitter.\nuniform float u_jitter;\nuniform float u_last_jitter;\n\n// Whether to plot only a single category.\nuniform float u_only_color;\nuniform float u_grid_mode;\n\nuniform vec3 u_filter_numeric; // An override for simple numeric operations.\nuniform vec3 u_last_filter_numeric; // An override for simple numeric operations.\n\nuniform vec3 u_filter2_numeric; // An override for simple numeric operations.\nuniform vec3 u_last_filter2_numeric; // An override for simple numeric operations.\n\n// Transform from data space to the open window.\nuniform mat3 u_window_scale;\nuniform mat3 u_last_window_scale;\n// Transform from the open window to the d3-zoom.\nuniform mat3 u_zoom;\n\nuniform float u_width;\nuniform float u_height;\nuniform float u_use_glyphset;\nvarying vec2 letter_pos; // store which letter to use.\n\nuniform float u_maxix;           // The maximum index to plot.\nuniform float u_time;            // The current time.\nuniform float u_k;               // The d3-scale factor.\nuniform float u_color_picker_mode;\nuniform float u_base_size;\nuniform float u_current_alpha;\nuniform float u_last_alpha;\n\nuniform sampler2D u_one_d_aesthetic_map;\nuniform sampler2D u_color_aesthetic_map;\n\n// The same set of items for a variety of aesthetics.\n\n// whether to continuously interpolate between\n// x0 and x, y0 and y.\nuniform float u_position_interpolation_mode;\n\nfloat a_color;\nfloat a_last_color;\n\nuniform float u_color_buffer_num;\nuniform float u_last_color_buffer_num;\n\nuniform vec3 u_color_constant;\nuniform vec3 u_last_color_constant;\n\nuniform float u_color_transform;\nuniform float u_last_color_transform;\nuniform vec2 u_color_domain;\nuniform vec2 u_last_color_domain;\nuniform float u_last_color_map_position;\nuniform float u_color_map_position;\n\nbool a_color_is_constant;\nbool a_last_color_is_constant;\n\n/*\npython code to generate what follows.\ndef autogenerate_code():\n  ks = ["x", "y", "jitter_radius", "jitter_speed", "size", "filter1", "filter2", "x0", "y0"]\n  times = ["", "last_"]\n  print("""\n  //  BEGIN AUTOGENERATED. DO NOT EDIT. \n  // ------------------------------------------------    \n  """)\n  for k in ks:\n    for time in times:\n      timek = time + k\n      print(f"""\n  uniform float u_{timek}_buffer_num;\n  uniform float u_{timek}_constant;\n  uniform float u_{timek}_transform;\n  uniform vec2 u_{timek}_domain;\n  uniform vec2 u_{timek}_range;\n  uniform float u_{timek}_map_position;\n  float a_{timek};\n  bool a_{timek}_is_constant;\n      """)\n  for i in range(0, 16):\n    print(f"attribute float buffer_{i};")\n  for k in ks:\n    for time in times:\n      timek = time + k\n      print(f"""\n    if (u_{timek}_buffer_num > -0.5) {{\n      a_{timek} = get_buffer(u_{timek}_buffer_num);\n      a_{timek}_is_constant = false;\n    }} else {{\n      a_{timek} = u_{timek}_constant;\n      a_{timek}_is_constant = true;\n    }}""")\n  print("""\n//  END AUTOGENERATED. DO NOT EDIT ABOVE. \n// ------------------------------------------------    \n  """)\n\nautogenerate_code()\n*/\n  //  BEGIN AUTOGENERATED. DO NOT EDIT. \n  // ------------------------------------------------    \n  \n\n  uniform float u_x_buffer_num;\n  uniform float u_x_constant;\n  uniform float u_x_transform;\n  uniform vec2 u_x_domain;\n  uniform vec2 u_x_range;\n  uniform float u_x_map_position;\n  float a_x;\n  bool a_x_is_constant;\n      \n\n  uniform float u_last_x_buffer_num;\n  uniform float u_last_x_constant;\n  uniform float u_last_x_transform;\n  uniform vec2 u_last_x_domain;\n  uniform vec2 u_last_x_range;\n  uniform float u_last_x_map_position;\n  float a_last_x;\n  bool a_last_x_is_constant;\n      \n\n  uniform float u_y_buffer_num;\n  uniform float u_y_constant;\n  uniform float u_y_transform;\n  uniform vec2 u_y_domain;\n  uniform vec2 u_y_range;\n  uniform float u_y_map_position;\n  float a_y;\n  bool a_y_is_constant;\n      \n\n  uniform float u_last_y_buffer_num;\n  uniform float u_last_y_constant;\n  uniform float u_last_y_transform;\n  uniform vec2 u_last_y_domain;\n  uniform vec2 u_last_y_range;\n  uniform float u_last_y_map_position;\n  float a_last_y;\n  bool a_last_y_is_constant;\n      \n\n  uniform float u_jitter_radius_buffer_num;\n  uniform float u_jitter_radius_constant;\n  uniform float u_jitter_radius_transform;\n  uniform vec2 u_jitter_radius_domain;\n  uniform vec2 u_jitter_radius_range;\n  uniform float u_jitter_radius_map_position;\n  float a_jitter_radius;\n  bool a_jitter_radius_is_constant;\n      \n\n  uniform float u_last_jitter_radius_buffer_num;\n  uniform float u_last_jitter_radius_constant;\n  uniform float u_last_jitter_radius_transform;\n  uniform vec2 u_last_jitter_radius_domain;\n  uniform vec2 u_last_jitter_radius_range;\n  uniform float u_last_jitter_radius_map_position;\n  float a_last_jitter_radius;\n  bool a_last_jitter_radius_is_constant;\n      \n\n  uniform float u_jitter_speed_buffer_num;\n  uniform float u_jitter_speed_constant;\n  uniform float u_jitter_speed_transform;\n  uniform vec2 u_jitter_speed_domain;\n  uniform vec2 u_jitter_speed_range;\n  uniform float u_jitter_speed_map_position;\n  float a_jitter_speed;\n  bool a_jitter_speed_is_constant;\n      \n\n  uniform float u_last_jitter_speed_buffer_num;\n  uniform float u_last_jitter_speed_constant;\n  uniform float u_last_jitter_speed_transform;\n  uniform vec2 u_last_jitter_speed_domain;\n  uniform vec2 u_last_jitter_speed_range;\n  uniform float u_last_jitter_speed_map_position;\n  float a_last_jitter_speed;\n  bool a_last_jitter_speed_is_constant;\n      \n\n  uniform float u_size_buffer_num;\n  uniform float u_size_constant;\n  uniform float u_size_transform;\n  uniform vec2 u_size_domain;\n  uniform vec2 u_size_range;\n  uniform float u_size_map_position;\n  float a_size;\n  bool a_size_is_constant;\n      \n\n  uniform float u_last_size_buffer_num;\n  uniform float u_last_size_constant;\n  uniform float u_last_size_transform;\n  uniform vec2 u_last_size_domain;\n  uniform vec2 u_last_size_range;\n  uniform float u_last_size_map_position;\n  float a_last_size;\n  bool a_last_size_is_constant;\n      \n\n  uniform float u_filter_buffer_num;\n  uniform float u_filter_map_position;\n  float a_filter1;\n  bool a_filter_is_constant;\n  uniform float u_last_filter_buffer_num;\n  uniform float u_last_filter_map_position;\n  float a_last_filter1;\n  bool a_last_filter_is_constant;\n\n  uniform float u_filter2_buffer_num;\n  uniform float u_filter2_map_position;\n  float a_filter2;\n  bool a_filter2_is_constant;\n  uniform float u_last_filter2_buffer_num;\n  uniform float u_last_filter2_map_position;\n  float a_last_filter2;\n  bool a_last_filter2_is_constant;\n\n  uniform float u_x0_buffer_num;\n  uniform float u_x0_constant;\n  uniform float u_x0_transform;\n  uniform vec2 u_x0_domain;\n  uniform vec2 u_x0_range;\n  uniform float u_x0_map_position;\n  float a_x0;\n  bool a_x0_is_constant;\n      \n\n  uniform float u_last_x0_buffer_num;\n  uniform float u_last_x0_constant;\n  uniform float u_last_x0_transform;\n  uniform vec2 u_last_x0_domain;\n  uniform vec2 u_last_x0_range;\n  uniform float u_last_x0_map_position;\n  float a_last_x0;\n  bool a_last_x0_is_constant;\n      \n\n  uniform float u_y0_buffer_num;\n  uniform float u_y0_constant;\n  uniform float u_y0_transform;\n  uniform vec2 u_y0_domain;\n  uniform vec2 u_y0_range;\n  uniform float u_y0_map_position;\n  float a_y0;\n  bool a_y0_is_constant;\n      \n\n  uniform float u_last_y0_buffer_num;\n  uniform float u_last_y0_constant;\n  uniform float u_last_y0_transform;\n  uniform vec2 u_last_y0_domain;\n  uniform vec2 u_last_y0_range;\n  uniform float u_last_y0_map_position;\n  float a_last_y0;\n  bool a_last_y0_is_constant;\n      \n\nattribute float buffer_0;\nattribute float buffer_1;\nattribute float buffer_2;\nattribute float buffer_3;\nattribute float buffer_4;\nattribute float buffer_5;\nattribute float buffer_6;\nattribute float buffer_7;\nattribute float buffer_8;\nattribute float buffer_9;\nattribute float buffer_10;\nattribute float buffer_11;\nattribute float buffer_12;\nattribute float buffer_13;\nattribute float buffer_14;\nattribute float buffer_15;\n\n// END AUTOGENERATED\n  \n\nhighp float ix_to_random(in float ix, in float seed) {\n  // For high numbers, taking the log avoids coincidence.\n  highp float seed2 = log(ix + 1.) + 1.;\n  vec2 co = vec2(seed2, seed);\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float dt = dot(co.xy, vec2(a, b));\n  highp float sn = mod(dt, 3.14);\n  return fract(sin(sn) * c);\n}\n\n// The fill color.\nvarying vec4 fill;\nvarying float point_size;\n\nuniform float u_jitter_radius_lookup;\nuniform float u_jitter_radius_lookup_y_constant;\nuniform vec2 u_jitter_radius_lookup_x_domain;\nuniform vec2 u_jitter_radius_lookup_y_domain;\n\nfloat point_size_adjust;\n\n// A coordinate to throw away a vertex point.\nvec4 discard_me = vec4(100.0, 100.0, 1.0, 1.0);\n\n// Initialized in the main loop\n// mat3 from_coord_to_gl;\n\nconst float e = 1.618282;\n// I\'ve been convinced.\nconst float tau = 2. * 3.14159265359;\n\nfloat interpolate_raw(in float x, in float min, in float max) {\n  if (x < min) {return 0.;}\n  if (x > max) {return 1.;}\n  return (x - min)/(max - min);\n}\n\nfloat interpolate(in float x, in float min, in float max) {\n  if (max < min) {\n    return 1. - interpolate_raw(x, max, min);\n  } else {\n    return interpolate_raw(x, min, max);\n  }\n}\n\n/*\n\nThe following glsl code was written in python.\n\nbuffers = [*range(16)]\n\ndef write_buffs(buffs):\n    if len(buffs) == 1:\n        return[f"return buffer_{buffs[0]}"]\n    condition_1 = ["  " + line for line in write_buffs(buffs[:len(buffs)//2])]\n    condition_2 = ["" + line for line in write_buffs(buffs[len(buffs)//2:])]\n\n    args = [\n        f"if (i < {buffs[len(buffs) // 2 - 1]}.5) {{",\n        *condition_1,\n        "}",\n        *condition_2\n    ]\n    return args\n\nprint("\\n".join(write_buffs(buffers)))\n*/\n\nfloat get_buffer(in float i) {\n  //given an index, returns the appropriate buffer.\n  if (i < 7.5) {\n    if (i < 3.5) {\n      if (i < 1.5) {\n        if (i < 0.5) {\n          return buffer_0;\n        }\n        return buffer_1;\n      }\n      if (i < 2.5) {\n        return buffer_2;\n      }\n      return buffer_3;\n    }\n    if (i < 5.5) {\n      if (i < 4.5) {\n        return buffer_4;\n      }\n      return buffer_5;\n    }\n    if (i < 6.5) {\n      return buffer_6;\n    }\n    return buffer_7;\n  }\n  if (i < 11.5) {\n    if (i < 9.5) {\n      if (i < 8.5) {\n        return buffer_8;\n      }\n      return buffer_9;\n    }\n    if (i < 10.5) {\n      return buffer_10;\n    }\n    return buffer_11;\n  }\n  if (i < 13.5) {\n    if (i < 12.5) {\n      return buffer_12;\n    }\n    return buffer_13;\n  }\n  if (i < 14.5) {\n    return buffer_14;\n  }\n  return buffer_15;\n}\n\nfloat linstep(in vec2 range, in float x) {\n  return interpolate(x, range.x, range.y);\n  float scale_size = range.y - range.x;\n  float from_left = x - range.x;\n  return clamp(from_left / scale_size, 0.0, 1.0);\n}\n\nfloat linscale(in vec2 range, in float x) {\n  float scale_size = range.y - range.x;\n  float from_left = x - range.x;\n  return from_left / scale_size;\n}\n\nvec2 box_muller(in float ix, in float seed) {\n  // Box-Muller transform gives you two gaussian randoms for two uniforms.\n  highp float U = ix_to_random(ix, seed);\n  highp float V = ix_to_random(ix, seed + 17.123123);\n  return vec2(sqrt(-2. * log(U)) * cos(tau * V),\n              sqrt(-2. * log(U)) * sin(tau * V));\n}\n\n/*************** END COLOR SCALES *******************************/\n\nfloat domainify(in vec2 domain, in float transform, in float attr, in bool clamped) {\n\n  // Clamp an attribute into a domain, with an option log or sqrt transform.\n  if (transform == 2.) {\n    domain = sqrt(domain);\n    attr = sqrt(attr);\n  }\n  if (transform == 3.) {\n    domain = log(domain);\n    attr = log(attr);\n  }\n  if (clamped) {\n    return linstep(domain, attr);\n  } else {\n    return linscale(domain, attr);\n  }\n}\n\nmat3 pixelspace_to_glspace;\n\nfloat run_numeric_filter (in float a_filter,\n  in float u_filter_op, in float u_filter_param_1,\n  in float u_filter_param_2) {\n  bool truthy;\n  if (u_filter_op < 1.5) {\n    truthy = a_filter < u_filter_param_1;\n  } else if (u_filter_op < 2.5) {\n    truthy = a_filter > u_filter_param_1;\n  } else if (u_filter_op < 3.5) {\n    truthy = a_filter == u_filter_param_1;\n  } else if (u_filter_op < 4.5) {\n    truthy = abs(a_filter - u_filter_param_2) < u_filter_param_1;\n  }\n  if (truthy) {return 1.;} else {return 0.;}\n}\n\nfloat choose_and_run_filter(\n  in vec3 u_filter_numeric,\n  in float a_filter,\n  in float map_location,\n  in bool filter_is_constant\n  ) {\n    if (filter_is_constant) {\n      return 1.;\n    }\n    if (u_filter_numeric.r < 0.5) {\n      // Must be on a dictionary. Unreasonable assumption, maybe?\n      float frac_filter = linstep(vec2(-2047., 2047), a_filter);\n      float map_coords = (map_location - .5) / 32.;\n      return texture2D(u_one_d_aesthetic_map, vec2(map_coords, frac_filter)).a;\n    } else {\n      return run_numeric_filter(a_filter,\n        u_filter_numeric.r, u_filter_numeric.g, u_filter_numeric.b);\n    }\n}\n\nconst float tau_0 = 2. * 3.14159265359;\n\nhighp float ix_to_random_1540259130(in float ix, in float seed) {\n  // For high numbers, taking the log avoids coincidence.\n  highp float seed2 = log(ix) + 1.;\n  vec2 co = vec2(seed2, seed);\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float dt= dot(co.xy ,vec2(a,b));\n  highp float sn= mod(dt,3.14);\n  return fract(sin(sn) * c);\n}\n\nhighp vec2 box_muller_1540259130(in float ix, in float seed) {\n  // Box-Muller transform gives you two gaussian randoms for two uniforms.\n  highp float U = ix_to_random_1540259130(ix, seed);\n  highp float V = ix_to_random_1540259130(ix, seed + 17.123123);\n  return vec2(\n    sqrt(-2.*log(U))*cos(tau_0*V),\n    sqrt(-2.*log(U))*sin(tau_0*V)\n  );\n}\n\nvec2 logarithmic_spiral_jitter_1540259130(\n  in float ix, // a random seed.\n  in float a, // offset\n  in float angle_parameter_1540259130, // angle parameter\n  in float randomize_angle_1540259130, // sd radians\n  in float max_r_1540259130, // Maximum radius of spiral.\n  in float randomize_rotation_max_radians_1540259130, // in standard deviations to the log-multiplier.\n  in float randomize_radius_1540259130, // in standard deviation percentage points.\n  in float hole, // donut hole size.\n  in float speed_0, // webgl units per second.\n  in float time_0,// The time, in seconds, to plot at. Generally passed as a uniform or something.\n  in float acceleration,\n  in float n_spirals_1540259130,\n  in float shear,\n  in float aspect_ratio_1540259130\n  ) {\n  // Each point starts at a different place on the spiral.\n  vec2 two_gaussians_1540259130 = box_muller_1540259130(ix, 55.1);\n\n  highp float calculated_angle = angle_parameter_1540259130 + two_gaussians_1540259130.x * randomize_angle_1540259130;\n  float k = 1. / tan(calculated_angle);\n  if (k > 100000.) {\n    k = 0.;\n  }\n\n  // The length of the segment to be traversed.\n  float arc_length =  sqrt((1. + k*k)/k) * (max_r_1540259130 - a);\n  float period = arc_length / speed_0;\n\n  // Every point needs to start at a different place along the curve.\n  float stagger_time = ix_to_random_1540259130(ix, 3.);\n\n  // How long does a circuit take? Add some random noise.\n  float time_period = period * exp(box_muller_1540259130(ix, 0.031).x / 6.);\n\n  // Adjust u_time from the clock to our current spot.\n  float varying_time = time_0 + stagger_time * time_period;\n\n  // Adjust that time by raising to a power to set the speed along the curve.\n  // Not sure if this is the soundest way to parametrize.\n  float relative_time = pow(1. - mod(varying_time, time_period)/time_period, acceleration);\n\n  // Calculate the radius at this time point.\n  float radius = max_r_1540259130 * relative_time + a;\n\n  // The angle implied by that radius.\n  float theta  = 1./k * log(radius / a);\n\n  /* A different way to calculate radius from the theta. Not used\n  float max_theta = 1. / k * log(max_r / a);\n  float theta2 = max_theta * relative_time;\n  vec2 pos_theta_style = vec2(a * exp(k * theta2), theta2);\n  radius = pos_theta_style.x;\n  theta = pos_theta_style.y;\n  */\n\n  // If multiple spirals, the theta needs to be rotated for which spiral we\'re in.\n  // Choose it based on a new random seed.\n  float which_spiral = floor(ix_to_random_1540259130(ix, 13.13) * n_spirals_1540259130);\n  float which_spiral_adjust = which_spiral / n_spirals_1540259130 * tau_0;\n  theta = theta + which_spiral_adjust;\n\n  // Add some gaussian jitter to the polar coordinates.\n  vec2 polar_jitter = box_muller_1540259130(ix, 24.);\n\n  highp float radius_adjust = 1. + polar_jitter.x * randomize_radius_1540259130;\n  highp float theta_adjust = polar_jitter.y * randomize_rotation_max_radians_1540259130;\n\n  vec2 shear_adjust = box_muller_1540259130(ix, 59.1) * shear;\n\n  mat3 shear_mat = mat3(\n    1., shear_adjust.x, 0.,\n    shear_adjust.y, 1., 0.,\n    0., 0., 1.);\n  // into euclidean space.\n  vec3 pos_spiral = vec3(\n   cos(theta + theta_adjust)*(radius * radius_adjust + hole),\n   sin(theta + theta_adjust)*(radius * radius_adjust + hole),\n   0.\n  );\n  mat3 adjust_to_viewport =\n         mat3(\n            1./aspect_ratio_1540259130, 0., 0.,\n            0., 1., 0.,\n            0., 0., 1.);\n\n  pos_spiral = pos_spiral * shear_mat * \n               adjust_to_viewport;\n  return pos_spiral.xy;\n}\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1604150559(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\n#ifndef PI\n#define PI 3.141592653589793\n#endif\n\nfloat sineInOut_0(float t) {\n  return -0.5 * (cos(PI * t) - 1.0);\n}\n\n#ifndef PI\n#define PI 3.141592653589793\n#endif\n\nvec2 bezier_interpolate(vec2 p1, vec2 p2, float frac, float ix) {\n  // Interpolates between two points on a Bezier curve around a jittered middle.\n    vec2 midpoint = box_muller(ix, 3.) * .05 *\n         dot(p2 - p1, p2 - p1)\n         + p2 / 2. + p1 / 2.;\n\n      return mix(\n        mix(p2, midpoint, frac),\n        mix(midpoint, p1, frac),\n      frac);\n}\n\nfloat sineInOut(float t) {\n  return -0.5 * (cos(PI * t) - 1.0);\n}\n\nconst vec4 decoder = vec4(1./256./256./256., 1. / 256. / 256., 1. / 256., 1.);\n\nfloat RGBAtoFloat(in vec4 floater) {\n  //return 0.05;\n  // Scale values up by 256.\n  return dot(floater, decoder);\n}\n\nfloat texture_float_lookup(in vec2 domain,\n                           in vec2 range,\n                           in float transform,\n                           in float attr,\n                           in float texture_position) {\n  if (transform == 4.0) {\n    // Literal transforms aren\'t looked up, just returned as is.\n    return attr;\n  }\n  float inrange = domainify(domain, transform, attr, true);\n  if (texture_position > 0.5) {\n    float y_pos = texture_position / 32. - 0.5 / 32.;\n    vec4 encoded = texture2D(u_one_d_aesthetic_map, vec2(y_pos, inrange));\n    return encoded.a;\n    return RGBAtoFloat(encoded); // unreachable.\n  } else {\n    return mix(range.x, range.y, inrange);\n  }\n}\n\nvec2 calculate_position(in vec2 position, in float x_scale_type,\n                        in vec2 x_domain, in vec2 x_range, in float y_scale_type,\n                        in vec2 y_domain, in vec2 y_range, in mat3 window_scale,\n                        in mat3 zoom, in float x_map_position,\n                        in float y_map_position\n                        ) {\n    float x;\n    float y;\n\n    if (x_scale_type < 4.0) {\n      x = texture_float_lookup(x_domain, x_range,\n        x_scale_type,\n        position.x, x_map_position\n        );\n    } else {\n      x = position.x;\n    }\n\n    if (y_scale_type < 4.0) {\n      y = texture_float_lookup(y_domain, y_range, y_scale_type,\n        position.y, y_map_position\n        );\n    } else {\n      y = position.y;\n    }\n\n    vec3 pos2d = vec3(x, y, 1.0) * window_scale * zoom * pixelspace_to_glspace;\n    return pos2d.xy;\n}\n\nfloat cubicInOut(float t) {\n  return t < 0.5\n    ? 4.0 * t * t * t\n    : 1. - 4.0 * pow(1. - t, 3.0);\n}\n\nvec4 ixToRGBA(in float ix)  {\n  float min = fract(ix / 256.);\n  float mid = fract((ix - min) / 256.);\n  float high = fract((ix - min - mid * 256.) / (256.) / 256.);\n  return vec4(min, mid, high, 1.);\n}\n\nvec2 circle_jitter(in float ix, in float aspect_ratio, in float time,\n                   in float radius, in float speed) {\n  vec2 two_gaussians = box_muller(ix, 12.);\n\n  float stagger_time = two_gaussians.y * tau;\n\n  // How long does a circuit take?\n\n  float units_per_period = radius * radius * tau / 2.;\n  float units_per_second = speed / 100.;\n  float seconds_per_period = units_per_period / units_per_second;\n  float time_period = seconds_per_period;\n  if (time_period > 1e4) {\n    return vec2(0., 0.);\n  }\n\n  // Adjust time from the clock to our current spot.\n  float varying_time = time + stagger_time * time_period;\n  // Where are we from 0 to 1 relative to the time period\n\n  float relative_time = 1. - mod(varying_time, time_period) / time_period;\n\n  float theta = relative_time * tau;\n\n  float r_mult = (sqrt(ix_to_random(ix, 7.)));\n  return vec2(cos(theta) * r_mult, aspect_ratio * sin(theta) * r_mult) *\n         radius;\n}\n\nvec2 calculate_jitter(\n  in float jitter_type,\n  in float ix, // distinguishing index\n  in vec2 jitter_radius_domain,\n  in vec2 jitter_radius_range,\n  in float jitter_radius_transform,\n  in float jitter_radius,\n  in float jitter_radius_map_position,\n  in bool jitter_radius_is_constant,\n  in vec2 jitter_speed_domain,\n  in vec2 jitter_speed_range,\n  in float jitter_speed_transform,\n  in float jitter_speed,\n  in float jitter_speed_map_position,\n  in bool jitter_speed_is_constant\n) {\n\n  // Jitter is calculated based on speed, so requires two full maps in.\n  if (jitter_type == 0.) {\n    // No jitter\n    return vec2(0., 0.);\n  }\n\n  if (jitter_type == 5.) {\n    // Temporal jitter--should be broken out into a separate channel/channels.\n    float time_period = 60.;\n    float share = 1./4.;\n    float offset = ix_to_random(ix, 12.);\n    float fractional = fract((offset * time_period + u_time)/time_period);\n    if (fractional > share) {\n      return vec2(0., 0.);\n    }\n    float size = 0.5 * (1. - cos(2. * 3.1415926 * min(fractional/share, 1. - fractional/share)));\n    size = clamp(size, 0., 1.);\n    return vec2(size, 0.);\n  }\n  float jitter_r;  \n  if (jitter_radius_is_constant) {\n    jitter_r = jitter_radius;\n  } else {\n    jitter_r = texture_float_lookup(\n    jitter_radius_domain,\n    jitter_radius_range,\n    jitter_radius_transform,\n    jitter_radius,\n    0.);\n  }\n  if (jitter_type == 3.) {\n    float r = box_muller(ix, 1.).r * jitter_r;\n    r = r / u_k;    \n    float theta = ix_to_random(ix, 15.) * tau;\n    return vec2(cos(theta) * r, sin(theta) * r * u_width / u_height);\n  }\n\n  if (jitter_type == 2.) {\n    // uniform in the circle.\n    float theta = ix_to_random(ix, 15.) * tau;\n    float r = jitter_r * sqrt(ix_to_random(ix, 115.));\n    r = r / u_k;\n    return vec2(cos(theta) * r, sin(theta) * r * u_width / u_height);\n  }\n\n  /* Jittering that includes motion) */\n\n  float p_jitter_speed =\n      texture_float_lookup(jitter_speed_domain,\n                          jitter_speed_range,\n                          jitter_speed_transform, jitter_speed,\n                          jitter_speed_map_position);\n\n  if (jitter_type == 1.) {\n    return logarithmic_spiral_jitter_1540259130(\n                ix,\n                0.005 * jitter_r,                     // a\n                1.3302036,                       // angle parameter\n                0.005,                                 // angle random\n                jitter_r,                             // max radius\n                0.03,                                 // random_rotation\n                0.06,                                 // random radius\n                0.003 * point_size_adjust * jitter_r, // donut.\n                .5 * p_jitter_speed * jitter_r / point_size_adjust, // speed\n                u_time,                                           // time\n                0.8,                                              // acceleration\n                2.0,                                              // n_spirals\n                .09, //shear\n                u_width/u_height         // shear\n            );\n  }\n\n  if (jitter_type == 4.) {\n    // circle\n    return circle_jitter(ix, u_width/u_height, u_time, jitter_r, p_jitter_speed);\n  }\n}\n\nvoid run_color_fill(in float ease) {\n  if (u_only_color >= -1.5) {\n    if (u_only_color > -.5 && a_color != u_only_color) {\n      gl_Position = discard_me;\n      return;\n    } else {\n      // -1 is a special value meaning \'plot everything\'.\n      fill = vec4(0., 0., 0., 1. / 255.);\n      gl_PointSize = 1.;\n    }\n  } else {\n    if (a_color_is_constant) {\n      fill = vec4(u_color_constant.rgb, u_current_alpha);\n    } else {\n      float fractional_color = linstep(u_color_domain, a_color);\n      float color_pos = (u_color_map_position * -1. - 1.) / 32. + 0.5 / 32.;\n      fill = texture2D(u_color_aesthetic_map , vec2(color_pos, fractional_color));\n      fill = vec4(fill.rgb, u_current_alpha);\n    }\n    if (ease < 1.) {\n      vec4 last_fill;\n      if (a_last_color_is_constant) {\n        last_fill = vec4(u_last_color_constant.rgb, u_last_alpha);\n      } else {\n        float last_fractional = linstep(u_last_color_domain, a_last_color);\n        float color_pos = (u_last_color_map_position * -1. - 1.) / 32. + 0.5 / 32.;\n        last_fill = texture2D(u_color_aesthetic_map, vec2(color_pos, last_fractional));\n        // Alpha channel interpolation already happened.\n        last_fill = vec4(last_fill.rgb, u_last_alpha);\n      }\n      // RGB blending is bad--maybe use https://www.shadertoy.com/view/lsdGzN\n      // instead?\n      fill = mix(last_fill, fill, ease);\n    }\n  }\n}\n\nvec2 calc_and_interpolate_positions(\n  inout vec2 old_position,\n  in float u_last_x_transform,\n  in vec2 u_last_x_domain,\n  in vec2 u_last_x_range,\n  in float u_last_y_transform,\n  in vec2 u_last_y_domain,\n  in vec2 u_last_y_range,\n  in mat3 u_last_window_scale,\n  in mat3 u_zoom,\n  in float u_last_x_map_position,\n  in float u_last_y_map_position,\n  inout vec2 position,\n  in float u_x_transform,\n  in vec2 u_x_domain,\n  in vec2 u_x_range,\n  in float u_y_transform,\n  in vec2 u_y_domain,\n  in vec2 u_y_range,\n  in mat3 u_window_scale,\n  in float u_x_map_position,\n  in float u_y_map_position,\n  in float interpolation,\n  in float u_grid_mode, \n  in float ix) {\n  old_position = calculate_position(old_position, u_last_x_transform,\n    u_last_x_domain, u_last_x_range,\n    u_last_y_transform, u_last_y_domain, u_last_y_range,\n    u_last_window_scale,\n    u_zoom, u_last_x_map_position,      \n    u_last_y_map_position);\n    \n  bool plot_actual_position = u_grid_mode < .5;\n\n  if (plot_actual_position) {\n    position = calculate_position(position, \n      u_x_transform,\n      u_x_domain, u_x_range,\n      u_y_transform, u_y_domain, \n      u_y_range, u_window_scale, u_zoom, \n      u_x_map_position, u_y_map_position);\n\n    float xpos = clamp((1. + position.x) / 2., 0., 1.);\n    float randy = ix_to_random(ix, 13.76);\n    float delay = xpos + randy * .1;\n    delay = delay * 3.;\n\n    float frac = interpolate(\n      u_update_time,\n      delay,\n      u_transition_duration + delay\n    );\n\n    frac = sineInOut_0(frac);\n\n    if (frac <= 0.) {\n      position = old_position;\n    } else if (frac < 1.) {\n      frac = fract(frac);\n      position = bezier_interpolate(position, old_position, frac, ix);\n    }\n  } else {\n    position.x = -1. + 2. * linscale(u_x_domain, position.x);\n    //position.y = -1.0;\n    vec2 jitterspec = vec2(\n      (ix_to_random(ix, 3.) * a_jitter_radius ) * 2.,\n      (ix_to_random(ix, 1.5) * a_jitter_speed ) * 2.\n    );\n    position = position + jitterspec;\n  }\n  return position;\n}\n\nvoid main() {\n  float debug_mode = 0.;\n  float ix = buffer_0;\n  if (ix > u_maxix) {\n    // throw away points that are too low.\n    gl_Position = discard_me;\n    return;\n  }\n\n  if (debug_mode > 1.5) {\n    // Debug mode.\n    gl_PointSize = 2.;\n    gl_Position = vec4(box_muller(ix, 2.).xy * .33, 0., 1.);\n    return;\n  }\n\n // Autogenerated below this point\n if (u_x_buffer_num > -0.5) {\n      a_x = get_buffer(u_x_buffer_num);\n      a_x_is_constant = false;\n    } else {\n      a_x = u_x_constant;\n      a_x_is_constant = true;\n    }\n\n    if (u_last_x_buffer_num > -0.5) {\n      a_last_x = get_buffer(u_last_x_buffer_num);\n      a_last_x_is_constant = false;\n    } else {\n      a_last_x = u_last_x_constant;\n      a_last_x_is_constant = true;\n    }\n\n    if (u_y_buffer_num > -0.5) {\n      a_y = get_buffer(u_y_buffer_num);\n      a_y_is_constant = false;\n    } else {\n      a_y = u_y_constant;\n      a_y_is_constant = true;\n    }\n\n    if (u_last_y_buffer_num > -0.5) {\n      a_last_y = get_buffer(u_last_y_buffer_num);\n      a_last_y_is_constant = false;\n    } else {\n      a_last_y = u_last_y_constant;\n      a_last_y_is_constant = true;\n    }\n\n    if (u_jitter_radius_buffer_num > -0.5) {\n      a_jitter_radius = get_buffer(u_jitter_radius_buffer_num);\n      a_jitter_radius_is_constant = false;\n    } else {\n      a_jitter_radius = u_jitter_radius_constant;\n      a_jitter_radius_is_constant = true;\n    }\n\n    if (u_last_jitter_radius_buffer_num > -0.5) {\n      a_last_jitter_radius = get_buffer(u_last_jitter_radius_buffer_num);\n      a_last_jitter_radius_is_constant = false;\n    } else {\n      a_last_jitter_radius = u_last_jitter_radius_constant;\n      a_last_jitter_radius_is_constant = true;\n    }\n\n    if (u_jitter_speed_buffer_num > -0.5) {\n      a_jitter_speed = get_buffer(u_jitter_speed_buffer_num);\n      a_jitter_speed_is_constant = false;\n    } else {\n      a_jitter_speed = u_jitter_speed_constant;\n      a_jitter_speed_is_constant = true;\n    }\n\n    if (u_last_jitter_speed_buffer_num > -0.5) {\n      a_last_jitter_speed = get_buffer(u_last_jitter_speed_buffer_num);\n      a_last_jitter_speed_is_constant = false;\n    } else {\n      a_last_jitter_speed = u_last_jitter_speed_constant;\n      a_last_jitter_speed_is_constant = true;\n    }\n\n    if (u_size_buffer_num > -0.5) {\n      a_size = get_buffer(u_size_buffer_num);\n      a_size_is_constant = false;\n    } else {\n      a_size = u_size_constant;\n      a_size_is_constant = true;\n    }\n\n    if (u_last_size_buffer_num > -0.5) {\n      a_last_size = get_buffer(u_last_size_buffer_num);\n      a_last_size_is_constant = false;\n    } else {\n      a_last_size = u_last_size_constant;\n      a_last_size_is_constant = true;\n    }\n\n    if (u_filter_buffer_num > -0.5) {\n      a_filter1 = get_buffer(u_filter_buffer_num);\n      a_filter_is_constant = false;\n    } else {\n      a_filter1 = 1.;\n      a_filter_is_constant = true;\n    }\n\n    if (u_last_filter_buffer_num > -0.5) {\n      a_last_filter1 = get_buffer(u_last_filter_buffer_num);\n      a_last_filter_is_constant = false;\n    } else {\n      a_last_filter1 = 1.;\n      a_last_filter_is_constant = true;\n    }\n\n    if (u_filter2_buffer_num > -0.5) {\n      a_filter2 = get_buffer(u_filter2_buffer_num);\n      a_filter2_is_constant = false;\n    } else {\n      a_filter2 = 1.;\n      a_filter2_is_constant = true;\n    }\n\n    if (u_last_filter2_buffer_num > -0.5) {\n      a_last_filter2 = get_buffer(u_last_filter2_buffer_num);\n      a_last_filter2_is_constant = false;\n    } else {\n      a_last_filter2 = 1.;\n      a_last_filter2_is_constant = true;\n    }\n\n    if (u_x0_buffer_num > -0.5) {\n      a_x0 = get_buffer(u_x0_buffer_num);\n      a_x0_is_constant = false;\n    } else {\n      a_x0 = u_x0_constant;\n      a_x0_is_constant = true;\n    }\n\n    if (u_last_x0_buffer_num > -0.5) {\n      a_last_x0 = get_buffer(u_last_x0_buffer_num);\n      a_last_x0_is_constant = false;\n    } else {\n      a_last_x0 = u_last_x0_constant;\n      a_last_x0_is_constant = true;\n    }\n\n    if (u_y0_buffer_num > -0.5) {\n      a_y0 = get_buffer(u_y0_buffer_num);\n      a_y0_is_constant = false;\n    } else {\n      a_y0 = u_y0_constant;\n      a_y0_is_constant = true;\n    }\n\n    if (u_last_y0_buffer_num > -0.5) {\n      a_last_y0 = get_buffer(u_last_y0_buffer_num);\n      a_last_y0_is_constant = false;\n    } else {\n      a_last_y0 = u_last_y0_constant;\n      a_last_y0_is_constant = true;\n    }\n//  END AUTOGENERATED. DO NOT EDIT ABOVE. \n// ------------------------------------------------    \n  gl_PointSize = 1.;\n\n  if (u_color_buffer_num > -0.5) {\n    a_color = get_buffer(u_color_buffer_num);\n    a_color_is_constant = false;\n  } else {\n    a_color = ix;\n    a_color_is_constant = true;\n  }\n\n  if (u_last_color_buffer_num > -0.5) {\n    a_last_color = get_buffer(u_last_color_buffer_num);\n    a_last_color_is_constant = false;\n  } else {\n    a_last_color = ix;\n    a_last_color_is_constant = true;\n  }\n\n  pixelspace_to_glspace = mat3(\n      2. / u_width, 0., -1.,\n      0., - 2. / u_height, 1.,\n      0., 0., 1.\n  );\n\n  float interpolation =\n    interpolate(u_update_time, 0., u_transition_duration);\n    \n  float ease = interpolation;\n\n  // I set this sometimes.\n\n  vec2 position = vec2(a_x, a_y);\n  vec2 old_position = vec2(a_last_x, a_last_y);\n\n  position = calc_and_interpolate_positions(\n    old_position,\n    u_last_x_transform,\n    u_last_x_domain, u_last_x_range,\n    u_last_y_transform,\n    u_last_y_domain, u_last_y_range,\n    u_last_window_scale,\n    u_zoom,\n    u_last_x_map_position,\n    u_last_y_map_position,\n    position,\n    u_x_transform,\n    u_x_domain, u_x_range,\n    u_y_transform,\n    u_y_domain, u_y_range,\n    u_window_scale,\n    u_x_map_position,\n    u_y_map_position,\n    interpolation,\n    u_grid_mode,\n    ix\n  );\n\n  if (u_x0_buffer_num > 0.) {\n    vec2 position0 = vec2(a_x0, a_y0);\n    vec2 old_position0 = vec2(a_last_x0, a_last_y0);\n\n    position0 = calc_and_interpolate_positions(\n      old_position0,\n      u_last_x0_transform,\n      u_last_x0_domain, u_last_x0_range,\n      u_last_y0_transform,\n      u_last_y0_domain, u_last_y0_range,\n      u_last_window_scale,\n      u_zoom,\n      u_last_x0_map_position,\n      u_last_y0_map_position,\n      position0,\n      u_x0_transform,\n      u_x0_domain, u_x0_range,\n      u_y0_transform,\n      u_y0_domain, u_y0_range,\n      u_window_scale,\n      u_x0_map_position,\n      u_y0_map_position,\n      interpolation,\n      u_grid_mode,\n      ix\n    );\n\n    if (u_position_interpolation_mode > 0.) {\n      float rand2 = ix_to_random(ix, 11.76);\n\n      // If it\'s a continuous loop, just choose a random point along that loop.\n      float rand_offset = fract(u_update_time/u_transition_duration / 10. + rand2);\n      position = mix(position0, position, rand_offset);\n    }\n  }\n\n  bool plot_actual_position = u_grid_mode < .5;\n\n  if (u_position_interpolation_mode > 0.) {\n    float rand2 = ix_to_random(ix, 11.76);\n\n    // If it\'s a continuous loop, just choose a random point along that loop.\n    float rand_offset = fract(u_update_time/u_transition_duration + rand2);\n    \n  }\n\n/*  position = vec2(\n    ix_to_random(ix, .1),\n    ix_to_random(ix, .2)\n  );*/\n  /* FILTERING */\n\n  float filter1_status = choose_and_run_filter(\n    u_filter_numeric,\n    a_filter1,\n    u_filter_map_position,\n    a_filter_is_constant\n  );\n\n  float last_filter1_status = choose_and_run_filter(\n    u_last_filter_numeric,\n    a_last_filter1,\n    u_last_filter_map_position,\n    a_last_filter_is_constant\n  );\n\n  float filter2_status = choose_and_run_filter(\n    u_filter2_numeric,\n    a_filter2,\n    u_filter2_map_position,\n    a_filter2_is_constant\n  );\n\n  float last_filter2_status = choose_and_run_filter(\n    u_last_filter2_numeric,\n    a_last_filter2,\n    u_last_filter2_map_position,\n    a_last_filter2_is_constant\n  );\n\n  bool was_filtered = last_filter2_status < .5 || last_filter1_status < .5;\n  bool will_be_filtered = filter2_status < .5 || filter1_status < .5;\n\n  bool filter_status = will_be_filtered;\n\n  if (ease < ix_to_random(ix, 1.)) {\n    filter_status = was_filtered;\n  }\n\n  if (filter_status == true) {\n    gl_Position = discard_me;\n    return;\n  }\n\n  float size_multiplier = texture_float_lookup(\n    u_size_domain,\n    u_size_range,\n    u_size_transform, a_size,\n    u_size_map_position);\n\n  float last_size_multiplier = texture_float_lookup(\n    u_last_size_domain, u_last_size_range, u_last_size_transform, a_last_size,\n    u_last_size_map_position);\n\n  size_multiplier = u_base_size * \n     mix(last_size_multiplier, size_multiplier, ease);\n  \n  float depth_size_adjust = (1.0 - ix / (u_maxix));\n\n  // It\'s ugly on new macs when it jumps straight from one to two for a bunch of points at once.\n  float size_fuzz = exp(ix_to_random(ix, 3.1) * .5 - .25);\n\n  point_size_adjust = exp(log(u_k) * u_zoom_balance) * size_fuzz;// * depth_size_adjust;\n//  point_size_adjust = exp(log(u_k) * u_zoom_balance);\n  gl_PointSize = point_size_adjust * size_multiplier;\n  if (gl_PointSize <= 0.01) {\n    gl_Position = discard_me;\n    return;\n  }\n  vec2 jitter = vec2(0., 0.);\n//  \n\n  if (plot_actual_position && (u_jitter > 0. || u_last_jitter > 0.)) {\n    /* JITTER */\n    jitter = vec2(ix_to_random(ix, 2. + u_time), ix_to_random(ix, 3. + u_time)) * .01;\n    float jitter_radius_fraction;\n      jitter = calculate_jitter(\n        u_jitter, ix,\n        u_jitter_radius_domain,        u_jitter_radius_range,\n        u_jitter_radius_transform,        a_jitter_radius,\n        u_jitter_radius_map_position,        a_jitter_radius_is_constant,\n        u_jitter_speed_domain,\n        u_jitter_speed_range,\n        u_jitter_speed_transform, a_jitter_speed,\n        u_jitter_speed_map_position, a_jitter_speed_is_constant\n      );\n    vec2 last_jitter;\n    if (ease < 1.) {\n      last_jitter = calculate_jitter(\n        u_last_jitter, ix,\n        u_last_jitter_radius_domain,       \n        u_last_jitter_radius_range,\n        u_last_jitter_radius_transform,        \n        a_last_jitter_radius,\n        u_last_jitter_radius_map_position,\n        a_last_jitter_radius_is_constant,\n        u_last_jitter_speed_domain,\n        u_last_jitter_speed_range,\n        u_last_jitter_speed_transform,\n        a_last_jitter_speed,\n        u_last_jitter_speed_map_position,\n        a_last_jitter_speed_is_constant\n      );\n      jitter = mix(last_jitter, jitter, ease);\n    }\n    if (u_jitter == 5.) {\n      gl_PointSize *= jitter.x;\n      jitter = vec2(0., 0.);\n      if (gl_PointSize < 0.05) {\n        gl_Position = discard_me;\n        return;\n      }\n    }\n    gl_Position = vec4(position + jitter, 0., 1.);\n  } else {\n    gl_Position = vec4(position + jitter, 0., 1.);\n  }  \n  if (u_color_picker_mode > 0.) {\n    // Add one so the first element is distinguishable.\n    fill = encode_float_1604150559(ix + 1.);\n  } else {\n    run_color_fill(ease);\n  }\n//  gl_PointSize = 2.1;\n  point_size = gl_PointSize;\n/*  if (u_use_glyphset > 0. && point_size > 5.0) {\n    float random_letter = floor(64. * ix_to_random(ix, 1.3));\n    letter_pos = vec2(\n      // start at a number between 0 and 7.\n      mod(random_letter, 8.) / 8.,\n      floor(random_letter / 8.) / 8.\n    );\n    gl_PointSize *= 3.0;\n  }*/\n}\n',count:(t,e)=>e.manager.count,attributes:{buffer_0:(t,e)=>e.manager.regl_elements.get("ix")},uniforms:{u_update_time:t.prop("update_time"),u_transition_duration:(t,e)=>e.prefs.duration,u_only_color:(t,e)=>void 0!==e.only_color?e.only_color:-2,u_use_glyphset:(t,{prefs:e})=>e.glyph_set?1:0,u_glyphset:(t,{prefs:e})=>e.glyph_set?this.get_image_texture(e.glyph_set):this.textures.empty_texture,u_color_picker_mode:t.prop("color_picker_mode"),u_position_interpolation_mode(){return this.aes.position_interpolation?1:0},u_grid_mode:(t,{grid_mode:e})=>e,u_colors_as_grid:t.prop("colors_as_grid"),u_width:({viewportWidth:t})=>t,u_height:({viewportHeight:t})=>t,u_one_d_aesthetic_map:this.aes.aesthetic_map.one_d_texture,u_color_aesthetic_map:this.aes.aesthetic_map.color_texture,u_aspect_ratio:({viewportWidth:t,viewportHeight:e})=>t/e,u_zoom_balance:t.prop("zoom_balance"),u_base_size:(t,{prefs:e})=>e.point_size,u_maxix:(t,e)=>e.max_ix,u_k:(t,e)=>e.transform.k,u_window_scale:t.prop("webgl_scale"),u_last_window_scale:t.prop("last_webgl_scale"),u_time:({time:t})=>t,u_filter_numeric(){return this.aes.dim("filter").current.ops_to_array()},u_last_filter_numeric(){return this.aes.dim("filter").last.ops_to_array()},u_filter2_numeric(){return this.aes.dim("filter").current.ops_to_array()},u_last_filter2_numeric(){return this.aes.dim("filter").last.ops_to_array()},u_current_alpha:()=>this.optimal_alpha,u_last_alpha:()=>this.optimal_alpha,u_jitter:()=>this.aes.dim("jitter_radius").current.jitter_int_format,u_last_jitter:()=>this.aes.dim("jitter_radius").last.jitter_int_format,u_zoom:(t,e)=>e.zoom_matrix}};for(const n of Nt(0,16))e.attributes[`buffer_${n}`]=(t,{manager:e,buffer_num_to_variable:i})=>e.regl_elements.get(i[n])||{constant:0};for(const n of["x","y","color","jitter_radius","x0","y0","jitter_speed","size","filter","filter2","character"])for(const t of["current","last"]){const i="current"===t?"":"last_";e.uniforms[`u_${i}${n}_map`]=()=>this.aes.dim(n)[t].textures.one_d,e.uniforms[`u_${i}${n}_map_position`]=()=>this.aes.dim(n)[t].map_position,e.uniforms[`u_${i}${n}_buffer_num`]=(e,{aes_to_buffer_num:i})=>{const l=i[`${n}--${t}`];return void 0===l?-1:l},"filter"!==n&&"filter2"!==n&&(e.uniforms[`u_${i}${n}_domain`]=()=>this.aes.dim(n)[t].domain,e.uniforms[`u_${i}${n}_range`]=()=>this.aes.dim(n)[t].range,e.uniforms[`u_${i}${n}_transform`]=()=>{const e=this.aes.dim(n)[t].transform;if("linear"===e)return 1;if("sqrt"===e)return 2;if("log"===e)return 3;if("literal"===e)return 4;throw"Invalid transform"},e.uniforms[`u_${i}${n}_constant`]=()=>this.aes.dim(n)[t].constant)}return this._renderer=t(e),this._renderer}allocate_aesthetic_buffers(){const t=[],e=["x","y","color","x0","y0","size","jitter_radius","jitter_speed","filter","filter2"];for(const r of e)for(const e of["current","last"])try{this.aes.dim(r)[e].field&&t.push({aesthetic:r,time:e,field:this.aes.dim(r)[e].field})}catch(a){throw this.reglframe.cancel(),this.reglframe=void 0,a}t.sort(((t,n)=>t.time<n.time?-1:n.time<t.time?1:e.indexOf(t.aesthetic)-e.indexOf(n.aesthetic)));const n={},i={ix:0};let l=0;for(const{aesthetic:r,time:o,field:s}of t){const t=`${r}--${o}`;void 0===i[s]?l++<16?(n[t]=l,i[s]=l):n[t]=n[`${r}--current`]:n[t]=i[s]}return{aes_to_buffer_num:n,variable_to_buffer_num:i,buffer_num_to_variable:[...Object.keys(i)]}}get discard_share(){return 0}}class es{constructor(t,e,n){this.tile=e,this.regl=t,this.renderer=n,e._regl_elements=e._regl_elements||new Map,this.regl_elements=e._regl_elements}ready(t,e=!0){const{renderer:n,regl_elements:i}=this,l=new Set;for(let[a,r]of n.aes)for(const t of[r.current,r.last])t.field&&l.add(t.field);for(const a of["ix",...l]){const t=this.regl_elements.get(a);if(null===t)return!1;if(void 0===t){if(!this.tile.ready)return!1;if(i.set(a,null),!e)return n.deferred_functions.push((()=>this.create_regl_buffer(a))),!1;if(void 0===a)continue;this.create_regl_buffer(a)}}return!0}get count(){const{tile:t,regl_elements:e}=this;return e.has("_count")?e.get("_count"):t.ready&&t._table?(e.set("_count",t.table.getChild("ix").length),e.get("_count")):void 0}create_buffer_data(t){const{tile:e}=this;if(!e.ready)throw"Tile table not present.";const n=e.table.getChild(`${t}_float_version`)||e.table.getChild(t);if(!n){throw`Requested ${t} but table has columns ${e.table.schema.fields.map((t=>t.name)).join(", ")}`}if(3!==n.type.typeId){console.log(n.type),console.log(n);const t=new Float32Array(e.table.length);for(let i=0;i<e.table.length;i++)t[i]=n.data[0].values[i];return t}return n.data[0].values.constructor===Float64Array?new Float32Array(n.data[0].values):n.data[0].values}create_regl_buffer(t){const{regl_elements:e}=this,n=this.create_buffer_data(t);if(n.constructor!==Float32Array)throw console.log(typeof n,n),"Buffer data must be a Float32Array";const i=n.length,l=this.renderer.buffers.allocate_block(i,4);e.set(t,l),l.buffer.subdata(n,l.offset)}}class ns{constructor(t,e){this.regl=t,this.buffer_size=e,this.buffers=[],this.buffer_offsets=[],this.generate_new_buffer()}generate_new_buffer(){this.pointer&&this.buffer_offsets.unshift(this.pointer),this.pointer=0,this.buffers.unshift(this.regl.buffer({type:"float",length:this.buffer_size,usage:"dynamic"}))}allocate_block(t,e){this.pointer+t*e>this.buffer_size&&this.generate_new_buffer();const n={buffer:this.buffers[0],offset:this.pointer,stride:e};return this.pointer+=t*e,n}}function is(t,e,n,i){return new(n||(n=Promise))((function(l,a){function r(t){try{s(i.next(t))}catch(e){a(e)}}function o(t){try{s(i.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?l(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}s((i=i.apply(t,e||[])).next())}))}function ls(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function as(t){return this instanceof as?(this.v=t,this):new as(t)}function rs(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,l=n.apply(t,e||[]),a=[];return i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i;function r(t){l[t]&&(i[t]=function(e){return new Promise((function(n,i){a.push([t,e,n,i])>1||o(t,e)}))})}function o(t,e){try{(n=l[t](e)).value instanceof as?Promise.resolve(n.value.v).then(s,d):c(a[0][2],n)}catch(i){c(a[0][3],i)}var n}function s(t){o("next",t)}function d(t){o("throw",t)}function c(t,e){t(e),a.shift(),a.length&&o(a[0][0],a[0][1])}}function os(t){var e,n;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,l){e[i]=t[i]?function(e){return(n=!n)?{value:as(t[i](e)),done:"return"===i}:l?l(e):e}:l}}function ss(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=ls(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,l){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,l,(e=t[n](e)).done,e.value)}))}}}const ds=new TextDecoder("utf-8"),cs=t=>ds.decode(t),us=new TextEncoder,hs=t=>us.encode(t),[ps,ms]=(()=>{const t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},"undefined"!=typeof BigInt?[BigInt,!0]:[e,!1]})(),[bs,fs]=(()=>{const t=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!=typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),[ys,Zs]=(()=>{const t=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!=typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),Xs=t=>"function"==typeof t,Gs=t=>null!=t&&Object(t)===t,Vs=t=>Gs(t)&&Xs(t.then),Ws=t=>Gs(t)&&Xs(t[Symbol.iterator]),Rs=t=>Gs(t)&&Xs(t[Symbol.asyncIterator]),gs=t=>Gs(t)&&Gs(t.schema),vs=t=>Gs(t)&&"done"in t&&"value"in t,xs=t=>Gs(t)&&Xs(t.stat)&&(t=>"number"==typeof t)(t.fd),_s=t=>Gs(t)&&Ss(t.body),Ks=t=>"_getDOMStream"in t&&"_getNodeStream"in t,Ss=t=>Gs(t)&&Xs(t.cancel)&&Xs(t.getReader)&&!Ks(t),Ys=t=>Gs(t)&&Xs(t.read)&&Xs(t.pipe)&&(t=>"boolean"==typeof t)(t.readable)&&!Ks(t),Ls="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function Hs(t,e,n=0,i=e.byteLength){const l=t.byteLength,a=new Uint8Array(t.buffer,t.byteOffset,l),r=new Uint8Array(e.buffer,e.byteOffset,Math.min(i,l));return a.set(r,n),t}function Cs(t,e){const n=function(t){const e=t[0]?[t[0]]:[];let n,i,l,a;for(let r,o,s=0,d=0,c=t.length;++s<c;)r=e[d],o=t[s],!r||!o||r.buffer!==o.buffer||o.byteOffset<r.byteOffset?o&&(e[++d]=o):(({byteOffset:n,byteLength:l}=r),({byteOffset:i,byteLength:a}=o),n+l<i||i+a<n?o&&(e[++d]=o):e[d]=new Uint8Array(r.buffer,n,i-n+a));return e}(t),i=n.reduce(((t,e)=>t+e.byteLength),0);let l,a,r,o=0,s=-1;const d=Math.min(e||Number.POSITIVE_INFINITY,i);for(const c=n.length;++s<c;){if(l=n[s],a=l.subarray(0,Math.min(l.length,d-o)),d<=o+a.length){a.length<l.length?n[s]=l.subarray(a.length):a.length===l.length&&s++,r?Hs(r,a,o):r=a;break}Hs(r||(r=new Uint8Array(d)),a,o),o+=a.length}return[r||new Uint8Array(0),n.slice(s),i-(r?r.byteLength:0)]}function Ns(t,e){let n=vs(e)?e.value:e;return n instanceof t?t===Uint8Array?new t(n.buffer,n.byteOffset,n.byteLength):n:n?("string"==typeof n&&(n=hs(n)),n instanceof ArrayBuffer||n instanceof Ls?new t(n):Gs(i=n)&&Xs(i.clear)&&Xs(i.bytes)&&Xs(i.position)&&Xs(i.setPosition)&&Xs(i.capacity)&&Xs(i.getBufferIdentifier)&&Xs(i.createLong)?Ns(t,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new t(0):new t(n.buffer,n.byteOffset,n.byteLength/t.BYTES_PER_ELEMENT):t.from(n)):new t(0);var i}const Js=t=>Ns(Int32Array,t),ks=t=>Ns(Uint8Array,t),zs=t=>(t.next(),t);const Is=t=>function*(t,e){const n=function*(t){yield t},i="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Ls?n(e):Ws(e)?e:n(e);return yield*zs(function*(e){let n=null;do{n=e.next(yield Ns(t,n))}while(!n.done)}(i[Symbol.iterator]())),new t}(Uint8Array,t);function ws(t,e){return rs(this,arguments,(function*(){if(Vs(e))return yield as(yield as(yield*os(ss(ws(t,yield as(e))))));const n=function(t){return rs(this,arguments,(function*(){yield yield as(yield as(t))}))},i="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Ls?n(e):Ws(e)?function(t){return rs(this,arguments,(function*(){yield as(yield*os(ss(zs(function*(t){let e=null;do{e=t.next(yield null==e?void 0:e.value)}while(!e.done)}(t[Symbol.iterator]())))))}))}(e):Rs(e)?e:n(e);return yield as(yield*os(ss(zs(function(e){return rs(this,arguments,(function*(){let n=null;do{n=yield as(e.next(yield yield as(Ns(t,n))))}while(!n.done)}))}(i[Symbol.asyncIterator]()))))),yield as(new t)}))}const Ts=t=>ws(Uint8Array,t);var Fs={fromIterable:t=>Qs(function*(t){let e,n,i,l,a=!1,r=[],o=0;function s(){return"peek"===i?Cs(r,l)[0]:([n,r,o]=Cs(r,l),n)}({cmd:i,size:l}=yield null);const d=Is(t)[Symbol.iterator]();try{do{if(({done:e,value:n}=Number.isNaN(l-o)?d.next():d.next(l-o)),!e&&n.byteLength>0&&(r.push(n),o+=n.byteLength),e||l<=o)do{({cmd:i,size:l}=yield s())}while(l<o)}while(!e)}catch(c){(a=!0)&&"function"==typeof d.throw&&d.throw(c)}finally{!1===a&&"function"==typeof d.return&&d.return(null)}return null}(t)),fromAsyncIterable:t=>Qs(function(t){return rs(this,arguments,(function*(){let e,n,i,l,a=!1,r=[],o=0;function s(){return"peek"===i?Cs(r,l)[0]:([n,r,o]=Cs(r,l),n)}({cmd:i,size:l}=yield yield as(null));const d=Ts(t)[Symbol.asyncIterator]();try{do{if(({done:e,value:n}=Number.isNaN(l-o)?yield as(d.next()):yield as(d.next(l-o))),!e&&n.byteLength>0&&(r.push(n),o+=n.byteLength),e||l<=o)do{({cmd:i,size:l}=yield yield as(s()))}while(l<o)}while(!e)}catch(c){(a=!0)&&"function"==typeof d.throw&&(yield as(d.throw(c)))}finally{!1===a&&"function"==typeof d.return&&(yield as(d.return(new Uint8Array(0))))}return yield as(null)}))}(t)),fromDOMStream:t=>Qs(function(t){return rs(this,arguments,(function*(){let e,n,i,l=!1,a=!1,r=[],o=0;function s(){return"peek"===n?Cs(r,i)[0]:([e,r,o]=Cs(r,i),e)}({cmd:n,size:i}=yield yield as(null));const d=new Ms(t);try{do{if(({done:l,value:e}=Number.isNaN(i-o)?yield as(d.read()):yield as(d.read(i-o))),!l&&e.byteLength>0&&(r.push(ks(e)),o+=e.byteLength),l||i<=o)do{({cmd:n,size:i}=yield yield as(s()))}while(i<o)}while(!l)}catch(c){(a=!0)&&(yield as(d.cancel(c)))}finally{!1===a?yield as(d.cancel()):t.locked&&d.releaseLock()}return yield as(null)}))}(t)),fromNodeStream:t=>Qs(function(t){return rs(this,arguments,(function*(){const e=[];let n,i,l,a="error",r=!1,o=null,s=0,d=[];function c(){return"peek"===n?Cs(d,i)[0]:([l,d,s]=Cs(d,i),l)}if(({cmd:n,size:i}=yield yield as(null)),t.isTTY)return yield yield as(new Uint8Array(0)),yield as(null);try{e[0]=Bs(t,"end"),e[1]=Bs(t,"error");do{if(e[2]=Bs(t,"readable"),[a,o]=yield as(Promise.race(e.map((t=>t[2])))),"error"===a)break;if((r="end"===a)||(Number.isFinite(i-s)?(l=ks(t.read(i-s)),l.byteLength<i-s&&(l=ks(t.read()))):l=ks(t.read()),l.byteLength>0&&(d.push(l),s+=l.byteLength)),r||i<=s)do{({cmd:n,size:i}=yield yield as(c()))}while(i<s)}while(!r)}finally{yield as(u(e,"error"===a?o:null))}return yield as(null);function u(e,n){return l=d=null,new Promise(((i,l)=>{for(const[n,r]of e)t.off(n,r);try{const e=t.destroy;e&&e.call(t,n),n=void 0}catch(a){n=a||n}finally{null!=n?l(n):i()}}))}}))}(t)),toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}};const Qs=t=>(t.next(),t);class Ms{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return is(this,void 0,void 0,(function*(){const{reader:e,source:n}=this;e&&(yield e.cancel(t).catch((()=>{}))),n&&n.locked&&this.releaseLock()}))}read(t){return is(this,void 0,void 0,(function*(){if(0===t)return{done:null==this.reader,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=ks(e)),e}))}}const Bs=(t,e)=>{const n=t=>i([e,t]);let i;return[e,n,new Promise((l=>(i=l)&&t.once(e,n)))]};var Us,js,Ps,Es,Os,Ds,As,qs,$s,td,ed,nd,id,ld,ad,rd,od,sd;(js=Us||(Us={}))[js.V1=0]="V1",js[js.V2=1]="V2",js[js.V3=2]="V3",js[js.V4=3]="V4",js[js.V5=4]="V5",(Es=Ps||(Ps={}))[Es.Sparse=0]="Sparse",Es[Es.Dense=1]="Dense",(Ds=Os||(Os={}))[Ds.HALF=0]="HALF",Ds[Ds.SINGLE=1]="SINGLE",Ds[Ds.DOUBLE=2]="DOUBLE",(qs=As||(As={}))[qs.DAY=0]="DAY",qs[qs.MILLISECOND=1]="MILLISECOND",(td=$s||($s={}))[td.SECOND=0]="SECOND",td[td.MILLISECOND=1]="MILLISECOND",td[td.MICROSECOND=2]="MICROSECOND",td[td.NANOSECOND=3]="NANOSECOND",(nd=ed||(ed={}))[nd.YEAR_MONTH=0]="YEAR_MONTH",nd[nd.DAY_TIME=1]="DAY_TIME",nd[nd.MONTH_DAY_NANO=2]="MONTH_DAY_NANO",(ld=id||(id={}))[ld.NONE=0]="NONE",ld[ld.Schema=1]="Schema",ld[ld.DictionaryBatch=2]="DictionaryBatch",ld[ld.RecordBatch=3]="RecordBatch",ld[ld.Tensor=4]="Tensor",ld[ld.SparseTensor=5]="SparseTensor",(rd=ad||(ad={}))[rd.NONE=0]="NONE",rd[rd.Null=1]="Null",rd[rd.Int=2]="Int",rd[rd.Float=3]="Float",rd[rd.Binary=4]="Binary",rd[rd.Utf8=5]="Utf8",rd[rd.Bool=6]="Bool",rd[rd.Decimal=7]="Decimal",rd[rd.Date=8]="Date",rd[rd.Time=9]="Time",rd[rd.Timestamp=10]="Timestamp",rd[rd.Interval=11]="Interval",rd[rd.List=12]="List",rd[rd.Struct=13]="Struct",rd[rd.Union=14]="Union",rd[rd.FixedSizeBinary=15]="FixedSizeBinary",rd[rd.FixedSizeList=16]="FixedSizeList",rd[rd.Map=17]="Map",rd[rd.Dictionary=-1]="Dictionary",rd[rd.Int8=-2]="Int8",rd[rd.Int16=-3]="Int16",rd[rd.Int32=-4]="Int32",rd[rd.Int64=-5]="Int64",rd[rd.Uint8=-6]="Uint8",rd[rd.Uint16=-7]="Uint16",rd[rd.Uint32=-8]="Uint32",rd[rd.Uint64=-9]="Uint64",rd[rd.Float16=-10]="Float16",rd[rd.Float32=-11]="Float32",rd[rd.Float64=-12]="Float64",rd[rd.DateDay=-13]="DateDay",rd[rd.DateMillisecond=-14]="DateMillisecond",rd[rd.TimestampSecond=-15]="TimestampSecond",rd[rd.TimestampMillisecond=-16]="TimestampMillisecond",rd[rd.TimestampMicrosecond=-17]="TimestampMicrosecond",rd[rd.TimestampNanosecond=-18]="TimestampNanosecond",rd[rd.TimeSecond=-19]="TimeSecond",rd[rd.TimeMillisecond=-20]="TimeMillisecond",rd[rd.TimeMicrosecond=-21]="TimeMicrosecond",rd[rd.TimeNanosecond=-22]="TimeNanosecond",rd[rd.DenseUnion=-23]="DenseUnion",rd[rd.SparseUnion=-24]="SparseUnion",rd[rd.IntervalDayTime=-25]="IntervalDayTime",rd[rd.IntervalYearMonth=-26]="IntervalYearMonth",(sd=od||(od={}))[sd.OFFSET=0]="OFFSET",sd[sd.DATA=1]="DATA",sd[sd.VALIDITY=2]="VALIDITY",sd[sd.TYPE=3]="TYPE";function dd(t){if(null===t)return"null";if(undefined===t)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"==typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map((t=>dd(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}`:e))}const cd=Symbol.for("isArrowBigNum");function ud(t,...e){return 0===e.length?Object.setPrototypeOf(Ns(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}function hd(...t){return ud.apply(this,t)}function pd(...t){return ud.apply(this,t)}function md(...t){return ud.apply(this,t)}function bd(t){const{buffer:e,byteOffset:n,length:i,signed:l}=t,a=new Int32Array(e,n,i);let r=0,o=0;const s=a.length;let d,c;for(;o<s;)c=a[o++],d=a[o++],l||(d>>>=0),r+=(c>>>0)+d*Math.pow(o,32);return r}let fd,yd;function Zd(t){let e="";const n=new Uint32Array(2);let i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const l=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let a=-1;const r=i.length-1;do{for(n[0]=i[a=0];a<r;)i[a++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+i[a];i[a]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],e=`${n[0]}${e}`}while(l[0]||l[1]||l[2]||l[3]);return e||"0"}ud.prototype[cd]=!0,ud.prototype.toJSON=function(){return`"${fd(this)}"`},ud.prototype.valueOf=function(){return bd(this)},ud.prototype.toString=function(){return fd(this)},ud.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return bd(this);case"string":return fd(this);case"default":return yd(this)}return fd(this)},Object.setPrototypeOf(hd.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(pd.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(md.prototype,Object.create(Uint32Array.prototype)),Object.assign(hd.prototype,ud.prototype,{constructor:hd,signed:!0,TypedArray:Int32Array,BigIntArray:bs}),Object.assign(pd.prototype,ud.prototype,{constructor:pd,signed:!1,TypedArray:Uint32Array,BigIntArray:ys}),Object.assign(md.prototype,ud.prototype,{constructor:md,signed:!0,TypedArray:Uint32Array,BigIntArray:ys}),ms?(yd=t=>8===t.byteLength?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:Zd(t),fd=t=>8===t.byteLength?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:Zd(t)):(fd=Zd,yd=fd);class Xd{static new(t,e){switch(e){case!0:return new hd(t);case!1:return new pd(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case bs:return new hd(t)}return 16===t.byteLength?new md(t):new pd(t)}static signed(t){return new hd(t)}static unsigned(t){return new pd(t)}static decimal(t){return new md(t)}constructor(t,e){return Xd.new(t,e)}}var Gd,Vd,Wd,Rd,gd,vd,xd,_d,Kd,Sd,Yd,Ld,Hd,Cd,Nd,Jd,kd,zd,Id,wd;class Td{static isNull(t){return(null==t?void 0:t.typeId)===ad.Null}static isInt(t){return(null==t?void 0:t.typeId)===ad.Int}static isFloat(t){return(null==t?void 0:t.typeId)===ad.Float}static isBinary(t){return(null==t?void 0:t.typeId)===ad.Binary}static isUtf8(t){return(null==t?void 0:t.typeId)===ad.Utf8}static isBool(t){return(null==t?void 0:t.typeId)===ad.Bool}static isDecimal(t){return(null==t?void 0:t.typeId)===ad.Decimal}static isDate(t){return(null==t?void 0:t.typeId)===ad.Date}static isTime(t){return(null==t?void 0:t.typeId)===ad.Time}static isTimestamp(t){return(null==t?void 0:t.typeId)===ad.Timestamp}static isInterval(t){return(null==t?void 0:t.typeId)===ad.Interval}static isList(t){return(null==t?void 0:t.typeId)===ad.List}static isStruct(t){return(null==t?void 0:t.typeId)===ad.Struct}static isUnion(t){return(null==t?void 0:t.typeId)===ad.Union}static isFixedSizeBinary(t){return(null==t?void 0:t.typeId)===ad.FixedSizeBinary}static isFixedSizeList(t){return(null==t?void 0:t.typeId)===ad.FixedSizeList}static isMap(t){return(null==t?void 0:t.typeId)===ad.Map}static isDictionary(t){return(null==t?void 0:t.typeId)===ad.Dictionary}static isDenseUnion(t){return Td.isUnion(t)&&t.mode===Ps.Dense}static isSparseUnion(t){return Td.isUnion(t)&&t.mode===Ps.Sparse}get typeId(){return ad.NONE}}Gd=Symbol.toStringTag,Td[Gd]=((wd=Td.prototype).children=null,wd.ArrayType=Array,wd[Symbol.toStringTag]="DataType");class Fd extends Td{toString(){return"Null"}get typeId(){return ad.Null}}Vd=Symbol.toStringTag,Fd[Vd]=Fd.prototype[Symbol.toStringTag]="Null";class Qd extends Td{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return ad.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Wd=Symbol.toStringTag,Qd[Wd]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(Qd.prototype);class Md extends Qd{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(class extends Qd{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(class extends Qd{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(Md.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(class extends Qd{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(class extends Qd{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(class extends Qd{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Qd{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(class extends Qd{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}.prototype,"ArrayType",{value:BigUint64Array});class Bd extends Td{constructor(t){super(),this.precision=t}get typeId(){return ad.Float}get ArrayType(){switch(this.precision){case Os.HALF:return Uint16Array;case Os.SINGLE:return Float32Array;case Os.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}Rd=Symbol.toStringTag,Bd[Rd]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(Bd.prototype);Object.defineProperty(class extends Bd{constructor(){super(Os.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Bd{constructor(){super(Os.SINGLE)}}.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(class extends Bd{constructor(){super(Os.DOUBLE)}}.prototype,"ArrayType",{value:Float64Array});class Ud extends Td{constructor(){super()}get typeId(){return ad.Binary}toString(){return"Binary"}}gd=Symbol.toStringTag,Ud[gd]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(Ud.prototype);class jd extends Td{constructor(){super()}get typeId(){return ad.Utf8}toString(){return"Utf8"}}vd=Symbol.toStringTag,jd[vd]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(jd.prototype);class Pd extends Td{constructor(){super()}get typeId(){return ad.Bool}toString(){return"Bool"}}xd=Symbol.toStringTag,Pd[xd]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(Pd.prototype);class Ed extends Td{constructor(t,e,n=128){super(),this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return ad.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}_d=Symbol.toStringTag,Ed[_d]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Ed.prototype);class Od extends Td{constructor(t){super(),this.unit=t}get typeId(){return ad.Date}toString(){return`Date${32*(this.unit+1)}<${As[this.unit]}>`}}Kd=Symbol.toStringTag,Od[Kd]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Od.prototype);class Dd extends Td{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return ad.Time}toString(){return`Time${this.bitWidth}<${$s[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}Sd=Symbol.toStringTag,Dd[Sd]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Dd.prototype);class Ad extends Td{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return ad.Timestamp}toString(){return`Timestamp<${$s[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}Yd=Symbol.toStringTag,Ad[Yd]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Ad.prototype);class qd extends Td{constructor(t){super(),this.unit=t}get typeId(){return ad.Interval}toString(){return`Interval<${ed[this.unit]}>`}}Ld=Symbol.toStringTag,qd[Ld]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(qd.prototype);class $d extends Td{constructor(t){super(),this.children=[t]}get typeId(){return ad.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Hd=Symbol.toStringTag,$d[Hd]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))($d.prototype);class tc extends Td{constructor(t){super(),this.children=t}get typeId(){return ad.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}Cd=Symbol.toStringTag,tc[Cd]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(tc.prototype);class ec extends Td{constructor(t,e,n){super(),this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,n)=>(t[e]=n)&&t||t),Object.create(null))}get typeId(){return ad.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}Nd=Symbol.toStringTag,ec[Nd]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(ec.prototype);class nc extends Td{constructor(t){super(),this.byteWidth=t}get typeId(){return ad.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Jd=Symbol.toStringTag,nc[Jd]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(nc.prototype);class ic extends Td{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return ad.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}kd=Symbol.toStringTag,ic[kd]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(ic.prototype);class lc extends Td{constructor(t,e=!1){super(),this.children=[t],this.keysSorted=e}get typeId(){return ad.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}zd=Symbol.toStringTag,lc[zd]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(lc.prototype);const ac=(rc=-1,()=>++rc);var rc;class oc extends Td{constructor(t,e,n,i){super(),this.indices=e,this.dictionary=t,this.isOrdered=i||!1,this.id=null==n?ac():"number"==typeof n?n:n.low}get typeId(){return ad.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function sc(t){const e=t;switch(t.typeId){case ad.Decimal:return t.bitWidth/32;case ad.Timestamp:return 2;case ad.Date:case ad.Interval:return 1+e.unit;case ad.FixedSizeList:return e.listSize;case ad.FixedSizeBinary:return e.byteWidth;default:return 1}}Id=Symbol.toStringTag,oc[Id]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(oc.prototype);class dc{visitMany(t,...e){return t.map(((t,n)=>this.visit(t,...e.map((t=>t[n])))))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return function(t,e,n=!0){if("number"==typeof e)return cc(t,e,n);if("string"==typeof e&&e in ad)return cc(t,ad[e],n);if(e&&e instanceof Td)return cc(t,uc(e),n);if((null==e?void 0:e.type)&&e.type instanceof Td)return cc(t,uc(e.type),n);return cc(t,ad.NONE,n)}(this,t,e)}getVisitFnByTypeId(t,e=!0){return cc(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function cc(t,e,n=!0){let i=null;switch(e){case ad.Null:i=t.visitNull;break;case ad.Bool:i=t.visitBool;break;case ad.Int:i=t.visitInt;break;case ad.Int8:i=t.visitInt8||t.visitInt;break;case ad.Int16:i=t.visitInt16||t.visitInt;break;case ad.Int32:i=t.visitInt32||t.visitInt;break;case ad.Int64:i=t.visitInt64||t.visitInt;break;case ad.Uint8:i=t.visitUint8||t.visitInt;break;case ad.Uint16:i=t.visitUint16||t.visitInt;break;case ad.Uint32:i=t.visitUint32||t.visitInt;break;case ad.Uint64:i=t.visitUint64||t.visitInt;break;case ad.Float:i=t.visitFloat;break;case ad.Float16:i=t.visitFloat16||t.visitFloat;break;case ad.Float32:i=t.visitFloat32||t.visitFloat;break;case ad.Float64:i=t.visitFloat64||t.visitFloat;break;case ad.Utf8:i=t.visitUtf8;break;case ad.Binary:i=t.visitBinary;break;case ad.FixedSizeBinary:i=t.visitFixedSizeBinary;break;case ad.Date:i=t.visitDate;break;case ad.DateDay:i=t.visitDateDay||t.visitDate;break;case ad.DateMillisecond:i=t.visitDateMillisecond||t.visitDate;break;case ad.Timestamp:i=t.visitTimestamp;break;case ad.TimestampSecond:i=t.visitTimestampSecond||t.visitTimestamp;break;case ad.TimestampMillisecond:i=t.visitTimestampMillisecond||t.visitTimestamp;break;case ad.TimestampMicrosecond:i=t.visitTimestampMicrosecond||t.visitTimestamp;break;case ad.TimestampNanosecond:i=t.visitTimestampNanosecond||t.visitTimestamp;break;case ad.Time:i=t.visitTime;break;case ad.TimeSecond:i=t.visitTimeSecond||t.visitTime;break;case ad.TimeMillisecond:i=t.visitTimeMillisecond||t.visitTime;break;case ad.TimeMicrosecond:i=t.visitTimeMicrosecond||t.visitTime;break;case ad.TimeNanosecond:i=t.visitTimeNanosecond||t.visitTime;break;case ad.Decimal:i=t.visitDecimal;break;case ad.List:i=t.visitList;break;case ad.Struct:i=t.visitStruct;break;case ad.Union:i=t.visitUnion;break;case ad.DenseUnion:i=t.visitDenseUnion||t.visitUnion;break;case ad.SparseUnion:i=t.visitSparseUnion||t.visitUnion;break;case ad.Dictionary:i=t.visitDictionary;break;case ad.Interval:i=t.visitInterval;break;case ad.IntervalDayTime:i=t.visitIntervalDayTime||t.visitInterval;break;case ad.IntervalYearMonth:i=t.visitIntervalYearMonth||t.visitInterval;break;case ad.FixedSizeList:i=t.visitFixedSizeList;break;case ad.Map:i=t.visitMap}if("function"==typeof i)return i;if(!n)return()=>null;throw new Error(`Unrecognized type '${ad[e]}'`)}function uc(t){switch(t.typeId){case ad.Null:return ad.Null;case ad.Int:{const{bitWidth:e,isSigned:n}=t;switch(e){case 8:return n?ad.Int8:ad.Uint8;case 16:return n?ad.Int16:ad.Uint16;case 32:return n?ad.Int32:ad.Uint32;case 64:return n?ad.Int64:ad.Uint64}return ad.Int}case ad.Float:switch(t.precision){case Os.HALF:return ad.Float16;case Os.SINGLE:return ad.Float32;case Os.DOUBLE:return ad.Float64}return ad.Float;case ad.Binary:return ad.Binary;case ad.Utf8:return ad.Utf8;case ad.Bool:return ad.Bool;case ad.Decimal:return ad.Decimal;case ad.Time:switch(t.unit){case $s.SECOND:return ad.TimeSecond;case $s.MILLISECOND:return ad.TimeMillisecond;case $s.MICROSECOND:return ad.TimeMicrosecond;case $s.NANOSECOND:return ad.TimeNanosecond}return ad.Time;case ad.Timestamp:switch(t.unit){case $s.SECOND:return ad.TimestampSecond;case $s.MILLISECOND:return ad.TimestampMillisecond;case $s.MICROSECOND:return ad.TimestampMicrosecond;case $s.NANOSECOND:return ad.TimestampNanosecond}return ad.Timestamp;case ad.Date:switch(t.unit){case As.DAY:return ad.DateDay;case As.MILLISECOND:return ad.DateMillisecond}return ad.Date;case ad.Interval:switch(t.unit){case ed.DAY_TIME:return ad.IntervalDayTime;case ed.YEAR_MONTH:return ad.IntervalYearMonth}return ad.Interval;case ad.Map:return ad.Map;case ad.List:return ad.List;case ad.Struct:return ad.Struct;case ad.Union:switch(t.mode){case Ps.Dense:return ad.DenseUnion;case Ps.Sparse:return ad.SparseUnion}return ad.Union;case ad.FixedSizeBinary:return ad.FixedSizeBinary;case ad.FixedSizeList:return ad.FixedSizeList;case ad.Dictionary:return ad.Dictionary}throw new Error(`Unrecognized type '${ad[t.typeId]}'`)}dc.prototype.visitInt8=null,dc.prototype.visitInt16=null,dc.prototype.visitInt32=null,dc.prototype.visitInt64=null,dc.prototype.visitUint8=null,dc.prototype.visitUint16=null,dc.prototype.visitUint32=null,dc.prototype.visitUint64=null,dc.prototype.visitFloat16=null,dc.prototype.visitFloat32=null,dc.prototype.visitFloat64=null,dc.prototype.visitDateDay=null,dc.prototype.visitDateMillisecond=null,dc.prototype.visitTimestampSecond=null,dc.prototype.visitTimestampMillisecond=null,dc.prototype.visitTimestampMicrosecond=null,dc.prototype.visitTimestampNanosecond=null,dc.prototype.visitTimeSecond=null,dc.prototype.visitTimeMillisecond=null,dc.prototype.visitTimeMicrosecond=null,dc.prototype.visitTimeNanosecond=null,dc.prototype.visitDenseUnion=null,dc.prototype.visitSparseUnion=null,dc.prototype.visitIntervalDayTime=null,dc.prototype.visitIntervalYearMonth=null;const hc=new Float64Array(1),pc=new Uint32Array(hc.buffer);function mc(t){const e=(31744&t)>>10,n=(1023&t)/1024,i=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return i*(n?Number.NaN:1/0);case 0:return i*(n?6103515625e-14*n:0)}return i*Math.pow(2,e-15)*(1+n)}class bc extends dc{}function fc(t){return(e,n,i)=>{if(e.setValid(n,null!=i))return t(e,n,i)}}const yc=(t,e,n)=>{t[e]=Math.trunc(n%4294967296),t[e+1]=Math.trunc(n/4294967296)},Zc=(t,e,n,i)=>{const{[n]:l,[n+1]:a}=e;null!=l&&null!=a&&t.set(i.subarray(0,a-l),l)},Xc=({values:t},e,n)=>{t[e]=n},Gc=({values:t},e,n)=>{t[e]=n},Vc=({values:t},e,n)=>{t[e]=function(t){if(t!=t)return 32256;hc[0]=t;const e=(2147483648&pc[1])>>16&65535;let n=2146435072&pc[1],i=0;return n>=1089470464?pc[0]>0?n=31744:(n=(2080374784&n)>>16,i=(1048575&pc[1])>>10):n<=1056964608?(i=1048576+(1048575&pc[1]),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=512+(1048575&pc[1])>>10),e|n|65535&i}(n)},Wc=({values:t},e,n)=>{((t,e,n)=>{t[e]=Math.trunc(n/864e5)})(t,e,n.valueOf())},Rc=({values:t},e,n)=>{yc(t,2*e,n.valueOf())},gc=({values:t},e,n)=>yc(t,2*e,n/1e3),vc=({values:t},e,n)=>yc(t,2*e,n),xc=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e3*n%4294967296),t[e+1]=Math.trunc(1e3*n/4294967296)})(t,2*e,n),_c=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e6*n%4294967296),t[e+1]=Math.trunc(1e6*n/4294967296)})(t,2*e,n),Kc=({values:t},e,n)=>{t[e]=n},Sc=({values:t},e,n)=>{t[e]=n},Yc=({values:t},e,n)=>{t[e]=n},Lc=({values:t},e,n)=>{t[e]=n},Hc=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],l=t.children[i];kc.visit(l,t.valueOffsets[e],n)},Cc=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],l=t.children[i];kc.visit(l,e,n)},Nc=({values:t},e,n)=>{t.set(n.subarray(0,2),2*e)},Jc=({values:t},e,n)=>{t[e]=12*n[0]+n[1]%12};bc.prototype.visitBool=fc((({offset:t,values:e},n,i)=>{const l=t+n;i?e[l>>3]|=1<<l%8:e[l>>3]&=~(1<<l%8)})),bc.prototype.visitInt=fc(Xc),bc.prototype.visitInt8=fc(Xc),bc.prototype.visitInt16=fc(Xc),bc.prototype.visitInt32=fc(Xc),bc.prototype.visitInt64=fc(Xc),bc.prototype.visitUint8=fc(Xc),bc.prototype.visitUint16=fc(Xc),bc.prototype.visitUint32=fc(Xc),bc.prototype.visitUint64=fc(Xc),bc.prototype.visitFloat=fc(((t,e,n)=>{switch(t.type.precision){case Os.HALF:return Vc(t,e,n);case Os.SINGLE:case Os.DOUBLE:default:return Gc(t,e,n)}})),bc.prototype.visitFloat16=fc(Vc),bc.prototype.visitFloat32=fc(Gc),bc.prototype.visitFloat64=fc(Gc),bc.prototype.visitUtf8=fc((({values:t,valueOffsets:e},n,i)=>{Zc(t,e,n,hs(i))})),bc.prototype.visitBinary=fc((({values:t,valueOffsets:e},n,i)=>Zc(t,e,n,i))),bc.prototype.visitFixedSizeBinary=fc((({stride:t,values:e},n,i)=>{e.set(i.subarray(0,t),t*n)})),bc.prototype.visitDate=fc(((t,e,n)=>{t.type.unit===As.DAY?Wc(t,e,n):Rc(t,e,n)})),bc.prototype.visitDateDay=fc(Wc),bc.prototype.visitDateMillisecond=fc(Rc),bc.prototype.visitTimestamp=fc(((t,e,n)=>{switch(t.type.unit){case $s.SECOND:return gc(t,e,n);case $s.MILLISECOND:return vc(t,e,n);case $s.MICROSECOND:return xc(t,e,n);case $s.NANOSECOND:return _c(t,e,n)}})),bc.prototype.visitTimestampSecond=fc(gc),bc.prototype.visitTimestampMillisecond=fc(vc),bc.prototype.visitTimestampMicrosecond=fc(xc),bc.prototype.visitTimestampNanosecond=fc(_c),bc.prototype.visitTime=fc(((t,e,n)=>{switch(t.type.unit){case $s.SECOND:return Kc(t,e,n);case $s.MILLISECOND:return Sc(t,e,n);case $s.MICROSECOND:return Yc(t,e,n);case $s.NANOSECOND:return Lc(t,e,n)}})),bc.prototype.visitTimeSecond=fc(Kc),bc.prototype.visitTimeMillisecond=fc(Sc),bc.prototype.visitTimeMicrosecond=fc(Yc),bc.prototype.visitTimeNanosecond=fc(Lc),bc.prototype.visitDecimal=fc((({values:t,stride:e},n,i)=>{t.set(i.subarray(0,e),e*n)})),bc.prototype.visitList=fc(((t,e,n)=>{const i=t.children[0],l=t.valueOffsets,a=kc.getVisitFn(i);if(Array.isArray(n))for(let r=-1,o=l[e],s=l[e+1];o<s;)a(i,o++,n[++r]);else for(let r=-1,o=l[e],s=l[e+1];o<s;)a(i,o++,n.get(++r))})),bc.prototype.visitStruct=fc(((t,e,n)=>{const i=t.type.children.map((t=>kc.getVisitFn(t.type))),l=n instanceof Map?(a=e,r=n,(t,e,n,i)=>e&&t(e,a,r.get(n.name))):n instanceof eh?((t,e)=>(n,i,l,a)=>i&&n(i,t,e.get(a)))(e,n):Array.isArray(n)?((t,e)=>(n,i,l,a)=>i&&n(i,t,e[a]))(e,n):((t,e)=>(n,i,l,a)=>i&&n(i,t,e[l.name]))(e,n);var a,r;t.type.children.forEach(((e,n)=>l(i[n],t.children[n],e,n)))})),bc.prototype.visitUnion=fc(((t,e,n)=>{t.type.mode===Ps.Dense?Hc(t,e,n):Cc(t,e,n)})),bc.prototype.visitDenseUnion=fc(Hc),bc.prototype.visitSparseUnion=fc(Cc),bc.prototype.visitDictionary=fc(((t,e,n)=>{var i;null===(i=t.dictionary)||void 0===i||i.set(t.values[e],n)})),bc.prototype.visitInterval=fc(((t,e,n)=>{t.type.unit===ed.DAY_TIME?Nc(t,e,n):Jc(t,e,n)})),bc.prototype.visitIntervalDayTime=fc(Nc),bc.prototype.visitIntervalYearMonth=fc(Jc),bc.prototype.visitFixedSizeList=fc(((t,e,n)=>{const{stride:i}=t,l=t.children[0],a=kc.getVisitFn(l);if(Array.isArray(n))for(let r=-1,o=e*i;++r<i;)a(l,o+r,n[r]);else for(let r=-1,o=e*i;++r<i;)a(l,o+r,n.get(r))})),bc.prototype.visitMap=fc(((t,e,n)=>{const i=t.children[0],l=t.valueOffsets,a=kc.getVisitFn(i);let{[e]:r,[e+1]:o}=l;const s=n instanceof Map?n.entries():Object.entries(n);for(const d of s)if(a(i,r,d),++r>=o)break}));const kc=new bc,zc=Symbol.for("parent"),Ic=Symbol.for("rowIndex");class wc{constructor(t,e){return this[zc]=t,this[Ic]=e,new Proxy(this,new Fc)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Ic],e=this[zc],n=e.type.children,i={};for(let l=-1,a=n.length;++l<a;)i[n[l].name]=du.visit(e.children[l],t);return i}toString(){return`{${[...this].map((([t,e])=>`${dd(t)}: ${dd(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Tc(this[zc],this[Ic])}}class Tc{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,du.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(wc.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[zc]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ic]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class Fc{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[zc].type.children.map((t=>t.name))}has(t,e){return-1!==t[zc].type.children.findIndex((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(-1!==t[zc].type.children.findIndex((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[zc].type.children.findIndex((t=>t.name===e));if(-1!==n){const i=du.visit(t[zc].children[n],t[Ic]);return Reflect.set(t,e,i),i}}set(t,e,n){const i=t[zc].type.children.findIndex((t=>t.name===e));return-1!==i?(kc.visit(t[zc].children[i],t[Ic],n),Reflect.set(t,e,n)):!!Reflect.has(t,e)&&Reflect.set(t,e,n)}}class Qc extends dc{}function Mc(t){return(e,n)=>e.getValid(n)?t(e,n):null}const Bc=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),Uc=t=>new Date(t),jc=(t,e,n)=>{const{[n]:i,[n+1]:l}=e;return null!=i&&null!=l?t.subarray(i,l):null},Pc=({values:t},e)=>((t,e)=>Uc(((t,e)=>864e5*t[e])(t,e)))(t,e),Ec=({values:t},e)=>((t,e)=>Uc(Bc(t,e)))(t,2*e),Oc=({stride:t,values:e},n)=>e[t*n],Dc=({values:t},e)=>t[e],Ac=({values:t},e)=>1e3*Bc(t,2*e),qc=({values:t},e)=>Bc(t,2*e),$c=({values:t},e)=>((t,e)=>t[e+1]/1e3*4294967296+(t[e]>>>0)/1e3)(t,2*e),tu=({values:t},e)=>((t,e)=>t[e+1]/1e6*4294967296+(t[e]>>>0)/1e6)(t,2*e),eu=({values:t},e)=>t[e],nu=({values:t},e)=>t[e],iu=({values:t},e)=>t[e],lu=({values:t},e)=>t[e],au=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return du.visit(i,t.valueOffsets[e])},ru=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return du.visit(i,e)},ou=({values:t},e)=>t.subarray(2*e,2*(e+1)),su=({values:t},e)=>{const n=t[e],i=new Int32Array(2);return i[0]=Math.trunc(n/12),i[1]=Math.trunc(n%12),i};Qc.prototype.visitNull=Mc(((t,e)=>null)),Qc.prototype.visitBool=Mc((({offset:t,values:e},n)=>{const i=t+n;return 0!=(e[i>>3]&1<<i%8)})),Qc.prototype.visitInt=Mc((({values:t},e)=>t[e])),Qc.prototype.visitInt8=Mc(Oc),Qc.prototype.visitInt16=Mc(Oc),Qc.prototype.visitInt32=Mc(Oc),Qc.prototype.visitInt64=Mc(Dc),Qc.prototype.visitUint8=Mc(Oc),Qc.prototype.visitUint16=Mc(Oc),Qc.prototype.visitUint32=Mc(Oc),Qc.prototype.visitUint64=Mc(Dc),Qc.prototype.visitFloat=Mc((({type:t,values:e},n)=>t.precision!==Os.HALF?e[n]:mc(e[n]))),Qc.prototype.visitFloat16=Mc((({stride:t,values:e},n)=>mc(e[t*n]))),Qc.prototype.visitFloat32=Mc(Oc),Qc.prototype.visitFloat64=Mc(Oc),Qc.prototype.visitUtf8=Mc((({values:t,valueOffsets:e},n)=>{const i=jc(t,e,n);return null!==i?cs(i):null})),Qc.prototype.visitBinary=Mc((({values:t,valueOffsets:e},n)=>jc(t,e,n))),Qc.prototype.visitFixedSizeBinary=Mc((({stride:t,values:e},n)=>e.subarray(t*n,t*(n+1)))),Qc.prototype.visitDate=Mc(((t,e)=>t.type.unit===As.DAY?Pc(t,e):Ec(t,e))),Qc.prototype.visitDateDay=Mc(Pc),Qc.prototype.visitDateMillisecond=Mc(Ec),Qc.prototype.visitTimestamp=Mc(((t,e)=>{switch(t.type.unit){case $s.SECOND:return Ac(t,e);case $s.MILLISECOND:return qc(t,e);case $s.MICROSECOND:return $c(t,e);case $s.NANOSECOND:return tu(t,e)}})),Qc.prototype.visitTimestampSecond=Mc(Ac),Qc.prototype.visitTimestampMillisecond=Mc(qc),Qc.prototype.visitTimestampMicrosecond=Mc($c),Qc.prototype.visitTimestampNanosecond=Mc(tu),Qc.prototype.visitTime=Mc(((t,e)=>{switch(t.type.unit){case $s.SECOND:return eu(t,e);case $s.MILLISECOND:return nu(t,e);case $s.MICROSECOND:return iu(t,e);case $s.NANOSECOND:return lu(t,e)}})),Qc.prototype.visitTimeSecond=Mc(eu),Qc.prototype.visitTimeMillisecond=Mc(nu),Qc.prototype.visitTimeMicrosecond=Mc(iu),Qc.prototype.visitTimeNanosecond=Mc(lu),Qc.prototype.visitDecimal=Mc((({values:t,stride:e},n)=>Xd.decimal(t.subarray(e*n,e*(n+1))))),Qc.prototype.visitList=Mc(((t,e)=>{const{valueOffsets:n,stride:i}=t,{[e*i]:l}=n,{[e*i+1]:a}=n,r=t.children[0].slice(l,a-l);return new eh([r])})),Qc.prototype.visitStruct=Mc(((t,e)=>new wc(t,e))),Qc.prototype.visitUnion=Mc(((t,e)=>t.type.mode===Ps.Dense?au(t,e):ru(t,e))),Qc.prototype.visitDenseUnion=Mc(au),Qc.prototype.visitSparseUnion=Mc(ru),Qc.prototype.visitDictionary=Mc(((t,e)=>{var n;return null===(n=t.dictionary)||void 0===n?void 0:n.get(t.values[e])})),Qc.prototype.visitInterval=Mc(((t,e)=>t.type.unit===ed.DAY_TIME?ou(t,e):su(t,e))),Qc.prototype.visitIntervalDayTime=Mc(ou),Qc.prototype.visitIntervalYearMonth=Mc(su),Qc.prototype.visitFixedSizeList=Mc(((t,e)=>{const{stride:n}=t,i=t.children[0].slice(e*n,n);return new eh([i])})),Qc.prototype.visitMap=Mc(((t,e)=>{const{valueOffsets:n}=t,{[e]:i}=n,{[e+1]:l}=n,a=t.children[0];return new hu(a.slice(i,l-i))}));const du=new Qc,cu=Symbol.for("keys"),uu=Symbol.for("vals");class hu{constructor(t){return this[cu]=new eh([t.children[0]]).memoize(),this[uu]=t.children[1],new Proxy(this,new mu)}[Symbol.iterator](){return new pu(this[cu],this[uu])}get size(){return this[cu].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[cu],e=this[uu],n={};for(let i=-1,l=t.length;++i<l;)n[t.get(i)]=du.visit(e,i);return n}toString(){return`{${[...this].map((([t,e])=>`${dd(t)}: ${dd(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class pu{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),du.visit(this.vals,t)]})}}class mu{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[cu].toArray().map(String)}has(t,e){return t[cu].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[cu].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[cu].indexOf(e);if(-1!==n){const i=du.visit(Reflect.get(t,uu),n);return Reflect.set(t,e,i),i}}set(t,e,n){const i=t[cu].indexOf(e);return-1!==i?(kc.visit(Reflect.get(t,uu),i,n),Reflect.set(t,e,n)):!!Reflect.has(t,e)&&Reflect.set(t,e,n)}}let bu;function fu(t,e,n,i){const{length:l=0}=t;let a="number"!=typeof e?0:e,r="number"!=typeof n?l:n;return a<0&&(a=(a%l+l)%l),r<0&&(r=(r%l+l)%l),r<a&&(bu=a,a=r,r=bu),r>l&&(r=l),i?i(t,a,r):[a,r]}Object.defineProperties(hu.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[cu]:{writable:!0,enumerable:!1,configurable:!1,value:null},[uu]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const yu=t=>t!=t;function Zu(t){if("object"!==typeof t||null===t)return yu(t)?yu:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&function(t,e){let n=0;const i=t.length;if(i!==e.length)return!1;if(i>0)do{if(t[n]!==e[n])return!1}while(++n<i);return!0}(t,e):t instanceof Map?function(t){let e=-1;const n=[];for(const i of t.values())n[++e]=Zu(i);return Xu(n)}(t):Array.isArray(t)?function(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=Zu(t[n]);return Xu(e)}(t):t instanceof eh?function(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=Zu(t.get(n));return Xu(e)}(t):function(t,e=!1){const n=Object.keys(t);if(!e&&0===n.length)return()=>!1;const i=[];for(let l=-1,a=n.length;++l<a;)i[l]=Zu(t[n[l]]);return Xu(i,n)}(t,!0)}function Xu(t,e){return n=>{if(!n||"object"!=typeof n)return!1;switch(n.constructor){case Array:return function(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e[i]))return!1;return!0}(t,n);case Map:return Gu(t,n,n.keys());case hu:case wc:case Object:case void 0:return Gu(t,n,e||Object.keys(n))}return n instanceof eh&&function(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e.get(i)))return!1;return!0}(t,n)}}function Gu(t,e,n){const i=n[Symbol.iterator](),l=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),a=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let r=0;const o=t.length;let s=a.next(),d=i.next(),c=l.next();for(;r<o&&!d.done&&!c.done&&!s.done&&(d.value===c.value&&t[r](s.value));++r,d=i.next(),c=l.next(),s=a.next());return!!(r===o&&d.done&&c.done&&s.done)||(i.return&&i.return(),l.return&&l.return(),a.return&&a.return(),!1)}function Vu(t,e,n,i){return 0!=(n&1<<i)}function Wu(t,e,n,i){return(n&1<<i)>>i}function Ru(t){const e=[];let n=0,i=0,l=0;for(const r of t)r&&(l|=1<<i),8==++i&&(e[n++]=l,l=i=0);(0===n||i>0)&&(e[n++]=l);const a=new Uint8Array(e.length+7&-8);return a.set(e),a}class gu{constructor(t,e,n,i,l){this.bytes=t,this.length=n,this.context=i,this.get=l,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function vu(t,e,n){if(n-e<=0)return 0;if(n-e<8){let i=0;for(const l of new gu(t,e,n-e,t,Wu))i+=l;return i}const i=n>>3<<3,l=e+(e%8==0?0:8-e%8);return vu(t,e,l)+vu(t,i,n)+function(t,e,n){let i=0,l=Math.trunc(e);const a=new DataView(t.buffer,t.byteOffset,t.byteLength),r=void 0===n?t.byteLength:l+n;for(;r-l>=4;)i+=xu(a.getUint32(l)),l+=4;for(;r-l>=2;)i+=xu(a.getUint16(l)),l+=2;for(;r-l>=1;)i+=xu(a.getUint8(l)),l+=1;return i}(t,l>>3,i-l>>3)}function xu(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}class _u{constructor(t,e,n,i,l,a=[],r){let o;this.type=t,this.children=a,this.dictionary=r,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1)),l instanceof _u?(this.stride=l.stride,this.values=l.values,this.typeIds=l.typeIds,this.nullBitmap=l.nullBitmap,this.valueOffsets=l.valueOffsets):(this.stride=sc(t),l&&((o=l[0])&&(this.valueOffsets=o),(o=l[1])&&(this.values=o),(o=l[2])&&(this.nullBitmap=o),(o=l[3])&&(this.typeIds=o))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:n,nullBitmap:i,typeIds:l}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),l&&(t+=l.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-vu(t,this.offset,this.offset+this.length)),e}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return 0!=(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:t}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:t,_nullCount:0})}const{nullBitmap:n,offset:i}=this,l=i+t>>3,a=(i+t)%8,r=n[l]>>a&1;return e?0===r&&(n[l]|=1<<a,this._nullCount=this.nullCount+1):1===r&&(n[l]&=~(1<<a),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,n=this.length,i=this._nullCount,l=this,a=this.children){return new _u(t,e,n,i,l,a,this.dictionary)}slice(t,e){const{stride:n,typeId:i,children:l}=this,a=+(0===this._nullCount)-1,r=16===i?n:1,o=this._sliceBuffers(t,e,n,i);return this.clone(this.type,this.offset+t,e,a,o,0===l.length||this.valueOffsets?l:this._sliceChildren(l,r*t,r*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===ad.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:n}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);i[e>>3]=(1<<e-(-8&e))-1,n>0&&i.set(function(t,e,n){const i=n.byteLength+7&-8;if(t>0||n.byteLength<i){const l=new Uint8Array(i);return l.set(t%8==0?n.subarray(t>>3):Ru(new gu(n,t,e,null,Vu)).subarray(0,i)),l}return n}(this.offset,e,this.nullBitmap),0);const l=this.buffers;return l[od.VALIDITY]=i,this.clone(this.type,0,t,n+(t-e),l)}_sliceBuffers(t,e,n,i){let l;const{buffers:a}=this;return(l=a[od.TYPE])&&(a[od.TYPE]=l.subarray(t,t+e)),(l=a[od.OFFSET])&&(a[od.OFFSET]=l.subarray(t,t+e+1))||(l=a[od.DATA])&&(a[od.DATA]=6===i?l:l.subarray(n*t,n*(t+e))),a}_sliceChildren(t,e,n){return t.map((t=>t.slice(e,n)))}}_u.prototype.children=Object.freeze([]);class Ku extends dc{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:n=0,length:i=0}=t;return new _u(e,n,i,0)}visitBool(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length>>3,nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitInt(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length,nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitFloat(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length,nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitUtf8(t){const{type:e,offset:n=0}=t,i=ks(t.data),l=ks(t.nullBitmap),a=Js(t.valueOffsets),{length:r=a.length-1,nullCount:o=(t.nullBitmap?-1:0)}=t;return new _u(e,n,r,o,[a,i,l])}visitBinary(t){const{type:e,offset:n=0}=t,i=ks(t.data),l=ks(t.nullBitmap),a=Js(t.valueOffsets),{length:r=a.length-1,nullCount:o=(t.nullBitmap?-1:0)}=t;return new _u(e,n,r,o,[a,i,l])}visitFixedSizeBinary(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length/sc(e),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitDate(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length/sc(e),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitTimestamp(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length/sc(e),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitTime(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length/sc(e),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitDecimal(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length/sc(e),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitList(t){const{type:e,offset:n=0,child:i}=t,l=ks(t.nullBitmap),a=Js(t.valueOffsets),{length:r=a.length-1,nullCount:o=(t.nullBitmap?-1:0)}=t;return new _u(e,n,r,o,[a,void 0,l],[i])}visitStruct(t){const{type:e,offset:n=0,children:i=[]}=t,l=ks(t.nullBitmap),{length:a=i.reduce(((t,{length:e})=>Math.max(t,e)),0),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,void 0,l],i)}visitUnion(t){const{type:e,offset:n=0,children:i=[]}=t,l=ks(t.nullBitmap),a=Ns(e.ArrayType,t.typeIds),{length:r=a.length,nullCount:o=(t.nullBitmap?-1:0)}=t;if(Td.isSparseUnion(e))return new _u(e,n,r,o,[void 0,void 0,l,a],i);const s=Js(t.valueOffsets);return new _u(e,n,r,o,[s,void 0,l,a],i)}visitDictionary(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.indices.ArrayType,t.data),{dictionary:a=new eh([(new Ku).visit({type:e.dictionary})])}=t,{length:r=l.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new _u(e,n,r,o,[void 0,l,i],[],a)}visitInterval(t){const{type:e,offset:n=0}=t,i=ks(t.nullBitmap),l=Ns(e.ArrayType,t.data),{length:a=l.length/sc(e),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,l,i])}visitFixedSizeList(t){const{type:e,offset:n=0,child:i=(new Ku).visit({type:e.valueType})}=t,l=ks(t.nullBitmap),{length:a=i.length/sc(e),nullCount:r=(t.nullBitmap?-1:0)}=t;return new _u(e,n,a,r,[void 0,void 0,l],[i])}visitMap(t){const{type:e,offset:n=0,child:i=(new Ku).visit({type:e.childType})}=t,l=ks(t.nullBitmap),a=Js(t.valueOffsets),{length:r=a.length-1,nullCount:o=(t.nullBitmap?-1:0)}=t;return new _u(e,n,r,o,[a,void 0,l],[i])}}function Su(t){return(new Ku).visit(t)}class Yu{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function Lu(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function Hu(t){return t.reduce(((t,e,n)=>(t[n+1]=t[n]+e.length,t)),new Uint32Array(t.length+1))}function Cu(t,e,n,i){const l=[];for(let a=-1,r=t.length;++a<r;){const r=t[a],o=e[a],{length:s}=r;if(o>=i)break;if(n>=o+s)continue;if(o>=n&&o+s<=i){l.push(r);continue}const d=Math.max(0,n-o),c=Math.min(i-o,s);l.push(r.slice(d,c-d))}return 0===l.length&&l.push(t[0].slice(0,0)),l}function Nu(t,e,n,i){let l=0,a=0,r=e.length-1;do{if(l>=r-1)return n<e[r]?i(t,l,n-e[l]):null;a=l+Math.trunc(.5*(r-l)),n<e[a]?r=a:l=a}while(l<r)}function Ju(t,e){return t.getValid(e)}function ku(t){function e(e,n,i){return t(e[n],i)}return function(t){return Nu(this.data,this._offsets,t,e)}}function zu(t){let e;function n(n,i,l){return t(n[i],l,e)}return function(t,i){const l=this.data;e=i;const a=Nu(l,this._offsets,t,n);return e=void 0,a}}function Iu(t){let e;function n(n,i,l){let a=l,r=0,o=0;for(let s=i-1,d=n.length;++s<d;){const i=n[s];if(~(r=t(i,e,a)))return o+r;a=0,o+=i.length}return-1}return function(t,i){e=t;const l=this.data,a="number"!=typeof i?n(l,0,0):Nu(l,this._offsets,i,n);return e=void 0,a}}class wu extends dc{}function Tu(t,e,n){if(void 0===e)return-1;if(null===e)return function(t,e){const{nullBitmap:n}=t;if(!n||t.nullCount<=0)return-1;let i=0;for(const l of new gu(n,t.offset+(e||0),t.length,n,Vu)){if(!l)return i;++i}return-1}(t,n);const i=du.getVisitFn(t),l=Zu(e);for(let a=(n||0)-1,r=t.length;++a<r;)if(l(i(t,a)))return a;return-1}function Fu(t,e,n){const i=du.getVisitFn(t),l=Zu(e);for(let a=(n||0)-1,r=t.length;++a<r;)if(l(i(t,a)))return a;return-1}wu.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},wu.prototype.visitBool=Tu,wu.prototype.visitInt=Tu,wu.prototype.visitInt8=Tu,wu.prototype.visitInt16=Tu,wu.prototype.visitInt32=Tu,wu.prototype.visitInt64=Tu,wu.prototype.visitUint8=Tu,wu.prototype.visitUint16=Tu,wu.prototype.visitUint32=Tu,wu.prototype.visitUint64=Tu,wu.prototype.visitFloat=Tu,wu.prototype.visitFloat16=Tu,wu.prototype.visitFloat32=Tu,wu.prototype.visitFloat64=Tu,wu.prototype.visitUtf8=Tu,wu.prototype.visitBinary=Tu,wu.prototype.visitFixedSizeBinary=Tu,wu.prototype.visitDate=Tu,wu.prototype.visitDateDay=Tu,wu.prototype.visitDateMillisecond=Tu,wu.prototype.visitTimestamp=Tu,wu.prototype.visitTimestampSecond=Tu,wu.prototype.visitTimestampMillisecond=Tu,wu.prototype.visitTimestampMicrosecond=Tu,wu.prototype.visitTimestampNanosecond=Tu,wu.prototype.visitTime=Tu,wu.prototype.visitTimeSecond=Tu,wu.prototype.visitTimeMillisecond=Tu,wu.prototype.visitTimeMicrosecond=Tu,wu.prototype.visitTimeNanosecond=Tu,wu.prototype.visitDecimal=Tu,wu.prototype.visitList=Tu,wu.prototype.visitStruct=Tu,wu.prototype.visitUnion=Tu,wu.prototype.visitDenseUnion=Fu,wu.prototype.visitSparseUnion=Fu,wu.prototype.visitDictionary=Tu,wu.prototype.visitInterval=Tu,wu.prototype.visitIntervalDayTime=Tu,wu.prototype.visitIntervalYearMonth=Tu,wu.prototype.visitFixedSizeList=Tu,wu.prototype.visitMap=Tu;const Qu=new wu;class Mu extends dc{}function Bu(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(e.typeId===ad.Timestamp||e instanceof Qd&&64!==e.bitWidth||e instanceof Dd&&64!==e.bitWidth||e instanceof Bd&&e.precision!==Os.HALF))return new Yu(t.data.length,(e=>{const n=t.data[e];return n.values.subarray(0,n.length)[Symbol.iterator]()}));let n=0;return new Yu(t.data.length,(e=>{const i=t.data[e].length,l=t.slice(n,n+i);return n+=i,new Uu(l)}))}class Uu{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Mu.prototype.visitNull=Bu,Mu.prototype.visitBool=Bu,Mu.prototype.visitInt=Bu,Mu.prototype.visitInt8=Bu,Mu.prototype.visitInt16=Bu,Mu.prototype.visitInt32=Bu,Mu.prototype.visitInt64=Bu,Mu.prototype.visitUint8=Bu,Mu.prototype.visitUint16=Bu,Mu.prototype.visitUint32=Bu,Mu.prototype.visitUint64=Bu,Mu.prototype.visitFloat=Bu,Mu.prototype.visitFloat16=Bu,Mu.prototype.visitFloat32=Bu,Mu.prototype.visitFloat64=Bu,Mu.prototype.visitUtf8=Bu,Mu.prototype.visitBinary=Bu,Mu.prototype.visitFixedSizeBinary=Bu,Mu.prototype.visitDate=Bu,Mu.prototype.visitDateDay=Bu,Mu.prototype.visitDateMillisecond=Bu,Mu.prototype.visitTimestamp=Bu,Mu.prototype.visitTimestampSecond=Bu,Mu.prototype.visitTimestampMillisecond=Bu,Mu.prototype.visitTimestampMicrosecond=Bu,Mu.prototype.visitTimestampNanosecond=Bu,Mu.prototype.visitTime=Bu,Mu.prototype.visitTimeSecond=Bu,Mu.prototype.visitTimeMillisecond=Bu,Mu.prototype.visitTimeMicrosecond=Bu,Mu.prototype.visitTimeNanosecond=Bu,Mu.prototype.visitDecimal=Bu,Mu.prototype.visitList=Bu,Mu.prototype.visitStruct=Bu,Mu.prototype.visitUnion=Bu,Mu.prototype.visitDenseUnion=Bu,Mu.prototype.visitSparseUnion=Bu,Mu.prototype.visitDictionary=Bu,Mu.prototype.visitInterval=Bu,Mu.prototype.visitIntervalDayTime=Bu,Mu.prototype.visitIntervalYearMonth=Bu,Mu.prototype.visitFixedSizeList=Bu,Mu.prototype.visitMap=Bu;const ju=new Mu,Pu=(t,e)=>t+e;class Eu extends dc{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return 16}visitDate(t,e){return 4*(t.type.unit+1)}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===$s.SECOND?4:8}visitInterval(t,e){return 4*(t.type.unit+1)}visitStruct(t,e){return this.visitMany(t.children,t.children.map((()=>e))).reduce(Pu,0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return this.visitMany(t.children,t.children.map((()=>e))).reduce(Pu,0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+((null===(n=t.dictionary)||void 0===n?void 0:n.getByteLength(t.values[e]))||0)}}const Ou=({type:t,children:e,typeIds:n,valueOffsets:i},l)=>{const a=t.typeIdToChildIndex[n[l]];return 8+Au.visit(e[a],i[l])},Du=({children:t},e)=>4+Au.visitMany(t,t.map((()=>e))).reduce(Pu,0);Eu.prototype.visitUtf8=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Eu.prototype.visitBinary=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Eu.prototype.visitList=({valueOffsets:t,stride:e,children:n},i)=>{const l=n[0],{[i*e]:a}=t,{[i*e+1]:r}=t,o=Au.getVisitFn(l.type),s=l.slice(a,r-a);let d=8;for(let c=-1,u=r-a;++c<u;)d+=o(s,c);return d},Eu.prototype.visitFixedSizeList=({stride:t,children:e},n)=>{const i=e[0],l=i.slice(n*t,t),a=Au.getVisitFn(i.type);let r=0;for(let o=-1,s=l.length;++o<s;)r+=a(l,o);return r},Eu.prototype.visitUnion=(t,e)=>t.type.mode===Ps.Dense?Ou(t,e):Du(t,e),Eu.prototype.visitDenseUnion=Ou,Eu.prototype.visitSparseUnion=Du;const Au=new Eu;var qu;const $u={},th={};class eh{constructor(t){var e,n,i;const l=t[0]instanceof eh?t.flatMap((t=>t.data)):t;if(l.some((t=>!(t instanceof _u))))throw new TypeError("Vector constructor expects an Array of Data instances.");const a=null===(e=l[0])||void 0===e?void 0:e.type;switch(l.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:n,byteLength:i}=$u[a.typeId],r=l[0];this.isValid=t=>Ju(r,t),this.get=e=>t(r,e),this.set=(t,n)=>e(r,t,n),this.indexOf=t=>n(r,t),this.getByteLength=t=>i(r,t),this._offsets=[0,r.length];break}default:Object.setPrototypeOf(this,th[a.typeId]),this._offsets=Hu(l)}this.data=l,this.type=a,this.stride=sc(a),this.numChildren=null!==(i=null===(n=a.children)||void 0===n?void 0:n.length)&&void 0!==i?i:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return-1===this._byteLength&&(this._byteLength=this.data.reduce(((t,e)=>t+e.byteLength),0)),this._byteLength}get nullCount(){return-1===this._nullCount&&(this._nullCount=Lu(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${ad[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return ju.visit(this)}concat(...t){return new eh(this.data.concat(t.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new eh(fu(this,t,e,(({data:t,_offsets:e},n,i)=>Cu(t,e,n,i))))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:n,stride:i,ArrayType:l}=this;switch(t.typeId){case ad.Int:case ad.Float:case ad.Decimal:case ad.Time:case ad.Timestamp:switch(e.length){case 0:return new l;case 1:return e[0].values.subarray(0,n*i);default:return e.reduce(((t,{values:e})=>(t.array.set(e,t.offset),t.offset+=e.length,t)),{array:new l(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new eh(this.data.map((({children:e})=>e[t]))):null}get isMemoized(){return!!Td.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(Td.isDictionary(this.type)){const t=new nh(this.data[0].dictionary),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new eh(e)}return new nh(this)}unmemoize(){if(Td.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new eh(e)}return this}}qu=Symbol.toStringTag,eh[qu]=(t=>{t.type=Td.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._nullCount=-1,t._byteLength=-1,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(ad).map((t=>ad[t])).filter((t=>"number"==typeof t&&t!==ad.NONE));for(const n of e){const e=du.getVisitFnByTypeId(n),i=kc.getVisitFnByTypeId(n),l=Qu.getVisitFnByTypeId(n),a=Au.getVisitFnByTypeId(n);$u[n]={get:e,set:i,indexOf:l,byteLength:a},th[n]=Object.create(t,{isValid:{value:ku(Ju)},get:{value:ku(du.getVisitFnByTypeId(n))},set:{value:zu(kc.getVisitFnByTypeId(n))},indexOf:{value:Iu(Qu.getVisitFnByTypeId(n))},getByteLength:{value:ku(Au.getVisitFnByTypeId(n))}})}return"Vector"})(eh.prototype);class nh extends eh{constructor(t){super(t.data);const e=this.get,n=this.set,i=this.slice,l=new Array(this.length);Object.defineProperty(this,"get",{value(t){const n=l[t];if(void 0!==n)return n;const i=e.call(this,t);return l[t]=i,i}}),Object.defineProperty(this,"set",{value(t,e){n.call(this,t,e),l[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new nh(i.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new eh(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class ih{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,i){return t.prep(8,24),t.writeInt64(i),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}}const lh=new Int32Array(2),ah=new Float32Array(lh.buffer),rh=new Float64Array(lh.buffer),oh=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];class sh{constructor(t,e){this.low=0|t,this.high=0|e}static create(t,e){return 0==t&&0==e?sh.ZERO:new sh(t,e)}toFloat64(){return(this.low>>>0)+4294967296*this.high}equals(t){return this.low==t.low&&this.high==t.high}}var dh,ch,uh,hh,ph,mh,bh,fh,yh,Zh,Xh,Gh,Vh;sh.ZERO=new sh(0,0),(ch=dh||(dh={}))[ch.UTF8_BYTES=1]="UTF8_BYTES",ch[ch.UTF16_STRING=2]="UTF16_STRING";class Wh{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new Wh(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new sh(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new sh(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return lh[0]=this.readInt32(t),ah[0]}readFloat64(t){return lh[oh?0:1]=this.readInt32(t),lh[oh?1:0]=this.readInt32(t+4),rh[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){ah[0]=e,this.writeInt32(t,lh[0])}writeFloat64(t,e){rh[0]=e,this.writeInt32(t,lh[oh?0:1]),this.writeInt32(t+4,lh[oh?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);let i="",l=0;if(t+=4,e===dh.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;l<n;){let e;const n=this.readUint8(t+l++);if(n<192)e=n;else{const i=this.readUint8(t+l++);if(n<224)e=(31&n)<<6|63&i;else{const a=this.readUint8(t+l++);if(n<240)e=(15&n)<<12|(63&i)<<6|63&a;else{e=(7&n)<<18|(63&i)<<12|(63&a)<<6|63&this.readUint8(t+l++)}}}e<65536?i+=String.fromCharCode(e):(e-=65536,i+=String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return i}__union_with_string(t,e){return"string"==typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return sh.create(t,e)}createScalarList(t,e){const n=[];for(let i=0;i<e;++i)null!==t(i)&&n.push(t(i));return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const e=t(i);null!==e&&n.push(e.unpack())}return n}}class Rh{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,e=t||1024,this.bb=Wh.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=1+~(this.bb.capacity()-this.space+e)&t-1;for(;this.space<n+t+e;){const t=this.bb.capacity();this.bb=Rh.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){!this.force_defaults&&e.equals(n)||(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,i=Wh.allocate(n);return i.setPosition(n-e),i.bytes().set(t.bytes(),n-e),i}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const n=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const i=2*(n+2);this.addInt16(i);let l=0;const a=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(t)){for(let e=2;e<i;e+=2)if(this.bb.readInt16(a+e)!=this.bb.readInt16(t+e))continue t;l=this.vtables[e];break}}return l?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,l-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const i=n?4:0;if(e){const t=e;if(this.prep(this.minalign,8+i),4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=3;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,4+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(0!=this.bb.readInt16(i+e)))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let i;const l=t.charCodeAt(n++);if(l<55296||l>=56320)i=l;else{i=(l<<10)+t.charCodeAt(n++)+-56613888}i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(63&i|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let n=0,i=this.space,l=this.bb.bytes();n<e.length;n++)l[i++]=e[n];return this.endVector()}createLong(t,e){return sh.create(t,e)}createObjectOffset(t){return null===t?0:"string"==typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];if(null===i)throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(i))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class gh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new gh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new gh).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return gh.startKeyValue(t),gh.addKey(t,e),gh.addValue(t,n),gh.endKeyValue(t)}}!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(uh||(uh={})),(ph=hh||(hh={}))[ph.Little=0]="Little",ph[ph.Big=1]="Big",(bh=mh||(mh={}))[bh.DenseArray=0]="DenseArray";class vh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new vh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new vh).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return vh.startInt(t),vh.addBitWidth(t,e),vh.addIsSigned(t,n),vh.endInt(t)}}class xh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new xh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new xh).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new vh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):mh.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,mh.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class _h{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new _h).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new _h).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return _h.startBinary(t),_h.endBinary(t)}}class Kh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new Kh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new Kh).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Kh.startBool(t),Kh.endBool(t)}}!function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(fh||(fh={}));class Sh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):fh.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,fh.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return Sh.startDate(t),Sh.addUnit(t,e),Sh.endDate(t)}}class Yh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new Yh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new Yh).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,i){return Yh.startDecimal(t),Yh.addPrecision(t,e),Yh.addScale(t,n),Yh.addBitWidth(t,i),Yh.endDecimal(t)}}!function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(yh||(yh={}));class Lh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new Lh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new Lh).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return Lh.startFixedSizeBinary(t),Lh.addByteWidth(t,e),Lh.endFixedSizeBinary(t)}}class Hh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new Hh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new Hh).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return Hh.startFixedSizeList(t),Hh.addListSize(t,e),Hh.endFixedSizeList(t)}}!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(Zh||(Zh={}));class Ch{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new Ch).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new Ch).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Zh.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,Zh.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return Ch.startFloatingPoint(t),Ch.addPrecision(t,e),Ch.endFloatingPoint(t)}}!function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(Xh||(Xh={}));class Nh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new Nh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new Nh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Xh.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Xh.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return Nh.startInterval(t),Nh.addUnit(t,e),Nh.endInterval(t)}}class Jh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new Jh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new Jh).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return Jh.startList(t),Jh.endList(t)}}class kh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new kh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new kh).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return kh.startMap(t),kh.addKeysSorted(t,e),kh.endMap(t)}}class zh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new zh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new zh).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return zh.startNull(t),zh.endNull(t)}}class Ih{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new Ih).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new Ih).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Ih.startStruct_(t),Ih.endStruct_(t)}}class wh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new wh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new wh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):yh.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,yh.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return wh.startTime(t),wh.addUnit(t,e),wh.addBitWidth(t,n),wh.endTime(t)}}class Th{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Th).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new Th).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):yh.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,yh.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return Th.startTimestamp(t),Th.addUnit(t,e),Th.addTimezone(t,n),Th.endTimestamp(t)}}!function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(Gh||(Gh={}));class Fh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new Fh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new Fh).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Gh.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*t):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,Gh.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return Fh.startUnion(t),Fh.addMode(t,e),Fh.addTypeIds(t,n),Fh.endUnion(t)}}class Qh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new Qh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new Qh).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Qh.startUtf8(t),Qh.endUtf8(t)}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList"}(Vh||(Vh={}));class Mh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new Mh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new Mh).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):Vh.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new xh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const n=this.bb.__offset(this.bb_pos,14);return n?(e||new Mh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,16);return n?(e||new gh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,Vh.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}}class Bh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new Bh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new Bh).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):hh.Little}fields(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Mh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new gh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,hh.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,i,l){return Bh.startSchema(t),Bh.addEndianness(t,e),Bh.addFields(t,n),Bh.addCustomMetadata(t,i),Bh.addFeatures(t,l),Bh.endSchema(t)}}class Uh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new Uh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new Uh).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):uh.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Bh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new ih).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new ih).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new gh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,uh.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}class jh{constructor(t=[],e,n){this.fields=t||[],this.metadata=e||new Map,n||(n=Oh(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),n=this.fields.filter((t=>e.has(t.name)));return new jh(n,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new jh(e,this.metadata)}assign(...t){const e=t[0]instanceof jh?t[0]:Array.isArray(t[0])?new jh(t[0]):new jh(t),n=[...this.fields],i=Eh(Eh(new Map,this.metadata),e.metadata),l=e.fields.filter((t=>{const e=n.findIndex((e=>e.name===t.name));return!~e||(n[e]=t.clone({metadata:Eh(Eh(new Map,n[e].metadata),t.metadata)}))&&!1})),a=Oh(l,new Map);return new jh([...n,...l],i,new Map([...this.dictionaries,...a]))}}jh.prototype.fields=null,jh.prototype.metadata=null,jh.prototype.dictionaries=null;class Ph{constructor(t,e,n=!1,i){this.name=t,this.type=e,this.nullable=n,this.metadata=i||new Map}static new(...t){let[e,n,i,l]=t;return t[0]&&"object"==typeof t[0]&&(({name:e}=t[0]),void 0===n&&(n=t[0].type),void 0===i&&(i=t[0].nullable),void 0===l&&(l=t[0].metadata)),new Ph(`${e}`,n,i,l)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,i,l]=t;return t[0]&&"object"==typeof t[0]?({name:e=this.name,type:n=this.type,nullable:i=this.nullable,metadata:l=this.metadata}=t[0]):[e=this.name,n=this.type,i=this.nullable,l=this.metadata]=t,Ph.new(e,n,i,l)}}function Eh(t,e){return new Map([...t||new Map,...e||new Map])}function Oh(t,e=new Map){for(let n=-1,i=t.length;++n<i;){const i=t[n].type;if(Td.isDictionary(i))if(e.has(i.id)){if(e.get(i.id)!==i.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(i.id,i.dictionary);i.children&&i.children.length>0&&Oh(i.children,e)}return e}Ph.prototype.type=null,Ph.prototype.name=null,Ph.prototype.nullable=null,Ph.prototype.metadata=null;var Dh=sh,Ah=Rh,qh=Wh;class $h{constructor(t,e=Us.V4,n,i){this.schema=t,this.version=e,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(t){t=new qh(ks(t));const e=Uh.getRootAsFooter(t),n=jh.decode(e.schema());return new tp(n,e)}static encode(t){const e=new Ah,n=jh.encode(e,t.schema);Uh.startRecordBatchesVector(e,t.numRecordBatches);for(const a of[...t.recordBatches()].slice().reverse())ep.encode(e,a);const i=e.endVector();Uh.startDictionariesVector(e,t.numDictionaries);for(const a of[...t.dictionaryBatches()].slice().reverse())ep.encode(e,a);const l=e.endVector();return Uh.startFooter(e),Uh.addSchema(e,n),Uh.addVersion(e,Us.V4),Uh.addRecordBatches(e,i),Uh.addDictionaries(e,l),Uh.finishFooterBuffer(e,Uh.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class tp extends $h{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return ep.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return ep.decode(e)}return null}}class ep{constructor(t,e,n){this.metaDataLength=t,this.offset="number"==typeof n?n:n.low,this.bodyLength="number"==typeof e?e:e.low}static decode(t){return new ep(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:n}=e,i=new Dh(e.offset,0),l=new Dh(e.bodyLength,0);return ih.createBlock(t,i,n,l)}}const np=Object.freeze({done:!0,value:void 0});class ip{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class lp{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class ap extends lp{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}get closed(){return this._closedPromise}cancel(t){return is(this,void 0,void 0,(function*(){yield this.return(t)}))}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(np);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Fs.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Fs.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return is(this,void 0,void 0,(function*(){return yield this.abort(t),np}))}return(t){return is(this,void 0,void 0,(function*(){return yield this.close(),np}))}read(t){return is(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return is(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((t,e)=>{this.resolvers.push({resolve:t,reject:e})})):Promise.resolve(np)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class rp extends ap{write(t){if((t=ks(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?cs(this.toUint8Array(!0)):this.toUint8Array(!1).then(cs)}toUint8Array(t=!1){return t?Cs(this._values)[0]:(()=>is(this,void 0,void 0,(function*(){var t,e;const n=[];let i=0;try{for(var l,a=ss(this);!(l=yield a.next()).done;){const t=l.value;n.push(t),i+=t.byteLength}}catch(r){t={error:r}}finally{try{l&&!l.done&&(e=a.return)&&(yield e.call(a))}finally{if(t)throw t.error}}return Cs(n,i)[0]})))()}}class op{constructor(t){t&&(this.source=new dp(Fs.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class sp{constructor(t){t instanceof sp?this.source=t.source:t instanceof rp?this.source=new cp(Fs.fromAsyncIterable(t)):Ys(t)?this.source=new cp(Fs.fromNodeStream(t)):Ss(t)?this.source=new cp(Fs.fromDOMStream(t)):_s(t)?this.source=new cp(Fs.fromDOMStream(t.body)):Ws(t)?this.source=new cp(Fs.fromIterable(t)):(Vs(t)||Rs(t))&&(this.source=new cp(Fs.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class dp{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||np)}return(t){return Object.create(this.source.return&&this.source.return(t)||np)}}class cp{constructor(t){this.source=t,this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}cancel(t){return is(this,void 0,void 0,(function*(){yield this.return(t)}))}get closed(){return this._closedPromise}read(t){return is(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return is(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(t,e="read"){return is(this,void 0,void 0,(function*(){return yield this.source.next({cmd:e,size:t})}))}throw(t){return is(this,void 0,void 0,(function*(){const e=this.source.throw&&(yield this.source.throw(t))||np;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}return(t){return is(this,void 0,void 0,(function*(){const e=this.source.return&&(yield this.source.return(t))||np;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}}class up extends op{constructor(t,e){super(),this.position=0,this.buffer=ks(t),this.size=void 0===e?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:n,position:i}=this;return e&&i<n?("number"!=typeof t&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,t)),e.subarray(i,this.position)):null}readAt(t,e){const n=this.buffer,i=Math.min(this.size,t+e);return n?n.subarray(t,i):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class hp extends sp{constructor(t,e){super(),this.position=0,this._handle=t,"number"==typeof e?this.size=e:this._pending=(()=>is(this,void 0,void 0,(function*(){this.size=(yield t.stat()).size,delete this._pending})))()}readInt32(t){return is(this,void 0,void 0,(function*(){const{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}))}seek(t){return is(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size}))}read(t){return is(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:e,size:n,position:i}=this;if(e&&i<n){"number"!=typeof t&&(t=Number.POSITIVE_INFINITY);let l=i,a=0,r=0;const o=Math.min(n,l+Math.min(n-l,t)),s=new Uint8Array(Math.max(0,(this.position=o)-l));for(;(l+=r)<o&&(a+=r)<s.byteLength;)({bytesRead:r}=yield e.read(s,a,s.byteLength-a,l));return s}return null}))}readAt(t,e){return is(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:n,size:i}=this;if(n&&t+e<i){const l=Math.min(i,t+e),a=new Uint8Array(l-t);return(yield n.read(a,0,e,t)).buffer}return new Uint8Array(e)}))}close(){return is(this,void 0,void 0,(function*(){const t=this._handle;this._handle=null,t&&(yield t.close())}))}throw(t){return is(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}return(t){return is(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}}function pp(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const mp=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class bp{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([t.buffer[1]>>>16,65535&t.buffer[1],t.buffer[0]>>>16,65535&t.buffer[0]]);let i=e[3]*n[3];this.buffer[0]=65535&i;let l=i>>>16;return i=e[2]*n[3],l+=i,i=e[3]*n[2]>>>0,l+=i,this.buffer[0]+=l<<16,this.buffer[1]=l>>>0<i?65536:0,this.buffer[1]+=l>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${pp(this.buffer[1])} ${pp(this.buffer[0])}`}}class fp extends bp{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return fp.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return fp.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.length,i=new fp(e);for(let l=0;l<n;){const e=8<n-l?8:n-l,a=new fp(new Uint32Array([Number.parseInt(t.slice(l,l+e),10),0])),r=new fp(new Uint32Array([mp[e],0]));i.times(r),i.plus(a),l+=e}return i}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,i=t.length;++n<i;)fp.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new fp(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new fp(new Uint32Array(t.buffer)).plus(e)}}class yp extends bp{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]<<0,n=t.buffer[1]<<0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return yp.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return yp.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.startsWith("-"),i=t.length,l=new yp(e);for(let a=n?1:0;a<i;){const e=8<i-a?8:i-a,n=new yp(new Uint32Array([Number.parseInt(t.slice(a,a+e),10),0])),r=new yp(new Uint32Array([mp[e],0]));l.times(r),l.plus(n),a+=e}return n?l.negate():l}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,i=t.length;++n<i;)yp.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new yp(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new yp(new Uint32Array(t.buffer)).plus(e)}}class Zp{constructor(t){this.buffer=t}high(){return new yp(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new yp(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(t){const e=new fp(new Uint32Array([this.buffer[3],0])),n=new fp(new Uint32Array([this.buffer[2],0])),i=new fp(new Uint32Array([this.buffer[1],0])),l=new fp(new Uint32Array([this.buffer[0],0])),a=new fp(new Uint32Array([t.buffer[3],0])),r=new fp(new Uint32Array([t.buffer[2],0])),o=new fp(new Uint32Array([t.buffer[1],0])),s=new fp(new Uint32Array([t.buffer[0],0]));let d=fp.multiply(l,s);this.buffer[0]=d.low();const c=new fp(new Uint32Array([d.high(),0]));d=fp.multiply(i,s),c.plus(d),d=fp.multiply(l,o),c.plus(d),this.buffer[1]=c.low(),this.buffer[3]=c.lessThan(d)?1:0,this.buffer[2]=c.high();return new fp(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(fp.multiply(n,s)).plus(fp.multiply(i,o)).plus(fp.multiply(l,r)),this.buffer[3]+=fp.multiply(e,s).plus(fp.multiply(n,o)).plus(fp.multiply(i,r)).plus(fp.multiply(l,a)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${pp(this.buffer[3])} ${pp(this.buffer[2])} ${pp(this.buffer[1])} ${pp(this.buffer[0])}`}static multiply(t,e){return new Zp(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Zp(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return Zp.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return Zp.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const n=t.startsWith("-"),i=t.length,l=new Zp(e);for(let a=n?1:0;a<i;){const e=8<i-a?8:i-a,n=new Zp(new Uint32Array([Number.parseInt(t.slice(a,a+e),10),0,0,0])),r=new Zp(new Uint32Array([mp[e],0,0,0]));l.times(r),l.plus(n),a+=e}return n?l.negate():l}static convertArray(t){const e=new Uint32Array(4*t.length);for(let n=-1,i=t.length;++n<i;)Zp.from(t[n],new Uint32Array(e.buffer,e.byteOffset+16*n,4));return e}}class Xp extends dc{constructor(t,e,n,i){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=i}visit(t){return super.visit(t instanceof Ph?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return Su({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===Ps.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return Su({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class Gp extends Xp{constructor(t,e,n,i){super(new Uint8Array(0),e,n,i),this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):Ru(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return Ns(Uint8Array,Ns(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return Ns(Uint8Array,Ns(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:n}=this;return Td.isTimestamp(t)||(Td.isInt(t)||Td.isTime(t))&&64===t.bitWidth||Td.isDate(t)&&t.unit===As.MILLISECOND?Ns(Uint8Array,yp.convertArray(n[e])):Td.isDecimal(t)?Ns(Uint8Array,Zp.convertArray(n[e])):Td.isBinary(t)||Td.isFixedSizeBinary(t)?function(t){const e=t.join(""),n=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)n[i>>1]=Number.parseInt(e.slice(i,i+2),16);return n}(n[e]):Td.isBool(t)?Ru(n[e]):Td.isUtf8(t)?hs(n[e].join("")):Ns(Uint8Array,Ns(t.ArrayType,n[e].map((t=>+t))))}}class Vp extends dc{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,n)=>this.compareFields(t,e[n])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function Wp(t,e){return e instanceof t.constructor}function Rp(t,e){return t===e||Wp(t,e)}function gp(t,e){return t===e||Wp(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function vp(t,e){return t===e||Wp(t,e)&&t.precision===e.precision}function xp(t,e){return t===e||Wp(t,e)&&t.unit===e.unit}function _p(t,e){return t===e||Wp(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Kp(t,e){return t===e||Wp(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function Sp(t,e){return t===e||Wp(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,n)=>t===e.typeIds[n]))&&Lp.compareManyFields(t.children,e.children)}function Yp(t,e){return t===e||Wp(t,e)&&t.unit===e.unit}Vp.prototype.visitNull=Rp,Vp.prototype.visitBool=Rp,Vp.prototype.visitInt=gp,Vp.prototype.visitInt8=gp,Vp.prototype.visitInt16=gp,Vp.prototype.visitInt32=gp,Vp.prototype.visitInt64=gp,Vp.prototype.visitUint8=gp,Vp.prototype.visitUint16=gp,Vp.prototype.visitUint32=gp,Vp.prototype.visitUint64=gp,Vp.prototype.visitFloat=vp,Vp.prototype.visitFloat16=vp,Vp.prototype.visitFloat32=vp,Vp.prototype.visitFloat64=vp,Vp.prototype.visitUtf8=Rp,Vp.prototype.visitBinary=Rp,Vp.prototype.visitFixedSizeBinary=function(t,e){return t===e||Wp(t,e)&&t.byteWidth===e.byteWidth},Vp.prototype.visitDate=xp,Vp.prototype.visitDateDay=xp,Vp.prototype.visitDateMillisecond=xp,Vp.prototype.visitTimestamp=_p,Vp.prototype.visitTimestampSecond=_p,Vp.prototype.visitTimestampMillisecond=_p,Vp.prototype.visitTimestampMicrosecond=_p,Vp.prototype.visitTimestampNanosecond=_p,Vp.prototype.visitTime=Kp,Vp.prototype.visitTimeSecond=Kp,Vp.prototype.visitTimeMillisecond=Kp,Vp.prototype.visitTimeMicrosecond=Kp,Vp.prototype.visitTimeNanosecond=Kp,Vp.prototype.visitDecimal=Rp,Vp.prototype.visitList=function(t,e){return t===e||Wp(t,e)&&t.children.length===e.children.length&&Lp.compareManyFields(t.children,e.children)},Vp.prototype.visitStruct=function(t,e){return t===e||Wp(t,e)&&t.children.length===e.children.length&&Lp.compareManyFields(t.children,e.children)},Vp.prototype.visitUnion=Sp,Vp.prototype.visitDenseUnion=Sp,Vp.prototype.visitSparseUnion=Sp,Vp.prototype.visitDictionary=function(t,e){return t===e||Wp(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Lp.visit(t.indices,e.indices)&&Lp.visit(t.dictionary,e.dictionary)},Vp.prototype.visitInterval=Yp,Vp.prototype.visitIntervalDayTime=Yp,Vp.prototype.visitIntervalYearMonth=Yp,Vp.prototype.visitFixedSizeList=function(t,e){return t===e||Wp(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Lp.compareManyFields(t.children,e.children)},Vp.prototype.visitMap=function(t,e){return t===e||Wp(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Lp.compareManyFields(t.children,e.children)};const Lp=new Vp;function Hp(t,e){return Lp.compareSchemas(t,e)}function Cp(t,e){return function(t,e){const n=[...t.fields],i=[],l={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let a=0,r=0,o=-1;const s=e.length;let d,c=[];for(;l.numBatches-- >0;){for(r=Number.POSITIVE_INFINITY,o=-1;++o<s;)c[o]=d=e[o].shift(),r=Math.min(r,d?d.length:r);Number.isFinite(r)&&(c=Np(n,r,c,e,l),r>0&&(i[a++]=Su({type:new tc(n),length:r,nullCount:0,children:c.slice()})))}return[t=t.assign(n),i.map((e=>new Mp(t,e)))]}(t,e.map((t=>t.data.concat())))}function Np(t,e,n,i,l){var a;const r=(e+63&-64)>>3;for(let o=-1,s=i.length;++o<s;){const s=n[o],d=null==s?void 0:s.length;if(d>=e)d===e?n[o]=s:(n[o]=s.slice(0,e),l.numBatches=Math.max(l.numBatches,i[o].unshift(s.slice(e,d-e))));else{const i=t[o];t[o]=i.clone({nullable:!0}),n[o]=null!==(a=null==s?void 0:s._changeLengthAndBackfillNullBitmap(e))&&void 0!==a?a:Su({type:i.type,length:e,nullCount:e,nullBitmap:new Uint8Array(r)})}}return n}var Jp,kp,zp,Ip,wp,Tp,Fp;class Qp{constructor(...t){var e,n;if(0===t.length)return this.batches=[],this.schema=new jh([]),this._offsets=[0],this;let i,l;t[0]instanceof jh&&(i=t.shift()),t[t.length-1]instanceof Uint32Array&&(l=t.pop());const a=t=>{if(t){if(t instanceof Mp)return[t];if(t instanceof Qp)return t.batches;if(t instanceof _u){if(t.type instanceof tc)return[new Mp(new jh(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>a(t)));if("function"==typeof t[Symbol.iterator])return[...t].flatMap((t=>a(t)));if("object"==typeof t){const e=Object.keys(t),n=e.map((e=>new eh([t[e]]))),i=new jh(e.map(((t,e)=>new Ph(String(t),n[e].type)))),[,l]=Cp(i,n);return 0===l.length?[new Mp(t)]:l}}}return[]},r=t.flatMap((t=>a(t)));if(i=null!==(n=null!=i?i:null===(e=r[0])||void 0===e?void 0:e.schema)&&void 0!==n?n:new jh([]),!(i instanceof jh))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const o of r){if(!(o instanceof Mp))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Hp(i,o.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=r,this._offsets=null!=l?l:Hu(this.data)}get data(){return this.batches.map((({data:t})=>t))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=Lu(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return ju.visit(new eh(this.data))}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...t){const e=this.schema,n=this.data.concat(t.flatMap((({data:t})=>t)));return new Qp(e,n.map((t=>new Mp(e,t))))}slice(t,e){const n=this.schema;[t,e]=fu({length:this.numRows},t,e);const i=Cu(this.data,this._offsets,t,e);return new Qp(n,i.map((t=>new Mp(n,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:n}=this.schema.fields[t],i=Su({type:n,length:0,nullCount:0});e.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new eh(e)}return null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new eh([Su({type:new Fd,length:this.numRows})]));const l=n.fields.slice(),a=l[t].clone({type:e.type}),r=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[l[t],r[t]]=[a,e],[n,i]=Cp(n,r)}return new Qp(n,i)}select(t){const e=this.schema.fields.reduce(((t,e,n)=>t.set(e.name,n)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),n=this.batches.map((e=>e.selectAt(t)));return new Qp(e,n)}assign(t){const e=this.schema.fields,[n,i]=t.schema.fields.reduce(((t,n,i)=>{const[l,a]=t,r=e.findIndex((t=>t.name===n.name));return~r?a[r]=i:l.push(i),t}),[[],[]]),l=this.schema.assign(t.schema),a=[...e.map(((t,e)=>[e,i[e]])).map((([e,n])=>void 0===n?this.getChildAt(e):t.getChildAt(n))),...n.map((e=>t.getChildAt(e)))].filter(Boolean);return new Qp(...Cp(l,a))}}Jp=Symbol.toStringTag,Qp[Jp]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=ku(Ju),t.get=ku(du.getVisitFn(ad.Struct)),t.set=zu(kc.getVisitFn(ad.Struct)),t.indexOf=Iu(Qu.getVisitFn(ad.Struct)),t.getByteLength=ku(Au.getVisitFn(ad.Struct)),"Table"))(Qp.prototype);class Mp{constructor(...t){switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof jh))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Su({nullCount:0,type:new tc(this.schema.fields),children:this.schema.fields.map((t=>Su({type:t.type,nullCount:0})))})]=t,!(this.data instanceof _u))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Bp(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:n,children:i,length:l}=Object.keys(e).reduce(((t,n,i)=>(t.children[i]=e[n],t.length=Math.max(t.length,e[n].length),t.fields[i]=Ph.new({name:n,type:e[n].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),a=new jh(n),r=Su({type:new tc(n),length:l,children:i,nullCount:0});[this.schema,this.data]=Bp(a,r.children,l);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Up(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return du.visit(this.data,t)}set(t,e){return kc.visit(this.data,t,e)}indexOf(t,e){return Qu.visit(this.data,t,e)}getByteLength(t){return Au.visit(this.data,t)}[Symbol.iterator](){return ju.visit(new eh([this.data]))}toArray(){return[...this]}concat(...t){return new Qp(this.schema,[this,...t])}slice(t,e){const[n]=new eh([this.data]).slice(t,e).data;return new Mp(this.schema,n)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new eh([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,i=this.data;if(t>-1&&t<this.numCols){e||(e=new eh([Su({type:new Fd,length:this.numRows})]));const l=n.fields.slice(),a=i.children.slice(),r=l[t].clone({type:e.type});[l[t],a[t]]=[r,e.data[0]],n=new jh(l,new Map(this.schema.metadata)),i=Su({type:new tc(l),children:a})}return new Mp(n,i)}select(t){const e=this.schema.select(t),n=new tc(e.fields),i=[];for(const l of t){const t=this.schema.fields.findIndex((t=>t.name===l));~t&&(i[t]=this.data.children[t])}return new Mp(e,Su({type:n,length:this.numRows,children:i}))}selectAt(t){const e=this.schema.selectAt(t),n=t.map((t=>this.data.children[t])).filter(Boolean),i=Su({type:new tc(e.fields),length:this.numRows,children:n});return new Mp(e,i)}}function Bp(t,e,n=e.reduce(((t,e)=>Math.max(t,e.length)),0)){var i;const l=[...t.fields],a=[...e],r=(n+63&-64)>>3;for(const[o,s]of t.fields.entries()){const t=e[o];t&&t.length===n||(l[o]=s.clone({nullable:!0}),a[o]=null!==(i=null==t?void 0:t._changeLengthAndBackfillNullBitmap(n))&&void 0!==i?i:Su({type:s.type,length:n,nullCount:n,nullBitmap:new Uint8Array(r)}))}return[t.assign(l),Su({type:new tc(l),length:n,children:a})]}function Up(t,e,n=new Map){for(let i=-1,l=t.length;++i<l;){const l=t[i].type,a=e[i];if(Td.isDictionary(l))if(n.has(l.id)){if(n.get(l.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else a.dictionary&&n.set(l.id,a.dictionary);l.children&&l.children.length>0&&Up(l.children,a.children,n)}return n}kp=Symbol.toStringTag,Mp[kp]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Mp.prototype);class jp extends Mp{constructor(t){const e=t.fields.map((t=>Su({type:t.type})));super(t,Su({type:new tc(t.fields),nullCount:0,children:e}))}}(Ip=zp||(zp={}))[Ip.BUFFER=0]="BUFFER",(Tp=wp||(wp={}))[Tp.LZ4_FRAME=0]="LZ4_FRAME",Tp[Tp.ZSTD=1]="ZSTD";class Pp{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new Pp).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new Pp).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):wp.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):zp.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,wp.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,zp.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return Pp.startBodyCompression(t),Pp.addCodec(t,e),Pp.addMethod(t,n),Pp.endBodyCompression(t)}}class Ep{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class Op{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class Dp{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new Dp).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new Dp).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Op).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Ep).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new Pp).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}}class Ap{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new Ap).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new Ap).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Dp).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}}!function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(Fp||(Fp={}));class qp{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new qp).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new qp).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):uh.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Fp.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new gh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,uh.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,Fp.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,i,l,a){return qp.startMessage(t),qp.addVersion(t,e),qp.addHeaderType(t,n),qp.addHeader(t,i),qp.addBodyLength(t,l),qp.addCustomMetadata(t,a),qp.endMessage(t)}}var $p=sh;const tm=new class extends dc{visit(t,e){return null==t||null==e?void 0:super.visit(t,e)}visitNull(t,e){return zh.startNull(e),zh.endNull(e)}visitInt(t,e){return vh.startInt(e),vh.addBitWidth(e,t.bitWidth),vh.addIsSigned(e,t.isSigned),vh.endInt(e)}visitFloat(t,e){return Ch.startFloatingPoint(e),Ch.addPrecision(e,t.precision),Ch.endFloatingPoint(e)}visitBinary(t,e){return _h.startBinary(e),_h.endBinary(e)}visitBool(t,e){return Kh.startBool(e),Kh.endBool(e)}visitUtf8(t,e){return Qh.startUtf8(e),Qh.endUtf8(e)}visitDecimal(t,e){return Yh.startDecimal(e),Yh.addScale(e,t.scale),Yh.addPrecision(e,t.precision),Yh.addBitWidth(e,t.bitWidth),Yh.endDecimal(e)}visitDate(t,e){return Sh.startDate(e),Sh.addUnit(e,t.unit),Sh.endDate(e)}visitTime(t,e){return wh.startTime(e),wh.addUnit(e,t.unit),wh.addBitWidth(e,t.bitWidth),wh.endTime(e)}visitTimestamp(t,e){const n=t.timezone&&e.createString(t.timezone)||void 0;return Th.startTimestamp(e),Th.addUnit(e,t.unit),void 0!==n&&Th.addTimezone(e,n),Th.endTimestamp(e)}visitInterval(t,e){return Nh.startInterval(e),Nh.addUnit(e,t.unit),Nh.endInterval(e)}visitList(t,e){return Jh.startList(e),Jh.endList(e)}visitStruct(t,e){return Ih.startStruct_(e),Ih.endStruct_(e)}visitUnion(t,e){Fh.startTypeIdsVector(e,t.typeIds.length);const n=Fh.createTypeIdsVector(e,t.typeIds);return Fh.startUnion(e),Fh.addMode(e,t.mode),Fh.addTypeIds(e,n),Fh.endUnion(e)}visitDictionary(t,e){const n=this.visit(t.indices,e);return xh.startDictionaryEncoding(e),xh.addId(e,new $p(t.id,0)),xh.addIsOrdered(e,t.isOrdered),void 0!==n&&xh.addIndexType(e,n),xh.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return Lh.startFixedSizeBinary(e),Lh.addByteWidth(e,t.byteWidth),Lh.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return Hh.startFixedSizeList(e),Hh.addListSize(e,t.listSize),Hh.endFixedSizeList(e)}visitMap(t,e){return kh.startMap(e),kh.addKeysSorted(e,t.keysSorted),kh.endMap(e)}};function em(t){return new hm(t.count,im(t.columns),lm(t.columns))}function nm(t,e){return(t.children||[]).filter(Boolean).map((t=>Ph.fromJSON(t,e)))}function im(t){return(t||[]).reduce(((t,e)=>{return[...t,new bm(e.count,(n=e.VALIDITY,(n||[]).reduce(((t,e)=>t+ +(0===e)),0))),...im(e.children)];var n}),[])}function lm(t,e=[]){for(let n=-1,i=(t||[]).length;++n<i;){const i=t[n];i.VALIDITY&&e.push(new mm(e.length,i.VALIDITY.length)),i.TYPE&&e.push(new mm(e.length,i.TYPE.length)),i.OFFSET&&e.push(new mm(e.length,i.OFFSET.length)),i.DATA&&e.push(new mm(e.length,i.DATA.length)),e=lm(i.children,e)}return e}function am(t){return new Map(Object.entries(t||{}))}function rm(t){return new Qd(t.isSigned,t.bitWidth)}function om(t,e){const n=t.type.name;switch(n){case"NONE":case"null":return new Fd;case"binary":return new Ud;case"utf8":return new jd;case"bool":return new Pd;case"list":return new $d((e||[])[0]);case"struct":case"struct_":return new tc(e||[])}switch(n){case"int":{const e=t.type;return new Qd(e.isSigned,e.bitWidth)}case"floatingpoint":{const e=t.type;return new Bd(Os[e.precision])}case"decimal":{const e=t.type;return new Ed(e.scale,e.precision,e.bitWidth)}case"date":{const e=t.type;return new Od(As[e.unit])}case"time":{const e=t.type;return new Dd($s[e.unit],e.bitWidth)}case"timestamp":{const e=t.type;return new Ad($s[e.unit],e.timezone)}case"interval":{const e=t.type;return new qd(ed[e.unit])}case"union":{const n=t.type;return new ec(Ps[n.mode],n.typeIds||[],e||[])}case"fixedsizebinary":{const e=t.type;return new nc(e.byteWidth)}case"fixedsizelist":{const n=t.type;return new ic(n.listSize,(e||[])[0])}case"map":{const n=t.type;return new lc((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var sm=sh,dm=Rh,cm=Wh;class um{constructor(t,e,n,i){this._version=e,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength="number"==typeof t?t:t.low}static fromJSON(t,e){const n=new um(0,Us.V4,e);return n._createHeader=function(t,e){return()=>{switch(e){case id.Schema:return jh.fromJSON(t);case id.RecordBatch:return hm.fromJSON(t);case id.DictionaryBatch:return pm.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${id[e]}, type: ${e} }`)}}(t,e),n}static decode(t){t=new cm(ks(t));const e=qp.getRootAsMessage(t),n=e.bodyLength(),i=e.version(),l=e.headerType(),a=new um(n,i,l);return a._createHeader=function(t,e){return()=>{switch(e){case id.Schema:return jh.decode(t.header(new Bh));case id.RecordBatch:return hm.decode(t.header(new Dp),t.version());case id.DictionaryBatch:return pm.decode(t.header(new Ap),t.version())}throw new Error(`Unrecognized Message type: { name: ${id[e]}, type: ${e} }`)}}(e,l),a}static encode(t){const e=new dm;let n=-1;return t.isSchema()?n=jh.encode(e,t.header()):t.isRecordBatch()?n=hm.encode(e,t.header()):t.isDictionaryBatch()&&(n=pm.encode(e,t.header())),qp.startMessage(e),qp.addVersion(e,Us.V4),qp.addHeader(e,n),qp.addHeaderType(e,t.headerType),qp.addBodyLength(e,new sm(t.bodyLength,0)),qp.finishMessageBuffer(e,qp.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof jh)return new um(0,Us.V4,id.Schema,t);if(t instanceof hm)return new um(e,Us.V4,id.RecordBatch,t);if(t instanceof pm)return new um(e,Us.V4,id.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===id.Schema}isRecordBatch(){return this.headerType===id.RecordBatch}isDictionaryBatch(){return this.headerType===id.DictionaryBatch}}class hm{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length="number"==typeof t?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class pm{constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id="number"==typeof e?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class mm{constructor(t,e){this.offset="number"==typeof t?t:t.low,this.length="number"==typeof e?e:e.low}}class bm{constructor(t,e){this.length="number"==typeof t?t:t.low,this.nullCount="number"==typeof e?e:e.low}}function fm(t,e){const n=[];for(let i,l=-1,a=-1,r=t.childrenLength();++l<r;)(i=t.children(l))&&(n[++a]=Ph.decode(i,e));return n}function ym(t){const e=new Map;if(t)for(let n,i,l=-1,a=Math.trunc(t.customMetadataLength());++l<a;)(n=t.customMetadata(l))&&null!=(i=n.key())&&e.set(i,n.value());return e}function Zm(t){return new Qd(t.isSigned(),t.bitWidth())}function Xm(t,e){const n=t.typeType();switch(n){case Vh.NONE:case Vh.Null:return new Fd;case Vh.Binary:return new Ud;case Vh.Utf8:return new jd;case Vh.Bool:return new Pd;case Vh.List:return new $d((e||[])[0]);case Vh.Struct_:return new tc(e||[])}switch(n){case Vh.Int:{const e=t.type(new vh);return new Qd(e.isSigned(),e.bitWidth())}case Vh.FloatingPoint:{const e=t.type(new Ch);return new Bd(e.precision())}case Vh.Decimal:{const e=t.type(new Yh);return new Ed(e.scale(),e.precision(),e.bitWidth())}case Vh.Date:{const e=t.type(new Sh);return new Od(e.unit())}case Vh.Time:{const e=t.type(new wh);return new Dd(e.unit(),e.bitWidth())}case Vh.Timestamp:{const e=t.type(new Th);return new Ad(e.unit(),e.timezone())}case Vh.Interval:{const e=t.type(new Nh);return new qd(e.unit())}case Vh.Union:{const n=t.type(new Fh);return new ec(n.mode(),n.typeIdsArray()||[],e||[])}case Vh.FixedSizeBinary:{const e=t.type(new Lh);return new nc(e.byteWidth())}case Vh.FixedSizeList:{const n=t.type(new Hh);return new ic(n.listSize(),(e||[])[0])}case Vh.Map:{const n=t.type(new kh);return new lc((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${Vh[n]}" (${n})`)}Ph.encode=function(t,e){let n=-1,i=-1,l=-1;const a=e.type;let r=e.typeId;Td.isDictionary(a)?(r=a.dictionary.typeId,l=tm.visit(a,t),i=tm.visit(a.dictionary,t)):i=tm.visit(a,t);const o=(a.children||[]).map((e=>Ph.encode(t,e))),s=Mh.createChildrenVector(t,o),d=e.metadata&&e.metadata.size>0?Mh.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const i=t.createString(`${e}`),l=t.createString(`${n}`);return gh.startKeyValue(t),gh.addKey(t,i),gh.addValue(t,l),gh.endKeyValue(t)}))):-1;e.name&&(n=t.createString(e.name));Mh.startField(t),Mh.addType(t,i),Mh.addTypeType(t,r),Mh.addChildren(t,s),Mh.addNullable(t,!!e.nullable),-1!==n&&Mh.addName(t,n);-1!==l&&Mh.addDictionary(t,l);-1!==d&&Mh.addCustomMetadata(t,d);return Mh.endField(t)},Ph.decode=function(t,e){let n,i,l,a,r,o;e&&(o=t.dictionary())?e.has(n=o.id().low)?(a=(a=o.indexType())?Zm(a):new Md,r=new oc(e.get(n),a,n,o.isOrdered()),i=new Ph(t.name(),r,t.nullable(),ym(t))):(a=(a=o.indexType())?Zm(a):new Md,e.set(n,l=Xm(t,fm(t,e))),r=new oc(l,a,n,o.isOrdered()),i=new Ph(t.name(),r,t.nullable(),ym(t))):(l=Xm(t,fm(t,e)),i=new Ph(t.name(),l,t.nullable(),ym(t)));return i||null},Ph.fromJSON=function(t,e){let n,i,l,a,r,o;return e&&(a=t.dictionary)?e.has(n=a.id)?(i=(i=a.indexType)?rm(i):new Md,o=new oc(e.get(n),i,n,a.isOrdered),l=new Ph(t.name,o,t.nullable,am(t.customMetadata))):(i=(i=a.indexType)?rm(i):new Md,e.set(n,r=om(t,nm(t,e))),o=new oc(r,i,n,a.isOrdered),l=new Ph(t.name,o,t.nullable,am(t.customMetadata))):(r=om(t,nm(t,e)),l=new Ph(t.name,r,t.nullable,am(t.customMetadata))),l||null},jh.encode=function(t,e){const n=e.fields.map((e=>Ph.encode(t,e)));Bh.startFieldsVector(t,n.length);const i=Bh.createFieldsVector(t,n),l=e.metadata&&e.metadata.size>0?Bh.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const i=t.createString(`${e}`),l=t.createString(`${n}`);return gh.startKeyValue(t),gh.addKey(t,i),gh.addValue(t,l),gh.endKeyValue(t)}))):-1;Bh.startSchema(t),Bh.addFields(t,i),Bh.addEndianness(t,Gm?hh.Little:hh.Big),-1!==l&&Bh.addCustomMetadata(t,l);return Bh.endSchema(t)},jh.decode=function(t,e=new Map){const n=function(t,e){const n=[];for(let i,l=-1,a=-1,r=t.fieldsLength();++l<r;)(i=t.fields(l))&&(n[++a]=Ph.decode(i,e));return n}(t,e);return new jh(n,ym(t),e)},jh.fromJSON=function(t,e=new Map){return new jh(function(t,e){return(t.fields||[]).filter(Boolean).map((t=>Ph.fromJSON(t,e)))}(t,e),am(t.customMetadata),e)},hm.encode=function(t,e){const n=e.nodes||[],i=e.buffers||[];Dp.startNodesVector(t,n.length);for(const r of n.slice().reverse())bm.encode(t,r);const l=t.endVector();Dp.startBuffersVector(t,i.length);for(const r of i.slice().reverse())mm.encode(t,r);const a=t.endVector();return Dp.startRecordBatch(t),Dp.addLength(t,new sm(e.length,0)),Dp.addNodes(t,l),Dp.addBuffers(t,a),Dp.endRecordBatch(t)},hm.decode=function(t,e=Us.V4){return new hm(t.length(),function(t){const e=[];for(let n,i=-1,l=-1,a=t.nodesLength();++i<a;)(n=t.nodes(i))&&(e[++l]=bm.decode(n));return e}(t),function(t,e){const n=[];for(let i,l=-1,a=-1,r=t.buffersLength();++l<r;)(i=t.buffers(l))&&(e<Us.V4&&(i.bb_pos+=8*(l+1)),n[++a]=mm.decode(i));return n}(t,e))},hm.fromJSON=em,pm.encode=function(t,e){const n=hm.encode(t,e.data);return Ap.startDictionaryBatch(t),Ap.addId(t,new sm(e.id,0)),Ap.addIsDelta(t,e.isDelta),Ap.addData(t,n),Ap.endDictionaryBatch(t)},pm.decode=function(t,e=Us.V4){return new pm(hm.decode(t.data(),e),t.id(),t.isDelta())},pm.fromJSON=function(t){return new pm(em(t.data),t.id,t.isDelta)},bm.encode=function(t,e){return Op.createFieldNode(t,new sm(e.length,0),new sm(e.nullCount,0))},bm.decode=function(t){return new bm(t.length(),t.nullCount())},mm.encode=function(t,e){return Ep.createBuffer(t,new sm(e.offset,0),new sm(e.length,0))},mm.decode=function(t){return new mm(t.offset(),t.length())};const Gm=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]})(),Vm=t=>`Expected ${id[t]} Message in stream, but was null or length 0.`,Wm=t=>`Header pointer of flatbuffer-encoded ${id[t]} Message is null or length 0.`,Rm=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,gm=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class vm{constructor(t){this.source=t instanceof op?t:new op(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||-1===t.value&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?np:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Vm(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=ks(this.source.read(t));if(e.byteLength<t)throw new Error(gm(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=id.Schema,n=this.readMessage(e),i=null==n?void 0:n.header();if(t&&!i)throw new Error(Wm(e));return i}readMetadataLength(){const t=this.source.read(Km),e=t&&new Wh(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return np;if(e.byteLength<t)throw new Error(Rm(t,e.byteLength));return{done:!1,value:um.decode(e)}}}class xm{constructor(t,e){this.source=t instanceof sp?t:xs(t)?new hp(t,e):new sp(t)}[Symbol.asyncIterator](){return this}next(){return is(this,void 0,void 0,(function*(){let t;return(t=yield this.readMetadataLength()).done||-1===t.value&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?np:t}))}throw(t){return is(this,void 0,void 0,(function*(){return yield this.source.throw(t)}))}return(t){return is(this,void 0,void 0,(function*(){return yield this.source.return(t)}))}readMessage(t){return is(this,void 0,void 0,(function*(){let e;if((e=yield this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Vm(t));return e.value}))}readMessageBody(t){return is(this,void 0,void 0,(function*(){if(t<=0)return new Uint8Array(0);const e=ks(yield this.source.read(t));if(e.byteLength<t)throw new Error(gm(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}))}readSchema(t=!1){return is(this,void 0,void 0,(function*(){const e=id.Schema,n=yield this.readMessage(e),i=null==n?void 0:n.header();if(t&&!i)throw new Error(Wm(e));return i}))}readMetadataLength(){return is(this,void 0,void 0,(function*(){const t=yield this.source.read(Km),e=t&&new Wh(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}))}readMetadata(t){return is(this,void 0,void 0,(function*(){const e=yield this.source.read(t);if(!e)return np;if(e.byteLength<t)throw new Error(Rm(t,e.byteLength));return{done:!1,value:um.decode(e)}}))}}class _m extends vm{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof ip?t:new ip(t)}next(){const{_json:t}=this;if(!this._schema){this._schema=!0;return{done:!1,value:um.fromJSON(t.schema,id.Schema)}}if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];this._body=e.data.columns;return{done:!1,value:um.fromJSON(e,id.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];this._body=e.columns;return{done:!1,value:um.fromJSON(e,id.RecordBatch)}}return this._body=[],np}readMessageBody(t){return function t(e){return(e||[]).reduce(((e,n)=>[...e,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE&&[n.TYPE]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...t(n.children)]),[])}(this._body)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Vm(t));return e.value}readSchema(){const t=id.Schema,e=this.readMessage(t),n=null==e?void 0:e.header();if(!e||!n)throw new Error(Wm(t));return n}}const Km=4,Sm=new Uint8Array("ARROW1".length);for(let Wb=0;Wb<"ARROW1".length;Wb+=1)Sm[Wb]="ARROW1".codePointAt(Wb);function Ym(t,e=0){for(let n=-1,i=Sm.length;++n<i;)if(Sm[n]!==t[e+n])return!1;return!0}const Lm=Sm.length,Hm=Lm+Km,Cm=2*Lm+Km;class Nm extends lp{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return Vs(e)?e.then((()=>this)):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Fs.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Fs.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Nm?t:gs(t)?function(t){return new Jm(new Bm(t))}(t):xs(t)?function(t){return is(this,void 0,void 0,(function*(){const{size:e}=yield t.stat(),n=new hp(t,e);return e>=Cm&&Ym(yield n.readAt(0,Lm+7&-8))?new Im(new Mm(n)):new km(new Fm(n))}))}(t):Vs(t)?(()=>is(this,void 0,void 0,(function*(){return yield Nm.from(yield t)})))():_s(t)||Ss(t)||Ys(t)||Rs(t)?function(t){return is(this,void 0,void 0,(function*(){const e=yield t.peek(Lm+7&-8);return e&&e.byteLength>=4?Ym(e)?new zm(new Qm(yield t.read())):new km(new Fm(t)):new km(new Fm(function(){return rs(this,arguments,(function*(){}))}()))}))}(new sp(t)):function(t){const e=t.peek(Lm+7&-8);return e&&e.byteLength>=4?Ym(e)?new zm(new Qm(t.read())):new Jm(new Tm(t)):new Jm(new Tm(function*(){}()))}(new op(t))}static readAll(t){return t instanceof Nm?t.isSync()?jm(t):Pm(t):gs(t)||ArrayBuffer.isView(t)||Ws(t)||vs(t)?jm(t):Pm(t)}}class Jm extends Nm{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return rs(this,arguments,(function*(){yield as(yield*os(ss(this[Symbol.iterator]())))}))}}class km extends Nm{constructor(t){super(t),this._impl=t}readAll(){var t,e;return is(this,void 0,void 0,(function*(){const n=new Array;try{for(var i,l=ss(this);!(i=yield l.next()).done;){const t=i.value;n.push(t)}}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=l.return)&&(yield e.call(l))}finally{if(t)throw t.error}}return n}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class zm extends Jm{constructor(t){super(t),this._impl=t}}class Im extends km{constructor(t){super(t),this._impl=t}}class wm{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const n=this._loadVectors(t,e,this.schema.fields),i=Su({type:new tc(this.schema.fields),length:t.length,children:n});return new Mp(this.schema,i)}_loadDictionaryBatch(t,e){const{id:n,isDelta:i}=t,{dictionaries:l,schema:a}=this,r=l.get(n);if(i||!r){const l=a.dictionaries.get(n),o=this._loadVectors(t.data,e,[l]);return(r&&i?r.concat(new eh(o)):new eh(o)).memoize()}return r.memoize()}_loadVectors(t,e,n){return new Xp(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}class Tm extends wm{constructor(t,e){super(e),this._reader=gs(t)?new _m(this._handle=t):new vm(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Um(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):np}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):np}next(){if(this.closed)return np;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),i=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),i=e.readMessageBody(t.bodyLength),l=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,l)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new jp(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Fm extends wm{constructor(t,e){super(e),this._reader=new xm(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return is(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(t){return is(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=Um(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(t){return is(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):np}))}return(t){return is(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):np}))}next(){return is(this,void 0,void 0,(function*(){if(this.closed)return np;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),i=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),i=yield e.readMessageBody(t.bodyLength),l=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,l)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new jp(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(t){return is(this,void 0,void 0,(function*(){return yield this._reader.readMessage(t)}))}}class Qm extends Tm{constructor(t,e){super(t instanceof up?t:new up(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(id.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}_readDictionaryBatch(t){var e;const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(id.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,i)}}}_readFooter(){const{_handle:t}=this,e=t.size-Hm,n=t.readInt32(e),i=t.readAt(e-n,n);return $h.decode(i)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}}class Mm extends Fm{constructor(t,...e){const n="number"!=typeof e[0]?e.shift():void 0,i=e[0]instanceof Map?e.shift():void 0;super(t instanceof hp?t:new hp(t,n),i)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return is(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)}))}readRecordBatch(t){var e;return is(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(id.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}))}_readDictionaryBatch(t){var e;return is(this,void 0,void 0,(function*(){const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(id.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,i)}}}))}_readFooter(){return is(this,void 0,void 0,(function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-Hm,n=yield t.readInt32(e),i=yield t.readAt(e-n,n);return $h.decode(i)}))}_readNextMessageAndValidate(t){return is(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null}))}}class Bm extends Tm{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new Gp(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}function Um(t,e){return e&&"boolean"==typeof e.autoDestroy?e.autoDestroy:t.autoDestroy}function*jm(t){const e=Nm.from(t);try{if(!e.open({autoDestroy:!1}).closed)do{yield e}while(!e.reset().open().closed)}finally{e.cancel()}}function Pm(t){return rs(this,arguments,(function*(){const e=yield as(Nm.from(t));try{if(!(yield as(e.open({autoDestroy:!1}))).closed)do{yield yield as(e)}while(!(yield as(e.reset().open())).closed)}finally{yield as(e.cancel())}}))}function Em(t){const e=Nm.from(t);return Vs(e)?(()=>is(this,void 0,void 0,(function*(){return new Qp(yield(yield e).readAll())})))():new Qp(e.readAll())}const Om=Symbol("Comlink.proxy"),Dm=Symbol("Comlink.endpoint"),Am=Symbol("Comlink.releaseProxy"),qm=Symbol("Comlink.thrown"),$m=t=>"object"==typeof t&&null!==t||"function"==typeof t,tb=new Map([["proxy",{canHandle:t=>$m(t)&&t[Om],serialize(t){const{port1:e,port2:n}=new MessageChannel;return eb(t,e),[n,[n]]},deserialize:t=>(t.start(),ib(t))}],["throw",{canHandle:t=>$m(t)&&qm in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function eb(t,e=self){e.addEventListener("message",(function n(i){if(!i||!i.data)return;const{id:l,type:a,path:r}=Object.assign({path:[]},i.data),o=(i.data.argumentList||[]).map(cb);let s;try{const e=r.slice(0,-1).reduce(((t,e)=>t[e]),t),n=r.reduce(((t,e)=>t[e]),t);switch(a){case"GET":s=n;break;case"SET":e[r.slice(-1)[0]]=cb(i.data.value),s=!0;break;case"APPLY":s=n.apply(e,o);break;case"CONSTRUCT":s=function(t){return Object.assign(t,{[Om]:!0})}(new n(...o));break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;eb(t,n),s=sb(e,[e])}break;case"RELEASE":s=void 0;break;default:return}}catch(d){s={value:d,[qm]:0}}Promise.resolve(s).catch((t=>({value:t,[qm]:0}))).then((t=>{const[i,r]=db(t);e.postMessage(Object.assign(Object.assign({},i),{id:l}),r),"RELEASE"===a&&(e.removeEventListener("message",n),nb(e))}))})),e.start&&e.start()}function nb(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function ib(t,e){return ab(t,[],e)}function lb(t){if(t)throw new Error("Proxy has been released and is not useable")}function ab(t,e=[],n=function(){}){let i=!1;const l=new Proxy(n,{get(n,a){if(lb(i),a===Am)return()=>ub(t,{type:"RELEASE",path:e.map((t=>t.toString()))}).then((()=>{nb(t),i=!0}));if("then"===a){if(0===e.length)return{then:()=>l};const n=ub(t,{type:"GET",path:e.map((t=>t.toString()))}).then(cb);return n.then.bind(n)}return ab(t,[...e,a])},set(n,l,a){lb(i);const[r,o]=db(a);return ub(t,{type:"SET",path:[...e,l].map((t=>t.toString())),value:r},o).then(cb)},apply(n,l,a){lb(i);const r=e[e.length-1];if(r===Dm)return ub(t,{type:"ENDPOINT"}).then(cb);if("bind"===r)return ab(t,e.slice(0,-1));const[o,s]=rb(a);return ub(t,{type:"APPLY",path:e.map((t=>t.toString())),argumentList:o},s).then(cb)},construct(n,l){lb(i);const[a,r]=rb(l);return ub(t,{type:"CONSTRUCT",path:e.map((t=>t.toString())),argumentList:a},r).then(cb)}});return l}function rb(t){const e=t.map(db);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const ob=new WeakMap;function sb(t,e){return ob.set(t,e),t}function db(t){for(const[e,n]of tb)if(n.canHandle(t)){const[i,l]=n.serialize(t);return[{type:"HANDLER",name:e,value:i},l]}return[{type:"RAW",value:t},ob.get(t)||[]]}function cb(t){switch(t.type){case"HANDLER":return tb.get(t.name).deserialize(t.value);case"RAW":return t.value}}function ub(t,e,n){return new Promise((i=>{const l=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===l&&(t.removeEventListener("message",e),i(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:l},e),n)}))}class hb extends Map{get_count(t){return super.get(t)||0}get_counter(t){const e=super.get(t);return e||(super.set(t,new hb),super.get(t))}merge(t){for(let e of t.value_iter())this.add(...e)}inc(...t){this.add(1,...t)}add(t,...e){if(1===e.length)this.set(e[0],this.get_count(e[0])+t);else{this.get_counter(e[0]).add(t,...e.slice(1))}}is_counter(){}values(){return Array.from(this.value_iter())}*value_iter(){for(let[t,e]of this.entries())if(e.is_counter)for(let n of e.value_iter())yield[n[0],t,...n.slice(1)];else yield[e,t]}}const pb="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IHQ9U3ltYm9sKCJDb21saW5rLnByb3h5IiksZT1TeW1ib2woIkNvbWxpbmsuZW5kcG9pbnQiKSxpPVN5bWJvbCgiQ29tbGluay5yZWxlYXNlUHJveHkiKSxuPVN5bWJvbCgiQ29tbGluay50aHJvd24iKSxyPXQ9PiJvYmplY3QiPT10eXBlb2YgdCYmbnVsbCE9PXR8fCJmdW5jdGlvbiI9PXR5cGVvZiB0LHM9bmV3IE1hcChbWyJwcm94eSIse2NhbkhhbmRsZTplPT5yKGUpJiZlW3RdLHNlcmlhbGl6ZSh0KXtjb25zdHtwb3J0MTplLHBvcnQyOml9PW5ldyBNZXNzYWdlQ2hhbm5lbDtyZXR1cm4gbyh0LGUpLFtpLFtpXV19LGRlc2VyaWFsaXplKHQpe3JldHVybiB0LnN0YXJ0KCksYyh0LFtdLGUpO3ZhciBlfX1dLFsidGhyb3ciLHtjYW5IYW5kbGU6dD0+cih0KSYmbiBpbiB0LHNlcmlhbGl6ZSh7dmFsdWU6dH0pe2xldCBlO3JldHVybiBlPXQgaW5zdGFuY2VvZiBFcnJvcj97aXNFcnJvcjohMCx2YWx1ZTp7bWVzc2FnZTp0Lm1lc3NhZ2UsbmFtZTp0Lm5hbWUsc3RhY2s6dC5zdGFja319Ontpc0Vycm9yOiExLHZhbHVlOnR9LFtlLFtdXX0sZGVzZXJpYWxpemUodCl7aWYodC5pc0Vycm9yKXRocm93IE9iamVjdC5hc3NpZ24obmV3IEVycm9yKHQudmFsdWUubWVzc2FnZSksdC52YWx1ZSk7dGhyb3cgdC52YWx1ZX19XV0pO2Z1bmN0aW9uIG8oZSxpPXNlbGYpe2kuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGZ1bmN0aW9uIHIocyl7aWYoIXN8fCFzLmRhdGEpcmV0dXJuO2NvbnN0e2lkOmwsdHlwZTpjLHBhdGg6aH09T2JqZWN0LmFzc2lnbih7cGF0aDpbXX0scy5kYXRhKSx1PShzLmRhdGEuYXJndW1lbnRMaXN0fHxbXSkubWFwKGYpO2xldCB5O3RyeXtjb25zdCBpPWguc2xpY2UoMCwtMSkucmVkdWNlKCgodCxlKT0+dFtlXSksZSksbj1oLnJlZHVjZSgoKHQsZSk9PnRbZV0pLGUpO3N3aXRjaChjKXtjYXNlIkdFVCI6eT1uO2JyZWFrO2Nhc2UiU0VUIjppW2guc2xpY2UoLTEpWzBdXT1mKHMuZGF0YS52YWx1ZSkseT0hMDticmVhaztjYXNlIkFQUExZIjp5PW4uYXBwbHkoaSx1KTticmVhaztjYXNlIkNPTlNUUlVDVCI6eT1mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihlLHtbdF06ITB9KX0obmV3IG4oLi4udSkpO2JyZWFrO2Nhc2UiRU5EUE9JTlQiOntjb25zdHtwb3J0MTp0LHBvcnQyOml9PW5ldyBNZXNzYWdlQ2hhbm5lbDtvKGUsaSkseT1kKHQsW3RdKX1icmVhaztjYXNlIlJFTEVBU0UiOnk9dm9pZCAwO2JyZWFrO2RlZmF1bHQ6cmV0dXJufX1jYXRjaChiKXt5PXt2YWx1ZTpiLFtuXTowfX1Qcm9taXNlLnJlc29sdmUoeSkuY2F0Y2goKHQ9Pih7dmFsdWU6dCxbbl06MH0pKSkudGhlbigodD0+e2NvbnN0W2Usbl09cCh0KTtpLnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7aWQ6bH0pLG4pLCJSRUxFQVNFIj09PWMmJihpLnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLHIpLGEoaSkpfSkpfSkpLGkuc3RhcnQmJmkuc3RhcnQoKX1mdW5jdGlvbiBhKHQpeyhmdW5jdGlvbih0KXtyZXR1cm4iTWVzc2FnZVBvcnQiPT09dC5jb25zdHJ1Y3Rvci5uYW1lfSkodCkmJnQuY2xvc2UoKX1mdW5jdGlvbiBsKHQpe2lmKHQpdGhyb3cgbmV3IEVycm9yKCJQcm94eSBoYXMgYmVlbiByZWxlYXNlZCBhbmQgaXMgbm90IHVzZWFibGUiKX1mdW5jdGlvbiBjKHQsbj1bXSxyPWZ1bmN0aW9uKCl7fSl7bGV0IHM9ITE7Y29uc3Qgbz1uZXcgUHJveHkocix7Z2V0KGUscil7aWYobChzKSxyPT09aSlyZXR1cm4oKT0+eSh0LHt0eXBlOiJSRUxFQVNFIixwYXRoOm4ubWFwKCh0PT50LnRvU3RyaW5nKCkpKX0pLnRoZW4oKCgpPT57YSh0KSxzPSEwfSkpO2lmKCJ0aGVuIj09PXIpe2lmKDA9PT1uLmxlbmd0aClyZXR1cm57dGhlbjooKT0+b307Y29uc3QgZT15KHQse3R5cGU6IkdFVCIscGF0aDpuLm1hcCgodD0+dC50b1N0cmluZygpKSl9KS50aGVuKGYpO3JldHVybiBlLnRoZW4uYmluZChlKX1yZXR1cm4gYyh0LFsuLi5uLHJdKX0sc2V0KGUsaSxyKXtsKHMpO2NvbnN0W28sYV09cChyKTtyZXR1cm4geSh0LHt0eXBlOiJTRVQiLHBhdGg6Wy4uLm4saV0ubWFwKCh0PT50LnRvU3RyaW5nKCkpKSx2YWx1ZTpvfSxhKS50aGVuKGYpfSxhcHBseShpLHIsbyl7bChzKTtjb25zdCBhPW5bbi5sZW5ndGgtMV07aWYoYT09PWUpcmV0dXJuIHkodCx7dHlwZToiRU5EUE9JTlQifSkudGhlbihmKTtpZigiYmluZCI9PT1hKXJldHVybiBjKHQsbi5zbGljZSgwLC0xKSk7Y29uc3RbdSxkXT1oKG8pO3JldHVybiB5KHQse3R5cGU6IkFQUExZIixwYXRoOm4ubWFwKCh0PT50LnRvU3RyaW5nKCkpKSxhcmd1bWVudExpc3Q6dX0sZCkudGhlbihmKX0sY29uc3RydWN0KGUsaSl7bChzKTtjb25zdFtyLG9dPWgoaSk7cmV0dXJuIHkodCx7dHlwZToiQ09OU1RSVUNUIixwYXRoOm4ubWFwKCh0PT50LnRvU3RyaW5nKCkpKSxhcmd1bWVudExpc3Q6cn0sbykudGhlbihmKX19KTtyZXR1cm4gb31mdW5jdGlvbiBoKHQpe2NvbnN0IGU9dC5tYXAocCk7cmV0dXJuW2UubWFwKCh0PT50WzBdKSksKGk9ZS5tYXAoKHQ9PnRbMV0pKSxBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLGkpKV07dmFyIGl9Y29uc3QgdT1uZXcgV2Vha01hcDtmdW5jdGlvbiBkKHQsZSl7cmV0dXJuIHUuc2V0KHQsZSksdH1mdW5jdGlvbiBwKHQpe2Zvcihjb25zdFtlLGldb2YgcylpZihpLmNhbkhhbmRsZSh0KSl7Y29uc3RbbixyXT1pLnNlcmlhbGl6ZSh0KTtyZXR1cm5be3R5cGU6IkhBTkRMRVIiLG5hbWU6ZSx2YWx1ZTpufSxyXX1yZXR1cm5be3R5cGU6IlJBVyIsdmFsdWU6dH0sdS5nZXQodCl8fFtdXX1mdW5jdGlvbiBmKHQpe3N3aXRjaCh0LnR5cGUpe2Nhc2UiSEFORExFUiI6cmV0dXJuIHMuZ2V0KHQubmFtZSkuZGVzZXJpYWxpemUodC52YWx1ZSk7Y2FzZSJSQVciOnJldHVybiB0LnZhbHVlfX1mdW5jdGlvbiB5KHQsZSxpKXtyZXR1cm4gbmV3IFByb21pc2UoKG49Pntjb25zdCByPW5ldyBBcnJheSg0KS5maWxsKDApLm1hcCgoKCk9Pk1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikudG9TdHJpbmcoMTYpKSkuam9pbigiLSIpO3QuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGZ1bmN0aW9uIGUoaSl7aS5kYXRhJiZpLmRhdGEuaWQmJmkuZGF0YS5pZD09PXImJih0LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGUpLG4oaS5kYXRhKSl9KSksdC5zdGFydCYmdC5zdGFydCgpLHQucG9zdE1lc3NhZ2UoT2JqZWN0LmFzc2lnbih7aWQ6cn0sZSksaSl9KSl9ZnVuY3Rpb24gYih0LGUsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKSgoZnVuY3Rpb24ocixzKXtmdW5jdGlvbiBvKHQpe3RyeXtsKG4ubmV4dCh0KSl9Y2F0Y2goZSl7cyhlKX19ZnVuY3Rpb24gYSh0KXt0cnl7bChuLnRocm93KHQpKX1jYXRjaChlKXtzKGUpfX1mdW5jdGlvbiBsKHQpe3ZhciBlO3QuZG9uZT9yKHQudmFsdWUpOihlPXQudmFsdWUsZSBpbnN0YW5jZW9mIGk/ZTpuZXcgaSgoZnVuY3Rpb24odCl7dChlKX0pKSkudGhlbihvLGEpfWwoKG49bi5hcHBseSh0LGV8fFtdKSkubmV4dCgpKX0pKX1mdW5jdGlvbiBnKHQpe3ZhciBlPSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJlN5bWJvbC5pdGVyYXRvcixpPWUmJnRbZV0sbj0wO2lmKGkpcmV0dXJuIGkuY2FsbCh0KTtpZih0JiYibnVtYmVyIj09dHlwZW9mIHQubGVuZ3RoKXJldHVybntuZXh0OmZ1bmN0aW9uKCl7cmV0dXJuIHQmJm4+PXQubGVuZ3RoJiYodD12b2lkIDApLHt2YWx1ZTp0JiZ0W24rK10sZG9uZTohdH19fTt0aHJvdyBuZXcgVHlwZUVycm9yKGU/Ik9iamVjdCBpcyBub3QgaXRlcmFibGUuIjoiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpfWZ1bmN0aW9uIG0odCl7cmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBtPyh0aGlzLnY9dCx0aGlzKTpuZXcgbSh0KX1mdW5jdGlvbiBfKHQsZSxpKXtpZighU3ltYm9sLmFzeW5jSXRlcmF0b3IpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7dmFyIG4scj1pLmFwcGx5KHQsZXx8W10pLHM9W107cmV0dXJuIG49e30sbygibmV4dCIpLG8oInRocm93IiksbygicmV0dXJuIiksbltTeW1ib2wuYXN5bmNJdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sbjtmdW5jdGlvbiBvKHQpe3JbdF0mJihuW3RdPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24oaSxuKXtzLnB1c2goW3QsZSxpLG5dKT4xfHxhKHQsZSl9KSl9KX1mdW5jdGlvbiBhKHQsZSl7dHJ5eyhpPXJbdF0oZSkpLnZhbHVlIGluc3RhbmNlb2YgbT9Qcm9taXNlLnJlc29sdmUoaS52YWx1ZS52KS50aGVuKGwsYyk6aChzWzBdWzJdLGkpfWNhdGNoKG4pe2goc1swXVszXSxuKX12YXIgaX1mdW5jdGlvbiBsKHQpe2EoIm5leHQiLHQpfWZ1bmN0aW9uIGModCl7YSgidGhyb3ciLHQpfWZ1bmN0aW9uIGgodCxlKXt0KGUpLHMuc2hpZnQoKSxzLmxlbmd0aCYmYShzWzBdWzBdLHNbMF1bMV0pfX1mdW5jdGlvbiB2KHQpe3ZhciBlLGk7cmV0dXJuIGU9e30sbigibmV4dCIpLG4oInRocm93IiwoZnVuY3Rpb24odCl7dGhyb3cgdH0pKSxuKCJyZXR1cm4iKSxlW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sZTtmdW5jdGlvbiBuKG4scil7ZVtuXT10W25dP2Z1bmN0aW9uKGUpe3JldHVybihpPSFpKT97dmFsdWU6bSh0W25dKGUpKSxkb25lOiJyZXR1cm4iPT09bn06cj9yKGUpOmV9OnJ9fWZ1bmN0aW9uIHcodCl7aWYoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKXRocm93IG5ldyBUeXBlRXJyb3IoIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpO3ZhciBlLGk9dFtTeW1ib2wuYXN5bmNJdGVyYXRvcl07cmV0dXJuIGk/aS5jYWxsKHQpOih0PWcodCksZT17fSxuKCJuZXh0IiksbigidGhyb3ciKSxuKCJyZXR1cm4iKSxlW1N5bWJvbC5hc3luY0l0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxlKTtmdW5jdGlvbiBuKGkpe2VbaV09dFtpXSYmZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihuLHIpeyhmdW5jdGlvbih0LGUsaSxuKXtQcm9taXNlLnJlc29sdmUobikudGhlbigoZnVuY3Rpb24oZSl7dCh7dmFsdWU6ZSxkb25lOml9KX0pLGUpfSkobixyLChlPXRbaV0oZSkpLmRvbmUsZS52YWx1ZSl9KSl9fX1jb25zdCBJPW5ldyBUZXh0RGVjb2RlcigidXRmLTgiKSxTPXQ9PkkuZGVjb2RlKHQpLEI9bmV3IFRleHRFbmNvZGVyLEE9dD0+Qi5lbmNvZGUodCksW1QsT109KCgpPT57Y29uc3QgdD0oKT0+e3Rocm93IG5ldyBFcnJvcigiQmlnSW50IGlzIG5vdCBhdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCIpfTtmdW5jdGlvbiBlKCl7dGhyb3cgdCgpfXJldHVybiBlLmFzSW50Tj0oKT0+e3Rocm93IHQoKX0sZS5hc1VpbnROPSgpPT57dGhyb3cgdCgpfSwidW5kZWZpbmVkIiE9dHlwZW9mIEJpZ0ludD9bQmlnSW50LCEwXTpbZSwhMV19KSgpLFtELHhdPSgoKT0+e2NvbnN0IHQ9KCk9Pnt0aHJvdyBuZXcgRXJyb3IoIkJpZ0ludDY0QXJyYXkgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Iil9O3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgQmlnSW50NjRBcnJheT9bQmlnSW50NjRBcnJheSwhMF06W2NsYXNze3N0YXRpYyBnZXQgQllURVNfUEVSX0VMRU1FTlQoKXtyZXR1cm4gOH1zdGF0aWMgb2YoKXt0aHJvdyB0KCl9c3RhdGljIGZyb20oKXt0aHJvdyB0KCl9Y29uc3RydWN0b3IoKXt0aHJvdyB0KCl9fSwhMV19KSgpLFtNLEZdPSgoKT0+e2NvbnN0IHQ9KCk9Pnt0aHJvdyBuZXcgRXJyb3IoIkJpZ1VpbnQ2NEFycmF5IGlzIG5vdCBhdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCIpfTtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIEJpZ1VpbnQ2NEFycmF5P1tCaWdVaW50NjRBcnJheSwhMF06W2NsYXNze3N0YXRpYyBnZXQgQllURVNfUEVSX0VMRU1FTlQoKXtyZXR1cm4gOH1zdGF0aWMgb2YoKXt0aHJvdyB0KCl9c3RhdGljIGZyb20oKXt0aHJvdyB0KCl9Y29uc3RydWN0b3IoKXt0aHJvdyB0KCl9fSwhMV19KSgpLEw9dD0+ImJvb2xlYW4iPT10eXBlb2YgdCxOPXQ9PiJmdW5jdGlvbiI9PXR5cGVvZiB0LFU9dD0+bnVsbCE9dCYmT2JqZWN0KHQpPT09dCxDPXQ9PlUodCkmJk4odC50aGVuKSxFPXQ9PlUodCkmJk4odFtTeW1ib2wuaXRlcmF0b3JdKSxWPXQ9PlUodCkmJk4odFtTeW1ib2wuYXN5bmNJdGVyYXRvcl0pLFI9dD0+VSh0KSYmVSh0LnNjaGVtYSksej10PT5VKHQpJiYiZG9uZSJpbiB0JiYidmFsdWUiaW4gdCxQPXQ9PlUodCkmJk4odC5zdGF0KSYmKHQ9PiJudW1iZXIiPT10eXBlb2YgdCkodC5mZCksaj10PT5VKHQpJiYkKHQuYm9keSksaz10PT4iX2dldERPTVN0cmVhbSJpbiB0JiYiX2dldE5vZGVTdHJlYW0iaW4gdCwkPXQ9PlUodCkmJk4odC5jYW5jZWwpJiZOKHQuZ2V0UmVhZGVyKSYmIWsodCksWT10PT5VKHQpJiZOKHQucmVhZCkmJk4odC5waXBlKSYmTCh0LnJlYWRhYmxlKSYmIWsodCksVz0idW5kZWZpbmVkIiE9dHlwZW9mIFNoYXJlZEFycmF5QnVmZmVyP1NoYXJlZEFycmF5QnVmZmVyOkFycmF5QnVmZmVyO2Z1bmN0aW9uIEgodCxlLGk9MCxuPWUuYnl0ZUxlbmd0aCl7Y29uc3Qgcj10LmJ5dGVMZW5ndGgscz1uZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQsciksbz1uZXcgVWludDhBcnJheShlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQsTWF0aC5taW4obixyKSk7cmV0dXJuIHMuc2V0KG8saSksdH1mdW5jdGlvbiBLKHQsZSl7Y29uc3QgaT1mdW5jdGlvbih0KXtjb25zdCBlPXRbMF0/W3RbMF1dOltdO2xldCBpLG4scixzO2ZvcihsZXQgbyxhLGw9MCxjPTAsaD10Lmxlbmd0aDsrK2w8aDspbz1lW2NdLGE9dFtsXSwhb3x8IWF8fG8uYnVmZmVyIT09YS5idWZmZXJ8fGEuYnl0ZU9mZnNldDxvLmJ5dGVPZmZzZXQ/YSYmKGVbKytjXT1hKTooKHtieXRlT2Zmc2V0OmksYnl0ZUxlbmd0aDpyfT1vKSwoe2J5dGVPZmZzZXQ6bixieXRlTGVuZ3RoOnN9PWEpLGkrcjxufHxuK3M8aT9hJiYoZVsrK2NdPWEpOmVbY109bmV3IFVpbnQ4QXJyYXkoby5idWZmZXIsaSxuLWkrcykpO3JldHVybiBlfSh0KSxuPWkucmVkdWNlKCgodCxlKT0+dCtlLmJ5dGVMZW5ndGgpLDApO2xldCByLHMsbyxhPTAsbD0tMTtjb25zdCBjPU1hdGgubWluKGV8fE51bWJlci5QT1NJVElWRV9JTkZJTklUWSxuKTtmb3IoY29uc3QgaD1pLmxlbmd0aDsrK2w8aDspe2lmKHI9aVtsXSxzPXIuc3ViYXJyYXkoMCxNYXRoLm1pbihyLmxlbmd0aCxjLWEpKSxjPD1hK3MubGVuZ3RoKXtzLmxlbmd0aDxyLmxlbmd0aD9pW2xdPXIuc3ViYXJyYXkocy5sZW5ndGgpOnMubGVuZ3RoPT09ci5sZW5ndGgmJmwrKyxvP0gobyxzLGEpOm89czticmVha31IKG98fChvPW5ldyBVaW50OEFycmF5KGMpKSxzLGEpLGErPXMubGVuZ3RofXJldHVybltvfHxuZXcgVWludDhBcnJheSgwKSxpLnNsaWNlKGwpLG4tKG8/by5ieXRlTGVuZ3RoOjApXX1mdW5jdGlvbiBKKHQsZSl7bGV0IGk9eihlKT9lLnZhbHVlOmU7cmV0dXJuIGkgaW5zdGFuY2VvZiB0P3Q9PT1VaW50OEFycmF5P25ldyB0KGkuYnVmZmVyLGkuYnl0ZU9mZnNldCxpLmJ5dGVMZW5ndGgpOmk6aT8oInN0cmluZyI9PXR5cGVvZiBpJiYoaT1BKGkpKSxpIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fGkgaW5zdGFuY2VvZiBXP25ldyB0KGkpOlUobj1pKSYmTihuLmNsZWFyKSYmTihuLmJ5dGVzKSYmTihuLnBvc2l0aW9uKSYmTihuLnNldFBvc2l0aW9uKSYmTihuLmNhcGFjaXR5KSYmTihuLmdldEJ1ZmZlcklkZW50aWZpZXIpJiZOKG4uY3JlYXRlTG9uZyk/Sih0LGkuYnl0ZXMoKSk6QXJyYXlCdWZmZXIuaXNWaWV3KGkpP2kuYnl0ZUxlbmd0aDw9MD9uZXcgdCgwKTpuZXcgdChpLmJ1ZmZlcixpLmJ5dGVPZmZzZXQsaS5ieXRlTGVuZ3RoL3QuQllURVNfUEVSX0VMRU1FTlQpOnQuZnJvbShpKSk6bmV3IHQoMCk7dmFyIG59Y29uc3QgRz10PT5KKEludDMyQXJyYXksdCksWj10PT5KKFVpbnQ4QXJyYXksdCkscT10PT4odC5uZXh0KCksdCk7Y29uc3QgUT10PT5mdW5jdGlvbioodCxlKXtjb25zdCBpPWZ1bmN0aW9uKih0KXt5aWVsZCB0fSxuPSJzdHJpbmciPT10eXBlb2YgZXx8QXJyYXlCdWZmZXIuaXNWaWV3KGUpfHxlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fGUgaW5zdGFuY2VvZiBXP2koZSk6RShlKT9lOmkoZSk7cmV0dXJuIHlpZWxkKnEoZnVuY3Rpb24qKGUpe2xldCBpPW51bGw7ZG97aT1lLm5leHQoeWllbGQgSih0LGkpKX13aGlsZSghaS5kb25lKX0obltTeW1ib2wuaXRlcmF0b3JdKCkpKSxuZXcgdH0oVWludDhBcnJheSx0KTtmdW5jdGlvbiBYKHQsZSl7cmV0dXJuIF8odGhpcyxhcmd1bWVudHMsKGZ1bmN0aW9uKigpe2lmKEMoZSkpcmV0dXJuIHlpZWxkIG0oeWllbGQgbSh5aWVsZCp2KHcoWCh0LHlpZWxkIG0oZSkpKSkpKTtjb25zdCBpPWZ1bmN0aW9uKHQpe3JldHVybiBfKHRoaXMsYXJndW1lbnRzLChmdW5jdGlvbiooKXt5aWVsZCB5aWVsZCBtKHlpZWxkIG0odCkpfSkpfSxuPSJzdHJpbmciPT10eXBlb2YgZXx8QXJyYXlCdWZmZXIuaXNWaWV3KGUpfHxlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fGUgaW5zdGFuY2VvZiBXP2koZSk6RShlKT9mdW5jdGlvbih0KXtyZXR1cm4gXyh0aGlzLGFyZ3VtZW50cywoZnVuY3Rpb24qKCl7eWllbGQgbSh5aWVsZCp2KHcocShmdW5jdGlvbioodCl7bGV0IGU9bnVsbDtkb3tlPXQubmV4dCh5aWVsZCBudWxsPT1lP3ZvaWQgMDplLnZhbHVlKX13aGlsZSghZS5kb25lKX0odFtTeW1ib2wuaXRlcmF0b3JdKCkpKSkpKX0pKX0oZSk6VihlKT9lOmkoZSk7cmV0dXJuIHlpZWxkIG0oeWllbGQqdih3KHEoZnVuY3Rpb24oZSl7cmV0dXJuIF8odGhpcyxhcmd1bWVudHMsKGZ1bmN0aW9uKigpe2xldCBpPW51bGw7ZG97aT15aWVsZCBtKGUubmV4dCh5aWVsZCB5aWVsZCBtKEoodCxpKSkpKX13aGlsZSghaS5kb25lKX0pKX0obltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSkpKSkpLHlpZWxkIG0obmV3IHQpfSkpfWNvbnN0IHR0PXQ9PlgoVWludDhBcnJheSx0KTtmdW5jdGlvbiBldCh0LGUsaSl7aWYoMCE9PXQpe2k9aS5zbGljZSgwLGUrMSk7Zm9yKGxldCBuPS0xOysrbjw9ZTspaVtuXSs9dH1yZXR1cm4gaX12YXIgaXQ9e2Zyb21JdGVyYWJsZTp0PT5udChmdW5jdGlvbioodCl7bGV0IGUsaSxuLHIscz0hMSxvPVtdLGE9MDtmdW5jdGlvbiBsKCl7cmV0dXJuInBlZWsiPT09bj9LKG8scilbMF06KFtpLG8sYV09SyhvLHIpLGkpfSh7Y21kOm4sc2l6ZTpyfT15aWVsZCBudWxsKTtjb25zdCBjPVEodClbU3ltYm9sLml0ZXJhdG9yXSgpO3RyeXtkb3tpZigoe2RvbmU6ZSx2YWx1ZTppfT1OdW1iZXIuaXNOYU4oci1hKT9jLm5leHQoKTpjLm5leHQoci1hKSksIWUmJmkuYnl0ZUxlbmd0aD4wJiYoby5wdXNoKGkpLGErPWkuYnl0ZUxlbmd0aCksZXx8cjw9YSlkb3soe2NtZDpuLHNpemU6cn09eWllbGQgbCgpKX13aGlsZShyPGEpfXdoaWxlKCFlKX1jYXRjaChoKXsocz0hMCkmJiJmdW5jdGlvbiI9PXR5cGVvZiBjLnRocm93JiZjLnRocm93KGgpfWZpbmFsbHl7ITE9PT1zJiYiZnVuY3Rpb24iPT10eXBlb2YgYy5yZXR1cm4mJmMucmV0dXJuKG51bGwpfXJldHVybiBudWxsfSh0KSksZnJvbUFzeW5jSXRlcmFibGU6dD0+bnQoZnVuY3Rpb24odCl7cmV0dXJuIF8odGhpcyxhcmd1bWVudHMsKGZ1bmN0aW9uKigpe2xldCBlLGksbixyLHM9ITEsbz1bXSxhPTA7ZnVuY3Rpb24gbCgpe3JldHVybiJwZWVrIj09PW4/SyhvLHIpWzBdOihbaSxvLGFdPUsobyxyKSxpKX0oe2NtZDpuLHNpemU6cn09eWllbGQgeWllbGQgbShudWxsKSk7Y29uc3QgYz10dCh0KVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKTt0cnl7ZG97aWYoKHtkb25lOmUsdmFsdWU6aX09TnVtYmVyLmlzTmFOKHItYSk/eWllbGQgbShjLm5leHQoKSk6eWllbGQgbShjLm5leHQoci1hKSkpLCFlJiZpLmJ5dGVMZW5ndGg+MCYmKG8ucHVzaChpKSxhKz1pLmJ5dGVMZW5ndGgpLGV8fHI8PWEpZG97KHtjbWQ6bixzaXplOnJ9PXlpZWxkIHlpZWxkIG0obCgpKSl9d2hpbGUocjxhKX13aGlsZSghZSl9Y2F0Y2goaCl7KHM9ITApJiYiZnVuY3Rpb24iPT10eXBlb2YgYy50aHJvdyYmKHlpZWxkIG0oYy50aHJvdyhoKSkpfWZpbmFsbHl7ITE9PT1zJiYiZnVuY3Rpb24iPT10eXBlb2YgYy5yZXR1cm4mJih5aWVsZCBtKGMucmV0dXJuKG5ldyBVaW50OEFycmF5KDApKSkpfXJldHVybiB5aWVsZCBtKG51bGwpfSkpfSh0KSksZnJvbURPTVN0cmVhbTp0PT5udChmdW5jdGlvbih0KXtyZXR1cm4gXyh0aGlzLGFyZ3VtZW50cywoZnVuY3Rpb24qKCl7bGV0IGUsaSxuLHI9ITEscz0hMSxvPVtdLGE9MDtmdW5jdGlvbiBsKCl7cmV0dXJuInBlZWsiPT09aT9LKG8sbilbMF06KFtlLG8sYV09SyhvLG4pLGUpfSh7Y21kOmksc2l6ZTpufT15aWVsZCB5aWVsZCBtKG51bGwpKTtjb25zdCBjPW5ldyBydCh0KTt0cnl7ZG97aWYoKHtkb25lOnIsdmFsdWU6ZX09TnVtYmVyLmlzTmFOKG4tYSk/eWllbGQgbShjLnJlYWQoKSk6eWllbGQgbShjLnJlYWQobi1hKSkpLCFyJiZlLmJ5dGVMZW5ndGg+MCYmKG8ucHVzaChaKGUpKSxhKz1lLmJ5dGVMZW5ndGgpLHJ8fG48PWEpZG97KHtjbWQ6aSxzaXplOm59PXlpZWxkIHlpZWxkIG0obCgpKSl9d2hpbGUobjxhKX13aGlsZSghcil9Y2F0Y2goaCl7KHM9ITApJiYoeWllbGQgbShjLmNhbmNlbChoKSkpfWZpbmFsbHl7ITE9PT1zP3lpZWxkIG0oYy5jYW5jZWwoKSk6dC5sb2NrZWQmJmMucmVsZWFzZUxvY2soKX1yZXR1cm4geWllbGQgbShudWxsKX0pKX0odCkpLGZyb21Ob2RlU3RyZWFtOnQ9Pm50KGZ1bmN0aW9uKHQpe3JldHVybiBfKHRoaXMsYXJndW1lbnRzLChmdW5jdGlvbiooKXtjb25zdCBlPVtdO2xldCBpLG4scixzPSJlcnJvciIsbz0hMSxhPW51bGwsbD0wLGM9W107ZnVuY3Rpb24gaCgpe3JldHVybiJwZWVrIj09PWk/SyhjLG4pWzBdOihbcixjLGxdPUsoYyxuKSxyKX1pZigoe2NtZDppLHNpemU6bn09eWllbGQgeWllbGQgbShudWxsKSksdC5pc1RUWSlyZXR1cm4geWllbGQgeWllbGQgbShuZXcgVWludDhBcnJheSgwKSkseWllbGQgbShudWxsKTt0cnl7ZVswXT1zdCh0LCJlbmQiKSxlWzFdPXN0KHQsImVycm9yIik7ZG97aWYoZVsyXT1zdCh0LCJyZWFkYWJsZSIpLFtzLGFdPXlpZWxkIG0oUHJvbWlzZS5yYWNlKGUubWFwKCh0PT50WzJdKSkpKSwiZXJyb3IiPT09cylicmVhaztpZigobz0iZW5kIj09PXMpfHwoTnVtYmVyLmlzRmluaXRlKG4tbCk/KHI9Wih0LnJlYWQobi1sKSksci5ieXRlTGVuZ3RoPG4tbCYmKHI9Wih0LnJlYWQoKSkpKTpyPVoodC5yZWFkKCkpLHIuYnl0ZUxlbmd0aD4wJiYoYy5wdXNoKHIpLGwrPXIuYnl0ZUxlbmd0aCkpLG98fG48PWwpZG97KHtjbWQ6aSxzaXplOm59PXlpZWxkIHlpZWxkIG0oaCgpKSl9d2hpbGUobjxsKX13aGlsZSghbyl9ZmluYWxseXt5aWVsZCBtKHUoZSwiZXJyb3IiPT09cz9hOm51bGwpKX1yZXR1cm4geWllbGQgbShudWxsKTtmdW5jdGlvbiB1KGUsaSl7cmV0dXJuIHI9Yz1udWxsLG5ldyBQcm9taXNlKCgobixyKT0+e2Zvcihjb25zdFtpLG9db2YgZSl0Lm9mZihpLG8pO3RyeXtjb25zdCBlPXQuZGVzdHJveTtlJiZlLmNhbGwodCxpKSxpPXZvaWQgMH1jYXRjaChzKXtpPXN8fGl9ZmluYWxseXtudWxsIT1pP3IoaSk6bigpfX0pKX19KSl9KHQpKSx0b0RPTVN0cmVhbSh0LGUpe3Rocm93IG5ldyBFcnJvcignInRvRE9NU3RyZWFtIiBub3QgYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKX0sdG9Ob2RlU3RyZWFtKHQsZSl7dGhyb3cgbmV3IEVycm9yKCcidG9Ob2RlU3RyZWFtIiBub3QgYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKX19O2NvbnN0IG50PXQ9Pih0Lm5leHQoKSx0KTtjbGFzcyBydHtjb25zdHJ1Y3Rvcih0KXt0aGlzLnNvdXJjZT10LHRoaXMucmVhZGVyPW51bGwsdGhpcy5yZWFkZXI9dGhpcy5zb3VyY2UuZ2V0UmVhZGVyKCksdGhpcy5yZWFkZXIuY2xvc2VkLmNhdGNoKCgoKT0+e30pKX1nZXQgY2xvc2VkKCl7cmV0dXJuIHRoaXMucmVhZGVyP3RoaXMucmVhZGVyLmNsb3NlZC5jYXRjaCgoKCk9Pnt9KSk6UHJvbWlzZS5yZXNvbHZlKCl9cmVsZWFzZUxvY2soKXt0aGlzLnJlYWRlciYmdGhpcy5yZWFkZXIucmVsZWFzZUxvY2soKSx0aGlzLnJlYWRlcj1udWxsfWNhbmNlbCh0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2NvbnN0e3JlYWRlcjplLHNvdXJjZTppfT10aGlzO2UmJih5aWVsZCBlLmNhbmNlbCh0KS5jYXRjaCgoKCk9Pnt9KSkpLGkmJmkubG9ja2VkJiZ0aGlzLnJlbGVhc2VMb2NrKCl9KSl9cmVhZCh0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2lmKDA9PT10KXJldHVybntkb25lOm51bGw9PXRoaXMucmVhZGVyLHZhbHVlOm5ldyBVaW50OEFycmF5KDApfTtjb25zdCBlPXlpZWxkIHRoaXMucmVhZGVyLnJlYWQoKTtyZXR1cm4hZS5kb25lJiYoZS52YWx1ZT1aKGUpKSxlfSkpfX1jb25zdCBzdD0odCxlKT0+e2NvbnN0IGk9dD0+bihbZSx0XSk7bGV0IG47cmV0dXJuW2UsaSxuZXcgUHJvbWlzZSgocj0+KG49cikmJnQub25jZShlLGkpKSldfTt2YXIgb3QsYXQsbHQsY3QsaHQsdXQsZHQscHQsZnQseXQsYnQsZ3QsbXQsX3QsdnQsd3QsSXQsU3Q7KGF0PW90fHwob3Q9e30pKVthdC5WMT0wXT0iVjEiLGF0W2F0LlYyPTFdPSJWMiIsYXRbYXQuVjM9Ml09IlYzIixhdFthdC5WND0zXT0iVjQiLGF0W2F0LlY1PTRdPSJWNSIsKGN0PWx0fHwobHQ9e30pKVtjdC5TcGFyc2U9MF09IlNwYXJzZSIsY3RbY3QuRGVuc2U9MV09IkRlbnNlIiwodXQ9aHR8fChodD17fSkpW3V0LkhBTEY9MF09IkhBTEYiLHV0W3V0LlNJTkdMRT0xXT0iU0lOR0xFIix1dFt1dC5ET1VCTEU9Ml09IkRPVUJMRSIsKHB0PWR0fHwoZHQ9e30pKVtwdC5EQVk9MF09IkRBWSIscHRbcHQuTUlMTElTRUNPTkQ9MV09Ik1JTExJU0VDT05EIiwoeXQ9ZnR8fChmdD17fSkpW3l0LlNFQ09ORD0wXT0iU0VDT05EIix5dFt5dC5NSUxMSVNFQ09ORD0xXT0iTUlMTElTRUNPTkQiLHl0W3l0Lk1JQ1JPU0VDT05EPTJdPSJNSUNST1NFQ09ORCIseXRbeXQuTkFOT1NFQ09ORD0zXT0iTkFOT1NFQ09ORCIsKGd0PWJ0fHwoYnQ9e30pKVtndC5ZRUFSX01PTlRIPTBdPSJZRUFSX01PTlRIIixndFtndC5EQVlfVElNRT0xXT0iREFZX1RJTUUiLGd0W2d0Lk1PTlRIX0RBWV9OQU5PPTJdPSJNT05USF9EQVlfTkFOTyIsKF90PW10fHwobXQ9e30pKVtfdC5OT05FPTBdPSJOT05FIixfdFtfdC5TY2hlbWE9MV09IlNjaGVtYSIsX3RbX3QuRGljdGlvbmFyeUJhdGNoPTJdPSJEaWN0aW9uYXJ5QmF0Y2giLF90W190LlJlY29yZEJhdGNoPTNdPSJSZWNvcmRCYXRjaCIsX3RbX3QuVGVuc29yPTRdPSJUZW5zb3IiLF90W190LlNwYXJzZVRlbnNvcj01XT0iU3BhcnNlVGVuc29yIiwod3Q9dnR8fCh2dD17fSkpW3d0Lk5PTkU9MF09Ik5PTkUiLHd0W3d0Lk51bGw9MV09Ik51bGwiLHd0W3d0LkludD0yXT0iSW50Iix3dFt3dC5GbG9hdD0zXT0iRmxvYXQiLHd0W3d0LkJpbmFyeT00XT0iQmluYXJ5Iix3dFt3dC5VdGY4PTVdPSJVdGY4Iix3dFt3dC5Cb29sPTZdPSJCb29sIix3dFt3dC5EZWNpbWFsPTddPSJEZWNpbWFsIix3dFt3dC5EYXRlPThdPSJEYXRlIix3dFt3dC5UaW1lPTldPSJUaW1lIix3dFt3dC5UaW1lc3RhbXA9MTBdPSJUaW1lc3RhbXAiLHd0W3d0LkludGVydmFsPTExXT0iSW50ZXJ2YWwiLHd0W3d0Lkxpc3Q9MTJdPSJMaXN0Iix3dFt3dC5TdHJ1Y3Q9MTNdPSJTdHJ1Y3QiLHd0W3d0LlVuaW9uPTE0XT0iVW5pb24iLHd0W3d0LkZpeGVkU2l6ZUJpbmFyeT0xNV09IkZpeGVkU2l6ZUJpbmFyeSIsd3Rbd3QuRml4ZWRTaXplTGlzdD0xNl09IkZpeGVkU2l6ZUxpc3QiLHd0W3d0Lk1hcD0xN109Ik1hcCIsd3Rbd3QuRGljdGlvbmFyeT0tMV09IkRpY3Rpb25hcnkiLHd0W3d0LkludDg9LTJdPSJJbnQ4Iix3dFt3dC5JbnQxNj0tM109IkludDE2Iix3dFt3dC5JbnQzMj0tNF09IkludDMyIix3dFt3dC5JbnQ2ND0tNV09IkludDY0Iix3dFt3dC5VaW50OD0tNl09IlVpbnQ4Iix3dFt3dC5VaW50MTY9LTddPSJVaW50MTYiLHd0W3d0LlVpbnQzMj0tOF09IlVpbnQzMiIsd3Rbd3QuVWludDY0PS05XT0iVWludDY0Iix3dFt3dC5GbG9hdDE2PS0xMF09IkZsb2F0MTYiLHd0W3d0LkZsb2F0MzI9LTExXT0iRmxvYXQzMiIsd3Rbd3QuRmxvYXQ2ND0tMTJdPSJGbG9hdDY0Iix3dFt3dC5EYXRlRGF5PS0xM109IkRhdGVEYXkiLHd0W3d0LkRhdGVNaWxsaXNlY29uZD0tMTRdPSJEYXRlTWlsbGlzZWNvbmQiLHd0W3d0LlRpbWVzdGFtcFNlY29uZD0tMTVdPSJUaW1lc3RhbXBTZWNvbmQiLHd0W3d0LlRpbWVzdGFtcE1pbGxpc2Vjb25kPS0xNl09IlRpbWVzdGFtcE1pbGxpc2Vjb25kIix3dFt3dC5UaW1lc3RhbXBNaWNyb3NlY29uZD0tMTddPSJUaW1lc3RhbXBNaWNyb3NlY29uZCIsd3Rbd3QuVGltZXN0YW1wTmFub3NlY29uZD0tMThdPSJUaW1lc3RhbXBOYW5vc2Vjb25kIix3dFt3dC5UaW1lU2Vjb25kPS0xOV09IlRpbWVTZWNvbmQiLHd0W3d0LlRpbWVNaWxsaXNlY29uZD0tMjBdPSJUaW1lTWlsbGlzZWNvbmQiLHd0W3d0LlRpbWVNaWNyb3NlY29uZD0tMjFdPSJUaW1lTWljcm9zZWNvbmQiLHd0W3d0LlRpbWVOYW5vc2Vjb25kPS0yMl09IlRpbWVOYW5vc2Vjb25kIix3dFt3dC5EZW5zZVVuaW9uPS0yM109IkRlbnNlVW5pb24iLHd0W3d0LlNwYXJzZVVuaW9uPS0yNF09IlNwYXJzZVVuaW9uIix3dFt3dC5JbnRlcnZhbERheVRpbWU9LTI1XT0iSW50ZXJ2YWxEYXlUaW1lIix3dFt3dC5JbnRlcnZhbFllYXJNb250aD0tMjZdPSJJbnRlcnZhbFllYXJNb250aCIsKFN0PUl0fHwoSXQ9e30pKVtTdC5PRkZTRVQ9MF09Ik9GRlNFVCIsU3RbU3QuREFUQT0xXT0iREFUQSIsU3RbU3QuVkFMSURJVFk9Ml09IlZBTElESVRZIixTdFtTdC5UWVBFPTNdPSJUWVBFIjtmdW5jdGlvbiBCdCh0KXtpZihudWxsPT09dClyZXR1cm4ibnVsbCI7aWYodW5kZWZpbmVkPT09dClyZXR1cm4idW5kZWZpbmVkIjtzd2l0Y2godHlwZW9mIHQpe2Nhc2UibnVtYmVyIjpjYXNlImJpZ2ludCI6cmV0dXJuYCR7dH1gO2Nhc2Uic3RyaW5nIjpyZXR1cm5gIiR7dH0iYH1yZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdFtTeW1ib2wudG9QcmltaXRpdmVdP3RbU3ltYm9sLnRvUHJpbWl0aXZlXSgic3RyaW5nIik6QXJyYXlCdWZmZXIuaXNWaWV3KHQpP3QgaW5zdGFuY2VvZiBCaWdJbnQ2NEFycmF5fHx0IGluc3RhbmNlb2YgQmlnVWludDY0QXJyYXk/YFske1suLi50XS5tYXAoKHQ9PkJ0KHQpKSl9XWA6YFske3R9XWA6QXJyYXlCdWZmZXIuaXNWaWV3KHQpP2BbJHt0fV1gOkpTT04uc3RyaW5naWZ5KHQsKCh0LGUpPT4iYmlnaW50Ij09dHlwZW9mIGU/YCR7ZX1gOmUpKX1jb25zdCBBdD1TeW1ib2wuZm9yKCJpc0Fycm93QmlnTnVtIik7ZnVuY3Rpb24gVHQodCwuLi5lKXtyZXR1cm4gMD09PWUubGVuZ3RoP09iamVjdC5zZXRQcm90b3R5cGVPZihKKHRoaXMuVHlwZWRBcnJheSx0KSx0aGlzLmNvbnN0cnVjdG9yLnByb3RvdHlwZSk6T2JqZWN0LnNldFByb3RvdHlwZU9mKG5ldyB0aGlzLlR5cGVkQXJyYXkodCwuLi5lKSx0aGlzLmNvbnN0cnVjdG9yLnByb3RvdHlwZSl9ZnVuY3Rpb24gT3QoLi4udCl7cmV0dXJuIFR0LmFwcGx5KHRoaXMsdCl9ZnVuY3Rpb24gRHQoLi4udCl7cmV0dXJuIFR0LmFwcGx5KHRoaXMsdCl9ZnVuY3Rpb24geHQoLi4udCl7cmV0dXJuIFR0LmFwcGx5KHRoaXMsdCl9ZnVuY3Rpb24gTXQodCl7Y29uc3R7YnVmZmVyOmUsYnl0ZU9mZnNldDppLGxlbmd0aDpuLHNpZ25lZDpyfT10LHM9bmV3IEludDMyQXJyYXkoZSxpLG4pO2xldCBvPTAsYT0wO2NvbnN0IGw9cy5sZW5ndGg7bGV0IGMsaDtmb3IoO2E8bDspaD1zW2ErK10sYz1zW2ErK10scnx8KGM+Pj49MCksbys9KGg+Pj4wKStjKk1hdGgucG93KGEsMzIpO3JldHVybiBvfWxldCBGdCxMdDtmdW5jdGlvbiBOdCh0KXtsZXQgZT0iIjtjb25zdCBpPW5ldyBVaW50MzJBcnJheSgyKTtsZXQgbj1uZXcgVWludDE2QXJyYXkodC5idWZmZXIsdC5ieXRlT2Zmc2V0LHQuYnl0ZUxlbmd0aC8yKTtjb25zdCByPW5ldyBVaW50MzJBcnJheSgobj1uZXcgVWludDE2QXJyYXkobikucmV2ZXJzZSgpKS5idWZmZXIpO2xldCBzPS0xO2NvbnN0IG89bi5sZW5ndGgtMTtkb3tmb3IoaVswXT1uW3M9MF07czxvOyluW3MrK109aVsxXT1pWzBdLzEwLGlbMF09KGlbMF0tMTAqaVsxXTw8MTYpK25bc107bltzXT1pWzFdPWlbMF0vMTAsaVswXT1pWzBdLTEwKmlbMV0sZT1gJHtpWzBdfSR7ZX1gfXdoaWxlKHJbMF18fHJbMV18fHJbMl18fHJbM10pO3JldHVybiBlfHwiMCJ9VHQucHJvdG90eXBlW0F0XT0hMCxUdC5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuYCIke0Z0KHRoaXMpfSJgfSxUdC5wcm90b3R5cGUudmFsdWVPZj1mdW5jdGlvbigpe3JldHVybiBNdCh0aGlzKX0sVHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIEZ0KHRoaXMpfSxUdC5wcm90b3R5cGVbU3ltYm9sLnRvUHJpbWl0aXZlXT1mdW5jdGlvbih0PSJkZWZhdWx0Iil7c3dpdGNoKHQpe2Nhc2UibnVtYmVyIjpyZXR1cm4gTXQodGhpcyk7Y2FzZSJzdHJpbmciOnJldHVybiBGdCh0aGlzKTtjYXNlImRlZmF1bHQiOnJldHVybiBMdCh0aGlzKX1yZXR1cm4gRnQodGhpcyl9LE9iamVjdC5zZXRQcm90b3R5cGVPZihPdC5wcm90b3R5cGUsT2JqZWN0LmNyZWF0ZShJbnQzMkFycmF5LnByb3RvdHlwZSkpLE9iamVjdC5zZXRQcm90b3R5cGVPZihEdC5wcm90b3R5cGUsT2JqZWN0LmNyZWF0ZShVaW50MzJBcnJheS5wcm90b3R5cGUpKSxPYmplY3Quc2V0UHJvdG90eXBlT2YoeHQucHJvdG90eXBlLE9iamVjdC5jcmVhdGUoVWludDMyQXJyYXkucHJvdG90eXBlKSksT2JqZWN0LmFzc2lnbihPdC5wcm90b3R5cGUsVHQucHJvdG90eXBlLHtjb25zdHJ1Y3RvcjpPdCxzaWduZWQ6ITAsVHlwZWRBcnJheTpJbnQzMkFycmF5LEJpZ0ludEFycmF5OkR9KSxPYmplY3QuYXNzaWduKER0LnByb3RvdHlwZSxUdC5wcm90b3R5cGUse2NvbnN0cnVjdG9yOkR0LHNpZ25lZDohMSxUeXBlZEFycmF5OlVpbnQzMkFycmF5LEJpZ0ludEFycmF5Ok19KSxPYmplY3QuYXNzaWduKHh0LnByb3RvdHlwZSxUdC5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnh0LHNpZ25lZDohMCxUeXBlZEFycmF5OlVpbnQzMkFycmF5LEJpZ0ludEFycmF5Ok19KSxPPyhMdD10PT44PT09dC5ieXRlTGVuZ3RoP25ldyB0LkJpZ0ludEFycmF5KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCwxKVswXTpOdCh0KSxGdD10PT44PT09dC5ieXRlTGVuZ3RoP2Ake25ldyB0LkJpZ0ludEFycmF5KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCwxKVswXX1gOk50KHQpKTooRnQ9TnQsTHQ9RnQpO2NsYXNzIFV0e3N0YXRpYyBuZXcodCxlKXtzd2l0Y2goZSl7Y2FzZSEwOnJldHVybiBuZXcgT3QodCk7Y2FzZSExOnJldHVybiBuZXcgRHQodCl9c3dpdGNoKHQuY29uc3RydWN0b3Ipe2Nhc2UgSW50OEFycmF5OmNhc2UgSW50MTZBcnJheTpjYXNlIEludDMyQXJyYXk6Y2FzZSBEOnJldHVybiBuZXcgT3QodCl9cmV0dXJuIDE2PT09dC5ieXRlTGVuZ3RoP25ldyB4dCh0KTpuZXcgRHQodCl9c3RhdGljIHNpZ25lZCh0KXtyZXR1cm4gbmV3IE90KHQpfXN0YXRpYyB1bnNpZ25lZCh0KXtyZXR1cm4gbmV3IER0KHQpfXN0YXRpYyBkZWNpbWFsKHQpe3JldHVybiBuZXcgeHQodCl9Y29uc3RydWN0b3IodCxlKXtyZXR1cm4gVXQubmV3KHQsZSl9fXZhciBDdCxFdCxWdCxSdCx6dCxQdCxqdCxrdCwkdCxZdCxXdCxIdCxLdCxKdCxHdCxadCxxdCxRdCxYdCx0ZTtjbGFzcyBlZXtzdGF0aWMgaXNOdWxsKHQpe3JldHVybihudWxsPT10P3ZvaWQgMDp0LnR5cGVJZCk9PT12dC5OdWxsfXN0YXRpYyBpc0ludCh0KXtyZXR1cm4obnVsbD09dD92b2lkIDA6dC50eXBlSWQpPT09dnQuSW50fXN0YXRpYyBpc0Zsb2F0KHQpe3JldHVybihudWxsPT10P3ZvaWQgMDp0LnR5cGVJZCk9PT12dC5GbG9hdH1zdGF0aWMgaXNCaW5hcnkodCl7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQudHlwZUlkKT09PXZ0LkJpbmFyeX1zdGF0aWMgaXNVdGY4KHQpe3JldHVybihudWxsPT10P3ZvaWQgMDp0LnR5cGVJZCk9PT12dC5VdGY4fXN0YXRpYyBpc0Jvb2wodCl7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQudHlwZUlkKT09PXZ0LkJvb2x9c3RhdGljIGlzRGVjaW1hbCh0KXtyZXR1cm4obnVsbD09dD92b2lkIDA6dC50eXBlSWQpPT09dnQuRGVjaW1hbH1zdGF0aWMgaXNEYXRlKHQpe3JldHVybihudWxsPT10P3ZvaWQgMDp0LnR5cGVJZCk9PT12dC5EYXRlfXN0YXRpYyBpc1RpbWUodCl7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQudHlwZUlkKT09PXZ0LlRpbWV9c3RhdGljIGlzVGltZXN0YW1wKHQpe3JldHVybihudWxsPT10P3ZvaWQgMDp0LnR5cGVJZCk9PT12dC5UaW1lc3RhbXB9c3RhdGljIGlzSW50ZXJ2YWwodCl7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQudHlwZUlkKT09PXZ0LkludGVydmFsfXN0YXRpYyBpc0xpc3QodCl7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQudHlwZUlkKT09PXZ0Lkxpc3R9c3RhdGljIGlzU3RydWN0KHQpe3JldHVybihudWxsPT10P3ZvaWQgMDp0LnR5cGVJZCk9PT12dC5TdHJ1Y3R9c3RhdGljIGlzVW5pb24odCl7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQudHlwZUlkKT09PXZ0LlVuaW9ufXN0YXRpYyBpc0ZpeGVkU2l6ZUJpbmFyeSh0KXtyZXR1cm4obnVsbD09dD92b2lkIDA6dC50eXBlSWQpPT09dnQuRml4ZWRTaXplQmluYXJ5fXN0YXRpYyBpc0ZpeGVkU2l6ZUxpc3QodCl7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQudHlwZUlkKT09PXZ0LkZpeGVkU2l6ZUxpc3R9c3RhdGljIGlzTWFwKHQpe3JldHVybihudWxsPT10P3ZvaWQgMDp0LnR5cGVJZCk9PT12dC5NYXB9c3RhdGljIGlzRGljdGlvbmFyeSh0KXtyZXR1cm4obnVsbD09dD92b2lkIDA6dC50eXBlSWQpPT09dnQuRGljdGlvbmFyeX1zdGF0aWMgaXNEZW5zZVVuaW9uKHQpe3JldHVybiBlZS5pc1VuaW9uKHQpJiZ0Lm1vZGU9PT1sdC5EZW5zZX1zdGF0aWMgaXNTcGFyc2VVbmlvbih0KXtyZXR1cm4gZWUuaXNVbmlvbih0KSYmdC5tb2RlPT09bHQuU3BhcnNlfWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuTk9ORX19Q3Q9U3ltYm9sLnRvU3RyaW5nVGFnLGVlW0N0XT0oKHRlPWVlLnByb3RvdHlwZSkuY2hpbGRyZW49bnVsbCx0ZS5BcnJheVR5cGU9QXJyYXksdGVbU3ltYm9sLnRvU3RyaW5nVGFnXT0iRGF0YVR5cGUiKTtjbGFzcyBpZSBleHRlbmRzIGVle3RvU3RyaW5nKCl7cmV0dXJuIk51bGwifWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuTnVsbH19RXQ9U3ltYm9sLnRvU3RyaW5nVGFnLGllW0V0XT0odD0+dFtTeW1ib2wudG9TdHJpbmdUYWddPSJOdWxsIikoaWUucHJvdG90eXBlKTtjbGFzcyBuZSBleHRlbmRzIGVle2NvbnN0cnVjdG9yKHQsZSl7c3VwZXIoKSx0aGlzLmlzU2lnbmVkPXQsdGhpcy5iaXRXaWR0aD1lfWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuSW50fWdldCBBcnJheVR5cGUoKXtzd2l0Y2godGhpcy5iaXRXaWR0aCl7Y2FzZSA4OnJldHVybiB0aGlzLmlzU2lnbmVkP0ludDhBcnJheTpVaW50OEFycmF5O2Nhc2UgMTY6cmV0dXJuIHRoaXMuaXNTaWduZWQ/SW50MTZBcnJheTpVaW50MTZBcnJheTtjYXNlIDMyOnJldHVybiB0aGlzLmlzU2lnbmVkP0ludDMyQXJyYXk6VWludDMyQXJyYXk7Y2FzZSA2NDpyZXR1cm4gdGhpcy5pc1NpZ25lZD9CaWdJbnQ2NEFycmF5OkJpZ1VpbnQ2NEFycmF5fXRocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pemVkICR7dGhpc1tTeW1ib2wudG9TdHJpbmdUYWddfSB0eXBlYCl9dG9TdHJpbmcoKXtyZXR1cm5gJHt0aGlzLmlzU2lnbmVkPyJJIjoiVWkifW50JHt0aGlzLmJpdFdpZHRofWB9fVZ0PVN5bWJvbC50b1N0cmluZ1RhZyxuZVtWdF09KHQ9Pih0LmlzU2lnbmVkPW51bGwsdC5iaXRXaWR0aD1udWxsLHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iSW50IikpKG5lLnByb3RvdHlwZSk7Y2xhc3MgcmUgZXh0ZW5kcyBuZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCEwLDgpfWdldCBBcnJheVR5cGUoKXtyZXR1cm4gSW50OEFycmF5fX1jbGFzcyBzZSBleHRlbmRzIG5le2NvbnN0cnVjdG9yKCl7c3VwZXIoITAsMTYpfWdldCBBcnJheVR5cGUoKXtyZXR1cm4gSW50MTZBcnJheX19Y2xhc3Mgb2UgZXh0ZW5kcyBuZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCEwLDMyKX1nZXQgQXJyYXlUeXBlKCl7cmV0dXJuIEludDMyQXJyYXl9fWNsYXNzIGFlIGV4dGVuZHMgbmV7Y29uc3RydWN0b3IoKXtzdXBlcighMCw2NCl9Z2V0IEFycmF5VHlwZSgpe3JldHVybiBCaWdJbnQ2NEFycmF5fX1jbGFzcyBsZSBleHRlbmRzIG5le2NvbnN0cnVjdG9yKCl7c3VwZXIoITEsOCl9Z2V0IEFycmF5VHlwZSgpe3JldHVybiBVaW50OEFycmF5fX1jbGFzcyBjZSBleHRlbmRzIG5le2NvbnN0cnVjdG9yKCl7c3VwZXIoITEsMTYpfWdldCBBcnJheVR5cGUoKXtyZXR1cm4gVWludDE2QXJyYXl9fWNsYXNzIGhlIGV4dGVuZHMgbmV7Y29uc3RydWN0b3IoKXtzdXBlcighMSwzMil9Z2V0IEFycmF5VHlwZSgpe3JldHVybiBVaW50MzJBcnJheX19Y2xhc3MgdWUgZXh0ZW5kcyBuZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCExLDY0KX1nZXQgQXJyYXlUeXBlKCl7cmV0dXJuIEJpZ1VpbnQ2NEFycmF5fX1PYmplY3QuZGVmaW5lUHJvcGVydHkocmUucHJvdG90eXBlLCJBcnJheVR5cGUiLHt2YWx1ZTpJbnQ4QXJyYXl9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoc2UucHJvdG90eXBlLCJBcnJheVR5cGUiLHt2YWx1ZTpJbnQxNkFycmF5fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG9lLnByb3RvdHlwZSwiQXJyYXlUeXBlIix7dmFsdWU6SW50MzJBcnJheX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhZS5wcm90b3R5cGUsIkFycmF5VHlwZSIse3ZhbHVlOkJpZ0ludDY0QXJyYXl9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobGUucHJvdG90eXBlLCJBcnJheVR5cGUiLHt2YWx1ZTpVaW50OEFycmF5fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGNlLnByb3RvdHlwZSwiQXJyYXlUeXBlIix7dmFsdWU6VWludDE2QXJyYXl9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaGUucHJvdG90eXBlLCJBcnJheVR5cGUiLHt2YWx1ZTpVaW50MzJBcnJheX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh1ZS5wcm90b3R5cGUsIkFycmF5VHlwZSIse3ZhbHVlOkJpZ1VpbnQ2NEFycmF5fSk7Y2xhc3MgZGUgZXh0ZW5kcyBlZXtjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMucHJlY2lzaW9uPXR9Z2V0IHR5cGVJZCgpe3JldHVybiB2dC5GbG9hdH1nZXQgQXJyYXlUeXBlKCl7c3dpdGNoKHRoaXMucHJlY2lzaW9uKXtjYXNlIGh0LkhBTEY6cmV0dXJuIFVpbnQxNkFycmF5O2Nhc2UgaHQuU0lOR0xFOnJldHVybiBGbG9hdDMyQXJyYXk7Y2FzZSBodC5ET1VCTEU6cmV0dXJuIEZsb2F0NjRBcnJheX10aHJvdyBuZXcgRXJyb3IoYFVucmVjb2duaXplZCAke3RoaXNbU3ltYm9sLnRvU3RyaW5nVGFnXX0gdHlwZWApfXRvU3RyaW5nKCl7cmV0dXJuYEZsb2F0JHt0aGlzLnByZWNpc2lvbjw8NXx8MTZ9YH19UnQ9U3ltYm9sLnRvU3RyaW5nVGFnLGRlW1J0XT0odD0+KHQucHJlY2lzaW9uPW51bGwsdFtTeW1ib2wudG9TdHJpbmdUYWddPSJGbG9hdCIpKShkZS5wcm90b3R5cGUpO2NsYXNzIHBlIGV4dGVuZHMgZGV7Y29uc3RydWN0b3IoKXtzdXBlcihodC5TSU5HTEUpfX1jbGFzcyBmZSBleHRlbmRzIGRle2NvbnN0cnVjdG9yKCl7c3VwZXIoaHQuRE9VQkxFKX19T2JqZWN0LmRlZmluZVByb3BlcnR5KGNsYXNzIGV4dGVuZHMgZGV7Y29uc3RydWN0b3IoKXtzdXBlcihodC5IQUxGKX19LnByb3RvdHlwZSwiQXJyYXlUeXBlIix7dmFsdWU6VWludDE2QXJyYXl9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocGUucHJvdG90eXBlLCJBcnJheVR5cGUiLHt2YWx1ZTpGbG9hdDMyQXJyYXl9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZmUucHJvdG90eXBlLCJBcnJheVR5cGUiLHt2YWx1ZTpGbG9hdDY0QXJyYXl9KTtjbGFzcyB5ZSBleHRlbmRzIGVle2NvbnN0cnVjdG9yKCl7c3VwZXIoKX1nZXQgdHlwZUlkKCl7cmV0dXJuIHZ0LkJpbmFyeX10b1N0cmluZygpe3JldHVybiJCaW5hcnkifX16dD1TeW1ib2wudG9TdHJpbmdUYWcseWVbenRdPSh0PT4odC5BcnJheVR5cGU9VWludDhBcnJheSx0W1N5bWJvbC50b1N0cmluZ1RhZ109IkJpbmFyeSIpKSh5ZS5wcm90b3R5cGUpO2NsYXNzIGJlIGV4dGVuZHMgZWV7Y29uc3RydWN0b3IoKXtzdXBlcigpfWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuVXRmOH10b1N0cmluZygpe3JldHVybiJVdGY4In19UHQ9U3ltYm9sLnRvU3RyaW5nVGFnLGJlW1B0XT0odD0+KHQuQXJyYXlUeXBlPVVpbnQ4QXJyYXksdFtTeW1ib2wudG9TdHJpbmdUYWddPSJVdGY4IikpKGJlLnByb3RvdHlwZSk7Y2xhc3MgZ2UgZXh0ZW5kcyBlZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCl9Z2V0IHR5cGVJZCgpe3JldHVybiB2dC5Cb29sfXRvU3RyaW5nKCl7cmV0dXJuIkJvb2wifX1qdD1TeW1ib2wudG9TdHJpbmdUYWcsZ2VbanRdPSh0PT4odC5BcnJheVR5cGU9VWludDhBcnJheSx0W1N5bWJvbC50b1N0cmluZ1RhZ109IkJvb2wiKSkoZ2UucHJvdG90eXBlKTtjbGFzcyBtZSBleHRlbmRzIGVle2NvbnN0cnVjdG9yKHQsZSxpPTEyOCl7c3VwZXIoKSx0aGlzLnNjYWxlPXQsdGhpcy5wcmVjaXNpb249ZSx0aGlzLmJpdFdpZHRoPWl9Z2V0IHR5cGVJZCgpe3JldHVybiB2dC5EZWNpbWFsfXRvU3RyaW5nKCl7cmV0dXJuYERlY2ltYWxbJHt0aGlzLnByZWNpc2lvbn1lJHt0aGlzLnNjYWxlPjA/IisiOiIifSR7dGhpcy5zY2FsZX1dYH19a3Q9U3ltYm9sLnRvU3RyaW5nVGFnLG1lW2t0XT0odD0+KHQuc2NhbGU9bnVsbCx0LnByZWNpc2lvbj1udWxsLHQuQXJyYXlUeXBlPVVpbnQzMkFycmF5LHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iRGVjaW1hbCIpKShtZS5wcm90b3R5cGUpO2NsYXNzIF9lIGV4dGVuZHMgZWV7Y29uc3RydWN0b3IodCl7c3VwZXIoKSx0aGlzLnVuaXQ9dH1nZXQgdHlwZUlkKCl7cmV0dXJuIHZ0LkRhdGV9dG9TdHJpbmcoKXtyZXR1cm5gRGF0ZSR7MzIqKHRoaXMudW5pdCsxKX08JHtkdFt0aGlzLnVuaXRdfT5gfX0kdD1TeW1ib2wudG9TdHJpbmdUYWcsX2VbJHRdPSh0PT4odC51bml0PW51bGwsdC5BcnJheVR5cGU9SW50MzJBcnJheSx0W1N5bWJvbC50b1N0cmluZ1RhZ109IkRhdGUiKSkoX2UucHJvdG90eXBlKTtjbGFzcyB2ZSBleHRlbmRzIF9le2NvbnN0cnVjdG9yKCl7c3VwZXIoZHQuTUlMTElTRUNPTkQpfX1jbGFzcyB3ZSBleHRlbmRzIGVle2NvbnN0cnVjdG9yKHQsZSl7c3VwZXIoKSx0aGlzLnVuaXQ9dCx0aGlzLmJpdFdpZHRoPWV9Z2V0IHR5cGVJZCgpe3JldHVybiB2dC5UaW1lfXRvU3RyaW5nKCl7cmV0dXJuYFRpbWUke3RoaXMuYml0V2lkdGh9PCR7ZnRbdGhpcy51bml0XX0+YH1nZXQgQXJyYXlUeXBlKCl7c3dpdGNoKHRoaXMuYml0V2lkdGgpe2Nhc2UgMzI6cmV0dXJuIEludDMyQXJyYXk7Y2FzZSA2NDpyZXR1cm4gQmlnSW50NjRBcnJheX10aHJvdyBuZXcgRXJyb3IoYFVucmVjb2duaXplZCAke3RoaXNbU3ltYm9sLnRvU3RyaW5nVGFnXX0gdHlwZWApfX1ZdD1TeW1ib2wudG9TdHJpbmdUYWcsd2VbWXRdPSh0PT4odC51bml0PW51bGwsdC5iaXRXaWR0aD1udWxsLHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iVGltZSIpKSh3ZS5wcm90b3R5cGUpO2NsYXNzIEllIGV4dGVuZHMgZWV7Y29uc3RydWN0b3IodCxlKXtzdXBlcigpLHRoaXMudW5pdD10LHRoaXMudGltZXpvbmU9ZX1nZXQgdHlwZUlkKCl7cmV0dXJuIHZ0LlRpbWVzdGFtcH10b1N0cmluZygpe3JldHVybmBUaW1lc3RhbXA8JHtmdFt0aGlzLnVuaXRdfSR7dGhpcy50aW1lem9uZT9gLCAke3RoaXMudGltZXpvbmV9YDoiIn0+YH19V3Q9U3ltYm9sLnRvU3RyaW5nVGFnLEllW1d0XT0odD0+KHQudW5pdD1udWxsLHQudGltZXpvbmU9bnVsbCx0LkFycmF5VHlwZT1JbnQzMkFycmF5LHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iVGltZXN0YW1wIikpKEllLnByb3RvdHlwZSk7Y2xhc3MgU2UgZXh0ZW5kcyBlZXtjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMudW5pdD10fWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuSW50ZXJ2YWx9dG9TdHJpbmcoKXtyZXR1cm5gSW50ZXJ2YWw8JHtidFt0aGlzLnVuaXRdfT5gfX1IdD1TeW1ib2wudG9TdHJpbmdUYWcsU2VbSHRdPSh0PT4odC51bml0PW51bGwsdC5BcnJheVR5cGU9SW50MzJBcnJheSx0W1N5bWJvbC50b1N0cmluZ1RhZ109IkludGVydmFsIikpKFNlLnByb3RvdHlwZSk7Y2xhc3MgQmUgZXh0ZW5kcyBlZXtjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMuY2hpbGRyZW49W3RdfWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuTGlzdH10b1N0cmluZygpe3JldHVybmBMaXN0PCR7dGhpcy52YWx1ZVR5cGV9PmB9Z2V0IHZhbHVlVHlwZSgpe3JldHVybiB0aGlzLmNoaWxkcmVuWzBdLnR5cGV9Z2V0IHZhbHVlRmllbGQoKXtyZXR1cm4gdGhpcy5jaGlsZHJlblswXX1nZXQgQXJyYXlUeXBlKCl7cmV0dXJuIHRoaXMudmFsdWVUeXBlLkFycmF5VHlwZX19S3Q9U3ltYm9sLnRvU3RyaW5nVGFnLEJlW0t0XT0odD0+KHQuY2hpbGRyZW49bnVsbCx0W1N5bWJvbC50b1N0cmluZ1RhZ109Ikxpc3QiKSkoQmUucHJvdG90eXBlKTtjbGFzcyBBZSBleHRlbmRzIGVle2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5jaGlsZHJlbj10fWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuU3RydWN0fXRvU3RyaW5nKCl7cmV0dXJuYFN0cnVjdDx7JHt0aGlzLmNoaWxkcmVuLm1hcCgodD0+YCR7dC5uYW1lfToke3QudHlwZX1gKSkuam9pbigiLCAiKX19PmB9fUp0PVN5bWJvbC50b1N0cmluZ1RhZyxBZVtKdF09KHQ9Pih0LmNoaWxkcmVuPW51bGwsdFtTeW1ib2wudG9TdHJpbmdUYWddPSJTdHJ1Y3QiKSkoQWUucHJvdG90eXBlKTtjbGFzcyBUZSBleHRlbmRzIGVle2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcigpLHRoaXMubW9kZT10LHRoaXMuY2hpbGRyZW49aSx0aGlzLnR5cGVJZHM9ZT1JbnQzMkFycmF5LmZyb20oZSksdGhpcy50eXBlSWRUb0NoaWxkSW5kZXg9ZS5yZWR1Y2UoKCh0LGUsaSk9Pih0W2VdPWkpJiZ0fHx0KSxPYmplY3QuY3JlYXRlKG51bGwpKX1nZXQgdHlwZUlkKCl7cmV0dXJuIHZ0LlVuaW9ufXRvU3RyaW5nKCl7cmV0dXJuYCR7dGhpc1tTeW1ib2wudG9TdHJpbmdUYWddfTwke3RoaXMuY2hpbGRyZW4ubWFwKCh0PT5gJHt0LnR5cGV9YCkpLmpvaW4oIiB8ICIpfT5gfX1HdD1TeW1ib2wudG9TdHJpbmdUYWcsVGVbR3RdPSh0PT4odC5tb2RlPW51bGwsdC50eXBlSWRzPW51bGwsdC5jaGlsZHJlbj1udWxsLHQudHlwZUlkVG9DaGlsZEluZGV4PW51bGwsdC5BcnJheVR5cGU9SW50OEFycmF5LHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iVW5pb24iKSkoVGUucHJvdG90eXBlKTtjbGFzcyBPZSBleHRlbmRzIGVle2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5ieXRlV2lkdGg9dH1nZXQgdHlwZUlkKCl7cmV0dXJuIHZ0LkZpeGVkU2l6ZUJpbmFyeX10b1N0cmluZygpe3JldHVybmBGaXhlZFNpemVCaW5hcnlbJHt0aGlzLmJ5dGVXaWR0aH1dYH19WnQ9U3ltYm9sLnRvU3RyaW5nVGFnLE9lW1p0XT0odD0+KHQuYnl0ZVdpZHRoPW51bGwsdC5BcnJheVR5cGU9VWludDhBcnJheSx0W1N5bWJvbC50b1N0cmluZ1RhZ109IkZpeGVkU2l6ZUJpbmFyeSIpKShPZS5wcm90b3R5cGUpO2NsYXNzIERlIGV4dGVuZHMgZWV7Y29uc3RydWN0b3IodCxlKXtzdXBlcigpLHRoaXMubGlzdFNpemU9dCx0aGlzLmNoaWxkcmVuPVtlXX1nZXQgdHlwZUlkKCl7cmV0dXJuIHZ0LkZpeGVkU2l6ZUxpc3R9Z2V0IHZhbHVlVHlwZSgpe3JldHVybiB0aGlzLmNoaWxkcmVuWzBdLnR5cGV9Z2V0IHZhbHVlRmllbGQoKXtyZXR1cm4gdGhpcy5jaGlsZHJlblswXX1nZXQgQXJyYXlUeXBlKCl7cmV0dXJuIHRoaXMudmFsdWVUeXBlLkFycmF5VHlwZX10b1N0cmluZygpe3JldHVybmBGaXhlZFNpemVMaXN0WyR7dGhpcy5saXN0U2l6ZX1dPCR7dGhpcy52YWx1ZVR5cGV9PmB9fXF0PVN5bWJvbC50b1N0cmluZ1RhZyxEZVtxdF09KHQ9Pih0LmNoaWxkcmVuPW51bGwsdC5saXN0U2l6ZT1udWxsLHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iRml4ZWRTaXplTGlzdCIpKShEZS5wcm90b3R5cGUpO2NsYXNzIHhlIGV4dGVuZHMgZWV7Y29uc3RydWN0b3IodCxlPSExKXtzdXBlcigpLHRoaXMuY2hpbGRyZW49W3RdLHRoaXMua2V5c1NvcnRlZD1lfWdldCB0eXBlSWQoKXtyZXR1cm4gdnQuTWFwfWdldCBrZXlUeXBlKCl7cmV0dXJuIHRoaXMuY2hpbGRyZW5bMF0udHlwZS5jaGlsZHJlblswXS50eXBlfWdldCB2YWx1ZVR5cGUoKXtyZXR1cm4gdGhpcy5jaGlsZHJlblswXS50eXBlLmNoaWxkcmVuWzFdLnR5cGV9Z2V0IGNoaWxkVHlwZSgpe3JldHVybiB0aGlzLmNoaWxkcmVuWzBdLnR5cGV9dG9TdHJpbmcoKXtyZXR1cm5gTWFwPHske3RoaXMuY2hpbGRyZW5bMF0udHlwZS5jaGlsZHJlbi5tYXAoKHQ9PmAke3QubmFtZX06JHt0LnR5cGV9YCkpLmpvaW4oIiwgIil9fT5gfX1RdD1TeW1ib2wudG9TdHJpbmdUYWcseGVbUXRdPSh0PT4odC5jaGlsZHJlbj1udWxsLHQua2V5c1NvcnRlZD1udWxsLHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iTWFwXyIpKSh4ZS5wcm90b3R5cGUpO2NvbnN0IE1lPShGZT0tMSwoKT0+KytGZSk7dmFyIEZlO2NsYXNzIExlIGV4dGVuZHMgZWV7Y29uc3RydWN0b3IodCxlLGksbil7c3VwZXIoKSx0aGlzLmluZGljZXM9ZSx0aGlzLmRpY3Rpb25hcnk9dCx0aGlzLmlzT3JkZXJlZD1ufHwhMSx0aGlzLmlkPW51bGw9PWk/TWUoKToibnVtYmVyIj09dHlwZW9mIGk/aTppLmxvd31nZXQgdHlwZUlkKCl7cmV0dXJuIHZ0LkRpY3Rpb25hcnl9Z2V0IGNoaWxkcmVuKCl7cmV0dXJuIHRoaXMuZGljdGlvbmFyeS5jaGlsZHJlbn1nZXQgdmFsdWVUeXBlKCl7cmV0dXJuIHRoaXMuZGljdGlvbmFyeX1nZXQgQXJyYXlUeXBlKCl7cmV0dXJuIHRoaXMuZGljdGlvbmFyeS5BcnJheVR5cGV9dG9TdHJpbmcoKXtyZXR1cm5gRGljdGlvbmFyeTwke3RoaXMuaW5kaWNlc30sICR7dGhpcy5kaWN0aW9uYXJ5fT5gfX1mdW5jdGlvbiBOZSh0KXtjb25zdCBlPXQ7c3dpdGNoKHQudHlwZUlkKXtjYXNlIHZ0LkRlY2ltYWw6cmV0dXJuIHQuYml0V2lkdGgvMzI7Y2FzZSB2dC5UaW1lc3RhbXA6cmV0dXJuIDI7Y2FzZSB2dC5EYXRlOmNhc2UgdnQuSW50ZXJ2YWw6cmV0dXJuIDErZS51bml0O2Nhc2UgdnQuRml4ZWRTaXplTGlzdDpyZXR1cm4gZS5saXN0U2l6ZTtjYXNlIHZ0LkZpeGVkU2l6ZUJpbmFyeTpyZXR1cm4gZS5ieXRlV2lkdGg7ZGVmYXVsdDpyZXR1cm4gMX19WHQ9U3ltYm9sLnRvU3RyaW5nVGFnLExlW1h0XT0odD0+KHQuaWQ9bnVsbCx0LmluZGljZXM9bnVsbCx0LmlzT3JkZXJlZD1udWxsLHQuZGljdGlvbmFyeT1udWxsLHRbU3ltYm9sLnRvU3RyaW5nVGFnXT0iRGljdGlvbmFyeSIpKShMZS5wcm90b3R5cGUpO2NsYXNzIFVle3Zpc2l0TWFueSh0LC4uLmUpe3JldHVybiB0Lm1hcCgoKHQsaSk9PnRoaXMudmlzaXQodCwuLi5lLm1hcCgodD0+dFtpXSkpKSkpfXZpc2l0KC4uLnQpe3JldHVybiB0aGlzLmdldFZpc2l0Rm4odFswXSwhMSkuYXBwbHkodGhpcyx0KX1nZXRWaXNpdEZuKHQsZT0hMCl7cmV0dXJuIGZ1bmN0aW9uKHQsZSxpPSEwKXtpZigibnVtYmVyIj09dHlwZW9mIGUpcmV0dXJuIENlKHQsZSxpKTtpZigic3RyaW5nIj09dHlwZW9mIGUmJmUgaW4gdnQpcmV0dXJuIENlKHQsdnRbZV0saSk7aWYoZSYmZSBpbnN0YW5jZW9mIGVlKXJldHVybiBDZSh0LEVlKGUpLGkpO2lmKChudWxsPT1lP3ZvaWQgMDplLnR5cGUpJiZlLnR5cGUgaW5zdGFuY2VvZiBlZSlyZXR1cm4gQ2UodCxFZShlLnR5cGUpLGkpO3JldHVybiBDZSh0LHZ0Lk5PTkUsaSl9KHRoaXMsdCxlKX1nZXRWaXNpdEZuQnlUeXBlSWQodCxlPSEwKXtyZXR1cm4gQ2UodGhpcyx0LGUpfXZpc2l0TnVsbCh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0Qm9vbCh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0SW50KHQsLi4uZSl7cmV0dXJuIG51bGx9dmlzaXRGbG9hdCh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0VXRmOCh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0QmluYXJ5KHQsLi4uZSl7cmV0dXJuIG51bGx9dmlzaXRGaXhlZFNpemVCaW5hcnkodCwuLi5lKXtyZXR1cm4gbnVsbH12aXNpdERhdGUodCwuLi5lKXtyZXR1cm4gbnVsbH12aXNpdFRpbWVzdGFtcCh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0VGltZSh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0RGVjaW1hbCh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0TGlzdCh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0U3RydWN0KHQsLi4uZSl7cmV0dXJuIG51bGx9dmlzaXRVbmlvbih0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0RGljdGlvbmFyeSh0LC4uLmUpe3JldHVybiBudWxsfXZpc2l0SW50ZXJ2YWwodCwuLi5lKXtyZXR1cm4gbnVsbH12aXNpdEZpeGVkU2l6ZUxpc3QodCwuLi5lKXtyZXR1cm4gbnVsbH12aXNpdE1hcCh0LC4uLmUpe3JldHVybiBudWxsfX1mdW5jdGlvbiBDZSh0LGUsaT0hMCl7bGV0IG49bnVsbDtzd2l0Y2goZSl7Y2FzZSB2dC5OdWxsOm49dC52aXNpdE51bGw7YnJlYWs7Y2FzZSB2dC5Cb29sOm49dC52aXNpdEJvb2w7YnJlYWs7Y2FzZSB2dC5JbnQ6bj10LnZpc2l0SW50O2JyZWFrO2Nhc2UgdnQuSW50ODpuPXQudmlzaXRJbnQ4fHx0LnZpc2l0SW50O2JyZWFrO2Nhc2UgdnQuSW50MTY6bj10LnZpc2l0SW50MTZ8fHQudmlzaXRJbnQ7YnJlYWs7Y2FzZSB2dC5JbnQzMjpuPXQudmlzaXRJbnQzMnx8dC52aXNpdEludDticmVhaztjYXNlIHZ0LkludDY0Om49dC52aXNpdEludDY0fHx0LnZpc2l0SW50O2JyZWFrO2Nhc2UgdnQuVWludDg6bj10LnZpc2l0VWludDh8fHQudmlzaXRJbnQ7YnJlYWs7Y2FzZSB2dC5VaW50MTY6bj10LnZpc2l0VWludDE2fHx0LnZpc2l0SW50O2JyZWFrO2Nhc2UgdnQuVWludDMyOm49dC52aXNpdFVpbnQzMnx8dC52aXNpdEludDticmVhaztjYXNlIHZ0LlVpbnQ2NDpuPXQudmlzaXRVaW50NjR8fHQudmlzaXRJbnQ7YnJlYWs7Y2FzZSB2dC5GbG9hdDpuPXQudmlzaXRGbG9hdDticmVhaztjYXNlIHZ0LkZsb2F0MTY6bj10LnZpc2l0RmxvYXQxNnx8dC52aXNpdEZsb2F0O2JyZWFrO2Nhc2UgdnQuRmxvYXQzMjpuPXQudmlzaXRGbG9hdDMyfHx0LnZpc2l0RmxvYXQ7YnJlYWs7Y2FzZSB2dC5GbG9hdDY0Om49dC52aXNpdEZsb2F0NjR8fHQudmlzaXRGbG9hdDticmVhaztjYXNlIHZ0LlV0Zjg6bj10LnZpc2l0VXRmODticmVhaztjYXNlIHZ0LkJpbmFyeTpuPXQudmlzaXRCaW5hcnk7YnJlYWs7Y2FzZSB2dC5GaXhlZFNpemVCaW5hcnk6bj10LnZpc2l0Rml4ZWRTaXplQmluYXJ5O2JyZWFrO2Nhc2UgdnQuRGF0ZTpuPXQudmlzaXREYXRlO2JyZWFrO2Nhc2UgdnQuRGF0ZURheTpuPXQudmlzaXREYXRlRGF5fHx0LnZpc2l0RGF0ZTticmVhaztjYXNlIHZ0LkRhdGVNaWxsaXNlY29uZDpuPXQudmlzaXREYXRlTWlsbGlzZWNvbmR8fHQudmlzaXREYXRlO2JyZWFrO2Nhc2UgdnQuVGltZXN0YW1wOm49dC52aXNpdFRpbWVzdGFtcDticmVhaztjYXNlIHZ0LlRpbWVzdGFtcFNlY29uZDpuPXQudmlzaXRUaW1lc3RhbXBTZWNvbmR8fHQudmlzaXRUaW1lc3RhbXA7YnJlYWs7Y2FzZSB2dC5UaW1lc3RhbXBNaWxsaXNlY29uZDpuPXQudmlzaXRUaW1lc3RhbXBNaWxsaXNlY29uZHx8dC52aXNpdFRpbWVzdGFtcDticmVhaztjYXNlIHZ0LlRpbWVzdGFtcE1pY3Jvc2Vjb25kOm49dC52aXNpdFRpbWVzdGFtcE1pY3Jvc2Vjb25kfHx0LnZpc2l0VGltZXN0YW1wO2JyZWFrO2Nhc2UgdnQuVGltZXN0YW1wTmFub3NlY29uZDpuPXQudmlzaXRUaW1lc3RhbXBOYW5vc2Vjb25kfHx0LnZpc2l0VGltZXN0YW1wO2JyZWFrO2Nhc2UgdnQuVGltZTpuPXQudmlzaXRUaW1lO2JyZWFrO2Nhc2UgdnQuVGltZVNlY29uZDpuPXQudmlzaXRUaW1lU2Vjb25kfHx0LnZpc2l0VGltZTticmVhaztjYXNlIHZ0LlRpbWVNaWxsaXNlY29uZDpuPXQudmlzaXRUaW1lTWlsbGlzZWNvbmR8fHQudmlzaXRUaW1lO2JyZWFrO2Nhc2UgdnQuVGltZU1pY3Jvc2Vjb25kOm49dC52aXNpdFRpbWVNaWNyb3NlY29uZHx8dC52aXNpdFRpbWU7YnJlYWs7Y2FzZSB2dC5UaW1lTmFub3NlY29uZDpuPXQudmlzaXRUaW1lTmFub3NlY29uZHx8dC52aXNpdFRpbWU7YnJlYWs7Y2FzZSB2dC5EZWNpbWFsOm49dC52aXNpdERlY2ltYWw7YnJlYWs7Y2FzZSB2dC5MaXN0Om49dC52aXNpdExpc3Q7YnJlYWs7Y2FzZSB2dC5TdHJ1Y3Q6bj10LnZpc2l0U3RydWN0O2JyZWFrO2Nhc2UgdnQuVW5pb246bj10LnZpc2l0VW5pb247YnJlYWs7Y2FzZSB2dC5EZW5zZVVuaW9uOm49dC52aXNpdERlbnNlVW5pb258fHQudmlzaXRVbmlvbjticmVhaztjYXNlIHZ0LlNwYXJzZVVuaW9uOm49dC52aXNpdFNwYXJzZVVuaW9ufHx0LnZpc2l0VW5pb247YnJlYWs7Y2FzZSB2dC5EaWN0aW9uYXJ5Om49dC52aXNpdERpY3Rpb25hcnk7YnJlYWs7Y2FzZSB2dC5JbnRlcnZhbDpuPXQudmlzaXRJbnRlcnZhbDticmVhaztjYXNlIHZ0LkludGVydmFsRGF5VGltZTpuPXQudmlzaXRJbnRlcnZhbERheVRpbWV8fHQudmlzaXRJbnRlcnZhbDticmVhaztjYXNlIHZ0LkludGVydmFsWWVhck1vbnRoOm49dC52aXNpdEludGVydmFsWWVhck1vbnRofHx0LnZpc2l0SW50ZXJ2YWw7YnJlYWs7Y2FzZSB2dC5GaXhlZFNpemVMaXN0Om49dC52aXNpdEZpeGVkU2l6ZUxpc3Q7YnJlYWs7Y2FzZSB2dC5NYXA6bj10LnZpc2l0TWFwfWlmKCJmdW5jdGlvbiI9PXR5cGVvZiBuKXJldHVybiBuO2lmKCFpKXJldHVybigpPT5udWxsO3Rocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pemVkIHR5cGUgJyR7dnRbZV19J2ApfWZ1bmN0aW9uIEVlKHQpe3N3aXRjaCh0LnR5cGVJZCl7Y2FzZSB2dC5OdWxsOnJldHVybiB2dC5OdWxsO2Nhc2UgdnQuSW50Ontjb25zdHtiaXRXaWR0aDplLGlzU2lnbmVkOml9PXQ7c3dpdGNoKGUpe2Nhc2UgODpyZXR1cm4gaT92dC5JbnQ4OnZ0LlVpbnQ4O2Nhc2UgMTY6cmV0dXJuIGk/dnQuSW50MTY6dnQuVWludDE2O2Nhc2UgMzI6cmV0dXJuIGk/dnQuSW50MzI6dnQuVWludDMyO2Nhc2UgNjQ6cmV0dXJuIGk/dnQuSW50NjQ6dnQuVWludDY0fXJldHVybiB2dC5JbnR9Y2FzZSB2dC5GbG9hdDpzd2l0Y2godC5wcmVjaXNpb24pe2Nhc2UgaHQuSEFMRjpyZXR1cm4gdnQuRmxvYXQxNjtjYXNlIGh0LlNJTkdMRTpyZXR1cm4gdnQuRmxvYXQzMjtjYXNlIGh0LkRPVUJMRTpyZXR1cm4gdnQuRmxvYXQ2NH1yZXR1cm4gdnQuRmxvYXQ7Y2FzZSB2dC5CaW5hcnk6cmV0dXJuIHZ0LkJpbmFyeTtjYXNlIHZ0LlV0Zjg6cmV0dXJuIHZ0LlV0Zjg7Y2FzZSB2dC5Cb29sOnJldHVybiB2dC5Cb29sO2Nhc2UgdnQuRGVjaW1hbDpyZXR1cm4gdnQuRGVjaW1hbDtjYXNlIHZ0LlRpbWU6c3dpdGNoKHQudW5pdCl7Y2FzZSBmdC5TRUNPTkQ6cmV0dXJuIHZ0LlRpbWVTZWNvbmQ7Y2FzZSBmdC5NSUxMSVNFQ09ORDpyZXR1cm4gdnQuVGltZU1pbGxpc2Vjb25kO2Nhc2UgZnQuTUlDUk9TRUNPTkQ6cmV0dXJuIHZ0LlRpbWVNaWNyb3NlY29uZDtjYXNlIGZ0Lk5BTk9TRUNPTkQ6cmV0dXJuIHZ0LlRpbWVOYW5vc2Vjb25kfXJldHVybiB2dC5UaW1lO2Nhc2UgdnQuVGltZXN0YW1wOnN3aXRjaCh0LnVuaXQpe2Nhc2UgZnQuU0VDT05EOnJldHVybiB2dC5UaW1lc3RhbXBTZWNvbmQ7Y2FzZSBmdC5NSUxMSVNFQ09ORDpyZXR1cm4gdnQuVGltZXN0YW1wTWlsbGlzZWNvbmQ7Y2FzZSBmdC5NSUNST1NFQ09ORDpyZXR1cm4gdnQuVGltZXN0YW1wTWljcm9zZWNvbmQ7Y2FzZSBmdC5OQU5PU0VDT05EOnJldHVybiB2dC5UaW1lc3RhbXBOYW5vc2Vjb25kfXJldHVybiB2dC5UaW1lc3RhbXA7Y2FzZSB2dC5EYXRlOnN3aXRjaCh0LnVuaXQpe2Nhc2UgZHQuREFZOnJldHVybiB2dC5EYXRlRGF5O2Nhc2UgZHQuTUlMTElTRUNPTkQ6cmV0dXJuIHZ0LkRhdGVNaWxsaXNlY29uZH1yZXR1cm4gdnQuRGF0ZTtjYXNlIHZ0LkludGVydmFsOnN3aXRjaCh0LnVuaXQpe2Nhc2UgYnQuREFZX1RJTUU6cmV0dXJuIHZ0LkludGVydmFsRGF5VGltZTtjYXNlIGJ0LllFQVJfTU9OVEg6cmV0dXJuIHZ0LkludGVydmFsWWVhck1vbnRofXJldHVybiB2dC5JbnRlcnZhbDtjYXNlIHZ0Lk1hcDpyZXR1cm4gdnQuTWFwO2Nhc2UgdnQuTGlzdDpyZXR1cm4gdnQuTGlzdDtjYXNlIHZ0LlN0cnVjdDpyZXR1cm4gdnQuU3RydWN0O2Nhc2UgdnQuVW5pb246c3dpdGNoKHQubW9kZSl7Y2FzZSBsdC5EZW5zZTpyZXR1cm4gdnQuRGVuc2VVbmlvbjtjYXNlIGx0LlNwYXJzZTpyZXR1cm4gdnQuU3BhcnNlVW5pb259cmV0dXJuIHZ0LlVuaW9uO2Nhc2UgdnQuRml4ZWRTaXplQmluYXJ5OnJldHVybiB2dC5GaXhlZFNpemVCaW5hcnk7Y2FzZSB2dC5GaXhlZFNpemVMaXN0OnJldHVybiB2dC5GaXhlZFNpemVMaXN0O2Nhc2UgdnQuRGljdGlvbmFyeTpyZXR1cm4gdnQuRGljdGlvbmFyeX10aHJvdyBuZXcgRXJyb3IoYFVucmVjb2duaXplZCB0eXBlICcke3Z0W3QudHlwZUlkXX0nYCl9VWUucHJvdG90eXBlLnZpc2l0SW50OD1udWxsLFVlLnByb3RvdHlwZS52aXNpdEludDE2PW51bGwsVWUucHJvdG90eXBlLnZpc2l0SW50MzI9bnVsbCxVZS5wcm90b3R5cGUudmlzaXRJbnQ2ND1udWxsLFVlLnByb3RvdHlwZS52aXNpdFVpbnQ4PW51bGwsVWUucHJvdG90eXBlLnZpc2l0VWludDE2PW51bGwsVWUucHJvdG90eXBlLnZpc2l0VWludDMyPW51bGwsVWUucHJvdG90eXBlLnZpc2l0VWludDY0PW51bGwsVWUucHJvdG90eXBlLnZpc2l0RmxvYXQxNj1udWxsLFVlLnByb3RvdHlwZS52aXNpdEZsb2F0MzI9bnVsbCxVZS5wcm90b3R5cGUudmlzaXRGbG9hdDY0PW51bGwsVWUucHJvdG90eXBlLnZpc2l0RGF0ZURheT1udWxsLFVlLnByb3RvdHlwZS52aXNpdERhdGVNaWxsaXNlY29uZD1udWxsLFVlLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcFNlY29uZD1udWxsLFVlLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcE1pbGxpc2Vjb25kPW51bGwsVWUucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wTWljcm9zZWNvbmQ9bnVsbCxVZS5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBOYW5vc2Vjb25kPW51bGwsVWUucHJvdG90eXBlLnZpc2l0VGltZVNlY29uZD1udWxsLFVlLnByb3RvdHlwZS52aXNpdFRpbWVNaWxsaXNlY29uZD1udWxsLFVlLnByb3RvdHlwZS52aXNpdFRpbWVNaWNyb3NlY29uZD1udWxsLFVlLnByb3RvdHlwZS52aXNpdFRpbWVOYW5vc2Vjb25kPW51bGwsVWUucHJvdG90eXBlLnZpc2l0RGVuc2VVbmlvbj1udWxsLFVlLnByb3RvdHlwZS52aXNpdFNwYXJzZVVuaW9uPW51bGwsVWUucHJvdG90eXBlLnZpc2l0SW50ZXJ2YWxEYXlUaW1lPW51bGwsVWUucHJvdG90eXBlLnZpc2l0SW50ZXJ2YWxZZWFyTW9udGg9bnVsbDtjb25zdCBWZT1uZXcgRmxvYXQ2NEFycmF5KDEpLFJlPW5ldyBVaW50MzJBcnJheShWZS5idWZmZXIpO2Z1bmN0aW9uIHplKHQpe2NvbnN0IGU9KDMxNzQ0JnQpPj4xMCxpPSgxMDIzJnQpLzEwMjQsbj1NYXRoLnBvdygtMSwoMzI3NjgmdCk+PjE1KTtzd2l0Y2goZSl7Y2FzZSAzMTpyZXR1cm4gbiooaT9OdW1iZXIuTmFOOjEvMCk7Y2FzZSAwOnJldHVybiBuKihpPzYxMDM1MTU2MjVlLTE0Kmk6MCl9cmV0dXJuIG4qTWF0aC5wb3coMixlLTE1KSooMStpKX1mdW5jdGlvbiBQZSh0KXtpZih0IT10KXJldHVybiAzMjI1NjtWZVswXT10O2NvbnN0IGU9KDIxNDc0ODM2NDgmUmVbMV0pPj4xNiY2NTUzNTtsZXQgaT0yMTQ2NDM1MDcyJlJlWzFdLG49MDtyZXR1cm4gaT49MTA4OTQ3MDQ2ND9SZVswXT4wP2k9MzE3NDQ6KGk9KDIwODAzNzQ3ODQmaSk+PjE2LG49KDEwNDg1NzUmUmVbMV0pPj4xMCk6aTw9MTA1Njk2NDYwOD8obj0xMDQ4NTc2KygxMDQ4NTc1JlJlWzFdKSxuPTEwNDg1NzYrKG48PChpPj4yMCktOTk4KT4+MjEsaT0wKTooaT1pLTEwNTY5NjQ2MDg+PjEwLG49NTEyKygxMDQ4NTc1JlJlWzFdKT4+MTApLGV8aXw2NTUzNSZufWNsYXNzIGplIGV4dGVuZHMgVWV7fWZ1bmN0aW9uIGtlKHQpe3JldHVybihlLGksbik9PntpZihlLnNldFZhbGlkKGksbnVsbCE9bikpcmV0dXJuIHQoZSxpLG4pfX1jb25zdCAkZT0odCxlLGkpPT57dFtlXT1NYXRoLnRydW5jKGklNDI5NDk2NzI5NiksdFtlKzFdPU1hdGgudHJ1bmMoaS80Mjk0OTY3Mjk2KX0sWWU9KHQsZSxpLG4pPT57Y29uc3R7W2ldOnIsW2krMV06c309ZTtudWxsIT1yJiZudWxsIT1zJiZ0LnNldChuLnN1YmFycmF5KDAscy1yKSxyKX0sV2U9KHt2YWx1ZXM6dH0sZSxpKT0+e3RbZV09aX0sSGU9KHt2YWx1ZXM6dH0sZSxpKT0+e3RbZV09aX0sS2U9KHt2YWx1ZXM6dH0sZSxpKT0+e3RbZV09UGUoaSl9LEplPSh7dmFsdWVzOnR9LGUsaSk9PnsoKHQsZSxpKT0+e3RbZV09TWF0aC50cnVuYyhpLzg2NGU1KX0pKHQsZSxpLnZhbHVlT2YoKSl9LEdlPSh7dmFsdWVzOnR9LGUsaSk9PnskZSh0LDIqZSxpLnZhbHVlT2YoKSl9LFplPSh7c3RyaWRlOnQsdmFsdWVzOmV9LGksbik9PntlLnNldChuLnN1YmFycmF5KDAsdCksdCppKX0scWU9KHQsZSxpKT0+e3QudHlwZS51bml0PT09ZHQuREFZP0plKHQsZSxpKTpHZSh0LGUsaSl9LFFlPSh7dmFsdWVzOnR9LGUsaSk9PiRlKHQsMiplLGkvMWUzKSxYZT0oe3ZhbHVlczp0fSxlLGkpPT4kZSh0LDIqZSxpKSx0aT0oe3ZhbHVlczp0fSxlLGkpPT4oKHQsZSxpKT0+e3RbZV09TWF0aC50cnVuYygxZTMqaSU0Mjk0OTY3Mjk2KSx0W2UrMV09TWF0aC50cnVuYygxZTMqaS80Mjk0OTY3Mjk2KX0pKHQsMiplLGkpLGVpPSh7dmFsdWVzOnR9LGUsaSk9PigodCxlLGkpPT57dFtlXT1NYXRoLnRydW5jKDFlNippJTQyOTQ5NjcyOTYpLHRbZSsxXT1NYXRoLnRydW5jKDFlNippLzQyOTQ5NjcyOTYpfSkodCwyKmUsaSksaWk9KHQsZSxpKT0+e3N3aXRjaCh0LnR5cGUudW5pdCl7Y2FzZSBmdC5TRUNPTkQ6cmV0dXJuIFFlKHQsZSxpKTtjYXNlIGZ0Lk1JTExJU0VDT05EOnJldHVybiBYZSh0LGUsaSk7Y2FzZSBmdC5NSUNST1NFQ09ORDpyZXR1cm4gdGkodCxlLGkpO2Nhc2UgZnQuTkFOT1NFQ09ORDpyZXR1cm4gZWkodCxlLGkpfX0sbmk9KHt2YWx1ZXM6dH0sZSxpKT0+e3RbZV09aX0scmk9KHt2YWx1ZXM6dH0sZSxpKT0+e3RbZV09aX0sc2k9KHt2YWx1ZXM6dH0sZSxpKT0+e3RbZV09aX0sb2k9KHt2YWx1ZXM6dH0sZSxpKT0+e3RbZV09aX0sYWk9KHQsZSxpKT0+e3N3aXRjaCh0LnR5cGUudW5pdCl7Y2FzZSBmdC5TRUNPTkQ6cmV0dXJuIG5pKHQsZSxpKTtjYXNlIGZ0Lk1JTExJU0VDT05EOnJldHVybiByaSh0LGUsaSk7Y2FzZSBmdC5NSUNST1NFQ09ORDpyZXR1cm4gc2kodCxlLGkpO2Nhc2UgZnQuTkFOT1NFQ09ORDpyZXR1cm4gb2kodCxlLGkpfX0sbGk9KHt2YWx1ZXM6dCxzdHJpZGU6ZX0saSxuKT0+e3Quc2V0KG4uc3ViYXJyYXkoMCxlKSxlKmkpfSxjaT0odCxlLGkpPT57Y29uc3Qgbj10LnR5cGUudHlwZUlkVG9DaGlsZEluZGV4W3QudHlwZUlkc1tlXV0scj10LmNoaWxkcmVuW25dO2ZpLnZpc2l0KHIsdC52YWx1ZU9mZnNldHNbZV0saSl9LGhpPSh0LGUsaSk9Pntjb25zdCBuPXQudHlwZS50eXBlSWRUb0NoaWxkSW5kZXhbdC50eXBlSWRzW2VdXSxyPXQuY2hpbGRyZW5bbl07ZmkudmlzaXQocixlLGkpfSx1aT0odCxlLGkpPT57dC50eXBlLnVuaXQ9PT1idC5EQVlfVElNRT9kaSh0LGUsaSk6cGkodCxlLGkpfSxkaT0oe3ZhbHVlczp0fSxlLGkpPT57dC5zZXQoaS5zdWJhcnJheSgwLDIpLDIqZSl9LHBpPSh7dmFsdWVzOnR9LGUsaSk9Pnt0W2VdPTEyKmlbMF0raVsxXSUxMn07amUucHJvdG90eXBlLnZpc2l0Qm9vbD1rZSgoKHtvZmZzZXQ6dCx2YWx1ZXM6ZX0saSxuKT0+e2NvbnN0IHI9dCtpO24/ZVtyPj4zXXw9MTw8ciU4OmVbcj4+M10mPX4oMTw8ciU4KX0pKSxqZS5wcm90b3R5cGUudmlzaXRJbnQ9a2UoV2UpLGplLnByb3RvdHlwZS52aXNpdEludDg9a2UoV2UpLGplLnByb3RvdHlwZS52aXNpdEludDE2PWtlKFdlKSxqZS5wcm90b3R5cGUudmlzaXRJbnQzMj1rZShXZSksamUucHJvdG90eXBlLnZpc2l0SW50NjQ9a2UoV2UpLGplLnByb3RvdHlwZS52aXNpdFVpbnQ4PWtlKFdlKSxqZS5wcm90b3R5cGUudmlzaXRVaW50MTY9a2UoV2UpLGplLnByb3RvdHlwZS52aXNpdFVpbnQzMj1rZShXZSksamUucHJvdG90eXBlLnZpc2l0VWludDY0PWtlKFdlKSxqZS5wcm90b3R5cGUudmlzaXRGbG9hdD1rZSgoKHQsZSxpKT0+e3N3aXRjaCh0LnR5cGUucHJlY2lzaW9uKXtjYXNlIGh0LkhBTEY6cmV0dXJuIEtlKHQsZSxpKTtjYXNlIGh0LlNJTkdMRTpjYXNlIGh0LkRPVUJMRTpkZWZhdWx0OnJldHVybiBIZSh0LGUsaSl9fSkpLGplLnByb3RvdHlwZS52aXNpdEZsb2F0MTY9a2UoS2UpLGplLnByb3RvdHlwZS52aXNpdEZsb2F0MzI9a2UoSGUpLGplLnByb3RvdHlwZS52aXNpdEZsb2F0NjQ9a2UoSGUpLGplLnByb3RvdHlwZS52aXNpdFV0Zjg9a2UoKCh7dmFsdWVzOnQsdmFsdWVPZmZzZXRzOmV9LGksbik9PntZZSh0LGUsaSxBKG4pKX0pKSxqZS5wcm90b3R5cGUudmlzaXRCaW5hcnk9a2UoKCh7dmFsdWVzOnQsdmFsdWVPZmZzZXRzOmV9LGksbik9PlllKHQsZSxpLG4pKSksamUucHJvdG90eXBlLnZpc2l0Rml4ZWRTaXplQmluYXJ5PWtlKFplKSxqZS5wcm90b3R5cGUudmlzaXREYXRlPWtlKHFlKSxqZS5wcm90b3R5cGUudmlzaXREYXRlRGF5PWtlKEplKSxqZS5wcm90b3R5cGUudmlzaXREYXRlTWlsbGlzZWNvbmQ9a2UoR2UpLGplLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcD1rZShpaSksamUucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wU2Vjb25kPWtlKFFlKSxqZS5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBNaWxsaXNlY29uZD1rZShYZSksamUucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wTWljcm9zZWNvbmQ9a2UodGkpLGplLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcE5hbm9zZWNvbmQ9a2UoZWkpLGplLnByb3RvdHlwZS52aXNpdFRpbWU9a2UoYWkpLGplLnByb3RvdHlwZS52aXNpdFRpbWVTZWNvbmQ9a2UobmkpLGplLnByb3RvdHlwZS52aXNpdFRpbWVNaWxsaXNlY29uZD1rZShyaSksamUucHJvdG90eXBlLnZpc2l0VGltZU1pY3Jvc2Vjb25kPWtlKHNpKSxqZS5wcm90b3R5cGUudmlzaXRUaW1lTmFub3NlY29uZD1rZShvaSksamUucHJvdG90eXBlLnZpc2l0RGVjaW1hbD1rZShsaSksamUucHJvdG90eXBlLnZpc2l0TGlzdD1rZSgoKHQsZSxpKT0+e2NvbnN0IG49dC5jaGlsZHJlblswXSxyPXQudmFsdWVPZmZzZXRzLHM9ZmkuZ2V0VmlzaXRGbihuKTtpZihBcnJheS5pc0FycmF5KGkpKWZvcihsZXQgbz0tMSxhPXJbZV0sbD1yW2UrMV07YTxsOylzKG4sYSsrLGlbKytvXSk7ZWxzZSBmb3IobGV0IG89LTEsYT1yW2VdLGw9cltlKzFdO2E8bDspcyhuLGErKyxpLmdldCgrK28pKX0pKSxqZS5wcm90b3R5cGUudmlzaXRTdHJ1Y3Q9a2UoKCh0LGUsaSk9Pntjb25zdCBuPXQudHlwZS5jaGlsZHJlbi5tYXAoKHQ9PmZpLmdldFZpc2l0Rm4odC50eXBlKSkpLHI9aSBpbnN0YW5jZW9mIE1hcD8ocz1lLG89aSwodCxlLGksbik9PmUmJnQoZSxzLG8uZ2V0KGkubmFtZSkpKTppIGluc3RhbmNlb2YgQ24/KCh0LGUpPT4oaSxuLHIscyk9Pm4mJmkobix0LGUuZ2V0KHMpKSkoZSxpKTpBcnJheS5pc0FycmF5KGkpPygodCxlKT0+KGksbixyLHMpPT5uJiZpKG4sdCxlW3NdKSkoZSxpKTooKHQsZSk9PihpLG4scixzKT0+biYmaShuLHQsZVtyLm5hbWVdKSkoZSxpKTt2YXIgcyxvO3QudHlwZS5jaGlsZHJlbi5mb3JFYWNoKCgoZSxpKT0+cihuW2ldLHQuY2hpbGRyZW5baV0sZSxpKSkpfSkpLGplLnByb3RvdHlwZS52aXNpdFVuaW9uPWtlKCgodCxlLGkpPT57dC50eXBlLm1vZGU9PT1sdC5EZW5zZT9jaSh0LGUsaSk6aGkodCxlLGkpfSkpLGplLnByb3RvdHlwZS52aXNpdERlbnNlVW5pb249a2UoY2kpLGplLnByb3RvdHlwZS52aXNpdFNwYXJzZVVuaW9uPWtlKGhpKSxqZS5wcm90b3R5cGUudmlzaXREaWN0aW9uYXJ5PWtlKCgodCxlLGkpPT57dmFyIG47bnVsbD09PShuPXQuZGljdGlvbmFyeSl8fHZvaWQgMD09PW58fG4uc2V0KHQudmFsdWVzW2VdLGkpfSkpLGplLnByb3RvdHlwZS52aXNpdEludGVydmFsPWtlKHVpKSxqZS5wcm90b3R5cGUudmlzaXRJbnRlcnZhbERheVRpbWU9a2UoZGkpLGplLnByb3RvdHlwZS52aXNpdEludGVydmFsWWVhck1vbnRoPWtlKHBpKSxqZS5wcm90b3R5cGUudmlzaXRGaXhlZFNpemVMaXN0PWtlKCgodCxlLGkpPT57Y29uc3R7c3RyaWRlOm59PXQscj10LmNoaWxkcmVuWzBdLHM9ZmkuZ2V0VmlzaXRGbihyKTtpZihBcnJheS5pc0FycmF5KGkpKWZvcihsZXQgbz0tMSxhPWUqbjsrK288bjspcyhyLGErbyxpW29dKTtlbHNlIGZvcihsZXQgbz0tMSxhPWUqbjsrK288bjspcyhyLGErbyxpLmdldChvKSl9KSksamUucHJvdG90eXBlLnZpc2l0TWFwPWtlKCgodCxlLGkpPT57Y29uc3Qgbj10LmNoaWxkcmVuWzBdLHI9dC52YWx1ZU9mZnNldHMscz1maS5nZXRWaXNpdEZuKG4pO2xldHtbZV06byxbZSsxXTphfT1yO2NvbnN0IGw9aSBpbnN0YW5jZW9mIE1hcD9pLmVudHJpZXMoKTpPYmplY3QuZW50cmllcyhpKTtmb3IoY29uc3QgYyBvZiBsKWlmKHMobixvLGMpLCsrbz49YSlicmVha30pKTtjb25zdCBmaT1uZXcgamUseWk9U3ltYm9sLmZvcigicGFyZW50IiksYmk9U3ltYm9sLmZvcigicm93SW5kZXgiKTtjbGFzcyBnaXtjb25zdHJ1Y3Rvcih0LGUpe3JldHVybiB0aGlzW3lpXT10LHRoaXNbYmldPWUsbmV3IFByb3h5KHRoaXMsbmV3IF9pKX10b0FycmF5KCl7cmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy50b0pTT04oKSl9dG9KU09OKCl7Y29uc3QgdD10aGlzW2JpXSxlPXRoaXNbeWldLGk9ZS50eXBlLmNoaWxkcmVuLG49e307Zm9yKGxldCByPS0xLHM9aS5sZW5ndGg7KytyPHM7KW5baVtyXS5uYW1lXT1qaS52aXNpdChlLmNoaWxkcmVuW3JdLHQpO3JldHVybiBufXRvU3RyaW5nKCl7cmV0dXJuYHske1suLi50aGlzXS5tYXAoKChbdCxlXSk9PmAke0J0KHQpfTogJHtCdChlKX1gKSkuam9pbigiLCAiKX19YH1bU3ltYm9sLmZvcigibm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20iKV0oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfVtTeW1ib2wuaXRlcmF0b3JdKCl7cmV0dXJuIG5ldyBtaSh0aGlzW3lpXSx0aGlzW2JpXSl9fWNsYXNzIG1pe2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5jaGlsZEluZGV4PTAsdGhpcy5jaGlsZHJlbj10LmNoaWxkcmVuLHRoaXMucm93SW5kZXg9ZSx0aGlzLmNoaWxkRmllbGRzPXQudHlwZS5jaGlsZHJlbix0aGlzLm51bUNoaWxkcmVuPXRoaXMuY2hpbGRGaWVsZHMubGVuZ3RofVtTeW1ib2wuaXRlcmF0b3JdKCl7cmV0dXJuIHRoaXN9bmV4dCgpe2NvbnN0IHQ9dGhpcy5jaGlsZEluZGV4O3JldHVybiB0PHRoaXMubnVtQ2hpbGRyZW4/KHRoaXMuY2hpbGRJbmRleD10KzEse2RvbmU6ITEsdmFsdWU6W3RoaXMuY2hpbGRGaWVsZHNbdF0ubmFtZSxqaS52aXNpdCh0aGlzLmNoaWxkcmVuW3RdLHRoaXMucm93SW5kZXgpXX0pOntkb25lOiEwLHZhbHVlOm51bGx9fX1PYmplY3QuZGVmaW5lUHJvcGVydGllcyhnaS5wcm90b3R5cGUse1tTeW1ib2wudG9TdHJpbmdUYWddOntlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMSx2YWx1ZToiUm93In0sW3lpXTp7d3JpdGFibGU6ITAsZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITEsdmFsdWU6bnVsbH0sW2JpXTp7d3JpdGFibGU6ITAsZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITEsdmFsdWU6LTF9fSk7Y2xhc3MgX2l7aXNFeHRlbnNpYmxlKCl7cmV0dXJuITF9ZGVsZXRlUHJvcGVydHkoKXtyZXR1cm4hMX1wcmV2ZW50RXh0ZW5zaW9ucygpe3JldHVybiEwfW93bktleXModCl7cmV0dXJuIHRbeWldLnR5cGUuY2hpbGRyZW4ubWFwKCh0PT50Lm5hbWUpKX1oYXModCxlKXtyZXR1cm4tMSE9PXRbeWldLnR5cGUuY2hpbGRyZW4uZmluZEluZGV4KCh0PT50Lm5hbWU9PT1lKSl9Z2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsZSl7aWYoLTEhPT10W3lpXS50eXBlLmNoaWxkcmVuLmZpbmRJbmRleCgodD0+dC5uYW1lPT09ZSkpKXJldHVybnt3cml0YWJsZTohMCxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19Z2V0KHQsZSl7aWYoUmVmbGVjdC5oYXModCxlKSlyZXR1cm4gdFtlXTtjb25zdCBpPXRbeWldLnR5cGUuY2hpbGRyZW4uZmluZEluZGV4KCh0PT50Lm5hbWU9PT1lKSk7aWYoLTEhPT1pKXtjb25zdCBuPWppLnZpc2l0KHRbeWldLmNoaWxkcmVuW2ldLHRbYmldKTtyZXR1cm4gUmVmbGVjdC5zZXQodCxlLG4pLG59fXNldCh0LGUsaSl7Y29uc3Qgbj10W3lpXS50eXBlLmNoaWxkcmVuLmZpbmRJbmRleCgodD0+dC5uYW1lPT09ZSkpO3JldHVybi0xIT09bj8oZmkudmlzaXQodFt5aV0uY2hpbGRyZW5bbl0sdFtiaV0saSksUmVmbGVjdC5zZXQodCxlLGkpKTohIVJlZmxlY3QuaGFzKHQsZSkmJlJlZmxlY3Quc2V0KHQsZSxpKX19Y2xhc3MgdmkgZXh0ZW5kcyBVZXt9ZnVuY3Rpb24gd2kodCl7cmV0dXJuKGUsaSk9PmUuZ2V0VmFsaWQoaSk/dChlLGkpOm51bGx9Y29uc3QgSWk9KHQsZSk9PjQyOTQ5NjcyOTYqdFtlKzFdKyh0W2VdPj4+MCksU2k9dD0+bmV3IERhdGUodCksQmk9KHQsZSxpKT0+e2NvbnN0e1tpXTpuLFtpKzFdOnJ9PWU7cmV0dXJuIG51bGwhPW4mJm51bGwhPXI/dC5zdWJhcnJheShuLHIpOm51bGx9LEFpPSh7dmFsdWVzOnR9LGUpPT4oKHQsZSk9PlNpKCgodCxlKT0+ODY0ZTUqdFtlXSkodCxlKSkpKHQsZSksVGk9KHt2YWx1ZXM6dH0sZSk9PigodCxlKT0+U2koSWkodCxlKSkpKHQsMiplKSxPaT0oe3N0cmlkZTp0LHZhbHVlczplfSxpKT0+ZVt0KmldLERpPSh7dmFsdWVzOnR9LGUpPT50W2VdLHhpPSh7dmFsdWVzOnR9LGUpPT4xZTMqSWkodCwyKmUpLE1pPSh7dmFsdWVzOnR9LGUpPT5JaSh0LDIqZSksRmk9KHt2YWx1ZXM6dH0sZSk9PigodCxlKT0+dFtlKzFdLzFlMyo0Mjk0OTY3Mjk2Kyh0W2VdPj4+MCkvMWUzKSh0LDIqZSksTGk9KHt2YWx1ZXM6dH0sZSk9PigodCxlKT0+dFtlKzFdLzFlNio0Mjk0OTY3Mjk2Kyh0W2VdPj4+MCkvMWU2KSh0LDIqZSksTmk9KHt2YWx1ZXM6dH0sZSk9PnRbZV0sVWk9KHt2YWx1ZXM6dH0sZSk9PnRbZV0sQ2k9KHt2YWx1ZXM6dH0sZSk9PnRbZV0sRWk9KHt2YWx1ZXM6dH0sZSk9PnRbZV0sVmk9KHQsZSk9Pntjb25zdCBpPXQudHlwZS50eXBlSWRUb0NoaWxkSW5kZXhbdC50eXBlSWRzW2VdXSxuPXQuY2hpbGRyZW5baV07cmV0dXJuIGppLnZpc2l0KG4sdC52YWx1ZU9mZnNldHNbZV0pfSxSaT0odCxlKT0+e2NvbnN0IGk9dC50eXBlLnR5cGVJZFRvQ2hpbGRJbmRleFt0LnR5cGVJZHNbZV1dLG49dC5jaGlsZHJlbltpXTtyZXR1cm4gamkudmlzaXQobixlKX0semk9KHt2YWx1ZXM6dH0sZSk9PnQuc3ViYXJyYXkoMiplLDIqKGUrMSkpLFBpPSh7dmFsdWVzOnR9LGUpPT57Y29uc3QgaT10W2VdLG49bmV3IEludDMyQXJyYXkoMik7cmV0dXJuIG5bMF09TWF0aC50cnVuYyhpLzEyKSxuWzFdPU1hdGgudHJ1bmMoaSUxMiksbn07dmkucHJvdG90eXBlLnZpc2l0TnVsbD13aSgoKHQsZSk9Pm51bGwpKSx2aS5wcm90b3R5cGUudmlzaXRCb29sPXdpKCgoe29mZnNldDp0LHZhbHVlczplfSxpKT0+e2NvbnN0IG49dCtpO3JldHVybiAwIT0oZVtuPj4zXSYxPDxuJTgpfSkpLHZpLnByb3RvdHlwZS52aXNpdEludD13aSgoKHt2YWx1ZXM6dH0sZSk9PnRbZV0pKSx2aS5wcm90b3R5cGUudmlzaXRJbnQ4PXdpKE9pKSx2aS5wcm90b3R5cGUudmlzaXRJbnQxNj13aShPaSksdmkucHJvdG90eXBlLnZpc2l0SW50MzI9d2koT2kpLHZpLnByb3RvdHlwZS52aXNpdEludDY0PXdpKERpKSx2aS5wcm90b3R5cGUudmlzaXRVaW50OD13aShPaSksdmkucHJvdG90eXBlLnZpc2l0VWludDE2PXdpKE9pKSx2aS5wcm90b3R5cGUudmlzaXRVaW50MzI9d2koT2kpLHZpLnByb3RvdHlwZS52aXNpdFVpbnQ2ND13aShEaSksdmkucHJvdG90eXBlLnZpc2l0RmxvYXQ9d2koKCh7dHlwZTp0LHZhbHVlczplfSxpKT0+dC5wcmVjaXNpb24hPT1odC5IQUxGP2VbaV06emUoZVtpXSkpKSx2aS5wcm90b3R5cGUudmlzaXRGbG9hdDE2PXdpKCgoe3N0cmlkZTp0LHZhbHVlczplfSxpKT0+emUoZVt0KmldKSkpLHZpLnByb3RvdHlwZS52aXNpdEZsb2F0MzI9d2koT2kpLHZpLnByb3RvdHlwZS52aXNpdEZsb2F0NjQ9d2koT2kpLHZpLnByb3RvdHlwZS52aXNpdFV0Zjg9d2koKCh7dmFsdWVzOnQsdmFsdWVPZmZzZXRzOmV9LGkpPT57Y29uc3Qgbj1CaSh0LGUsaSk7cmV0dXJuIG51bGwhPT1uP1Mobik6bnVsbH0pKSx2aS5wcm90b3R5cGUudmlzaXRCaW5hcnk9d2koKCh7dmFsdWVzOnQsdmFsdWVPZmZzZXRzOmV9LGkpPT5CaSh0LGUsaSkpKSx2aS5wcm90b3R5cGUudmlzaXRGaXhlZFNpemVCaW5hcnk9d2koKCh7c3RyaWRlOnQsdmFsdWVzOmV9LGkpPT5lLnN1YmFycmF5KHQqaSx0KihpKzEpKSkpLHZpLnByb3RvdHlwZS52aXNpdERhdGU9d2koKCh0LGUpPT50LnR5cGUudW5pdD09PWR0LkRBWT9BaSh0LGUpOlRpKHQsZSkpKSx2aS5wcm90b3R5cGUudmlzaXREYXRlRGF5PXdpKEFpKSx2aS5wcm90b3R5cGUudmlzaXREYXRlTWlsbGlzZWNvbmQ9d2koVGkpLHZpLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcD13aSgoKHQsZSk9Pntzd2l0Y2godC50eXBlLnVuaXQpe2Nhc2UgZnQuU0VDT05EOnJldHVybiB4aSh0LGUpO2Nhc2UgZnQuTUlMTElTRUNPTkQ6cmV0dXJuIE1pKHQsZSk7Y2FzZSBmdC5NSUNST1NFQ09ORDpyZXR1cm4gRmkodCxlKTtjYXNlIGZ0Lk5BTk9TRUNPTkQ6cmV0dXJuIExpKHQsZSl9fSkpLHZpLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcFNlY29uZD13aSh4aSksdmkucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wTWlsbGlzZWNvbmQ9d2koTWkpLHZpLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcE1pY3Jvc2Vjb25kPXdpKEZpKSx2aS5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBOYW5vc2Vjb25kPXdpKExpKSx2aS5wcm90b3R5cGUudmlzaXRUaW1lPXdpKCgodCxlKT0+e3N3aXRjaCh0LnR5cGUudW5pdCl7Y2FzZSBmdC5TRUNPTkQ6cmV0dXJuIE5pKHQsZSk7Y2FzZSBmdC5NSUxMSVNFQ09ORDpyZXR1cm4gVWkodCxlKTtjYXNlIGZ0Lk1JQ1JPU0VDT05EOnJldHVybiBDaSh0LGUpO2Nhc2UgZnQuTkFOT1NFQ09ORDpyZXR1cm4gRWkodCxlKX19KSksdmkucHJvdG90eXBlLnZpc2l0VGltZVNlY29uZD13aShOaSksdmkucHJvdG90eXBlLnZpc2l0VGltZU1pbGxpc2Vjb25kPXdpKFVpKSx2aS5wcm90b3R5cGUudmlzaXRUaW1lTWljcm9zZWNvbmQ9d2koQ2kpLHZpLnByb3RvdHlwZS52aXNpdFRpbWVOYW5vc2Vjb25kPXdpKEVpKSx2aS5wcm90b3R5cGUudmlzaXREZWNpbWFsPXdpKCgoe3ZhbHVlczp0LHN0cmlkZTplfSxpKT0+VXQuZGVjaW1hbCh0LnN1YmFycmF5KGUqaSxlKihpKzEpKSkpKSx2aS5wcm90b3R5cGUudmlzaXRMaXN0PXdpKCgodCxlKT0+e2NvbnN0e3ZhbHVlT2Zmc2V0czppLHN0cmlkZTpufT10LHtbZSpuXTpyfT1pLHtbZSpuKzFdOnN9PWksbz10LmNoaWxkcmVuWzBdLnNsaWNlKHIscy1yKTtyZXR1cm4gbmV3IENuKFtvXSl9KSksdmkucHJvdG90eXBlLnZpc2l0U3RydWN0PXdpKCgodCxlKT0+bmV3IGdpKHQsZSkpKSx2aS5wcm90b3R5cGUudmlzaXRVbmlvbj13aSgoKHQsZSk9PnQudHlwZS5tb2RlPT09bHQuRGVuc2U/VmkodCxlKTpSaSh0LGUpKSksdmkucHJvdG90eXBlLnZpc2l0RGVuc2VVbmlvbj13aShWaSksdmkucHJvdG90eXBlLnZpc2l0U3BhcnNlVW5pb249d2koUmkpLHZpLnByb3RvdHlwZS52aXNpdERpY3Rpb25hcnk9d2koKCh0LGUpPT57dmFyIGk7cmV0dXJuIG51bGw9PT0oaT10LmRpY3Rpb25hcnkpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmdldCh0LnZhbHVlc1tlXSl9KSksdmkucHJvdG90eXBlLnZpc2l0SW50ZXJ2YWw9d2koKCh0LGUpPT50LnR5cGUudW5pdD09PWJ0LkRBWV9USU1FP3ppKHQsZSk6UGkodCxlKSkpLHZpLnByb3RvdHlwZS52aXNpdEludGVydmFsRGF5VGltZT13aSh6aSksdmkucHJvdG90eXBlLnZpc2l0SW50ZXJ2YWxZZWFyTW9udGg9d2koUGkpLHZpLnByb3RvdHlwZS52aXNpdEZpeGVkU2l6ZUxpc3Q9d2koKCh0LGUpPT57Y29uc3R7c3RyaWRlOml9PXQsbj10LmNoaWxkcmVuWzBdLnNsaWNlKGUqaSxpKTtyZXR1cm4gbmV3IENuKFtuXSl9KSksdmkucHJvdG90eXBlLnZpc2l0TWFwPXdpKCgodCxlKT0+e2NvbnN0e3ZhbHVlT2Zmc2V0czppfT10LHtbZV06bn09aSx7W2UrMV06cn09aSxzPXQuY2hpbGRyZW5bMF07cmV0dXJuIG5ldyBZaShzLnNsaWNlKG4sci1uKSl9KSk7Y29uc3Qgamk9bmV3IHZpLGtpPVN5bWJvbC5mb3IoImtleXMiKSwkaT1TeW1ib2wuZm9yKCJ2YWxzIik7Y2xhc3MgWWl7Y29uc3RydWN0b3IodCl7cmV0dXJuIHRoaXNba2ldPW5ldyBDbihbdC5jaGlsZHJlblswXV0pLm1lbW9pemUoKSx0aGlzWyRpXT10LmNoaWxkcmVuWzFdLG5ldyBQcm94eSh0aGlzLG5ldyBIaSl9W1N5bWJvbC5pdGVyYXRvcl0oKXtyZXR1cm4gbmV3IFdpKHRoaXNba2ldLHRoaXNbJGldKX1nZXQgc2l6ZSgpe3JldHVybiB0aGlzW2tpXS5sZW5ndGh9dG9BcnJheSgpe3JldHVybiBPYmplY3QudmFsdWVzKHRoaXMudG9KU09OKCkpfXRvSlNPTigpe2NvbnN0IHQ9dGhpc1traV0sZT10aGlzWyRpXSxpPXt9O2ZvcihsZXQgbj0tMSxyPXQubGVuZ3RoOysrbjxyOylpW3QuZ2V0KG4pXT1qaS52aXNpdChlLG4pO3JldHVybiBpfXRvU3RyaW5nKCl7cmV0dXJuYHske1suLi50aGlzXS5tYXAoKChbdCxlXSk9PmAke0J0KHQpfTogJHtCdChlKX1gKSkuam9pbigiLCAiKX19YH1bU3ltYm9sLmZvcigibm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20iKV0oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfX1jbGFzcyBXaXtjb25zdHJ1Y3Rvcih0LGUpe3RoaXMua2V5cz10LHRoaXMudmFscz1lLHRoaXMua2V5SW5kZXg9MCx0aGlzLm51bUtleXM9dC5sZW5ndGh9W1N5bWJvbC5pdGVyYXRvcl0oKXtyZXR1cm4gdGhpc31uZXh0KCl7Y29uc3QgdD10aGlzLmtleUluZGV4O3JldHVybiB0PT09dGhpcy5udW1LZXlzP3tkb25lOiEwLHZhbHVlOm51bGx9Oih0aGlzLmtleUluZGV4Kysse2RvbmU6ITEsdmFsdWU6W3RoaXMua2V5cy5nZXQodCksamkudmlzaXQodGhpcy52YWxzLHQpXX0pfX1jbGFzcyBIaXtpc0V4dGVuc2libGUoKXtyZXR1cm4hMX1kZWxldGVQcm9wZXJ0eSgpe3JldHVybiExfXByZXZlbnRFeHRlbnNpb25zKCl7cmV0dXJuITB9b3duS2V5cyh0KXtyZXR1cm4gdFtraV0udG9BcnJheSgpLm1hcChTdHJpbmcpfWhhcyh0LGUpe3JldHVybiB0W2tpXS5pbmNsdWRlcyhlKX1nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxlKXtpZigtMSE9PXRba2ldLmluZGV4T2YoZSkpcmV0dXJue3dyaXRhYmxlOiEwLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfX1nZXQodCxlKXtpZihSZWZsZWN0Lmhhcyh0LGUpKXJldHVybiB0W2VdO2NvbnN0IGk9dFtraV0uaW5kZXhPZihlKTtpZigtMSE9PWkpe2NvbnN0IG49amkudmlzaXQoUmVmbGVjdC5nZXQodCwkaSksaSk7cmV0dXJuIFJlZmxlY3Quc2V0KHQsZSxuKSxufX1zZXQodCxlLGkpe2NvbnN0IG49dFtraV0uaW5kZXhPZihlKTtyZXR1cm4tMSE9PW4/KGZpLnZpc2l0KFJlZmxlY3QuZ2V0KHQsJGkpLG4saSksUmVmbGVjdC5zZXQodCxlLGkpKTohIVJlZmxlY3QuaGFzKHQsZSkmJlJlZmxlY3Quc2V0KHQsZSxpKX19bGV0IEtpO2Z1bmN0aW9uIEppKHQsZSxpLG4pe2NvbnN0e2xlbmd0aDpyPTB9PXQ7bGV0IHM9Im51bWJlciIhPXR5cGVvZiBlPzA6ZSxvPSJudW1iZXIiIT10eXBlb2YgaT9yOmk7cmV0dXJuIHM8MCYmKHM9KHMlcityKSVyKSxvPDAmJihvPShvJXIrciklciksbzxzJiYoS2k9cyxzPW8sbz1LaSksbz5yJiYobz1yKSxuP24odCxzLG8pOltzLG9dfU9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFlpLnByb3RvdHlwZSx7W1N5bWJvbC50b1N0cmluZ1RhZ106e2VudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiExLHZhbHVlOiJSb3cifSxba2ldOnt3cml0YWJsZTohMCxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMSx2YWx1ZTpudWxsfSxbJGldOnt3cml0YWJsZTohMCxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMSx2YWx1ZTpudWxsfX0pO2NvbnN0IEdpPXQ9PnQhPXQ7ZnVuY3Rpb24gWmkodCl7aWYoIm9iamVjdCIhPT10eXBlb2YgdHx8bnVsbD09PXQpcmV0dXJuIEdpKHQpP0dpOmU9PmU9PT10O2lmKHQgaW5zdGFuY2VvZiBEYXRlKXtjb25zdCBlPXQudmFsdWVPZigpO3JldHVybiB0PT50IGluc3RhbmNlb2YgRGF0ZSYmdC52YWx1ZU9mKCk9PT1lfXJldHVybiBBcnJheUJ1ZmZlci5pc1ZpZXcodCk/ZT0+ISFlJiZmdW5jdGlvbih0LGUpe2xldCBpPTA7Y29uc3Qgbj10Lmxlbmd0aDtpZihuIT09ZS5sZW5ndGgpcmV0dXJuITE7aWYobj4wKWRve2lmKHRbaV0hPT1lW2ldKXJldHVybiExfXdoaWxlKCsraTxuKTtyZXR1cm4hMH0odCxlKTp0IGluc3RhbmNlb2YgTWFwP2Z1bmN0aW9uKHQpe2xldCBlPS0xO2NvbnN0IGk9W107Zm9yKGNvbnN0IG4gb2YgdC52YWx1ZXMoKSlpWysrZV09Wmkobik7cmV0dXJuIHFpKGkpfSh0KTpBcnJheS5pc0FycmF5KHQpP2Z1bmN0aW9uKHQpe2NvbnN0IGU9W107Zm9yKGxldCBpPS0xLG49dC5sZW5ndGg7KytpPG47KWVbaV09WmkodFtpXSk7cmV0dXJuIHFpKGUpfSh0KTp0IGluc3RhbmNlb2YgQ24/ZnVuY3Rpb24odCl7Y29uc3QgZT1bXTtmb3IobGV0IGk9LTEsbj10Lmxlbmd0aDsrK2k8bjspZVtpXT1aaSh0LmdldChpKSk7cmV0dXJuIHFpKGUpfSh0KTpmdW5jdGlvbih0LGU9ITEpe2NvbnN0IGk9T2JqZWN0LmtleXModCk7aWYoIWUmJjA9PT1pLmxlbmd0aClyZXR1cm4oKT0+ITE7Y29uc3Qgbj1bXTtmb3IobGV0IHI9LTEscz1pLmxlbmd0aDsrK3I8czspbltyXT1aaSh0W2lbcl1dKTtyZXR1cm4gcWkobixpKX0odCwhMCl9ZnVuY3Rpb24gcWkodCxlKXtyZXR1cm4gaT0+e2lmKCFpfHwib2JqZWN0IiE9dHlwZW9mIGkpcmV0dXJuITE7c3dpdGNoKGkuY29uc3RydWN0b3Ipe2Nhc2UgQXJyYXk6cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10Lmxlbmd0aDtpZihlLmxlbmd0aCE9PWkpcmV0dXJuITE7Zm9yKGxldCBuPS0xOysrbjxpOylpZighdFtuXShlW25dKSlyZXR1cm4hMTtyZXR1cm4hMH0odCxpKTtjYXNlIE1hcDpyZXR1cm4gUWkodCxpLGkua2V5cygpKTtjYXNlIFlpOmNhc2UgZ2k6Y2FzZSBPYmplY3Q6Y2FzZSB2b2lkIDA6cmV0dXJuIFFpKHQsaSxlfHxPYmplY3Qua2V5cyhpKSl9cmV0dXJuIGkgaW5zdGFuY2VvZiBDbiYmZnVuY3Rpb24odCxlKXtjb25zdCBpPXQubGVuZ3RoO2lmKGUubGVuZ3RoIT09aSlyZXR1cm4hMTtmb3IobGV0IG49LTE7KytuPGk7KWlmKCF0W25dKGUuZ2V0KG4pKSlyZXR1cm4hMTtyZXR1cm4hMH0odCxpKX19ZnVuY3Rpb24gUWkodCxlLGkpe2NvbnN0IG49aVtTeW1ib2wuaXRlcmF0b3JdKCkscj1lIGluc3RhbmNlb2YgTWFwP2Uua2V5cygpOk9iamVjdC5rZXlzKGUpW1N5bWJvbC5pdGVyYXRvcl0oKSxzPWUgaW5zdGFuY2VvZiBNYXA/ZS52YWx1ZXMoKTpPYmplY3QudmFsdWVzKGUpW1N5bWJvbC5pdGVyYXRvcl0oKTtsZXQgbz0wO2NvbnN0IGE9dC5sZW5ndGg7bGV0IGw9cy5uZXh0KCksYz1uLm5leHQoKSxoPXIubmV4dCgpO2Zvcig7bzxhJiYhYy5kb25lJiYhaC5kb25lJiYhbC5kb25lJiYoYy52YWx1ZT09PWgudmFsdWUmJnRbb10obC52YWx1ZSkpOysrbyxjPW4ubmV4dCgpLGg9ci5uZXh0KCksbD1zLm5leHQoKSk7cmV0dXJuISEobz09PWEmJmMuZG9uZSYmaC5kb25lJiZsLmRvbmUpfHwobi5yZXR1cm4mJm4ucmV0dXJuKCksci5yZXR1cm4mJnIucmV0dXJuKCkscy5yZXR1cm4mJnMucmV0dXJuKCksITEpfWZ1bmN0aW9uIFhpKHQsZSxpLG4pe3JldHVybiAwIT0oaSYxPDxuKX1mdW5jdGlvbiB0bih0LGUsaSxuKXtyZXR1cm4oaSYxPDxuKT4+bn1mdW5jdGlvbiBlbih0LGUsaSl7Y29uc3Qgbj1pLmJ5dGVMZW5ndGgrNyYtODtpZih0PjB8fGkuYnl0ZUxlbmd0aDxuKXtjb25zdCByPW5ldyBVaW50OEFycmF5KG4pO3JldHVybiByLnNldCh0JTg9PTA/aS5zdWJhcnJheSh0Pj4zKTpubihuZXcgcm4oaSx0LGUsbnVsbCxYaSkpLnN1YmFycmF5KDAsbikpLHJ9cmV0dXJuIGl9ZnVuY3Rpb24gbm4odCl7Y29uc3QgZT1bXTtsZXQgaT0wLG49MCxyPTA7Zm9yKGNvbnN0IG8gb2YgdClvJiYocnw9MTw8biksOD09KytuJiYoZVtpKytdPXIscj1uPTApOygwPT09aXx8bj4wKSYmKGVbaSsrXT1yKTtjb25zdCBzPW5ldyBVaW50OEFycmF5KGUubGVuZ3RoKzcmLTgpO3JldHVybiBzLnNldChlKSxzfWNsYXNzIHJue2NvbnN0cnVjdG9yKHQsZSxpLG4scil7dGhpcy5ieXRlcz10LHRoaXMubGVuZ3RoPWksdGhpcy5jb250ZXh0PW4sdGhpcy5nZXQ9cix0aGlzLmJpdD1lJTgsdGhpcy5ieXRlSW5kZXg9ZT4+Myx0aGlzLmJ5dGU9dFt0aGlzLmJ5dGVJbmRleCsrXSx0aGlzLmluZGV4PTB9bmV4dCgpe3JldHVybiB0aGlzLmluZGV4PHRoaXMubGVuZ3RoPyg4PT09dGhpcy5iaXQmJih0aGlzLmJpdD0wLHRoaXMuYnl0ZT10aGlzLmJ5dGVzW3RoaXMuYnl0ZUluZGV4KytdKSx7dmFsdWU6dGhpcy5nZXQodGhpcy5jb250ZXh0LHRoaXMuaW5kZXgrKyx0aGlzLmJ5dGUsdGhpcy5iaXQrKyl9KTp7ZG9uZTohMCx2YWx1ZTpudWxsfX1bU3ltYm9sLml0ZXJhdG9yXSgpe3JldHVybiB0aGlzfX1mdW5jdGlvbiBzbih0LGUsaSl7aWYoaS1lPD0wKXJldHVybiAwO2lmKGktZTw4KXtsZXQgbj0wO2Zvcihjb25zdCByIG9mIG5ldyBybih0LGUsaS1lLHQsdG4pKW4rPXI7cmV0dXJuIG59Y29uc3Qgbj1pPj4zPDwzLHI9ZSsoZSU4PT0wPzA6OC1lJTgpO3JldHVybiBzbih0LGUscikrc24odCxuLGkpK2Z1bmN0aW9uKHQsZSxpKXtsZXQgbj0wLHI9TWF0aC50cnVuYyhlKTtjb25zdCBzPW5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQsdC5ieXRlTGVuZ3RoKSxvPXZvaWQgMD09PWk/dC5ieXRlTGVuZ3RoOnIraTtmb3IoO28tcj49NDspbis9b24ocy5nZXRVaW50MzIocikpLHIrPTQ7Zm9yKDtvLXI+PTI7KW4rPW9uKHMuZ2V0VWludDE2KHIpKSxyKz0yO2Zvcig7by1yPj0xOyluKz1vbihzLmdldFVpbnQ4KHIpKSxyKz0xO3JldHVybiBufSh0LHI+PjMsbi1yPj4zKX1mdW5jdGlvbiBvbih0KXtsZXQgZT1NYXRoLnRydW5jKHQpO3JldHVybiBlLT1lPj4+MSYxNDMxNjU1NzY1LGU9KDg1ODk5MzQ1OSZlKSsoZT4+PjImODU4OTkzNDU5KSwxNjg0MzAwOSooZSsoZT4+PjQpJjI1MjY0NTEzNSk+Pj4yNH1jbGFzcyBhbntjb25zdHJ1Y3Rvcih0LGUsaSxuLHIscz1bXSxvKXtsZXQgYTt0aGlzLnR5cGU9dCx0aGlzLmNoaWxkcmVuPXMsdGhpcy5kaWN0aW9uYXJ5PW8sdGhpcy5vZmZzZXQ9TWF0aC5mbG9vcihNYXRoLm1heChlfHwwLDApKSx0aGlzLmxlbmd0aD1NYXRoLmZsb29yKE1hdGgubWF4KGl8fDAsMCkpLHRoaXMuX251bGxDb3VudD1NYXRoLmZsb29yKE1hdGgubWF4KG58fDAsLTEpKSxyIGluc3RhbmNlb2YgYW4/KHRoaXMuc3RyaWRlPXIuc3RyaWRlLHRoaXMudmFsdWVzPXIudmFsdWVzLHRoaXMudHlwZUlkcz1yLnR5cGVJZHMsdGhpcy5udWxsQml0bWFwPXIubnVsbEJpdG1hcCx0aGlzLnZhbHVlT2Zmc2V0cz1yLnZhbHVlT2Zmc2V0cyk6KHRoaXMuc3RyaWRlPU5lKHQpLHImJigoYT1yWzBdKSYmKHRoaXMudmFsdWVPZmZzZXRzPWEpLChhPXJbMV0pJiYodGhpcy52YWx1ZXM9YSksKGE9clsyXSkmJih0aGlzLm51bGxCaXRtYXA9YSksKGE9clszXSkmJih0aGlzLnR5cGVJZHM9YSkpKSx0aGlzLm51bGxhYmxlPTAhPT10aGlzLl9udWxsQ291bnQmJnRoaXMubnVsbEJpdG1hcCYmdGhpcy5udWxsQml0bWFwLmJ5dGVMZW5ndGg+MH1nZXQgdHlwZUlkKCl7cmV0dXJuIHRoaXMudHlwZS50eXBlSWR9Z2V0IEFycmF5VHlwZSgpe3JldHVybiB0aGlzLnR5cGUuQXJyYXlUeXBlfWdldCBidWZmZXJzKCl7cmV0dXJuW3RoaXMudmFsdWVPZmZzZXRzLHRoaXMudmFsdWVzLHRoaXMubnVsbEJpdG1hcCx0aGlzLnR5cGVJZHNdfWdldCBieXRlTGVuZ3RoKCl7bGV0IHQ9MDtjb25zdHt2YWx1ZU9mZnNldHM6ZSx2YWx1ZXM6aSxudWxsQml0bWFwOm4sdHlwZUlkczpyfT10aGlzO3JldHVybiBlJiYodCs9ZS5ieXRlTGVuZ3RoKSxpJiYodCs9aS5ieXRlTGVuZ3RoKSxuJiYodCs9bi5ieXRlTGVuZ3RoKSxyJiYodCs9ci5ieXRlTGVuZ3RoKSx0aGlzLmNoaWxkcmVuLnJlZHVjZSgoKHQsZSk9PnQrZS5ieXRlTGVuZ3RoKSx0KX1nZXQgbnVsbENvdW50KCl7bGV0IHQsZT10aGlzLl9udWxsQ291bnQ7cmV0dXJuIGU8PS0xJiYodD10aGlzLm51bGxCaXRtYXApJiYodGhpcy5fbnVsbENvdW50PWU9dGhpcy5sZW5ndGgtc24odCx0aGlzLm9mZnNldCx0aGlzLm9mZnNldCt0aGlzLmxlbmd0aCkpLGV9Z2V0VmFsaWQodCl7aWYodGhpcy5udWxsYWJsZSYmdGhpcy5udWxsQ291bnQ+MCl7Y29uc3QgZT10aGlzLm9mZnNldCt0O3JldHVybiAwIT0odGhpcy5udWxsQml0bWFwW2U+PjNdJjE8PGUlOCl9cmV0dXJuITB9c2V0VmFsaWQodCxlKXtpZighdGhpcy5udWxsYWJsZSlyZXR1cm4gZTtpZighdGhpcy5udWxsQml0bWFwfHx0aGlzLm51bGxCaXRtYXAuYnl0ZUxlbmd0aDw9dD4+Myl7Y29uc3R7bnVsbEJpdG1hcDp0fT10aGlzLl9jaGFuZ2VMZW5ndGhBbmRCYWNrZmlsbE51bGxCaXRtYXAodGhpcy5sZW5ndGgpO09iamVjdC5hc3NpZ24odGhpcyx7bnVsbEJpdG1hcDp0LF9udWxsQ291bnQ6MH0pfWNvbnN0e251bGxCaXRtYXA6aSxvZmZzZXQ6bn09dGhpcyxyPW4rdD4+MyxzPShuK3QpJTgsbz1pW3JdPj5zJjE7cmV0dXJuIGU/MD09PW8mJihpW3JdfD0xPDxzLHRoaXMuX251bGxDb3VudD10aGlzLm51bGxDb3VudCsxKToxPT09byYmKGlbcl0mPX4oMTw8cyksdGhpcy5fbnVsbENvdW50PXRoaXMubnVsbENvdW50LTEpLGV9Y2xvbmUodD10aGlzLnR5cGUsZT10aGlzLm9mZnNldCxpPXRoaXMubGVuZ3RoLG49dGhpcy5fbnVsbENvdW50LHI9dGhpcyxzPXRoaXMuY2hpbGRyZW4pe3JldHVybiBuZXcgYW4odCxlLGksbixyLHMsdGhpcy5kaWN0aW9uYXJ5KX1zbGljZSh0LGUpe2NvbnN0e3N0cmlkZTppLHR5cGVJZDpuLGNoaWxkcmVuOnJ9PXRoaXMscz0rKDA9PT10aGlzLl9udWxsQ291bnQpLTEsbz0xNj09PW4/aToxLGE9dGhpcy5fc2xpY2VCdWZmZXJzKHQsZSxpLG4pO3JldHVybiB0aGlzLmNsb25lKHRoaXMudHlwZSx0aGlzLm9mZnNldCt0LGUscyxhLDA9PT1yLmxlbmd0aHx8dGhpcy52YWx1ZU9mZnNldHM/cjp0aGlzLl9zbGljZUNoaWxkcmVuKHIsbyp0LG8qZSkpfV9jaGFuZ2VMZW5ndGhBbmRCYWNrZmlsbE51bGxCaXRtYXAodCl7aWYodGhpcy50eXBlSWQ9PT12dC5OdWxsKXJldHVybiB0aGlzLmNsb25lKHRoaXMudHlwZSwwLHQsMCk7Y29uc3R7bGVuZ3RoOmUsbnVsbENvdW50Oml9PXRoaXMsbj1uZXcgVWludDhBcnJheSgodCs2MyYtNjQpPj4zKS5maWxsKDI1NSwwLGU+PjMpO25bZT4+M109KDE8PGUtKC04JmUpKS0xLGk+MCYmbi5zZXQoZW4odGhpcy5vZmZzZXQsZSx0aGlzLm51bGxCaXRtYXApLDApO2NvbnN0IHI9dGhpcy5idWZmZXJzO3JldHVybiByW0l0LlZBTElESVRZXT1uLHRoaXMuY2xvbmUodGhpcy50eXBlLDAsdCxpKyh0LWUpLHIpfV9zbGljZUJ1ZmZlcnModCxlLGksbil7bGV0IHI7Y29uc3R7YnVmZmVyczpzfT10aGlzO3JldHVybihyPXNbSXQuVFlQRV0pJiYoc1tJdC5UWVBFXT1yLnN1YmFycmF5KHQsdCtlKSksKHI9c1tJdC5PRkZTRVRdKSYmKHNbSXQuT0ZGU0VUXT1yLnN1YmFycmF5KHQsdCtlKzEpKXx8KHI9c1tJdC5EQVRBXSkmJihzW0l0LkRBVEFdPTY9PT1uP3I6ci5zdWJhcnJheShpKnQsaSoodCtlKSkpLHN9X3NsaWNlQ2hpbGRyZW4odCxlLGkpe3JldHVybiB0Lm1hcCgodD0+dC5zbGljZShlLGkpKSl9fWFuLnByb3RvdHlwZS5jaGlsZHJlbj1PYmplY3QuZnJlZXplKFtdKTtjbGFzcyBsbiBleHRlbmRzIFVle3Zpc2l0KHQpe3JldHVybiB0aGlzLmdldFZpc2l0Rm4odC50eXBlKS5jYWxsKHRoaXMsdCl9dmlzaXROdWxsKHQpe2NvbnN0e3R5cGU6ZSxvZmZzZXQ6aT0wLGxlbmd0aDpuPTB9PXQ7cmV0dXJuIG5ldyBhbihlLGksbiwwKX12aXNpdEJvb2wodCl7Y29uc3R7dHlwZTplLG9mZnNldDppPTB9PXQsbj1aKHQubnVsbEJpdG1hcCkscj1KKGUuQXJyYXlUeXBlLHQuZGF0YSkse2xlbmd0aDpzPXIubGVuZ3RoPj4zLG51bGxDb3VudDpvPSh0Lm51bGxCaXRtYXA/LTE6MCl9PXQ7cmV0dXJuIG5ldyBhbihlLGkscyxvLFt2b2lkIDAscixuXSl9dmlzaXRJbnQodCl7Y29uc3R7dHlwZTplLG9mZnNldDppPTB9PXQsbj1aKHQubnVsbEJpdG1hcCkscj1KKGUuQXJyYXlUeXBlLHQuZGF0YSkse2xlbmd0aDpzPXIubGVuZ3RoLG51bGxDb3VudDpvPSh0Lm51bGxCaXRtYXA/LTE6MCl9PXQ7cmV0dXJuIG5ldyBhbihlLGkscyxvLFt2b2lkIDAscixuXSl9dmlzaXRGbG9hdCh0KXtjb25zdHt0eXBlOmUsb2Zmc2V0Omk9MH09dCxuPVoodC5udWxsQml0bWFwKSxyPUooZS5BcnJheVR5cGUsdC5kYXRhKSx7bGVuZ3RoOnM9ci5sZW5ndGgsbnVsbENvdW50Om89KHQubnVsbEJpdG1hcD8tMTowKX09dDtyZXR1cm4gbmV3IGFuKGUsaSxzLG8sW3ZvaWQgMCxyLG5dKX12aXNpdFV0ZjgodCl7Y29uc3R7dHlwZTplLG9mZnNldDppPTB9PXQsbj1aKHQuZGF0YSkscj1aKHQubnVsbEJpdG1hcCkscz1HKHQudmFsdWVPZmZzZXRzKSx7bGVuZ3RoOm89cy5sZW5ndGgtMSxudWxsQ291bnQ6YT0odC5udWxsQml0bWFwPy0xOjApfT10O3JldHVybiBuZXcgYW4oZSxpLG8sYSxbcyxuLHJdKX12aXNpdEJpbmFyeSh0KXtjb25zdHt0eXBlOmUsb2Zmc2V0Omk9MH09dCxuPVoodC5kYXRhKSxyPVoodC5udWxsQml0bWFwKSxzPUcodC52YWx1ZU9mZnNldHMpLHtsZW5ndGg6bz1zLmxlbmd0aC0xLG51bGxDb3VudDphPSh0Lm51bGxCaXRtYXA/LTE6MCl9PXQ7cmV0dXJuIG5ldyBhbihlLGksbyxhLFtzLG4scl0pfXZpc2l0Rml4ZWRTaXplQmluYXJ5KHQpe2NvbnN0e3R5cGU6ZSxvZmZzZXQ6aT0wfT10LG49Wih0Lm51bGxCaXRtYXApLHI9SihlLkFycmF5VHlwZSx0LmRhdGEpLHtsZW5ndGg6cz1yLmxlbmd0aC9OZShlKSxudWxsQ291bnQ6bz0odC5udWxsQml0bWFwPy0xOjApfT10O3JldHVybiBuZXcgYW4oZSxpLHMsbyxbdm9pZCAwLHIsbl0pfXZpc2l0RGF0ZSh0KXtjb25zdHt0eXBlOmUsb2Zmc2V0Omk9MH09dCxuPVoodC5udWxsQml0bWFwKSxyPUooZS5BcnJheVR5cGUsdC5kYXRhKSx7bGVuZ3RoOnM9ci5sZW5ndGgvTmUoZSksbnVsbENvdW50Om89KHQubnVsbEJpdG1hcD8tMTowKX09dDtyZXR1cm4gbmV3IGFuKGUsaSxzLG8sW3ZvaWQgMCxyLG5dKX12aXNpdFRpbWVzdGFtcCh0KXtjb25zdHt0eXBlOmUsb2Zmc2V0Omk9MH09dCxuPVoodC5udWxsQml0bWFwKSxyPUooZS5BcnJheVR5cGUsdC5kYXRhKSx7bGVuZ3RoOnM9ci5sZW5ndGgvTmUoZSksbnVsbENvdW50Om89KHQubnVsbEJpdG1hcD8tMTowKX09dDtyZXR1cm4gbmV3IGFuKGUsaSxzLG8sW3ZvaWQgMCxyLG5dKX12aXNpdFRpbWUodCl7Y29uc3R7dHlwZTplLG9mZnNldDppPTB9PXQsbj1aKHQubnVsbEJpdG1hcCkscj1KKGUuQXJyYXlUeXBlLHQuZGF0YSkse2xlbmd0aDpzPXIubGVuZ3RoL05lKGUpLG51bGxDb3VudDpvPSh0Lm51bGxCaXRtYXA/LTE6MCl9PXQ7cmV0dXJuIG5ldyBhbihlLGkscyxvLFt2b2lkIDAscixuXSl9dmlzaXREZWNpbWFsKHQpe2NvbnN0e3R5cGU6ZSxvZmZzZXQ6aT0wfT10LG49Wih0Lm51bGxCaXRtYXApLHI9SihlLkFycmF5VHlwZSx0LmRhdGEpLHtsZW5ndGg6cz1yLmxlbmd0aC9OZShlKSxudWxsQ291bnQ6bz0odC5udWxsQml0bWFwPy0xOjApfT10O3JldHVybiBuZXcgYW4oZSxpLHMsbyxbdm9pZCAwLHIsbl0pfXZpc2l0TGlzdCh0KXtjb25zdHt0eXBlOmUsb2Zmc2V0Omk9MCxjaGlsZDpufT10LHI9Wih0Lm51bGxCaXRtYXApLHM9Ryh0LnZhbHVlT2Zmc2V0cykse2xlbmd0aDpvPXMubGVuZ3RoLTEsbnVsbENvdW50OmE9KHQubnVsbEJpdG1hcD8tMTowKX09dDtyZXR1cm4gbmV3IGFuKGUsaSxvLGEsW3Msdm9pZCAwLHJdLFtuXSl9dmlzaXRTdHJ1Y3QodCl7Y29uc3R7dHlwZTplLG9mZnNldDppPTAsY2hpbGRyZW46bj1bXX09dCxyPVoodC5udWxsQml0bWFwKSx7bGVuZ3RoOnM9bi5yZWR1Y2UoKCh0LHtsZW5ndGg6ZX0pPT5NYXRoLm1heCh0LGUpKSwwKSxudWxsQ291bnQ6bz0odC5udWxsQml0bWFwPy0xOjApfT10O3JldHVybiBuZXcgYW4oZSxpLHMsbyxbdm9pZCAwLHZvaWQgMCxyXSxuKX12aXNpdFVuaW9uKHQpe2NvbnN0e3R5cGU6ZSxvZmZzZXQ6aT0wLGNoaWxkcmVuOm49W119PXQscj1aKHQubnVsbEJpdG1hcCkscz1KKGUuQXJyYXlUeXBlLHQudHlwZUlkcykse2xlbmd0aDpvPXMubGVuZ3RoLG51bGxDb3VudDphPSh0Lm51bGxCaXRtYXA/LTE6MCl9PXQ7aWYoZWUuaXNTcGFyc2VVbmlvbihlKSlyZXR1cm4gbmV3IGFuKGUsaSxvLGEsW3ZvaWQgMCx2b2lkIDAscixzXSxuKTtjb25zdCBsPUcodC52YWx1ZU9mZnNldHMpO3JldHVybiBuZXcgYW4oZSxpLG8sYSxbbCx2b2lkIDAscixzXSxuKX12aXNpdERpY3Rpb25hcnkodCl7Y29uc3R7dHlwZTplLG9mZnNldDppPTB9PXQsbj1aKHQubnVsbEJpdG1hcCkscj1KKGUuaW5kaWNlcy5BcnJheVR5cGUsdC5kYXRhKSx7ZGljdGlvbmFyeTpzPW5ldyBDbihbKG5ldyBsbikudmlzaXQoe3R5cGU6ZS5kaWN0aW9uYXJ5fSldKX09dCx7bGVuZ3RoOm89ci5sZW5ndGgsbnVsbENvdW50OmE9KHQubnVsbEJpdG1hcD8tMTowKX09dDtyZXR1cm4gbmV3IGFuKGUsaSxvLGEsW3ZvaWQgMCxyLG5dLFtdLHMpfXZpc2l0SW50ZXJ2YWwodCl7Y29uc3R7dHlwZTplLG9mZnNldDppPTB9PXQsbj1aKHQubnVsbEJpdG1hcCkscj1KKGUuQXJyYXlUeXBlLHQuZGF0YSkse2xlbmd0aDpzPXIubGVuZ3RoL05lKGUpLG51bGxDb3VudDpvPSh0Lm51bGxCaXRtYXA/LTE6MCl9PXQ7cmV0dXJuIG5ldyBhbihlLGkscyxvLFt2b2lkIDAscixuXSl9dmlzaXRGaXhlZFNpemVMaXN0KHQpe2NvbnN0e3R5cGU6ZSxvZmZzZXQ6aT0wLGNoaWxkOm49KG5ldyBsbikudmlzaXQoe3R5cGU6ZS52YWx1ZVR5cGV9KX09dCxyPVoodC5udWxsQml0bWFwKSx7bGVuZ3RoOnM9bi5sZW5ndGgvTmUoZSksbnVsbENvdW50Om89KHQubnVsbEJpdG1hcD8tMTowKX09dDtyZXR1cm4gbmV3IGFuKGUsaSxzLG8sW3ZvaWQgMCx2b2lkIDAscl0sW25dKX12aXNpdE1hcCh0KXtjb25zdHt0eXBlOmUsb2Zmc2V0Omk9MCxjaGlsZDpuPShuZXcgbG4pLnZpc2l0KHt0eXBlOmUuY2hpbGRUeXBlfSl9PXQscj1aKHQubnVsbEJpdG1hcCkscz1HKHQudmFsdWVPZmZzZXRzKSx7bGVuZ3RoOm89cy5sZW5ndGgtMSxudWxsQ291bnQ6YT0odC5udWxsQml0bWFwPy0xOjApfT10O3JldHVybiBuZXcgYW4oZSxpLG8sYSxbcyx2b2lkIDAscl0sW25dKX19ZnVuY3Rpb24gY24odCl7cmV0dXJuKG5ldyBsbikudmlzaXQodCl9Y2xhc3MgaG57Y29uc3RydWN0b3IodD0wLGUpe3RoaXMubnVtQ2h1bmtzPXQsdGhpcy5nZXRDaHVua0l0ZXJhdG9yPWUsdGhpcy5jaHVua0luZGV4PTAsdGhpcy5jaHVua0l0ZXJhdG9yPXRoaXMuZ2V0Q2h1bmtJdGVyYXRvcigwKX1uZXh0KCl7Zm9yKDt0aGlzLmNodW5rSW5kZXg8dGhpcy5udW1DaHVua3M7KXtjb25zdCB0PXRoaXMuY2h1bmtJdGVyYXRvci5uZXh0KCk7aWYoIXQuZG9uZSlyZXR1cm4gdDsrK3RoaXMuY2h1bmtJbmRleDx0aGlzLm51bUNodW5rcyYmKHRoaXMuY2h1bmtJdGVyYXRvcj10aGlzLmdldENodW5rSXRlcmF0b3IodGhpcy5jaHVua0luZGV4KSl9cmV0dXJue2RvbmU6ITAsdmFsdWU6bnVsbH19W1N5bWJvbC5pdGVyYXRvcl0oKXtyZXR1cm4gdGhpc319ZnVuY3Rpb24gdW4odCl7cmV0dXJuIHQucmVkdWNlKCgodCxlKT0+dCtlLm51bGxDb3VudCksMCl9ZnVuY3Rpb24gZG4odCl7cmV0dXJuIHQucmVkdWNlKCgodCxlLGkpPT4odFtpKzFdPXRbaV0rZS5sZW5ndGgsdCkpLG5ldyBVaW50MzJBcnJheSh0Lmxlbmd0aCsxKSl9ZnVuY3Rpb24gcG4odCxlLGksbil7Y29uc3Qgcj1bXTtmb3IobGV0IHM9LTEsbz10Lmxlbmd0aDsrK3M8bzspe2NvbnN0IG89dFtzXSxhPWVbc10se2xlbmd0aDpsfT1vO2lmKGE+PW4pYnJlYWs7aWYoaT49YStsKWNvbnRpbnVlO2lmKGE+PWkmJmErbDw9bil7ci5wdXNoKG8pO2NvbnRpbnVlfWNvbnN0IGM9TWF0aC5tYXgoMCxpLWEpLGg9TWF0aC5taW4obi1hLGwpO3IucHVzaChvLnNsaWNlKGMsaC1jKSl9cmV0dXJuIDA9PT1yLmxlbmd0aCYmci5wdXNoKHRbMF0uc2xpY2UoMCwwKSkscn1mdW5jdGlvbiBmbih0LGUsaSxuKXtsZXQgcj0wLHM9MCxvPWUubGVuZ3RoLTE7ZG97aWYocj49by0xKXJldHVybiBpPGVbb10/bih0LHIsaS1lW3JdKTpudWxsO3M9citNYXRoLnRydW5jKC41KihvLXIpKSxpPGVbc10/bz1zOnI9c313aGlsZShyPG8pfWZ1bmN0aW9uIHluKHQsZSl7cmV0dXJuIHQuZ2V0VmFsaWQoZSl9ZnVuY3Rpb24gYm4odCl7ZnVuY3Rpb24gZShlLGksbil7cmV0dXJuIHQoZVtpXSxuKX1yZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGZuKHRoaXMuZGF0YSx0aGlzLl9vZmZzZXRzLHQsZSl9fWZ1bmN0aW9uIGduKHQpe2xldCBlO2Z1bmN0aW9uIGkoaSxuLHIpe3JldHVybiB0KGlbbl0scixlKX1yZXR1cm4gZnVuY3Rpb24odCxuKXtjb25zdCByPXRoaXMuZGF0YTtlPW47Y29uc3Qgcz1mbihyLHRoaXMuX29mZnNldHMsdCxpKTtyZXR1cm4gZT12b2lkIDAsc319ZnVuY3Rpb24gbW4odCl7bGV0IGU7ZnVuY3Rpb24gaShpLG4scil7bGV0IHM9cixvPTAsYT0wO2ZvcihsZXQgbD1uLTEsYz1pLmxlbmd0aDsrK2w8Yzspe2NvbnN0IG49aVtsXTtpZih+KG89dChuLGUscykpKXJldHVybiBhK287cz0wLGErPW4ubGVuZ3RofXJldHVybi0xfXJldHVybiBmdW5jdGlvbih0LG4pe2U9dDtjb25zdCByPXRoaXMuZGF0YSxzPSJudW1iZXIiIT10eXBlb2Ygbj9pKHIsMCwwKTpmbihyLHRoaXMuX29mZnNldHMsbixpKTtyZXR1cm4gZT12b2lkIDAsc319Y2xhc3MgX24gZXh0ZW5kcyBVZXt9ZnVuY3Rpb24gdm4odCxlLGkpe2lmKHZvaWQgMD09PWUpcmV0dXJuLTE7aWYobnVsbD09PWUpcmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3R7bnVsbEJpdG1hcDppfT10O2lmKCFpfHx0Lm51bGxDb3VudDw9MClyZXR1cm4tMTtsZXQgbj0wO2Zvcihjb25zdCByIG9mIG5ldyBybihpLHQub2Zmc2V0KyhlfHwwKSx0Lmxlbmd0aCxpLFhpKSl7aWYoIXIpcmV0dXJuIG47KytufXJldHVybi0xfSh0LGkpO2NvbnN0IG49amkuZ2V0VmlzaXRGbih0KSxyPVppKGUpO2ZvcihsZXQgcz0oaXx8MCktMSxvPXQubGVuZ3RoOysrczxvOylpZihyKG4odCxzKSkpcmV0dXJuIHM7cmV0dXJuLTF9ZnVuY3Rpb24gd24odCxlLGkpe2NvbnN0IG49amkuZ2V0VmlzaXRGbih0KSxyPVppKGUpO2ZvcihsZXQgcz0oaXx8MCktMSxvPXQubGVuZ3RoOysrczxvOylpZihyKG4odCxzKSkpcmV0dXJuIHM7cmV0dXJuLTF9X24ucHJvdG90eXBlLnZpc2l0TnVsbD1mdW5jdGlvbih0LGUpe3JldHVybiBudWxsPT09ZSYmdC5sZW5ndGg+MD8wOi0xfSxfbi5wcm90b3R5cGUudmlzaXRCb29sPXZuLF9uLnByb3RvdHlwZS52aXNpdEludD12bixfbi5wcm90b3R5cGUudmlzaXRJbnQ4PXZuLF9uLnByb3RvdHlwZS52aXNpdEludDE2PXZuLF9uLnByb3RvdHlwZS52aXNpdEludDMyPXZuLF9uLnByb3RvdHlwZS52aXNpdEludDY0PXZuLF9uLnByb3RvdHlwZS52aXNpdFVpbnQ4PXZuLF9uLnByb3RvdHlwZS52aXNpdFVpbnQxNj12bixfbi5wcm90b3R5cGUudmlzaXRVaW50MzI9dm4sX24ucHJvdG90eXBlLnZpc2l0VWludDY0PXZuLF9uLnByb3RvdHlwZS52aXNpdEZsb2F0PXZuLF9uLnByb3RvdHlwZS52aXNpdEZsb2F0MTY9dm4sX24ucHJvdG90eXBlLnZpc2l0RmxvYXQzMj12bixfbi5wcm90b3R5cGUudmlzaXRGbG9hdDY0PXZuLF9uLnByb3RvdHlwZS52aXNpdFV0Zjg9dm4sX24ucHJvdG90eXBlLnZpc2l0QmluYXJ5PXZuLF9uLnByb3RvdHlwZS52aXNpdEZpeGVkU2l6ZUJpbmFyeT12bixfbi5wcm90b3R5cGUudmlzaXREYXRlPXZuLF9uLnByb3RvdHlwZS52aXNpdERhdGVEYXk9dm4sX24ucHJvdG90eXBlLnZpc2l0RGF0ZU1pbGxpc2Vjb25kPXZuLF9uLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcD12bixfbi5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBTZWNvbmQ9dm4sX24ucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wTWlsbGlzZWNvbmQ9dm4sX24ucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wTWljcm9zZWNvbmQ9dm4sX24ucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wTmFub3NlY29uZD12bixfbi5wcm90b3R5cGUudmlzaXRUaW1lPXZuLF9uLnByb3RvdHlwZS52aXNpdFRpbWVTZWNvbmQ9dm4sX24ucHJvdG90eXBlLnZpc2l0VGltZU1pbGxpc2Vjb25kPXZuLF9uLnByb3RvdHlwZS52aXNpdFRpbWVNaWNyb3NlY29uZD12bixfbi5wcm90b3R5cGUudmlzaXRUaW1lTmFub3NlY29uZD12bixfbi5wcm90b3R5cGUudmlzaXREZWNpbWFsPXZuLF9uLnByb3RvdHlwZS52aXNpdExpc3Q9dm4sX24ucHJvdG90eXBlLnZpc2l0U3RydWN0PXZuLF9uLnByb3RvdHlwZS52aXNpdFVuaW9uPXZuLF9uLnByb3RvdHlwZS52aXNpdERlbnNlVW5pb249d24sX24ucHJvdG90eXBlLnZpc2l0U3BhcnNlVW5pb249d24sX24ucHJvdG90eXBlLnZpc2l0RGljdGlvbmFyeT12bixfbi5wcm90b3R5cGUudmlzaXRJbnRlcnZhbD12bixfbi5wcm90b3R5cGUudmlzaXRJbnRlcnZhbERheVRpbWU9dm4sX24ucHJvdG90eXBlLnZpc2l0SW50ZXJ2YWxZZWFyTW9udGg9dm4sX24ucHJvdG90eXBlLnZpc2l0Rml4ZWRTaXplTGlzdD12bixfbi5wcm90b3R5cGUudmlzaXRNYXA9dm47Y29uc3QgSW49bmV3IF9uO2NsYXNzIFNuIGV4dGVuZHMgVWV7fWZ1bmN0aW9uIEJuKHQpe2NvbnN0e3R5cGU6ZX09dDtpZigwPT09dC5udWxsQ291bnQmJjE9PT10LnN0cmlkZSYmKGUudHlwZUlkPT09dnQuVGltZXN0YW1wfHxlIGluc3RhbmNlb2YgbmUmJjY0IT09ZS5iaXRXaWR0aHx8ZSBpbnN0YW5jZW9mIHdlJiY2NCE9PWUuYml0V2lkdGh8fGUgaW5zdGFuY2VvZiBkZSYmZS5wcmVjaXNpb24hPT1odC5IQUxGKSlyZXR1cm4gbmV3IGhuKHQuZGF0YS5sZW5ndGgsKGU9Pntjb25zdCBpPXQuZGF0YVtlXTtyZXR1cm4gaS52YWx1ZXMuc3ViYXJyYXkoMCxpLmxlbmd0aClbU3ltYm9sLml0ZXJhdG9yXSgpfSkpO2xldCBpPTA7cmV0dXJuIG5ldyBobih0LmRhdGEubGVuZ3RoLChlPT57Y29uc3Qgbj10LmRhdGFbZV0ubGVuZ3RoLHI9dC5zbGljZShpLGkrbik7cmV0dXJuIGkrPW4sbmV3IEFuKHIpfSkpfWNsYXNzIEFue2NvbnN0cnVjdG9yKHQpe3RoaXMudmVjdG9yPXQsdGhpcy5pbmRleD0wfW5leHQoKXtyZXR1cm4gdGhpcy5pbmRleDx0aGlzLnZlY3Rvci5sZW5ndGg/e3ZhbHVlOnRoaXMudmVjdG9yLmdldCh0aGlzLmluZGV4KyspfTp7ZG9uZTohMCx2YWx1ZTpudWxsfX1bU3ltYm9sLml0ZXJhdG9yXSgpe3JldHVybiB0aGlzfX1Tbi5wcm90b3R5cGUudmlzaXROdWxsPUJuLFNuLnByb3RvdHlwZS52aXNpdEJvb2w9Qm4sU24ucHJvdG90eXBlLnZpc2l0SW50PUJuLFNuLnByb3RvdHlwZS52aXNpdEludDg9Qm4sU24ucHJvdG90eXBlLnZpc2l0SW50MTY9Qm4sU24ucHJvdG90eXBlLnZpc2l0SW50MzI9Qm4sU24ucHJvdG90eXBlLnZpc2l0SW50NjQ9Qm4sU24ucHJvdG90eXBlLnZpc2l0VWludDg9Qm4sU24ucHJvdG90eXBlLnZpc2l0VWludDE2PUJuLFNuLnByb3RvdHlwZS52aXNpdFVpbnQzMj1CbixTbi5wcm90b3R5cGUudmlzaXRVaW50NjQ9Qm4sU24ucHJvdG90eXBlLnZpc2l0RmxvYXQ9Qm4sU24ucHJvdG90eXBlLnZpc2l0RmxvYXQxNj1CbixTbi5wcm90b3R5cGUudmlzaXRGbG9hdDMyPUJuLFNuLnByb3RvdHlwZS52aXNpdEZsb2F0NjQ9Qm4sU24ucHJvdG90eXBlLnZpc2l0VXRmOD1CbixTbi5wcm90b3R5cGUudmlzaXRCaW5hcnk9Qm4sU24ucHJvdG90eXBlLnZpc2l0Rml4ZWRTaXplQmluYXJ5PUJuLFNuLnByb3RvdHlwZS52aXNpdERhdGU9Qm4sU24ucHJvdG90eXBlLnZpc2l0RGF0ZURheT1CbixTbi5wcm90b3R5cGUudmlzaXREYXRlTWlsbGlzZWNvbmQ9Qm4sU24ucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wPUJuLFNuLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcFNlY29uZD1CbixTbi5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBNaWxsaXNlY29uZD1CbixTbi5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBNaWNyb3NlY29uZD1CbixTbi5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBOYW5vc2Vjb25kPUJuLFNuLnByb3RvdHlwZS52aXNpdFRpbWU9Qm4sU24ucHJvdG90eXBlLnZpc2l0VGltZVNlY29uZD1CbixTbi5wcm90b3R5cGUudmlzaXRUaW1lTWlsbGlzZWNvbmQ9Qm4sU24ucHJvdG90eXBlLnZpc2l0VGltZU1pY3Jvc2Vjb25kPUJuLFNuLnByb3RvdHlwZS52aXNpdFRpbWVOYW5vc2Vjb25kPUJuLFNuLnByb3RvdHlwZS52aXNpdERlY2ltYWw9Qm4sU24ucHJvdG90eXBlLnZpc2l0TGlzdD1CbixTbi5wcm90b3R5cGUudmlzaXRTdHJ1Y3Q9Qm4sU24ucHJvdG90eXBlLnZpc2l0VW5pb249Qm4sU24ucHJvdG90eXBlLnZpc2l0RGVuc2VVbmlvbj1CbixTbi5wcm90b3R5cGUudmlzaXRTcGFyc2VVbmlvbj1CbixTbi5wcm90b3R5cGUudmlzaXREaWN0aW9uYXJ5PUJuLFNuLnByb3RvdHlwZS52aXNpdEludGVydmFsPUJuLFNuLnByb3RvdHlwZS52aXNpdEludGVydmFsRGF5VGltZT1CbixTbi5wcm90b3R5cGUudmlzaXRJbnRlcnZhbFllYXJNb250aD1CbixTbi5wcm90b3R5cGUudmlzaXRGaXhlZFNpemVMaXN0PUJuLFNuLnByb3RvdHlwZS52aXNpdE1hcD1Cbjtjb25zdCBUbj1uZXcgU24sT249KHQsZSk9PnQrZTtjbGFzcyBEbiBleHRlbmRzIFVle3Zpc2l0TnVsbCh0LGUpe3JldHVybiAwfXZpc2l0SW50KHQsZSl7cmV0dXJuIHQudHlwZS5iaXRXaWR0aC84fXZpc2l0RmxvYXQodCxlKXtyZXR1cm4gdC50eXBlLkFycmF5VHlwZS5CWVRFU19QRVJfRUxFTUVOVH12aXNpdEJvb2wodCxlKXtyZXR1cm4gMS84fXZpc2l0RGVjaW1hbCh0LGUpe3JldHVybiAxNn12aXNpdERhdGUodCxlKXtyZXR1cm4gNCoodC50eXBlLnVuaXQrMSl9dmlzaXRUaW1lKHQsZSl7cmV0dXJuIHQudHlwZS5iaXRXaWR0aC84fXZpc2l0VGltZXN0YW1wKHQsZSl7cmV0dXJuIHQudHlwZS51bml0PT09ZnQuU0VDT05EPzQ6OH12aXNpdEludGVydmFsKHQsZSl7cmV0dXJuIDQqKHQudHlwZS51bml0KzEpfXZpc2l0U3RydWN0KHQsZSl7cmV0dXJuIHRoaXMudmlzaXRNYW55KHQuY2hpbGRyZW4sdC5jaGlsZHJlbi5tYXAoKCgpPT5lKSkpLnJlZHVjZShPbiwwKX12aXNpdEZpeGVkU2l6ZUJpbmFyeSh0LGUpe3JldHVybiB0LnR5cGUuYnl0ZVdpZHRofXZpc2l0TWFwKHQsZSl7cmV0dXJuIHRoaXMudmlzaXRNYW55KHQuY2hpbGRyZW4sdC5jaGlsZHJlbi5tYXAoKCgpPT5lKSkpLnJlZHVjZShPbiwwKX12aXNpdERpY3Rpb25hcnkodCxlKXt2YXIgaTtyZXR1cm4gdC50eXBlLmluZGljZXMuYml0V2lkdGgvOCsoKG51bGw9PT0oaT10LmRpY3Rpb25hcnkpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmdldEJ5dGVMZW5ndGgodC52YWx1ZXNbZV0pKXx8MCl9fWNvbnN0IHhuPSh7dHlwZTp0LGNoaWxkcmVuOmUsdHlwZUlkczppLHZhbHVlT2Zmc2V0czpufSxyKT0+e2NvbnN0IHM9dC50eXBlSWRUb0NoaWxkSW5kZXhbaVtyXV07cmV0dXJuIDgrRm4udmlzaXQoZVtzXSxuW3JdKX0sTW49KHtjaGlsZHJlbjp0fSxlKT0+NCtGbi52aXNpdE1hbnkodCx0Lm1hcCgoKCk9PmUpKSkucmVkdWNlKE9uLDApO0RuLnByb3RvdHlwZS52aXNpdFV0Zjg9KHt2YWx1ZU9mZnNldHM6dH0sZSk9PnRbZSsxXS10W2VdKzgsRG4ucHJvdG90eXBlLnZpc2l0QmluYXJ5PSh7dmFsdWVPZmZzZXRzOnR9LGUpPT50W2UrMV0tdFtlXSs4LERuLnByb3RvdHlwZS52aXNpdExpc3Q9KHt2YWx1ZU9mZnNldHM6dCxzdHJpZGU6ZSxjaGlsZHJlbjppfSxuKT0+e2NvbnN0IHI9aVswXSx7W24qZV06c309dCx7W24qZSsxXTpvfT10LGE9Rm4uZ2V0VmlzaXRGbihyLnR5cGUpLGw9ci5zbGljZShzLG8tcyk7bGV0IGM9ODtmb3IobGV0IGg9LTEsdT1vLXM7KytoPHU7KWMrPWEobCxoKTtyZXR1cm4gY30sRG4ucHJvdG90eXBlLnZpc2l0Rml4ZWRTaXplTGlzdD0oe3N0cmlkZTp0LGNoaWxkcmVuOmV9LGkpPT57Y29uc3Qgbj1lWzBdLHI9bi5zbGljZShpKnQsdCkscz1Gbi5nZXRWaXNpdEZuKG4udHlwZSk7bGV0IG89MDtmb3IobGV0IGE9LTEsbD1yLmxlbmd0aDsrK2E8bDspbys9cyhyLGEpO3JldHVybiBvfSxEbi5wcm90b3R5cGUudmlzaXRVbmlvbj0odCxlKT0+dC50eXBlLm1vZGU9PT1sdC5EZW5zZT94bih0LGUpOk1uKHQsZSksRG4ucHJvdG90eXBlLnZpc2l0RGVuc2VVbmlvbj14bixEbi5wcm90b3R5cGUudmlzaXRTcGFyc2VVbmlvbj1Nbjtjb25zdCBGbj1uZXcgRG47dmFyIExuO2NvbnN0IE5uPXt9LFVuPXt9O2NsYXNzIENue2NvbnN0cnVjdG9yKHQpe3ZhciBlLGksbjtjb25zdCByPXRbMF1pbnN0YW5jZW9mIENuP3QuZmxhdE1hcCgodD0+dC5kYXRhKSk6dDtpZihyLnNvbWUoKHQ9PiEodCBpbnN0YW5jZW9mIGFuKSkpKXRocm93IG5ldyBUeXBlRXJyb3IoIlZlY3RvciBjb25zdHJ1Y3RvciBleHBlY3RzIGFuIEFycmF5IG9mIERhdGEgaW5zdGFuY2VzLiIpO2NvbnN0IHM9bnVsbD09PShlPXJbMF0pfHx2b2lkIDA9PT1lP3ZvaWQgMDplLnR5cGU7c3dpdGNoKHIubGVuZ3RoKXtjYXNlIDA6dGhpcy5fb2Zmc2V0cz1bMF07YnJlYWs7Y2FzZSAxOntjb25zdHtnZXQ6dCxzZXQ6ZSxpbmRleE9mOmksYnl0ZUxlbmd0aDpufT1ObltzLnR5cGVJZF0sbz1yWzBdO3RoaXMuaXNWYWxpZD10PT55bihvLHQpLHRoaXMuZ2V0PWU9PnQobyxlKSx0aGlzLnNldD0odCxpKT0+ZShvLHQsaSksdGhpcy5pbmRleE9mPXQ9Pmkobyx0KSx0aGlzLmdldEJ5dGVMZW5ndGg9dD0+bihvLHQpLHRoaXMuX29mZnNldHM9WzAsby5sZW5ndGhdO2JyZWFrfWRlZmF1bHQ6T2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsVW5bcy50eXBlSWRdKSx0aGlzLl9vZmZzZXRzPWRuKHIpfXRoaXMuZGF0YT1yLHRoaXMudHlwZT1zLHRoaXMuc3RyaWRlPU5lKHMpLHRoaXMubnVtQ2hpbGRyZW49bnVsbCE9PShuPW51bGw9PT0oaT1zLmNoaWxkcmVuKXx8dm9pZCAwPT09aT92b2lkIDA6aS5sZW5ndGgpJiZ2b2lkIDAhPT1uP246MCx0aGlzLmxlbmd0aD10aGlzLl9vZmZzZXRzW3RoaXMuX29mZnNldHMubGVuZ3RoLTFdfWdldCBieXRlTGVuZ3RoKCl7cmV0dXJuLTE9PT10aGlzLl9ieXRlTGVuZ3RoJiYodGhpcy5fYnl0ZUxlbmd0aD10aGlzLmRhdGEucmVkdWNlKCgodCxlKT0+dCtlLmJ5dGVMZW5ndGgpLDApKSx0aGlzLl9ieXRlTGVuZ3RofWdldCBudWxsQ291bnQoKXtyZXR1cm4tMT09PXRoaXMuX251bGxDb3VudCYmKHRoaXMuX251bGxDb3VudD11bih0aGlzLmRhdGEpKSx0aGlzLl9udWxsQ291bnR9Z2V0IEFycmF5VHlwZSgpe3JldHVybiB0aGlzLnR5cGUuQXJyYXlUeXBlfWdldFtTeW1ib2wudG9TdHJpbmdUYWddKCl7cmV0dXJuYCR7dGhpcy5WZWN0b3JOYW1lfTwke3RoaXMudHlwZVtTeW1ib2wudG9TdHJpbmdUYWddfT5gfWdldCBWZWN0b3JOYW1lKCl7cmV0dXJuYCR7dnRbdGhpcy50eXBlLnR5cGVJZF19VmVjdG9yYH1pc1ZhbGlkKHQpe3JldHVybiExfWdldCh0KXtyZXR1cm4gbnVsbH1zZXQodCxlKXt9aW5kZXhPZih0LGUpe3JldHVybi0xfWluY2x1ZGVzKHQsZSl7cmV0dXJuIHRoaXMuaW5kZXhPZih0LGUpPjB9Z2V0Qnl0ZUxlbmd0aCh0KXtyZXR1cm4gMH1bU3ltYm9sLml0ZXJhdG9yXSgpe3JldHVybiBUbi52aXNpdCh0aGlzKX1jb25jYXQoLi4udCl7cmV0dXJuIG5ldyBDbih0aGlzLmRhdGEuY29uY2F0KHQuZmxhdE1hcCgodD0+dC5kYXRhKSkuZmxhdChOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpKSl9c2xpY2UodCxlKXtyZXR1cm4gbmV3IENuKEppKHRoaXMsdCxlLCgoe2RhdGE6dCxfb2Zmc2V0czplfSxpLG4pPT5wbih0LGUsaSxuKSkpKX10b0pTT04oKXtyZXR1cm5bLi4udGhpc119dG9BcnJheSgpe2NvbnN0e3R5cGU6dCxkYXRhOmUsbGVuZ3RoOmksc3RyaWRlOm4sQXJyYXlUeXBlOnJ9PXRoaXM7c3dpdGNoKHQudHlwZUlkKXtjYXNlIHZ0LkludDpjYXNlIHZ0LkZsb2F0OmNhc2UgdnQuRGVjaW1hbDpjYXNlIHZ0LlRpbWU6Y2FzZSB2dC5UaW1lc3RhbXA6c3dpdGNoKGUubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIG5ldyByO2Nhc2UgMTpyZXR1cm4gZVswXS52YWx1ZXMuc3ViYXJyYXkoMCxpKm4pO2RlZmF1bHQ6cmV0dXJuIGUucmVkdWNlKCgodCx7dmFsdWVzOmV9KT0+KHQuYXJyYXkuc2V0KGUsdC5vZmZzZXQpLHQub2Zmc2V0Kz1lLmxlbmd0aCx0KSkse2FycmF5Om5ldyByKGkqbiksb2Zmc2V0OjB9KS5hcnJheX19cmV0dXJuWy4uLnRoaXNdfXRvU3RyaW5nKCl7cmV0dXJuYFske1suLi50aGlzXS5qb2luKCIsIil9XWB9Z2V0Q2hpbGQodCl7dmFyIGU7cmV0dXJuIHRoaXMuZ2V0Q2hpbGRBdChudWxsPT09KGU9dGhpcy50eXBlLmNoaWxkcmVuKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5maW5kSW5kZXgoKGU9PmUubmFtZT09PXQpKSl9Z2V0Q2hpbGRBdCh0KXtyZXR1cm4gdD4tMSYmdDx0aGlzLm51bUNoaWxkcmVuP25ldyBDbih0aGlzLmRhdGEubWFwKCgoe2NoaWxkcmVuOmV9KT0+ZVt0XSkpKTpudWxsfWdldCBpc01lbW9pemVkKCl7cmV0dXJuISFlZS5pc0RpY3Rpb25hcnkodGhpcy50eXBlKSYmdGhpcy5kYXRhWzBdLmRpY3Rpb25hcnkuaXNNZW1vaXplZH1tZW1vaXplKCl7aWYoZWUuaXNEaWN0aW9uYXJ5KHRoaXMudHlwZSkpe2NvbnN0IHQ9bmV3IEVuKHRoaXMuZGF0YVswXS5kaWN0aW9uYXJ5KSxlPXRoaXMuZGF0YS5tYXAoKGU9Pntjb25zdCBpPWUuY2xvbmUoKTtyZXR1cm4gaS5kaWN0aW9uYXJ5PXQsaX0pKTtyZXR1cm4gbmV3IENuKGUpfXJldHVybiBuZXcgRW4odGhpcyl9dW5tZW1vaXplKCl7aWYoZWUuaXNEaWN0aW9uYXJ5KHRoaXMudHlwZSkmJnRoaXMuaXNNZW1vaXplZCl7Y29uc3QgdD10aGlzLmRhdGFbMF0uZGljdGlvbmFyeS51bm1lbW9pemUoKSxlPXRoaXMuZGF0YS5tYXAoKGU9Pntjb25zdCBpPWUuY2xvbmUoKTtyZXR1cm4gaS5kaWN0aW9uYXJ5PXQsaX0pKTtyZXR1cm4gbmV3IENuKGUpfXJldHVybiB0aGlzfX1Mbj1TeW1ib2wudG9TdHJpbmdUYWcsQ25bTG5dPSh0PT57dC50eXBlPWVlLnByb3RvdHlwZSx0LmRhdGE9W10sdC5sZW5ndGg9MCx0LnN0cmlkZT0xLHQubnVtQ2hpbGRyZW49MCx0Ll9udWxsQ291bnQ9LTEsdC5fYnl0ZUxlbmd0aD0tMSx0Ll9vZmZzZXRzPW5ldyBVaW50MzJBcnJheShbMF0pLHRbU3ltYm9sLmlzQ29uY2F0U3ByZWFkYWJsZV09ITA7Y29uc3QgZT1PYmplY3Qua2V5cyh2dCkubWFwKCh0PT52dFt0XSkpLmZpbHRlcigodD0+Im51bWJlciI9PXR5cGVvZiB0JiZ0IT09dnQuTk9ORSkpO2Zvcihjb25zdCBpIG9mIGUpe2NvbnN0IGU9amkuZ2V0VmlzaXRGbkJ5VHlwZUlkKGkpLG49ZmkuZ2V0VmlzaXRGbkJ5VHlwZUlkKGkpLHI9SW4uZ2V0VmlzaXRGbkJ5VHlwZUlkKGkpLHM9Rm4uZ2V0VmlzaXRGbkJ5VHlwZUlkKGkpO05uW2ldPXtnZXQ6ZSxzZXQ6bixpbmRleE9mOnIsYnl0ZUxlbmd0aDpzfSxVbltpXT1PYmplY3QuY3JlYXRlKHQse2lzVmFsaWQ6e3ZhbHVlOmJuKHluKX0sZ2V0Ont2YWx1ZTpibihqaS5nZXRWaXNpdEZuQnlUeXBlSWQoaSkpfSxzZXQ6e3ZhbHVlOmduKGZpLmdldFZpc2l0Rm5CeVR5cGVJZChpKSl9LGluZGV4T2Y6e3ZhbHVlOm1uKEluLmdldFZpc2l0Rm5CeVR5cGVJZChpKSl9LGdldEJ5dGVMZW5ndGg6e3ZhbHVlOmJuKEZuLmdldFZpc2l0Rm5CeVR5cGVJZChpKSl9fSl9cmV0dXJuIlZlY3RvciJ9KShDbi5wcm90b3R5cGUpO2NsYXNzIEVuIGV4dGVuZHMgQ257Y29uc3RydWN0b3IodCl7c3VwZXIodC5kYXRhKTtjb25zdCBlPXRoaXMuZ2V0LGk9dGhpcy5zZXQsbj10aGlzLnNsaWNlLHI9bmV3IEFycmF5KHRoaXMubGVuZ3RoKTtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywiZ2V0Iix7dmFsdWUodCl7Y29uc3QgaT1yW3RdO2lmKHZvaWQgMCE9PWkpcmV0dXJuIGk7Y29uc3Qgbj1lLmNhbGwodGhpcyx0KTtyZXR1cm4gclt0XT1uLG59fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsInNldCIse3ZhbHVlKHQsZSl7aS5jYWxsKHRoaXMsdCxlKSxyW3RdPWV9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsInNsaWNlIix7dmFsdWU6KHQsZSk9Pm5ldyBFbihuLmNhbGwodGhpcyx0LGUpKX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCJpc01lbW9pemVkIix7dmFsdWU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywidW5tZW1vaXplIix7dmFsdWU6KCk9Pm5ldyBDbih0aGlzLmRhdGEpfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIm1lbW9pemUiLHt2YWx1ZTooKT0+dGhpc30pfX1mdW5jdGlvbiBWbih0KXtpZih0KXtpZih0IGluc3RhbmNlb2YgYW4pcmV0dXJuIG5ldyBDbihbdF0pO2lmKHQgaW5zdGFuY2VvZiBDbilyZXR1cm4gbmV3IENuKHQuZGF0YSk7aWYodC50eXBlIGluc3RhbmNlb2YgZWUpcmV0dXJuIG5ldyBDbihbY24odCldKTtpZihBcnJheS5pc0FycmF5KHQpKXJldHVybiBuZXcgQ24odC5mbGF0TWFwKCh0PT57cmV0dXJuKGU9dClpbnN0YW5jZW9mIGFuP1tlXTplIGluc3RhbmNlb2YgQ24/ZS5kYXRhOlZuKGUpLmRhdGE7dmFyIGV9KSkpO2lmKEFycmF5QnVmZmVyLmlzVmlldyh0KSl7dCBpbnN0YW5jZW9mIERhdGFWaWV3JiYodD1uZXcgVWludDhBcnJheSh0LmJ1ZmZlcikpO2NvbnN0IGU9e29mZnNldDowLGxlbmd0aDp0Lmxlbmd0aCxudWxsQ291bnQ6MCxkYXRhOnR9O2lmKHQgaW5zdGFuY2VvZiBJbnQ4QXJyYXkpcmV0dXJuIG5ldyBDbihbY24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHt0eXBlOm5ldyByZX0pKV0pO2lmKHQgaW5zdGFuY2VvZiBJbnQxNkFycmF5KXJldHVybiBuZXcgQ24oW2NuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7dHlwZTpuZXcgc2V9KSldKTtpZih0IGluc3RhbmNlb2YgSW50MzJBcnJheSlyZXR1cm4gbmV3IENuKFtjbihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3R5cGU6bmV3IG9lfSkpXSk7aWYodCBpbnN0YW5jZW9mIEJpZ0ludDY0QXJyYXkpcmV0dXJuIG5ldyBDbihbY24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHt0eXBlOm5ldyBhZX0pKV0pO2lmKHQgaW5zdGFuY2VvZiBVaW50OEFycmF5fHx0IGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXkpcmV0dXJuIG5ldyBDbihbY24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHt0eXBlOm5ldyBsZX0pKV0pO2lmKHQgaW5zdGFuY2VvZiBVaW50MTZBcnJheSlyZXR1cm4gbmV3IENuKFtjbihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3R5cGU6bmV3IGNlfSkpXSk7aWYodCBpbnN0YW5jZW9mIFVpbnQzMkFycmF5KXJldHVybiBuZXcgQ24oW2NuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7dHlwZTpuZXcgaGV9KSldKTtpZih0IGluc3RhbmNlb2YgQmlnVWludDY0QXJyYXkpcmV0dXJuIG5ldyBDbihbY24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHt0eXBlOm5ldyB1ZX0pKV0pO2lmKHQgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkpcmV0dXJuIG5ldyBDbihbY24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHt0eXBlOm5ldyBwZX0pKV0pO2lmKHQgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXkpcmV0dXJuIG5ldyBDbihbY24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHt0eXBlOm5ldyBmZX0pKV0pO3Rocm93IG5ldyBFcnJvcigiVW5yZWNvZ25pemVkIGlucHV0Iil9fXRocm93IG5ldyBFcnJvcigiVW5yZWNvZ25pemVkIGlucHV0Iil9ZnVuY3Rpb24gUm4odCl7aWYoIXR8fHQubGVuZ3RoPD0wKXJldHVybiBmdW5jdGlvbih0KXtyZXR1cm4hMH07bGV0IGU9IiI7Y29uc3QgaT10LmZpbHRlcigodD0+dD09dCkpO3JldHVybiBpLmxlbmd0aD4wJiYoZT1gXG4gICAgc3dpdGNoICh4KSB7JHtpLm1hcCgodD0+YFxuICAgICAgICBjYXNlICR7ZnVuY3Rpb24odCl7aWYoImJpZ2ludCIhPXR5cGVvZiB0KXJldHVybiBCdCh0KTtpZihPKXJldHVybmAke0J0KHQpfW5gO3JldHVybmAiJHtCdCh0KX0iYH0odCl9OmApKS5qb2luKCIiKX1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9YCksdC5sZW5ndGghPT1pLmxlbmd0aCYmKGU9YGlmICh4ICE9PSB4KSByZXR1cm4gZmFsc2U7XG4ke2V9YCksbmV3IEZ1bmN0aW9uKCJ4IixgJHtlfVxucmV0dXJuIHRydWU7YCl9Y29uc3Qgem49KHQsZSk9Pih0KmUrNjMmLTY0fHw2NCkvZTtjbGFzcyBQbntjb25zdHJ1Y3Rvcih0LGU9MSl7dGhpcy5idWZmZXI9dCx0aGlzLnN0cmlkZT1lLHRoaXMuQllURVNfUEVSX0VMRU1FTlQ9dC5CWVRFU19QRVJfRUxFTUVOVCx0aGlzLkFycmF5VHlwZT10LmNvbnN0cnVjdG9yLHRoaXMuX3Jlc2l6ZSh0aGlzLmxlbmd0aD1NYXRoLnRydW5jKHQubGVuZ3RoL2UpKX1nZXQgYnl0ZUxlbmd0aCgpe3JldHVybiBNYXRoLnRydW5jKHRoaXMubGVuZ3RoKnRoaXMuc3RyaWRlKnRoaXMuQllURVNfUEVSX0VMRU1FTlQpfWdldCByZXNlcnZlZExlbmd0aCgpe3JldHVybiB0aGlzLmJ1ZmZlci5sZW5ndGgvdGhpcy5zdHJpZGV9Z2V0IHJlc2VydmVkQnl0ZUxlbmd0aCgpe3JldHVybiB0aGlzLmJ1ZmZlci5ieXRlTGVuZ3RofXNldCh0LGUpe3JldHVybiB0aGlzfWFwcGVuZCh0KXtyZXR1cm4gdGhpcy5zZXQodGhpcy5sZW5ndGgsdCl9cmVzZXJ2ZSh0KXtpZih0PjApe3RoaXMubGVuZ3RoKz10O2NvbnN0IGU9dGhpcy5zdHJpZGUsaT10aGlzLmxlbmd0aCplLG49dGhpcy5idWZmZXIubGVuZ3RoO2k+PW4mJnRoaXMuX3Jlc2l6ZSh6bigwPT09bj8xKmk6MippLHRoaXMuQllURVNfUEVSX0VMRU1FTlQpKX1yZXR1cm4gdGhpc31mbHVzaCh0PXRoaXMubGVuZ3RoKXt0PXpuKHQqdGhpcy5zdHJpZGUsdGhpcy5CWVRFU19QRVJfRUxFTUVOVCk7Y29uc3QgZT0oKHQsZT0wKT0+dC5sZW5ndGg+PWU/dC5zdWJhcnJheSgwLGUpOkgobmV3IHQuY29uc3RydWN0b3IoZSksdCwwKSkodGhpcy5idWZmZXIsdCk7cmV0dXJuIHRoaXMuY2xlYXIoKSxlfWNsZWFyKCl7cmV0dXJuIHRoaXMubGVuZ3RoPTAsdGhpcy5fcmVzaXplKDApLHRoaXN9X3Jlc2l6ZSh0KXtyZXR1cm4gdGhpcy5idWZmZXI9SChuZXcgdGhpcy5BcnJheVR5cGUodCksdGhpcy5idWZmZXIpfX1Qbi5wcm90b3R5cGUub2Zmc2V0PTA7Y2xhc3Mgam4gZXh0ZW5kcyBQbntsYXN0KCl7cmV0dXJuIHRoaXMuZ2V0KHRoaXMubGVuZ3RoLTEpfWdldCh0KXtyZXR1cm4gdGhpcy5idWZmZXJbdF19c2V0KHQsZSl7cmV0dXJuIHRoaXMucmVzZXJ2ZSh0LXRoaXMubGVuZ3RoKzEpLHRoaXMuYnVmZmVyW3QqdGhpcy5zdHJpZGVdPWUsdGhpc319Y2xhc3Mga24gZXh0ZW5kcyBqbntjb25zdHJ1Y3Rvcih0PW5ldyBVaW50OEFycmF5KDApKXtzdXBlcih0LDEvOCksdGhpcy5udW1WYWxpZD0wfWdldCBudW1JbnZhbGlkKCl7cmV0dXJuIHRoaXMubGVuZ3RoLXRoaXMubnVtVmFsaWR9Z2V0KHQpe3JldHVybiB0aGlzLmJ1ZmZlclt0Pj4zXT4+dCU4JjF9c2V0KHQsZSl7Y29uc3R7YnVmZmVyOml9PXRoaXMucmVzZXJ2ZSh0LXRoaXMubGVuZ3RoKzEpLG49dD4+MyxyPXQlOCxzPWlbbl0+PnImMTtyZXR1cm4gZT8wPT09cyYmKGlbbl18PTE8PHIsKyt0aGlzLm51bVZhbGlkKToxPT09cyYmKGlbbl0mPX4oMTw8ciksLS10aGlzLm51bVZhbGlkKSx0aGlzfWNsZWFyKCl7cmV0dXJuIHRoaXMubnVtVmFsaWQ9MCxzdXBlci5jbGVhcigpfX1jbGFzcyAkbiBleHRlbmRzIGpue2NvbnN0cnVjdG9yKHQ9bmV3IEludDMyQXJyYXkoMSkpe3N1cGVyKHQsMSl9YXBwZW5kKHQpe3JldHVybiB0aGlzLnNldCh0aGlzLmxlbmd0aC0xLHQpfXNldCh0LGUpe2NvbnN0IGk9dGhpcy5sZW5ndGgtMSxuPXRoaXMucmVzZXJ2ZSh0LWkrMSkuYnVmZmVyO3JldHVybiBpPHQrKyYmbi5maWxsKG5baV0saSx0KSxuW3RdPW5bdC0xXStlLHRoaXN9Zmx1c2godD10aGlzLmxlbmd0aC0xKXtyZXR1cm4gdD50aGlzLmxlbmd0aCYmdGhpcy5zZXQodC0xLDApLHN1cGVyLmZsdXNoKHQrMSl9fWNsYXNzIFlue2NvbnN0cnVjdG9yKHt0eXBlOnQsbnVsbFZhbHVlczplfSl7dGhpcy5sZW5ndGg9MCx0aGlzLmZpbmlzaGVkPSExLHRoaXMudHlwZT10LHRoaXMuY2hpbGRyZW49W10sdGhpcy5udWxsVmFsdWVzPWUsdGhpcy5zdHJpZGU9TmUodCksdGhpcy5fbnVsbHM9bmV3IGtuLGUmJmUubGVuZ3RoPjAmJih0aGlzLl9pc1ZhbGlkPVJuKGUpKX1zdGF0aWMgdGhyb3VnaE5vZGUodCl7dGhyb3cgbmV3IEVycm9yKCcidGhyb3VnaE5vZGUiIG5vdCBhdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpfXN0YXRpYyB0aHJvdWdoRE9NKHQpe3Rocm93IG5ldyBFcnJvcignInRocm91Z2hET00iIG5vdCBhdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpfXRvVmVjdG9yKCl7cmV0dXJuIG5ldyBDbihbdGhpcy5mbHVzaCgpXSl9Z2V0IEFycmF5VHlwZSgpe3JldHVybiB0aGlzLnR5cGUuQXJyYXlUeXBlfWdldCBudWxsQ291bnQoKXtyZXR1cm4gdGhpcy5fbnVsbHMubnVtSW52YWxpZH1nZXQgbnVtQ2hpbGRyZW4oKXtyZXR1cm4gdGhpcy5jaGlsZHJlbi5sZW5ndGh9Z2V0IGJ5dGVMZW5ndGgoKXtsZXQgdD0wO2NvbnN0e19vZmZzZXRzOmUsX3ZhbHVlczppLF9udWxsczpuLF90eXBlSWRzOnIsY2hpbGRyZW46c309dGhpcztyZXR1cm4gZSYmKHQrPWUuYnl0ZUxlbmd0aCksaSYmKHQrPWkuYnl0ZUxlbmd0aCksbiYmKHQrPW4uYnl0ZUxlbmd0aCksciYmKHQrPXIuYnl0ZUxlbmd0aCkscy5yZWR1Y2UoKCh0LGUpPT50K2UuYnl0ZUxlbmd0aCksdCl9Z2V0IHJlc2VydmVkTGVuZ3RoKCl7cmV0dXJuIHRoaXMuX251bGxzLnJlc2VydmVkTGVuZ3RofWdldCByZXNlcnZlZEJ5dGVMZW5ndGgoKXtsZXQgdD0wO3JldHVybiB0aGlzLl9vZmZzZXRzJiYodCs9dGhpcy5fb2Zmc2V0cy5yZXNlcnZlZEJ5dGVMZW5ndGgpLHRoaXMuX3ZhbHVlcyYmKHQrPXRoaXMuX3ZhbHVlcy5yZXNlcnZlZEJ5dGVMZW5ndGgpLHRoaXMuX251bGxzJiYodCs9dGhpcy5fbnVsbHMucmVzZXJ2ZWRCeXRlTGVuZ3RoKSx0aGlzLl90eXBlSWRzJiYodCs9dGhpcy5fdHlwZUlkcy5yZXNlcnZlZEJ5dGVMZW5ndGgpLHRoaXMuY2hpbGRyZW4ucmVkdWNlKCgodCxlKT0+dCtlLnJlc2VydmVkQnl0ZUxlbmd0aCksdCl9Z2V0IHZhbHVlT2Zmc2V0cygpe3JldHVybiB0aGlzLl9vZmZzZXRzP3RoaXMuX29mZnNldHMuYnVmZmVyOm51bGx9Z2V0IHZhbHVlcygpe3JldHVybiB0aGlzLl92YWx1ZXM/dGhpcy5fdmFsdWVzLmJ1ZmZlcjpudWxsfWdldCBudWxsQml0bWFwKCl7cmV0dXJuIHRoaXMuX251bGxzP3RoaXMuX251bGxzLmJ1ZmZlcjpudWxsfWdldCB0eXBlSWRzKCl7cmV0dXJuIHRoaXMuX3R5cGVJZHM/dGhpcy5fdHlwZUlkcy5idWZmZXI6bnVsbH1hcHBlbmQodCl7cmV0dXJuIHRoaXMuc2V0KHRoaXMubGVuZ3RoLHQpfWlzVmFsaWQodCl7cmV0dXJuIHRoaXMuX2lzVmFsaWQodCl9c2V0KHQsZSl7cmV0dXJuIHRoaXMuc2V0VmFsaWQodCx0aGlzLmlzVmFsaWQoZSkpJiZ0aGlzLnNldFZhbHVlKHQsZSksdGhpc31zZXRWYWx1ZSh0LGUpe3RoaXMuX3NldFZhbHVlKHRoaXMsdCxlKX1zZXRWYWxpZCh0LGUpe3JldHVybiB0aGlzLmxlbmd0aD10aGlzLl9udWxscy5zZXQodCwrZSkubGVuZ3RoLGV9YWRkQ2hpbGQodCxlPWAke3RoaXMubnVtQ2hpbGRyZW59YCl7dGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgYXBwZW5kIGNoaWxkcmVuIHRvIG5vbi1uZXN0ZWQgdHlwZSAiJHt0aGlzLnR5cGV9ImApfWdldENoaWxkQXQodCl7cmV0dXJuIHRoaXMuY2hpbGRyZW5bdF18fG51bGx9Zmx1c2goKXtsZXQgdCxlLGksbjtjb25zdHt0eXBlOnIsbGVuZ3RoOnMsbnVsbENvdW50Om8sX3R5cGVJZHM6YSxfb2Zmc2V0czpsLF92YWx1ZXM6YyxfbnVsbHM6aH09dGhpczsoZT1udWxsPT1hP3ZvaWQgMDphLmZsdXNoKHMpKT9uPW51bGw9PWw/dm9pZCAwOmwuZmx1c2gocyk6dD0obj1udWxsPT1sP3ZvaWQgMDpsLmZsdXNoKHMpKT9udWxsPT1jP3ZvaWQgMDpjLmZsdXNoKGwubGFzdCgpKTpudWxsPT1jP3ZvaWQgMDpjLmZsdXNoKHMpLG8+MCYmKGk9bnVsbD09aD92b2lkIDA6aC5mbHVzaChzKSk7Y29uc3QgdT10aGlzLmNoaWxkcmVuLm1hcCgodD0+dC5mbHVzaCgpKSk7cmV0dXJuIHRoaXMuY2xlYXIoKSxjbih7dHlwZTpyLGxlbmd0aDpzLG51bGxDb3VudDpvLGNoaWxkcmVuOnUsY2hpbGQ6dVswXSxkYXRhOnQsdHlwZUlkczplLG51bGxCaXRtYXA6aSx2YWx1ZU9mZnNldHM6bn0pfWZpbmlzaCgpe3RoaXMuZmluaXNoZWQ9ITA7Zm9yKGNvbnN0IHQgb2YgdGhpcy5jaGlsZHJlbil0LmZpbmlzaCgpO3JldHVybiB0aGlzfWNsZWFyKCl7dmFyIHQsZSxpLG47dGhpcy5sZW5ndGg9MCxudWxsPT09KHQ9dGhpcy5fbnVsbHMpfHx2b2lkIDA9PT10fHx0LmNsZWFyKCksbnVsbD09PShlPXRoaXMuX3ZhbHVlcyl8fHZvaWQgMD09PWV8fGUuY2xlYXIoKSxudWxsPT09KGk9dGhpcy5fb2Zmc2V0cyl8fHZvaWQgMD09PWl8fGkuY2xlYXIoKSxudWxsPT09KG49dGhpcy5fdHlwZUlkcyl8fHZvaWQgMD09PW58fG4uY2xlYXIoKTtmb3IoY29uc3QgciBvZiB0aGlzLmNoaWxkcmVuKXIuY2xlYXIoKTtyZXR1cm4gdGhpc319WW4ucHJvdG90eXBlLmxlbmd0aD0xLFluLnByb3RvdHlwZS5zdHJpZGU9MSxZbi5wcm90b3R5cGUuY2hpbGRyZW49bnVsbCxZbi5wcm90b3R5cGUuZmluaXNoZWQ9ITEsWW4ucHJvdG90eXBlLm51bGxWYWx1ZXM9bnVsbCxZbi5wcm90b3R5cGUuX2lzVmFsaWQ9KCk9PiEwO2NsYXNzIFduIGV4dGVuZHMgWW57Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fdmFsdWVzPW5ldyBqbihuZXcgdGhpcy5BcnJheVR5cGUoMCksdGhpcy5zdHJpZGUpfXNldFZhbHVlKHQsZSl7Y29uc3QgaT10aGlzLl92YWx1ZXM7cmV0dXJuIGkucmVzZXJ2ZSh0LWkubGVuZ3RoKzEpLHN1cGVyLnNldFZhbHVlKHQsZSl9fWNsYXNzIEhuIGV4dGVuZHMgWW57Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fcGVuZGluZ0xlbmd0aD0wLHRoaXMuX29mZnNldHM9bmV3ICRufXNldFZhbHVlKHQsZSl7Y29uc3QgaT10aGlzLl9wZW5kaW5nfHwodGhpcy5fcGVuZGluZz1uZXcgTWFwKSxuPWkuZ2V0KHQpO24mJih0aGlzLl9wZW5kaW5nTGVuZ3RoLT1uLmxlbmd0aCksdGhpcy5fcGVuZGluZ0xlbmd0aCs9ZSBpbnN0YW5jZW9mIFlpP2Vba2ldLmxlbmd0aDplLmxlbmd0aCxpLnNldCh0LGUpfXNldFZhbGlkKHQsZSl7cmV0dXJuISFzdXBlci5zZXRWYWxpZCh0LGUpfHwoKHRoaXMuX3BlbmRpbmd8fCh0aGlzLl9wZW5kaW5nPW5ldyBNYXApKS5zZXQodCx2b2lkIDApLCExKX1jbGVhcigpe3JldHVybiB0aGlzLl9wZW5kaW5nTGVuZ3RoPTAsdGhpcy5fcGVuZGluZz12b2lkIDAsc3VwZXIuY2xlYXIoKX1mbHVzaCgpe3JldHVybiB0aGlzLl9mbHVzaCgpLHN1cGVyLmZsdXNoKCl9ZmluaXNoKCl7cmV0dXJuIHRoaXMuX2ZsdXNoKCksc3VwZXIuZmluaXNoKCl9X2ZsdXNoKCl7Y29uc3QgdD10aGlzLl9wZW5kaW5nLGU9dGhpcy5fcGVuZGluZ0xlbmd0aDtyZXR1cm4gdGhpcy5fcGVuZGluZ0xlbmd0aD0wLHRoaXMuX3BlbmRpbmc9dm9pZCAwLHQmJnQuc2l6ZT4wJiZ0aGlzLl9mbHVzaFBlbmRpbmcodCxlKSx0aGlzfX1jbGFzcyBLbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfW9mZnNldCgpe3JldHVybiB0aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiX3Bvcyl9bWV0YURhdGFMZW5ndGgoKXtyZXR1cm4gdGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrOCl9Ym9keUxlbmd0aCgpe3JldHVybiB0aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiX3BvcysxNil9c3RhdGljIHNpemVPZigpe3JldHVybiAyNH1zdGF0aWMgY3JlYXRlQmxvY2sodCxlLGksbil7cmV0dXJuIHQucHJlcCg4LDI0KSx0LndyaXRlSW50NjQobiksdC5wYWQoNCksdC53cml0ZUludDMyKGkpLHQud3JpdGVJbnQ2NChlKSx0Lm9mZnNldCgpfX1jb25zdCBKbj1uZXcgSW50MzJBcnJheSgyKSxHbj1uZXcgRmxvYXQzMkFycmF5KEpuLmJ1ZmZlciksWm49bmV3IEZsb2F0NjRBcnJheShKbi5idWZmZXIpLHFuPTE9PT1uZXcgVWludDE2QXJyYXkobmV3IFVpbnQ4QXJyYXkoWzEsMF0pLmJ1ZmZlcilbMF07Y2xhc3MgUW57Y29uc3RydWN0b3IodCxlKXt0aGlzLmxvdz0wfHQsdGhpcy5oaWdoPTB8ZX1zdGF0aWMgY3JlYXRlKHQsZSl7cmV0dXJuIDA9PXQmJjA9PWU/UW4uWkVSTzpuZXcgUW4odCxlKX10b0Zsb2F0NjQoKXtyZXR1cm4odGhpcy5sb3c+Pj4wKSs0Mjk0OTY3Mjk2KnRoaXMuaGlnaH1lcXVhbHModCl7cmV0dXJuIHRoaXMubG93PT10LmxvdyYmdGhpcy5oaWdoPT10LmhpZ2h9fXZhciBYbix0cixlcixpcixucixycixzcixvcixhcixscixjcixocix1cjtRbi5aRVJPPW5ldyBRbigwLDApLCh0cj1Ybnx8KFhuPXt9KSlbdHIuVVRGOF9CWVRFUz0xXT0iVVRGOF9CWVRFUyIsdHJbdHIuVVRGMTZfU1RSSU5HPTJdPSJVVEYxNl9TVFJJTkciO2NsYXNzIGRye2NvbnN0cnVjdG9yKHQpe3RoaXMuYnl0ZXNfPXQsdGhpcy5wb3NpdGlvbl89MH1zdGF0aWMgYWxsb2NhdGUodCl7cmV0dXJuIG5ldyBkcihuZXcgVWludDhBcnJheSh0KSl9Y2xlYXIoKXt0aGlzLnBvc2l0aW9uXz0wfWJ5dGVzKCl7cmV0dXJuIHRoaXMuYnl0ZXNffXBvc2l0aW9uKCl7cmV0dXJuIHRoaXMucG9zaXRpb25ffXNldFBvc2l0aW9uKHQpe3RoaXMucG9zaXRpb25fPXR9Y2FwYWNpdHkoKXtyZXR1cm4gdGhpcy5ieXRlc18ubGVuZ3RofXJlYWRJbnQ4KHQpe3JldHVybiB0aGlzLnJlYWRVaW50OCh0KTw8MjQ+PjI0fXJlYWRVaW50OCh0KXtyZXR1cm4gdGhpcy5ieXRlc19bdF19cmVhZEludDE2KHQpe3JldHVybiB0aGlzLnJlYWRVaW50MTYodCk8PDE2Pj4xNn1yZWFkVWludDE2KHQpe3JldHVybiB0aGlzLmJ5dGVzX1t0XXx0aGlzLmJ5dGVzX1t0KzFdPDw4fXJlYWRJbnQzMih0KXtyZXR1cm4gdGhpcy5ieXRlc19bdF18dGhpcy5ieXRlc19bdCsxXTw8OHx0aGlzLmJ5dGVzX1t0KzJdPDwxNnx0aGlzLmJ5dGVzX1t0KzNdPDwyNH1yZWFkVWludDMyKHQpe3JldHVybiB0aGlzLnJlYWRJbnQzMih0KT4+PjB9cmVhZEludDY0KHQpe3JldHVybiBuZXcgUW4odGhpcy5yZWFkSW50MzIodCksdGhpcy5yZWFkSW50MzIodCs0KSl9cmVhZFVpbnQ2NCh0KXtyZXR1cm4gbmV3IFFuKHRoaXMucmVhZFVpbnQzMih0KSx0aGlzLnJlYWRVaW50MzIodCs0KSl9cmVhZEZsb2F0MzIodCl7cmV0dXJuIEpuWzBdPXRoaXMucmVhZEludDMyKHQpLEduWzBdfXJlYWRGbG9hdDY0KHQpe3JldHVybiBKbltxbj8wOjFdPXRoaXMucmVhZEludDMyKHQpLEpuW3FuPzE6MF09dGhpcy5yZWFkSW50MzIodCs0KSxablswXX13cml0ZUludDgodCxlKXt0aGlzLmJ5dGVzX1t0XT1lfXdyaXRlVWludDgodCxlKXt0aGlzLmJ5dGVzX1t0XT1lfXdyaXRlSW50MTYodCxlKXt0aGlzLmJ5dGVzX1t0XT1lLHRoaXMuYnl0ZXNfW3QrMV09ZT4+OH13cml0ZVVpbnQxNih0LGUpe3RoaXMuYnl0ZXNfW3RdPWUsdGhpcy5ieXRlc19bdCsxXT1lPj44fXdyaXRlSW50MzIodCxlKXt0aGlzLmJ5dGVzX1t0XT1lLHRoaXMuYnl0ZXNfW3QrMV09ZT4+OCx0aGlzLmJ5dGVzX1t0KzJdPWU+PjE2LHRoaXMuYnl0ZXNfW3QrM109ZT4+MjR9d3JpdGVVaW50MzIodCxlKXt0aGlzLmJ5dGVzX1t0XT1lLHRoaXMuYnl0ZXNfW3QrMV09ZT4+OCx0aGlzLmJ5dGVzX1t0KzJdPWU+PjE2LHRoaXMuYnl0ZXNfW3QrM109ZT4+MjR9d3JpdGVJbnQ2NCh0LGUpe3RoaXMud3JpdGVJbnQzMih0LGUubG93KSx0aGlzLndyaXRlSW50MzIodCs0LGUuaGlnaCl9d3JpdGVVaW50NjQodCxlKXt0aGlzLndyaXRlVWludDMyKHQsZS5sb3cpLHRoaXMud3JpdGVVaW50MzIodCs0LGUuaGlnaCl9d3JpdGVGbG9hdDMyKHQsZSl7R25bMF09ZSx0aGlzLndyaXRlSW50MzIodCxKblswXSl9d3JpdGVGbG9hdDY0KHQsZSl7Wm5bMF09ZSx0aGlzLndyaXRlSW50MzIodCxKbltxbj8wOjFdKSx0aGlzLndyaXRlSW50MzIodCs0LEpuW3FuPzE6MF0pfWdldEJ1ZmZlcklkZW50aWZpZXIoKXtpZih0aGlzLmJ5dGVzXy5sZW5ndGg8dGhpcy5wb3NpdGlvbl8rNCs0KXRocm93IG5ldyBFcnJvcigiRmxhdEJ1ZmZlcnM6IEJ5dGVCdWZmZXIgaXMgdG9vIHNob3J0IHRvIGNvbnRhaW4gYW4gaWRlbnRpZmllci4iKTtsZXQgdD0iIjtmb3IobGV0IGU9MDtlPDQ7ZSsrKXQrPVN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5yZWFkSW50OCh0aGlzLnBvc2l0aW9uXys0K2UpKTtyZXR1cm4gdH1fX29mZnNldCh0LGUpe2NvbnN0IGk9dC10aGlzLnJlYWRJbnQzMih0KTtyZXR1cm4gZTx0aGlzLnJlYWRJbnQxNihpKT90aGlzLnJlYWRJbnQxNihpK2UpOjB9X191bmlvbih0LGUpe3JldHVybiB0LmJiX3Bvcz1lK3RoaXMucmVhZEludDMyKGUpLHQuYmI9dGhpcyx0fV9fc3RyaW5nKHQsZSl7dCs9dGhpcy5yZWFkSW50MzIodCk7Y29uc3QgaT10aGlzLnJlYWRJbnQzMih0KTtsZXQgbj0iIixyPTA7aWYodCs9NCxlPT09WG4uVVRGOF9CWVRFUylyZXR1cm4gdGhpcy5ieXRlc18uc3ViYXJyYXkodCx0K2kpO2Zvcig7cjxpOyl7bGV0IGU7Y29uc3QgaT10aGlzLnJlYWRVaW50OCh0K3IrKyk7aWYoaTwxOTIpZT1pO2Vsc2V7Y29uc3Qgbj10aGlzLnJlYWRVaW50OCh0K3IrKyk7aWYoaTwyMjQpZT0oMzEmaSk8PDZ8NjMmbjtlbHNle2NvbnN0IHM9dGhpcy5yZWFkVWludDgodCtyKyspO2lmKGk8MjQwKWU9KDE1JmkpPDwxMnwoNjMmbik8PDZ8NjMmcztlbHNle2U9KDcmaSk8PDE4fCg2MyZuKTw8MTJ8KDYzJnMpPDw2fDYzJnRoaXMucmVhZFVpbnQ4KHQrcisrKX19fWU8NjU1MzY/bis9U3RyaW5nLmZyb21DaGFyQ29kZShlKTooZS09NjU1MzYsbis9U3RyaW5nLmZyb21DaGFyQ29kZSg1NTI5NisoZT4+MTApLDU2MzIwKygxMDIzJmUpKSl9cmV0dXJuIG59X191bmlvbl93aXRoX3N0cmluZyh0LGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgdD90aGlzLl9fc3RyaW5nKGUpOnRoaXMuX191bmlvbih0LGUpfV9faW5kaXJlY3QodCl7cmV0dXJuIHQrdGhpcy5yZWFkSW50MzIodCl9X192ZWN0b3IodCl7cmV0dXJuIHQrdGhpcy5yZWFkSW50MzIodCkrNH1fX3ZlY3Rvcl9sZW4odCl7cmV0dXJuIHRoaXMucmVhZEludDMyKHQrdGhpcy5yZWFkSW50MzIodCkpfV9faGFzX2lkZW50aWZpZXIodCl7aWYoNCE9dC5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJGbGF0QnVmZmVyczogZmlsZSBpZGVudGlmaWVyIG11c3QgYmUgbGVuZ3RoIDQiKTtmb3IobGV0IGU9MDtlPDQ7ZSsrKWlmKHQuY2hhckNvZGVBdChlKSE9dGhpcy5yZWFkSW50OCh0aGlzLnBvc2l0aW9uKCkrNCtlKSlyZXR1cm4hMTtyZXR1cm4hMH1jcmVhdGVMb25nKHQsZSl7cmV0dXJuIFFuLmNyZWF0ZSh0LGUpfWNyZWF0ZVNjYWxhckxpc3QodCxlKXtjb25zdCBpPVtdO2ZvcihsZXQgbj0wO248ZTsrK24pbnVsbCE9PXQobikmJmkucHVzaCh0KG4pKTtyZXR1cm4gaX1jcmVhdGVPYmpMaXN0KHQsZSl7Y29uc3QgaT1bXTtmb3IobGV0IG49MDtuPGU7KytuKXtjb25zdCBlPXQobik7bnVsbCE9PWUmJmkucHVzaChlLnVucGFjaygpKX1yZXR1cm4gaX19Y2xhc3MgcHJ7Y29uc3RydWN0b3IodCl7bGV0IGU7dGhpcy5taW5hbGlnbj0xLHRoaXMudnRhYmxlPW51bGwsdGhpcy52dGFibGVfaW5fdXNlPTAsdGhpcy5pc05lc3RlZD0hMSx0aGlzLm9iamVjdF9zdGFydD0wLHRoaXMudnRhYmxlcz1bXSx0aGlzLnZlY3Rvcl9udW1fZWxlbXM9MCx0aGlzLmZvcmNlX2RlZmF1bHRzPSExLHRoaXMuc3RyaW5nX21hcHM9bnVsbCxlPXR8fDEwMjQsdGhpcy5iYj1kci5hbGxvY2F0ZShlKSx0aGlzLnNwYWNlPWV9Y2xlYXIoKXt0aGlzLmJiLmNsZWFyKCksdGhpcy5zcGFjZT10aGlzLmJiLmNhcGFjaXR5KCksdGhpcy5taW5hbGlnbj0xLHRoaXMudnRhYmxlPW51bGwsdGhpcy52dGFibGVfaW5fdXNlPTAsdGhpcy5pc05lc3RlZD0hMSx0aGlzLm9iamVjdF9zdGFydD0wLHRoaXMudnRhYmxlcz1bXSx0aGlzLnZlY3Rvcl9udW1fZWxlbXM9MCx0aGlzLmZvcmNlX2RlZmF1bHRzPSExLHRoaXMuc3RyaW5nX21hcHM9bnVsbH1mb3JjZURlZmF1bHRzKHQpe3RoaXMuZm9yY2VfZGVmYXVsdHM9dH1kYXRhQnVmZmVyKCl7cmV0dXJuIHRoaXMuYmJ9YXNVaW50OEFycmF5KCl7cmV0dXJuIHRoaXMuYmIuYnl0ZXMoKS5zdWJhcnJheSh0aGlzLmJiLnBvc2l0aW9uKCksdGhpcy5iYi5wb3NpdGlvbigpK3RoaXMub2Zmc2V0KCkpfXByZXAodCxlKXt0PnRoaXMubWluYWxpZ24mJih0aGlzLm1pbmFsaWduPXQpO2NvbnN0IGk9MSt+KHRoaXMuYmIuY2FwYWNpdHkoKS10aGlzLnNwYWNlK2UpJnQtMTtmb3IoO3RoaXMuc3BhY2U8aSt0K2U7KXtjb25zdCB0PXRoaXMuYmIuY2FwYWNpdHkoKTt0aGlzLmJiPXByLmdyb3dCeXRlQnVmZmVyKHRoaXMuYmIpLHRoaXMuc3BhY2UrPXRoaXMuYmIuY2FwYWNpdHkoKS10fXRoaXMucGFkKGkpfXBhZCh0KXtmb3IobGV0IGU9MDtlPHQ7ZSsrKXRoaXMuYmIud3JpdGVJbnQ4KC0tdGhpcy5zcGFjZSwwKX13cml0ZUludDgodCl7dGhpcy5iYi53cml0ZUludDgodGhpcy5zcGFjZS09MSx0KX13cml0ZUludDE2KHQpe3RoaXMuYmIud3JpdGVJbnQxNih0aGlzLnNwYWNlLT0yLHQpfXdyaXRlSW50MzIodCl7dGhpcy5iYi53cml0ZUludDMyKHRoaXMuc3BhY2UtPTQsdCl9d3JpdGVJbnQ2NCh0KXt0aGlzLmJiLndyaXRlSW50NjQodGhpcy5zcGFjZS09OCx0KX13cml0ZUZsb2F0MzIodCl7dGhpcy5iYi53cml0ZUZsb2F0MzIodGhpcy5zcGFjZS09NCx0KX13cml0ZUZsb2F0NjQodCl7dGhpcy5iYi53cml0ZUZsb2F0NjQodGhpcy5zcGFjZS09OCx0KX1hZGRJbnQ4KHQpe3RoaXMucHJlcCgxLDApLHRoaXMud3JpdGVJbnQ4KHQpfWFkZEludDE2KHQpe3RoaXMucHJlcCgyLDApLHRoaXMud3JpdGVJbnQxNih0KX1hZGRJbnQzMih0KXt0aGlzLnByZXAoNCwwKSx0aGlzLndyaXRlSW50MzIodCl9YWRkSW50NjQodCl7dGhpcy5wcmVwKDgsMCksdGhpcy53cml0ZUludDY0KHQpfWFkZEZsb2F0MzIodCl7dGhpcy5wcmVwKDQsMCksdGhpcy53cml0ZUZsb2F0MzIodCl9YWRkRmxvYXQ2NCh0KXt0aGlzLnByZXAoOCwwKSx0aGlzLndyaXRlRmxvYXQ2NCh0KX1hZGRGaWVsZEludDgodCxlLGkpeyh0aGlzLmZvcmNlX2RlZmF1bHRzfHxlIT1pKSYmKHRoaXMuYWRkSW50OChlKSx0aGlzLnNsb3QodCkpfWFkZEZpZWxkSW50MTYodCxlLGkpeyh0aGlzLmZvcmNlX2RlZmF1bHRzfHxlIT1pKSYmKHRoaXMuYWRkSW50MTYoZSksdGhpcy5zbG90KHQpKX1hZGRGaWVsZEludDMyKHQsZSxpKXsodGhpcy5mb3JjZV9kZWZhdWx0c3x8ZSE9aSkmJih0aGlzLmFkZEludDMyKGUpLHRoaXMuc2xvdCh0KSl9YWRkRmllbGRJbnQ2NCh0LGUsaSl7IXRoaXMuZm9yY2VfZGVmYXVsdHMmJmUuZXF1YWxzKGkpfHwodGhpcy5hZGRJbnQ2NChlKSx0aGlzLnNsb3QodCkpfWFkZEZpZWxkRmxvYXQzMih0LGUsaSl7KHRoaXMuZm9yY2VfZGVmYXVsdHN8fGUhPWkpJiYodGhpcy5hZGRGbG9hdDMyKGUpLHRoaXMuc2xvdCh0KSl9YWRkRmllbGRGbG9hdDY0KHQsZSxpKXsodGhpcy5mb3JjZV9kZWZhdWx0c3x8ZSE9aSkmJih0aGlzLmFkZEZsb2F0NjQoZSksdGhpcy5zbG90KHQpKX1hZGRGaWVsZE9mZnNldCh0LGUsaSl7KHRoaXMuZm9yY2VfZGVmYXVsdHN8fGUhPWkpJiYodGhpcy5hZGRPZmZzZXQoZSksdGhpcy5zbG90KHQpKX1hZGRGaWVsZFN0cnVjdCh0LGUsaSl7ZSE9aSYmKHRoaXMubmVzdGVkKGUpLHRoaXMuc2xvdCh0KSl9bmVzdGVkKHQpe2lmKHQhPXRoaXMub2Zmc2V0KCkpdGhyb3cgbmV3IEVycm9yKCJGbGF0QnVmZmVyczogc3RydWN0IG11c3QgYmUgc2VyaWFsaXplZCBpbmxpbmUuIil9bm90TmVzdGVkKCl7aWYodGhpcy5pc05lc3RlZCl0aHJvdyBuZXcgRXJyb3IoIkZsYXRCdWZmZXJzOiBvYmplY3Qgc2VyaWFsaXphdGlvbiBtdXN0IG5vdCBiZSBuZXN0ZWQuIil9c2xvdCh0KXtudWxsIT09dGhpcy52dGFibGUmJih0aGlzLnZ0YWJsZVt0XT10aGlzLm9mZnNldCgpKX1vZmZzZXQoKXtyZXR1cm4gdGhpcy5iYi5jYXBhY2l0eSgpLXRoaXMuc3BhY2V9c3RhdGljIGdyb3dCeXRlQnVmZmVyKHQpe2NvbnN0IGU9dC5jYXBhY2l0eSgpO2lmKDMyMjEyMjU0NzImZSl0aHJvdyBuZXcgRXJyb3IoIkZsYXRCdWZmZXJzOiBjYW5ub3QgZ3JvdyBidWZmZXIgYmV5b25kIDIgZ2lnYWJ5dGVzLiIpO2NvbnN0IGk9ZTw8MSxuPWRyLmFsbG9jYXRlKGkpO3JldHVybiBuLnNldFBvc2l0aW9uKGktZSksbi5ieXRlcygpLnNldCh0LmJ5dGVzKCksaS1lKSxufWFkZE9mZnNldCh0KXt0aGlzLnByZXAoNCwwKSx0aGlzLndyaXRlSW50MzIodGhpcy5vZmZzZXQoKS10KzQpfXN0YXJ0T2JqZWN0KHQpe3RoaXMubm90TmVzdGVkKCksbnVsbD09dGhpcy52dGFibGUmJih0aGlzLnZ0YWJsZT1bXSksdGhpcy52dGFibGVfaW5fdXNlPXQ7Zm9yKGxldCBlPTA7ZTx0O2UrKyl0aGlzLnZ0YWJsZVtlXT0wO3RoaXMuaXNOZXN0ZWQ9ITAsdGhpcy5vYmplY3Rfc3RhcnQ9dGhpcy5vZmZzZXQoKX1lbmRPYmplY3QoKXtpZihudWxsPT10aGlzLnZ0YWJsZXx8IXRoaXMuaXNOZXN0ZWQpdGhyb3cgbmV3IEVycm9yKCJGbGF0QnVmZmVyczogZW5kT2JqZWN0IGNhbGxlZCB3aXRob3V0IHN0YXJ0T2JqZWN0Iik7dGhpcy5hZGRJbnQzMigwKTtjb25zdCB0PXRoaXMub2Zmc2V0KCk7bGV0IGU9dGhpcy52dGFibGVfaW5fdXNlLTE7Zm9yKDtlPj0wJiYwPT10aGlzLnZ0YWJsZVtlXTtlLS0pO2NvbnN0IGk9ZSsxO2Zvcig7ZT49MDtlLS0pdGhpcy5hZGRJbnQxNigwIT10aGlzLnZ0YWJsZVtlXT90LXRoaXMudnRhYmxlW2VdOjApO3RoaXMuYWRkSW50MTYodC10aGlzLm9iamVjdF9zdGFydCk7Y29uc3Qgbj0yKihpKzIpO3RoaXMuYWRkSW50MTYobik7bGV0IHI9MDtjb25zdCBzPXRoaXMuc3BhY2U7dDpmb3IoZT0wO2U8dGhpcy52dGFibGVzLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy5iYi5jYXBhY2l0eSgpLXRoaXMudnRhYmxlc1tlXTtpZihuPT10aGlzLmJiLnJlYWRJbnQxNih0KSl7Zm9yKGxldCBlPTI7ZTxuO2UrPTIpaWYodGhpcy5iYi5yZWFkSW50MTYocytlKSE9dGhpcy5iYi5yZWFkSW50MTYodCtlKSljb250aW51ZSB0O3I9dGhpcy52dGFibGVzW2VdO2JyZWFrfX1yZXR1cm4gcj8odGhpcy5zcGFjZT10aGlzLmJiLmNhcGFjaXR5KCktdCx0aGlzLmJiLndyaXRlSW50MzIodGhpcy5zcGFjZSxyLXQpKToodGhpcy52dGFibGVzLnB1c2godGhpcy5vZmZzZXQoKSksdGhpcy5iYi53cml0ZUludDMyKHRoaXMuYmIuY2FwYWNpdHkoKS10LHRoaXMub2Zmc2V0KCktdCkpLHRoaXMuaXNOZXN0ZWQ9ITEsdH1maW5pc2godCxlLGkpe2NvbnN0IG49aT80OjA7aWYoZSl7Y29uc3QgdD1lO2lmKHRoaXMucHJlcCh0aGlzLm1pbmFsaWduLDgrbiksNCE9dC5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJGbGF0QnVmZmVyczogZmlsZSBpZGVudGlmaWVyIG11c3QgYmUgbGVuZ3RoIDQiKTtmb3IobGV0IGU9MztlPj0wO2UtLSl0aGlzLndyaXRlSW50OCh0LmNoYXJDb2RlQXQoZSkpfXRoaXMucHJlcCh0aGlzLm1pbmFsaWduLDQrbiksdGhpcy5hZGRPZmZzZXQodCksbiYmdGhpcy5hZGRJbnQzMih0aGlzLmJiLmNhcGFjaXR5KCktdGhpcy5zcGFjZSksdGhpcy5iYi5zZXRQb3NpdGlvbih0aGlzLnNwYWNlKX1maW5pc2hTaXplUHJlZml4ZWQodCxlKXt0aGlzLmZpbmlzaCh0LGUsITApfXJlcXVpcmVkRmllbGQodCxlKXtjb25zdCBpPXRoaXMuYmIuY2FwYWNpdHkoKS10LG49aS10aGlzLmJiLnJlYWRJbnQzMihpKTtpZighKDAhPXRoaXMuYmIucmVhZEludDE2KG4rZSkpKXRocm93IG5ldyBFcnJvcigiRmxhdEJ1ZmZlcnM6IGZpZWxkICIrZSsiIG11c3QgYmUgc2V0Iil9c3RhcnRWZWN0b3IodCxlLGkpe3RoaXMubm90TmVzdGVkKCksdGhpcy52ZWN0b3JfbnVtX2VsZW1zPWUsdGhpcy5wcmVwKDQsdCplKSx0aGlzLnByZXAoaSx0KmUpfWVuZFZlY3Rvcigpe3JldHVybiB0aGlzLndyaXRlSW50MzIodGhpcy52ZWN0b3JfbnVtX2VsZW1zKSx0aGlzLm9mZnNldCgpfWNyZWF0ZVNoYXJlZFN0cmluZyh0KXtpZighdClyZXR1cm4gMDtpZih0aGlzLnN0cmluZ19tYXBzfHwodGhpcy5zdHJpbmdfbWFwcz1uZXcgTWFwKSx0aGlzLnN0cmluZ19tYXBzLmhhcyh0KSlyZXR1cm4gdGhpcy5zdHJpbmdfbWFwcy5nZXQodCk7Y29uc3QgZT10aGlzLmNyZWF0ZVN0cmluZyh0KTtyZXR1cm4gdGhpcy5zdHJpbmdfbWFwcy5zZXQodCxlKSxlfWNyZWF0ZVN0cmluZyh0KXtpZighdClyZXR1cm4gMDtsZXQgZTtpZih0IGluc3RhbmNlb2YgVWludDhBcnJheSllPXQ7ZWxzZXtlPVtdO2xldCBpPTA7Zm9yKDtpPHQubGVuZ3RoOyl7bGV0IG47Y29uc3Qgcj10LmNoYXJDb2RlQXQoaSsrKTtpZihyPDU1Mjk2fHxyPj01NjMyMCluPXI7ZWxzZXtuPShyPDwxMCkrdC5jaGFyQ29kZUF0KGkrKykrLTU2NjEzODg4fW48MTI4P2UucHVzaChuKToobjwyMDQ4P2UucHVzaChuPj42JjMxfDE5Mik6KG48NjU1MzY/ZS5wdXNoKG4+PjEyJjE1fDIyNCk6ZS5wdXNoKG4+PjE4Jjd8MjQwLG4+PjEyJjYzfDEyOCksZS5wdXNoKG4+PjYmNjN8MTI4KSksZS5wdXNoKDYzJm58MTI4KSl9fXRoaXMuYWRkSW50OCgwKSx0aGlzLnN0YXJ0VmVjdG9yKDEsZS5sZW5ndGgsMSksdGhpcy5iYi5zZXRQb3NpdGlvbih0aGlzLnNwYWNlLT1lLmxlbmd0aCk7Zm9yKGxldCBpPTAsbj10aGlzLnNwYWNlLHI9dGhpcy5iYi5ieXRlcygpO2k8ZS5sZW5ndGg7aSsrKXJbbisrXT1lW2ldO3JldHVybiB0aGlzLmVuZFZlY3RvcigpfWNyZWF0ZUxvbmcodCxlKXtyZXR1cm4gUW4uY3JlYXRlKHQsZSl9Y3JlYXRlT2JqZWN0T2Zmc2V0KHQpe3JldHVybiBudWxsPT09dD8wOiJzdHJpbmciPT10eXBlb2YgdD90aGlzLmNyZWF0ZVN0cmluZyh0KTp0LnBhY2sodGhpcyl9Y3JlYXRlT2JqZWN0T2Zmc2V0TGlzdCh0KXtjb25zdCBlPVtdO2ZvcihsZXQgaT0wO2k8dC5sZW5ndGg7KytpKXtjb25zdCBuPXRbaV07aWYobnVsbD09PW4pdGhyb3cgbmV3IEVycm9yKCJGbGF0QnVmZmVyczogQXJndW1lbnQgZm9yIGNyZWF0ZU9iamVjdE9mZnNldExpc3QgY2Fubm90IGNvbnRhaW4gbnVsbC4iKTtlLnB1c2godGhpcy5jcmVhdGVPYmplY3RPZmZzZXQobikpfXJldHVybiBlfWNyZWF0ZVN0cnVjdE9mZnNldExpc3QodCxlKXtyZXR1cm4gZSh0aGlzLHQubGVuZ3RoKSx0aGlzLmNyZWF0ZU9iamVjdE9mZnNldExpc3QodCksdGhpcy5lbmRWZWN0b3IoKX19Y2xhc3MgZnJ7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzS2V5VmFsdWUodCxlKXtyZXR1cm4oZXx8bmV3IGZyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0tleVZhbHVlKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgZnIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1rZXkodCl7Y29uc3QgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiBlP3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrZSx0KTpudWxsfXZhbHVlKHQpe2NvbnN0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gZT90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmJfcG9zK2UsdCk6bnVsbH1zdGF0aWMgc3RhcnRLZXlWYWx1ZSh0KXt0LnN0YXJ0T2JqZWN0KDIpfXN0YXRpYyBhZGRLZXkodCxlKXt0LmFkZEZpZWxkT2Zmc2V0KDAsZSwwKX1zdGF0aWMgYWRkVmFsdWUodCxlKXt0LmFkZEZpZWxkT2Zmc2V0KDEsZSwwKX1zdGF0aWMgZW5kS2V5VmFsdWUodCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9c3RhdGljIGNyZWF0ZUtleVZhbHVlKHQsZSxpKXtyZXR1cm4gZnIuc3RhcnRLZXlWYWx1ZSh0KSxmci5hZGRLZXkodCxlKSxmci5hZGRWYWx1ZSh0LGkpLGZyLmVuZEtleVZhbHVlKHQpfX0hZnVuY3Rpb24odCl7dFt0LlYxPTBdPSJWMSIsdFt0LlYyPTFdPSJWMiIsdFt0LlYzPTJdPSJWMyIsdFt0LlY0PTNdPSJWNCIsdFt0LlY1PTRdPSJWNSJ9KGVyfHwoZXI9e30pKSwobnI9aXJ8fChpcj17fSkpW25yLkxpdHRsZT0wXT0iTGl0dGxlIixucltuci5CaWc9MV09IkJpZyIsKHNyPXJyfHwocnI9e30pKVtzci5EZW5zZUFycmF5PTBdPSJEZW5zZUFycmF5IjtjbGFzcyB5cntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfXN0YXRpYyBnZXRSb290QXNJbnQodCxlKXtyZXR1cm4oZXx8bmV3IHlyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0ludCh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IHlyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9Yml0V2lkdGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrdCk6MH1pc1NpZ25lZCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4hIXQmJiEhdGhpcy5iYi5yZWFkSW50OCh0aGlzLmJiX3Bvcyt0KX1zdGF0aWMgc3RhcnRJbnQodCl7dC5zdGFydE9iamVjdCgyKX1zdGF0aWMgYWRkQml0V2lkdGgodCxlKXt0LmFkZEZpZWxkSW50MzIoMCxlLDApfXN0YXRpYyBhZGRJc1NpZ25lZCh0LGUpe3QuYWRkRmllbGRJbnQ4KDEsK2UsMCl9c3RhdGljIGVuZEludCh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlSW50KHQsZSxpKXtyZXR1cm4geXIuc3RhcnRJbnQodCkseXIuYWRkQml0V2lkdGgodCxlKSx5ci5hZGRJc1NpZ25lZCh0LGkpLHlyLmVuZEludCh0KX19Y2xhc3MgYnJ7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzRGljdGlvbmFyeUVuY29kaW5nKHQsZSl7cmV0dXJuKGV8fG5ldyBicikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNEaWN0aW9uYXJ5RW5jb2RpbmcodCxlKXtyZXR1cm4gdC5zZXRQb3NpdGlvbih0LnBvc2l0aW9uKCkrNCksKGV8fG5ldyBicikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfWlkKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDY0KHRoaXMuYmJfcG9zK3QpOnRoaXMuYmIuY3JlYXRlTG9uZygwLDApfWluZGV4VHlwZSh0KXtjb25zdCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIGU/KHR8fG5ldyB5cikuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiX3BvcytlKSx0aGlzLmJiKTpudWxsfWlzT3JkZXJlZCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4hIXQmJiEhdGhpcy5iYi5yZWFkSW50OCh0aGlzLmJiX3Bvcyt0KX1kaWN0aW9uYXJ5S2luZCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MTYodGhpcy5iYl9wb3MrdCk6cnIuRGVuc2VBcnJheX1zdGF0aWMgc3RhcnREaWN0aW9uYXJ5RW5jb2RpbmcodCl7dC5zdGFydE9iamVjdCg0KX1zdGF0aWMgYWRkSWQodCxlKXt0LmFkZEZpZWxkSW50NjQoMCxlLHQuY3JlYXRlTG9uZygwLDApKX1zdGF0aWMgYWRkSW5kZXhUeXBlKHQsZSl7dC5hZGRGaWVsZE9mZnNldCgxLGUsMCl9c3RhdGljIGFkZElzT3JkZXJlZCh0LGUpe3QuYWRkRmllbGRJbnQ4KDIsK2UsMCl9c3RhdGljIGFkZERpY3Rpb25hcnlLaW5kKHQsZSl7dC5hZGRGaWVsZEludDE2KDMsZSxyci5EZW5zZUFycmF5KX1zdGF0aWMgZW5kRGljdGlvbmFyeUVuY29kaW5nKHQpe3JldHVybiB0LmVuZE9iamVjdCgpfX1jbGFzcyBncntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfXN0YXRpYyBnZXRSb290QXNCaW5hcnkodCxlKXtyZXR1cm4oZXx8bmV3IGdyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0JpbmFyeSh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IGdyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIHN0YXJ0QmluYXJ5KHQpe3Quc3RhcnRPYmplY3QoMCl9c3RhdGljIGVuZEJpbmFyeSh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlQmluYXJ5KHQpe3JldHVybiBnci5zdGFydEJpbmFyeSh0KSxnci5lbmRCaW5hcnkodCl9fWNsYXNzIG1ye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0Jvb2wodCxlKXtyZXR1cm4oZXx8bmV3IG1yKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0Jvb2wodCxlKXtyZXR1cm4gdC5zZXRQb3NpdGlvbih0LnBvc2l0aW9uKCkrNCksKGV8fG5ldyBtcikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXN0YXRpYyBzdGFydEJvb2wodCl7dC5zdGFydE9iamVjdCgwKX1zdGF0aWMgZW5kQm9vbCh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlQm9vbCh0KXtyZXR1cm4gbXIuc3RhcnRCb29sKHQpLG1yLmVuZEJvb2wodCl9fSFmdW5jdGlvbih0KXt0W3QuREFZPTBdPSJEQVkiLHRbdC5NSUxMSVNFQ09ORD0xXT0iTUlMTElTRUNPTkQifShvcnx8KG9yPXt9KSk7Y2xhc3MgX3J7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzRGF0ZSh0LGUpe3JldHVybihlfHxuZXcgX3IpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzRGF0ZSh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IF9yKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9dW5pdCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQxNih0aGlzLmJiX3Bvcyt0KTpvci5NSUxMSVNFQ09ORH1zdGF0aWMgc3RhcnREYXRlKHQpe3Quc3RhcnRPYmplY3QoMSl9c3RhdGljIGFkZFVuaXQodCxlKXt0LmFkZEZpZWxkSW50MTYoMCxlLG9yLk1JTExJU0VDT05EKX1zdGF0aWMgZW5kRGF0ZSh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlRGF0ZSh0LGUpe3JldHVybiBfci5zdGFydERhdGUodCksX3IuYWRkVW5pdCh0LGUpLF9yLmVuZERhdGUodCl9fWNsYXNzIHZye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0RlY2ltYWwodCxlKXtyZXR1cm4oZXx8bmV3IHZyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0RlY2ltYWwodCxlKXtyZXR1cm4gdC5zZXRQb3NpdGlvbih0LnBvc2l0aW9uKCkrNCksKGV8fG5ldyB2cikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXByZWNpc2lvbigpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQzMih0aGlzLmJiX3Bvcyt0KTowfXNjYWxlKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDMyKHRoaXMuYmJfcG9zK3QpOjB9Yml0V2lkdGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsOCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrdCk6MTI4fXN0YXRpYyBzdGFydERlY2ltYWwodCl7dC5zdGFydE9iamVjdCgzKX1zdGF0aWMgYWRkUHJlY2lzaW9uKHQsZSl7dC5hZGRGaWVsZEludDMyKDAsZSwwKX1zdGF0aWMgYWRkU2NhbGUodCxlKXt0LmFkZEZpZWxkSW50MzIoMSxlLDApfXN0YXRpYyBhZGRCaXRXaWR0aCh0LGUpe3QuYWRkRmllbGRJbnQzMigyLGUsMTI4KX1zdGF0aWMgZW5kRGVjaW1hbCh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlRGVjaW1hbCh0LGUsaSxuKXtyZXR1cm4gdnIuc3RhcnREZWNpbWFsKHQpLHZyLmFkZFByZWNpc2lvbih0LGUpLHZyLmFkZFNjYWxlKHQsaSksdnIuYWRkQml0V2lkdGgodCxuKSx2ci5lbmREZWNpbWFsKHQpfX0hZnVuY3Rpb24odCl7dFt0LlNFQ09ORD0wXT0iU0VDT05EIix0W3QuTUlMTElTRUNPTkQ9MV09Ik1JTExJU0VDT05EIix0W3QuTUlDUk9TRUNPTkQ9Ml09Ik1JQ1JPU0VDT05EIix0W3QuTkFOT1NFQ09ORD0zXT0iTkFOT1NFQ09ORCJ9KGFyfHwoYXI9e30pKTtjbGFzcyB3cntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfXN0YXRpYyBnZXRSb290QXNGaXhlZFNpemVCaW5hcnkodCxlKXtyZXR1cm4oZXx8bmV3IHdyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0ZpeGVkU2l6ZUJpbmFyeSh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IHdyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9Ynl0ZVdpZHRoKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDMyKHRoaXMuYmJfcG9zK3QpOjB9c3RhdGljIHN0YXJ0Rml4ZWRTaXplQmluYXJ5KHQpe3Quc3RhcnRPYmplY3QoMSl9c3RhdGljIGFkZEJ5dGVXaWR0aCh0LGUpe3QuYWRkRmllbGRJbnQzMigwLGUsMCl9c3RhdGljIGVuZEZpeGVkU2l6ZUJpbmFyeSh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlRml4ZWRTaXplQmluYXJ5KHQsZSl7cmV0dXJuIHdyLnN0YXJ0Rml4ZWRTaXplQmluYXJ5KHQpLHdyLmFkZEJ5dGVXaWR0aCh0LGUpLHdyLmVuZEZpeGVkU2l6ZUJpbmFyeSh0KX19Y2xhc3MgSXJ7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzRml4ZWRTaXplTGlzdCh0LGUpe3JldHVybihlfHxuZXcgSXIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzRml4ZWRTaXplTGlzdCh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IElyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9bGlzdFNpemUoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrdCk6MH1zdGF0aWMgc3RhcnRGaXhlZFNpemVMaXN0KHQpe3Quc3RhcnRPYmplY3QoMSl9c3RhdGljIGFkZExpc3RTaXplKHQsZSl7dC5hZGRGaWVsZEludDMyKDAsZSwwKX1zdGF0aWMgZW5kRml4ZWRTaXplTGlzdCh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlRml4ZWRTaXplTGlzdCh0LGUpe3JldHVybiBJci5zdGFydEZpeGVkU2l6ZUxpc3QodCksSXIuYWRkTGlzdFNpemUodCxlKSxJci5lbmRGaXhlZFNpemVMaXN0KHQpfX0hZnVuY3Rpb24odCl7dFt0LkhBTEY9MF09IkhBTEYiLHRbdC5TSU5HTEU9MV09IlNJTkdMRSIsdFt0LkRPVUJMRT0yXT0iRE9VQkxFIn0obHJ8fChscj17fSkpO2NsYXNzIFNye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0Zsb2F0aW5nUG9pbnQodCxlKXtyZXR1cm4oZXx8bmV3IFNyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0Zsb2F0aW5nUG9pbnQodCxlKXtyZXR1cm4gdC5zZXRQb3NpdGlvbih0LnBvc2l0aW9uKCkrNCksKGV8fG5ldyBTcikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXByZWNpc2lvbigpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQxNih0aGlzLmJiX3Bvcyt0KTpsci5IQUxGfXN0YXRpYyBzdGFydEZsb2F0aW5nUG9pbnQodCl7dC5zdGFydE9iamVjdCgxKX1zdGF0aWMgYWRkUHJlY2lzaW9uKHQsZSl7dC5hZGRGaWVsZEludDE2KDAsZSxsci5IQUxGKX1zdGF0aWMgZW5kRmxvYXRpbmdQb2ludCh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlRmxvYXRpbmdQb2ludCh0LGUpe3JldHVybiBTci5zdGFydEZsb2F0aW5nUG9pbnQodCksU3IuYWRkUHJlY2lzaW9uKHQsZSksU3IuZW5kRmxvYXRpbmdQb2ludCh0KX19IWZ1bmN0aW9uKHQpe3RbdC5ZRUFSX01PTlRIPTBdPSJZRUFSX01PTlRIIix0W3QuREFZX1RJTUU9MV09IkRBWV9USU1FIix0W3QuTU9OVEhfREFZX05BTk89Ml09Ik1PTlRIX0RBWV9OQU5PIn0oY3J8fChjcj17fSkpO2NsYXNzIEJye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0ludGVydmFsKHQsZSl7cmV0dXJuKGV8fG5ldyBCcikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNJbnRlcnZhbCh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IEJyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9dW5pdCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQxNih0aGlzLmJiX3Bvcyt0KTpjci5ZRUFSX01PTlRIfXN0YXRpYyBzdGFydEludGVydmFsKHQpe3Quc3RhcnRPYmplY3QoMSl9c3RhdGljIGFkZFVuaXQodCxlKXt0LmFkZEZpZWxkSW50MTYoMCxlLGNyLllFQVJfTU9OVEgpfXN0YXRpYyBlbmRJbnRlcnZhbCh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlSW50ZXJ2YWwodCxlKXtyZXR1cm4gQnIuc3RhcnRJbnRlcnZhbCh0KSxCci5hZGRVbml0KHQsZSksQnIuZW5kSW50ZXJ2YWwodCl9fWNsYXNzIEFye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0xpc3QodCxlKXtyZXR1cm4oZXx8bmV3IEFyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0xpc3QodCxlKXtyZXR1cm4gdC5zZXRQb3NpdGlvbih0LnBvc2l0aW9uKCkrNCksKGV8fG5ldyBBcikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXN0YXRpYyBzdGFydExpc3QodCl7dC5zdGFydE9iamVjdCgwKX1zdGF0aWMgZW5kTGlzdCh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlTGlzdCh0KXtyZXR1cm4gQXIuc3RhcnRMaXN0KHQpLEFyLmVuZExpc3QodCl9fWNsYXNzIFRye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc01hcCh0LGUpe3JldHVybihlfHxuZXcgVHIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzTWFwKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgVHIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1rZXlzU29ydGVkKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiEhdCYmISF0aGlzLmJiLnJlYWRJbnQ4KHRoaXMuYmJfcG9zK3QpfXN0YXRpYyBzdGFydE1hcCh0KXt0LnN0YXJ0T2JqZWN0KDEpfXN0YXRpYyBhZGRLZXlzU29ydGVkKHQsZSl7dC5hZGRGaWVsZEludDgoMCwrZSwwKX1zdGF0aWMgZW5kTWFwKHQpe3JldHVybiB0LmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVNYXAodCxlKXtyZXR1cm4gVHIuc3RhcnRNYXAodCksVHIuYWRkS2V5c1NvcnRlZCh0LGUpLFRyLmVuZE1hcCh0KX19Y2xhc3MgT3J7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzTnVsbCh0LGUpe3JldHVybihlfHxuZXcgT3IpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzTnVsbCh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IE9yKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIHN0YXJ0TnVsbCh0KXt0LnN0YXJ0T2JqZWN0KDApfXN0YXRpYyBlbmROdWxsKHQpe3JldHVybiB0LmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVOdWxsKHQpe3JldHVybiBPci5zdGFydE51bGwodCksT3IuZW5kTnVsbCh0KX19Y2xhc3MgRHJ7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzU3RydWN0Xyh0LGUpe3JldHVybihlfHxuZXcgRHIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzU3RydWN0Xyh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IERyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIHN0YXJ0U3RydWN0Xyh0KXt0LnN0YXJ0T2JqZWN0KDApfXN0YXRpYyBlbmRTdHJ1Y3RfKHQpe3JldHVybiB0LmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVTdHJ1Y3RfKHQpe3JldHVybiBEci5zdGFydFN0cnVjdF8odCksRHIuZW5kU3RydWN0Xyh0KX19Y2xhc3MgeHJ7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzVGltZSh0LGUpe3JldHVybihlfHxuZXcgeHIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzVGltZSh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IHhyKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9dW5pdCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQxNih0aGlzLmJiX3Bvcyt0KTphci5NSUxMSVNFQ09ORH1iaXRXaWR0aCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQzMih0aGlzLmJiX3Bvcyt0KTozMn1zdGF0aWMgc3RhcnRUaW1lKHQpe3Quc3RhcnRPYmplY3QoMil9c3RhdGljIGFkZFVuaXQodCxlKXt0LmFkZEZpZWxkSW50MTYoMCxlLGFyLk1JTExJU0VDT05EKX1zdGF0aWMgYWRkQml0V2lkdGgodCxlKXt0LmFkZEZpZWxkSW50MzIoMSxlLDMyKX1zdGF0aWMgZW5kVGltZSh0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlVGltZSh0LGUsaSl7cmV0dXJuIHhyLnN0YXJ0VGltZSh0KSx4ci5hZGRVbml0KHQsZSkseHIuYWRkQml0V2lkdGgodCxpKSx4ci5lbmRUaW1lKHQpfX1jbGFzcyBNcntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfXN0YXRpYyBnZXRSb290QXNUaW1lc3RhbXAodCxlKXtyZXR1cm4oZXx8bmV3IE1yKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc1RpbWVzdGFtcCh0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uKHQucG9zaXRpb24oKSs0KSwoZXx8bmV3IE1yKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9dW5pdCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQxNih0aGlzLmJiX3Bvcyt0KTphci5TRUNPTkR9dGltZXpvbmUodCl7Y29uc3QgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiBlP3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrZSx0KTpudWxsfXN0YXRpYyBzdGFydFRpbWVzdGFtcCh0KXt0LnN0YXJ0T2JqZWN0KDIpfXN0YXRpYyBhZGRVbml0KHQsZSl7dC5hZGRGaWVsZEludDE2KDAsZSxhci5TRUNPTkQpfXN0YXRpYyBhZGRUaW1lem9uZSh0LGUpe3QuYWRkRmllbGRPZmZzZXQoMSxlLDApfXN0YXRpYyBlbmRUaW1lc3RhbXAodCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9c3RhdGljIGNyZWF0ZVRpbWVzdGFtcCh0LGUsaSl7cmV0dXJuIE1yLnN0YXJ0VGltZXN0YW1wKHQpLE1yLmFkZFVuaXQodCxlKSxNci5hZGRUaW1lem9uZSh0LGkpLE1yLmVuZFRpbWVzdGFtcCh0KX19IWZ1bmN0aW9uKHQpe3RbdC5TcGFyc2U9MF09IlNwYXJzZSIsdFt0LkRlbnNlPTFdPSJEZW5zZSJ9KGhyfHwoaHI9e30pKTtjbGFzcyBGcntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfXN0YXRpYyBnZXRSb290QXNVbmlvbih0LGUpe3JldHVybihlfHxuZXcgRnIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzVW5pb24odCxlKXtyZXR1cm4gdC5zZXRQb3NpdGlvbih0LnBvc2l0aW9uKCkrNCksKGV8fG5ldyBGcikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfW1vZGUoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MTYodGhpcy5iYl9wb3MrdCk6aHIuU3BhcnNlfXR5cGVJZHModCl7Y29uc3QgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiBlP3RoaXMuYmIucmVhZEludDMyKHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrZSkrNCp0KTowfXR5cGVJZHNMZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHQ/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrdCk6MH10eXBlSWRzQXJyYXkoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHQ/bmV3IEludDMyQXJyYXkodGhpcy5iYi5ieXRlcygpLmJ1ZmZlcix0aGlzLmJiLmJ5dGVzKCkuYnl0ZU9mZnNldCt0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3QpLHRoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpKTpudWxsfXN0YXRpYyBzdGFydFVuaW9uKHQpe3Quc3RhcnRPYmplY3QoMil9c3RhdGljIGFkZE1vZGUodCxlKXt0LmFkZEZpZWxkSW50MTYoMCxlLGhyLlNwYXJzZSl9c3RhdGljIGFkZFR5cGVJZHModCxlKXt0LmFkZEZpZWxkT2Zmc2V0KDEsZSwwKX1zdGF0aWMgY3JlYXRlVHlwZUlkc1ZlY3Rvcih0LGUpe3Quc3RhcnRWZWN0b3IoNCxlLmxlbmd0aCw0KTtmb3IobGV0IGk9ZS5sZW5ndGgtMTtpPj0wO2ktLSl0LmFkZEludDMyKGVbaV0pO3JldHVybiB0LmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydFR5cGVJZHNWZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDQsZSw0KX1zdGF0aWMgZW5kVW5pb24odCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9c3RhdGljIGNyZWF0ZVVuaW9uKHQsZSxpKXtyZXR1cm4gRnIuc3RhcnRVbmlvbih0KSxGci5hZGRNb2RlKHQsZSksRnIuYWRkVHlwZUlkcyh0LGkpLEZyLmVuZFVuaW9uKHQpfX1jbGFzcyBMcntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfXN0YXRpYyBnZXRSb290QXNVdGY4KHQsZSl7cmV0dXJuKGV8fG5ldyBMcikuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNVdGY4KHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgTHIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgc3RhcnRVdGY4KHQpe3Quc3RhcnRPYmplY3QoMCl9c3RhdGljIGVuZFV0ZjgodCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9c3RhdGljIGNyZWF0ZVV0ZjgodCl7cmV0dXJuIExyLnN0YXJ0VXRmOCh0KSxMci5lbmRVdGY4KHQpfX0hZnVuY3Rpb24odCl7dFt0Lk5PTkU9MF09Ik5PTkUiLHRbdC5OdWxsPTFdPSJOdWxsIix0W3QuSW50PTJdPSJJbnQiLHRbdC5GbG9hdGluZ1BvaW50PTNdPSJGbG9hdGluZ1BvaW50Iix0W3QuQmluYXJ5PTRdPSJCaW5hcnkiLHRbdC5VdGY4PTVdPSJVdGY4Iix0W3QuQm9vbD02XT0iQm9vbCIsdFt0LkRlY2ltYWw9N109IkRlY2ltYWwiLHRbdC5EYXRlPThdPSJEYXRlIix0W3QuVGltZT05XT0iVGltZSIsdFt0LlRpbWVzdGFtcD0xMF09IlRpbWVzdGFtcCIsdFt0LkludGVydmFsPTExXT0iSW50ZXJ2YWwiLHRbdC5MaXN0PTEyXT0iTGlzdCIsdFt0LlN0cnVjdF89MTNdPSJTdHJ1Y3RfIix0W3QuVW5pb249MTRdPSJVbmlvbiIsdFt0LkZpeGVkU2l6ZUJpbmFyeT0xNV09IkZpeGVkU2l6ZUJpbmFyeSIsdFt0LkZpeGVkU2l6ZUxpc3Q9MTZdPSJGaXhlZFNpemVMaXN0Iix0W3QuTWFwPTE3XT0iTWFwIix0W3QuRHVyYXRpb249MThdPSJEdXJhdGlvbiIsdFt0LkxhcmdlQmluYXJ5PTE5XT0iTGFyZ2VCaW5hcnkiLHRbdC5MYXJnZVV0Zjg9MjBdPSJMYXJnZVV0ZjgiLHRbdC5MYXJnZUxpc3Q9MjFdPSJMYXJnZUxpc3QifSh1cnx8KHVyPXt9KSk7Y2xhc3MgTnJ7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzRmllbGQodCxlKXtyZXR1cm4oZXx8bmV3IE5yKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0ZpZWxkKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgTnIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1uYW1lKHQpe2NvbnN0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gZT90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmJfcG9zK2UsdCk6bnVsbH1udWxsYWJsZSgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4hIXQmJiEhdGhpcy5iYi5yZWFkSW50OCh0aGlzLmJiX3Bvcyt0KX10eXBlVHlwZSgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRVaW50OCh0aGlzLmJiX3Bvcyt0KTp1ci5OT05FfXR5cGUodCl7Y29uc3QgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEwKTtyZXR1cm4gZT90aGlzLmJiLl9fdW5pb24odCx0aGlzLmJiX3BvcytlKTpudWxsfWRpY3Rpb25hcnkodCl7Y29uc3QgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEyKTtyZXR1cm4gZT8odHx8bmV3IGJyKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK2UpLHRoaXMuYmIpOm51bGx9Y2hpbGRyZW4odCxlKXtjb25zdCBpPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTQpO3JldHVybiBpPyhlfHxuZXcgTnIpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytpKSs0KnQpLHRoaXMuYmIpOm51bGx9Y2hpbGRyZW5MZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTQpO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9Y3VzdG9tTWV0YWRhdGEodCxlKXtjb25zdCBpPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTYpO3JldHVybiBpPyhlfHxuZXcgZnIpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytpKSs0KnQpLHRoaXMuYmIpOm51bGx9Y3VzdG9tTWV0YWRhdGFMZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTYpO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9c3RhdGljIHN0YXJ0RmllbGQodCl7dC5zdGFydE9iamVjdCg3KX1zdGF0aWMgYWRkTmFtZSh0LGUpe3QuYWRkRmllbGRPZmZzZXQoMCxlLDApfXN0YXRpYyBhZGROdWxsYWJsZSh0LGUpe3QuYWRkRmllbGRJbnQ4KDEsK2UsMCl9c3RhdGljIGFkZFR5cGVUeXBlKHQsZSl7dC5hZGRGaWVsZEludDgoMixlLHVyLk5PTkUpfXN0YXRpYyBhZGRUeXBlKHQsZSl7dC5hZGRGaWVsZE9mZnNldCgzLGUsMCl9c3RhdGljIGFkZERpY3Rpb25hcnkodCxlKXt0LmFkZEZpZWxkT2Zmc2V0KDQsZSwwKX1zdGF0aWMgYWRkQ2hpbGRyZW4odCxlKXt0LmFkZEZpZWxkT2Zmc2V0KDUsZSwwKX1zdGF0aWMgY3JlYXRlQ2hpbGRyZW5WZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDQsZS5sZW5ndGgsNCk7Zm9yKGxldCBpPWUubGVuZ3RoLTE7aT49MDtpLS0pdC5hZGRPZmZzZXQoZVtpXSk7cmV0dXJuIHQuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0Q2hpbGRyZW5WZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDQsZSw0KX1zdGF0aWMgYWRkQ3VzdG9tTWV0YWRhdGEodCxlKXt0LmFkZEZpZWxkT2Zmc2V0KDYsZSwwKX1zdGF0aWMgY3JlYXRlQ3VzdG9tTWV0YWRhdGFWZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDQsZS5sZW5ndGgsNCk7Zm9yKGxldCBpPWUubGVuZ3RoLTE7aT49MDtpLS0pdC5hZGRPZmZzZXQoZVtpXSk7cmV0dXJuIHQuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0Q3VzdG9tTWV0YWRhdGFWZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDQsZSw0KX1zdGF0aWMgZW5kRmllbGQodCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9fWNsYXNzIFVye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc1NjaGVtYSh0LGUpe3JldHVybihlfHxuZXcgVXIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzU2NoZW1hKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgVXIpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1lbmRpYW5uZXNzKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDE2KHRoaXMuYmJfcG9zK3QpOmlyLkxpdHRsZX1maWVsZHModCxlKXtjb25zdCBpPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIGk/KGV8fG5ldyBOcikuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK2kpKzQqdCksdGhpcy5iYik6bnVsbH1maWVsZHNMZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHQ/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrdCk6MH1jdXN0b21NZXRhZGF0YSh0LGUpe2NvbnN0IGk9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gaT8oZXx8bmV3IGZyKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MraSkrNCp0KSx0aGlzLmJiKTpudWxsfWN1c3RvbU1ldGFkYXRhTGVuZ3RoKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9ZmVhdHVyZXModCl7Y29uc3QgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEwKTtyZXR1cm4gZT90aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK2UpKzgqdCk6dGhpcy5iYi5jcmVhdGVMb25nKDAsMCl9ZmVhdHVyZXNMZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTApO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9c3RhdGljIHN0YXJ0U2NoZW1hKHQpe3Quc3RhcnRPYmplY3QoNCl9c3RhdGljIGFkZEVuZGlhbm5lc3ModCxlKXt0LmFkZEZpZWxkSW50MTYoMCxlLGlyLkxpdHRsZSl9c3RhdGljIGFkZEZpZWxkcyh0LGUpe3QuYWRkRmllbGRPZmZzZXQoMSxlLDApfXN0YXRpYyBjcmVhdGVGaWVsZHNWZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDQsZS5sZW5ndGgsNCk7Zm9yKGxldCBpPWUubGVuZ3RoLTE7aT49MDtpLS0pdC5hZGRPZmZzZXQoZVtpXSk7cmV0dXJuIHQuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0RmllbGRzVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig0LGUsNCl9c3RhdGljIGFkZEN1c3RvbU1ldGFkYXRhKHQsZSl7dC5hZGRGaWVsZE9mZnNldCgyLGUsMCl9c3RhdGljIGNyZWF0ZUN1c3RvbU1ldGFkYXRhVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig0LGUubGVuZ3RoLDQpO2ZvcihsZXQgaT1lLmxlbmd0aC0xO2k+PTA7aS0tKXQuYWRkT2Zmc2V0KGVbaV0pO3JldHVybiB0LmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydEN1c3RvbU1ldGFkYXRhVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig0LGUsNCl9c3RhdGljIGFkZEZlYXR1cmVzKHQsZSl7dC5hZGRGaWVsZE9mZnNldCgzLGUsMCl9c3RhdGljIGNyZWF0ZUZlYXR1cmVzVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig4LGUubGVuZ3RoLDgpO2ZvcihsZXQgaT1lLmxlbmd0aC0xO2k+PTA7aS0tKXQuYWRkSW50NjQoZVtpXSk7cmV0dXJuIHQuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0RmVhdHVyZXNWZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDgsZSw4KX1zdGF0aWMgZW5kU2NoZW1hKHQpe3JldHVybiB0LmVuZE9iamVjdCgpfXN0YXRpYyBmaW5pc2hTY2hlbWFCdWZmZXIodCxlKXt0LmZpbmlzaChlKX1zdGF0aWMgZmluaXNoU2l6ZVByZWZpeGVkU2NoZW1hQnVmZmVyKHQsZSl7dC5maW5pc2goZSx2b2lkIDAsITApfXN0YXRpYyBjcmVhdGVTY2hlbWEodCxlLGksbixyKXtyZXR1cm4gVXIuc3RhcnRTY2hlbWEodCksVXIuYWRkRW5kaWFubmVzcyh0LGUpLFVyLmFkZEZpZWxkcyh0LGkpLFVyLmFkZEN1c3RvbU1ldGFkYXRhKHQsbiksVXIuYWRkRmVhdHVyZXModCxyKSxVci5lbmRTY2hlbWEodCl9fWNsYXNzIENye2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0Zvb3Rlcih0LGUpe3JldHVybihlfHxuZXcgQ3IpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzRm9vdGVyKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgQ3IpLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX12ZXJzaW9uKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDE2KHRoaXMuYmJfcG9zK3QpOmVyLlYxfXNjaGVtYSh0KXtjb25zdCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIGU/KHR8fG5ldyBVcikuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiX3BvcytlKSx0aGlzLmJiKTpudWxsfWRpY3Rpb25hcmllcyh0LGUpe2NvbnN0IGk9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gaT8oZXx8bmV3IEtuKS5fX2luaXQodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytpKSsyNCp0LHRoaXMuYmIpOm51bGx9ZGljdGlvbmFyaWVzTGVuZ3RoKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9cmVjb3JkQmF0Y2hlcyh0LGUpe2NvbnN0IGk9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMCk7cmV0dXJuIGk/KGV8fG5ldyBLbikuX19pbml0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MraSkrMjQqdCx0aGlzLmJiKTpudWxsfXJlY29yZEJhdGNoZXNMZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTApO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9Y3VzdG9tTWV0YWRhdGEodCxlKXtjb25zdCBpPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTIpO3JldHVybiBpPyhlfHxuZXcgZnIpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytpKSs0KnQpLHRoaXMuYmIpOm51bGx9Y3VzdG9tTWV0YWRhdGFMZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTIpO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9c3RhdGljIHN0YXJ0Rm9vdGVyKHQpe3Quc3RhcnRPYmplY3QoNSl9c3RhdGljIGFkZFZlcnNpb24odCxlKXt0LmFkZEZpZWxkSW50MTYoMCxlLGVyLlYxKX1zdGF0aWMgYWRkU2NoZW1hKHQsZSl7dC5hZGRGaWVsZE9mZnNldCgxLGUsMCl9c3RhdGljIGFkZERpY3Rpb25hcmllcyh0LGUpe3QuYWRkRmllbGRPZmZzZXQoMixlLDApfXN0YXRpYyBzdGFydERpY3Rpb25hcmllc1ZlY3Rvcih0LGUpe3Quc3RhcnRWZWN0b3IoMjQsZSw4KX1zdGF0aWMgYWRkUmVjb3JkQmF0Y2hlcyh0LGUpe3QuYWRkRmllbGRPZmZzZXQoMyxlLDApfXN0YXRpYyBzdGFydFJlY29yZEJhdGNoZXNWZWN0b3IodCxlKXt0LnN0YXJ0VmVjdG9yKDI0LGUsOCl9c3RhdGljIGFkZEN1c3RvbU1ldGFkYXRhKHQsZSl7dC5hZGRGaWVsZE9mZnNldCg0LGUsMCl9c3RhdGljIGNyZWF0ZUN1c3RvbU1ldGFkYXRhVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig0LGUubGVuZ3RoLDQpO2ZvcihsZXQgaT1lLmxlbmd0aC0xO2k+PTA7aS0tKXQuYWRkT2Zmc2V0KGVbaV0pO3JldHVybiB0LmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydEN1c3RvbU1ldGFkYXRhVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig0LGUsNCl9c3RhdGljIGVuZEZvb3Rlcih0KXtyZXR1cm4gdC5lbmRPYmplY3QoKX1zdGF0aWMgZmluaXNoRm9vdGVyQnVmZmVyKHQsZSl7dC5maW5pc2goZSl9c3RhdGljIGZpbmlzaFNpemVQcmVmaXhlZEZvb3RlckJ1ZmZlcih0LGUpe3QuZmluaXNoKGUsdm9pZCAwLCEwKX19Y2xhc3MgRXJ7Y29uc3RydWN0b3IodD1bXSxlLGkpe3RoaXMuZmllbGRzPXR8fFtdLHRoaXMubWV0YWRhdGE9ZXx8bmV3IE1hcCxpfHwoaT16cih0KSksdGhpcy5kaWN0aW9uYXJpZXM9aX1nZXRbU3ltYm9sLnRvU3RyaW5nVGFnXSgpe3JldHVybiJTY2hlbWEifWdldCBuYW1lcygpe3JldHVybiB0aGlzLmZpZWxkcy5tYXAoKHQ9PnQubmFtZSkpfXRvU3RyaW5nKCl7cmV0dXJuYFNjaGVtYTx7ICR7dGhpcy5maWVsZHMubWFwKCgodCxlKT0+YCR7ZX06ICR7dH1gKSkuam9pbigiLCAiKX0gfT5gfXNlbGVjdCh0KXtjb25zdCBlPW5ldyBTZXQodCksaT10aGlzLmZpZWxkcy5maWx0ZXIoKHQ9PmUuaGFzKHQubmFtZSkpKTtyZXR1cm4gbmV3IEVyKGksdGhpcy5tZXRhZGF0YSl9c2VsZWN0QXQodCl7Y29uc3QgZT10Lm1hcCgodD0+dGhpcy5maWVsZHNbdF0pKS5maWx0ZXIoQm9vbGVhbik7cmV0dXJuIG5ldyBFcihlLHRoaXMubWV0YWRhdGEpfWFzc2lnbiguLi50KXtjb25zdCBlPXRbMF1pbnN0YW5jZW9mIEVyP3RbMF06QXJyYXkuaXNBcnJheSh0WzBdKT9uZXcgRXIodFswXSk6bmV3IEVyKHQpLGk9Wy4uLnRoaXMuZmllbGRzXSxuPVJyKFJyKG5ldyBNYXAsdGhpcy5tZXRhZGF0YSksZS5tZXRhZGF0YSkscj1lLmZpZWxkcy5maWx0ZXIoKHQ9Pntjb25zdCBlPWkuZmluZEluZGV4KChlPT5lLm5hbWU9PT10Lm5hbWUpKTtyZXR1cm4hfmV8fChpW2VdPXQuY2xvbmUoe21ldGFkYXRhOlJyKFJyKG5ldyBNYXAsaVtlXS5tZXRhZGF0YSksdC5tZXRhZGF0YSl9KSkmJiExfSkpLHM9enIocixuZXcgTWFwKTtyZXR1cm4gbmV3IEVyKFsuLi5pLC4uLnJdLG4sbmV3IE1hcChbLi4udGhpcy5kaWN0aW9uYXJpZXMsLi4uc10pKX19RXIucHJvdG90eXBlLmZpZWxkcz1udWxsLEVyLnByb3RvdHlwZS5tZXRhZGF0YT1udWxsLEVyLnByb3RvdHlwZS5kaWN0aW9uYXJpZXM9bnVsbDtjbGFzcyBWcntjb25zdHJ1Y3Rvcih0LGUsaT0hMSxuKXt0aGlzLm5hbWU9dCx0aGlzLnR5cGU9ZSx0aGlzLm51bGxhYmxlPWksdGhpcy5tZXRhZGF0YT1ufHxuZXcgTWFwfXN0YXRpYyBuZXcoLi4udCl7bGV0W2UsaSxuLHJdPXQ7cmV0dXJuIHRbMF0mJiJvYmplY3QiPT10eXBlb2YgdFswXSYmKCh7bmFtZTplfT10WzBdKSx2b2lkIDA9PT1pJiYoaT10WzBdLnR5cGUpLHZvaWQgMD09PW4mJihuPXRbMF0ubnVsbGFibGUpLHZvaWQgMD09PXImJihyPXRbMF0ubWV0YWRhdGEpKSxuZXcgVnIoYCR7ZX1gLGksbixyKX1nZXQgdHlwZUlkKCl7cmV0dXJuIHRoaXMudHlwZS50eXBlSWR9Z2V0W1N5bWJvbC50b1N0cmluZ1RhZ10oKXtyZXR1cm4iRmllbGQifXRvU3RyaW5nKCl7cmV0dXJuYCR7dGhpcy5uYW1lfTogJHt0aGlzLnR5cGV9YH1jbG9uZSguLi50KXtsZXRbZSxpLG4scl09dDtyZXR1cm4gdFswXSYmIm9iamVjdCI9PXR5cGVvZiB0WzBdPyh7bmFtZTplPXRoaXMubmFtZSx0eXBlOmk9dGhpcy50eXBlLG51bGxhYmxlOm49dGhpcy5udWxsYWJsZSxtZXRhZGF0YTpyPXRoaXMubWV0YWRhdGF9PXRbMF0pOltlPXRoaXMubmFtZSxpPXRoaXMudHlwZSxuPXRoaXMubnVsbGFibGUscj10aGlzLm1ldGFkYXRhXT10LFZyLm5ldyhlLGksbixyKX19ZnVuY3Rpb24gUnIodCxlKXtyZXR1cm4gbmV3IE1hcChbLi4udHx8bmV3IE1hcCwuLi5lfHxuZXcgTWFwXSl9ZnVuY3Rpb24genIodCxlPW5ldyBNYXApe2ZvcihsZXQgaT0tMSxuPXQubGVuZ3RoOysraTxuOyl7Y29uc3Qgbj10W2ldLnR5cGU7aWYoZWUuaXNEaWN0aW9uYXJ5KG4pKWlmKGUuaGFzKG4uaWQpKXtpZihlLmdldChuLmlkKSE9PW4uZGljdGlvbmFyeSl0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBjcmVhdGUgU2NoZW1hIGNvbnRhaW5pbmcgdHdvIGRpZmZlcmVudCBkaWN0aW9uYXJpZXMgd2l0aCB0aGUgc2FtZSBJZCIpfWVsc2UgZS5zZXQobi5pZCxuLmRpY3Rpb25hcnkpO24uY2hpbGRyZW4mJm4uY2hpbGRyZW4ubGVuZ3RoPjAmJnpyKG4uY2hpbGRyZW4sZSl9cmV0dXJuIGV9VnIucHJvdG90eXBlLnR5cGU9bnVsbCxWci5wcm90b3R5cGUubmFtZT1udWxsLFZyLnByb3RvdHlwZS5udWxsYWJsZT1udWxsLFZyLnByb3RvdHlwZS5tZXRhZGF0YT1udWxsO3ZhciBQcj1Rbixqcj1wcixrcj1kcjtjbGFzcyAkcntjb25zdHJ1Y3Rvcih0LGU9b3QuVjQsaSxuKXt0aGlzLnNjaGVtYT10LHRoaXMudmVyc2lvbj1lLGkmJih0aGlzLl9yZWNvcmRCYXRjaGVzPWkpLG4mJih0aGlzLl9kaWN0aW9uYXJ5QmF0Y2hlcz1uKX1zdGF0aWMgZGVjb2RlKHQpe3Q9bmV3IGtyKFoodCkpO2NvbnN0IGU9Q3IuZ2V0Um9vdEFzRm9vdGVyKHQpLGk9RXIuZGVjb2RlKGUuc2NoZW1hKCkpO3JldHVybiBuZXcgWXIoaSxlKX1zdGF0aWMgZW5jb2RlKHQpe2NvbnN0IGU9bmV3IGpyLGk9RXIuZW5jb2RlKGUsdC5zY2hlbWEpO0NyLnN0YXJ0UmVjb3JkQmF0Y2hlc1ZlY3RvcihlLHQubnVtUmVjb3JkQmF0Y2hlcyk7Zm9yKGNvbnN0IHMgb2ZbLi4udC5yZWNvcmRCYXRjaGVzKCldLnNsaWNlKCkucmV2ZXJzZSgpKVdyLmVuY29kZShlLHMpO2NvbnN0IG49ZS5lbmRWZWN0b3IoKTtDci5zdGFydERpY3Rpb25hcmllc1ZlY3RvcihlLHQubnVtRGljdGlvbmFyaWVzKTtmb3IoY29uc3QgcyBvZlsuLi50LmRpY3Rpb25hcnlCYXRjaGVzKCldLnNsaWNlKCkucmV2ZXJzZSgpKVdyLmVuY29kZShlLHMpO2NvbnN0IHI9ZS5lbmRWZWN0b3IoKTtyZXR1cm4gQ3Iuc3RhcnRGb290ZXIoZSksQ3IuYWRkU2NoZW1hKGUsaSksQ3IuYWRkVmVyc2lvbihlLG90LlY0KSxDci5hZGRSZWNvcmRCYXRjaGVzKGUsbiksQ3IuYWRkRGljdGlvbmFyaWVzKGUsciksQ3IuZmluaXNoRm9vdGVyQnVmZmVyKGUsQ3IuZW5kRm9vdGVyKGUpKSxlLmFzVWludDhBcnJheSgpfWdldCBudW1SZWNvcmRCYXRjaGVzKCl7cmV0dXJuIHRoaXMuX3JlY29yZEJhdGNoZXMubGVuZ3RofWdldCBudW1EaWN0aW9uYXJpZXMoKXtyZXR1cm4gdGhpcy5fZGljdGlvbmFyeUJhdGNoZXMubGVuZ3RofSpyZWNvcmRCYXRjaGVzKCl7Zm9yKGxldCB0LGU9LTEsaT10aGlzLm51bVJlY29yZEJhdGNoZXM7KytlPGk7KSh0PXRoaXMuZ2V0UmVjb3JkQmF0Y2goZSkpJiYoeWllbGQgdCl9KmRpY3Rpb25hcnlCYXRjaGVzKCl7Zm9yKGxldCB0LGU9LTEsaT10aGlzLm51bURpY3Rpb25hcmllczsrK2U8aTspKHQ9dGhpcy5nZXREaWN0aW9uYXJ5QmF0Y2goZSkpJiYoeWllbGQgdCl9Z2V0UmVjb3JkQmF0Y2godCl7cmV0dXJuIHQ+PTAmJnQ8dGhpcy5udW1SZWNvcmRCYXRjaGVzJiZ0aGlzLl9yZWNvcmRCYXRjaGVzW3RdfHxudWxsfWdldERpY3Rpb25hcnlCYXRjaCh0KXtyZXR1cm4gdD49MCYmdDx0aGlzLm51bURpY3Rpb25hcmllcyYmdGhpcy5fZGljdGlvbmFyeUJhdGNoZXNbdF18fG51bGx9fWNsYXNzIFlyIGV4dGVuZHMgJHJ7Y29uc3RydWN0b3IodCxlKXtzdXBlcih0LGUudmVyc2lvbigpKSx0aGlzLl9mb290ZXI9ZX1nZXQgbnVtUmVjb3JkQmF0Y2hlcygpe3JldHVybiB0aGlzLl9mb290ZXIucmVjb3JkQmF0Y2hlc0xlbmd0aCgpfWdldCBudW1EaWN0aW9uYXJpZXMoKXtyZXR1cm4gdGhpcy5fZm9vdGVyLmRpY3Rpb25hcmllc0xlbmd0aCgpfWdldFJlY29yZEJhdGNoKHQpe2lmKHQ+PTAmJnQ8dGhpcy5udW1SZWNvcmRCYXRjaGVzKXtjb25zdCBlPXRoaXMuX2Zvb3Rlci5yZWNvcmRCYXRjaGVzKHQpO2lmKGUpcmV0dXJuIFdyLmRlY29kZShlKX1yZXR1cm4gbnVsbH1nZXREaWN0aW9uYXJ5QmF0Y2godCl7aWYodD49MCYmdDx0aGlzLm51bURpY3Rpb25hcmllcyl7Y29uc3QgZT10aGlzLl9mb290ZXIuZGljdGlvbmFyaWVzKHQpO2lmKGUpcmV0dXJuIFdyLmRlY29kZShlKX1yZXR1cm4gbnVsbH19Y2xhc3MgV3J7Y29uc3RydWN0b3IodCxlLGkpe3RoaXMubWV0YURhdGFMZW5ndGg9dCx0aGlzLm9mZnNldD0ibnVtYmVyIj09dHlwZW9mIGk/aTppLmxvdyx0aGlzLmJvZHlMZW5ndGg9Im51bWJlciI9PXR5cGVvZiBlP2U6ZS5sb3d9c3RhdGljIGRlY29kZSh0KXtyZXR1cm4gbmV3IFdyKHQubWV0YURhdGFMZW5ndGgoKSx0LmJvZHlMZW5ndGgoKSx0Lm9mZnNldCgpKX1zdGF0aWMgZW5jb2RlKHQsZSl7Y29uc3R7bWV0YURhdGFMZW5ndGg6aX09ZSxuPW5ldyBQcihlLm9mZnNldCwwKSxyPW5ldyBQcihlLmJvZHlMZW5ndGgsMCk7cmV0dXJuIEtuLmNyZWF0ZUJsb2NrKHQsbixpLHIpfX1jb25zdCBIcj1PYmplY3QuZnJlZXplKHtkb25lOiEwLHZhbHVlOnZvaWQgMH0pO2NsYXNzIEtye2NvbnN0cnVjdG9yKHQpe3RoaXMuX2pzb249dH1nZXQgc2NoZW1hKCl7cmV0dXJuIHRoaXMuX2pzb24uc2NoZW1hfWdldCBiYXRjaGVzKCl7cmV0dXJuIHRoaXMuX2pzb24uYmF0Y2hlc3x8W119Z2V0IGRpY3Rpb25hcmllcygpe3JldHVybiB0aGlzLl9qc29uLmRpY3Rpb25hcmllc3x8W119fWNsYXNzIEpye3RlZSgpe3JldHVybiB0aGlzLl9nZXRET01TdHJlYW0oKS50ZWUoKX1waXBlKHQsZSl7cmV0dXJuIHRoaXMuX2dldE5vZGVTdHJlYW0oKS5waXBlKHQsZSl9cGlwZVRvKHQsZSl7cmV0dXJuIHRoaXMuX2dldERPTVN0cmVhbSgpLnBpcGVUbyh0LGUpfXBpcGVUaHJvdWdoKHQsZSl7cmV0dXJuIHRoaXMuX2dldERPTVN0cmVhbSgpLnBpcGVUaHJvdWdoKHQsZSl9X2dldERPTVN0cmVhbSgpe3JldHVybiB0aGlzLl9ET01TdHJlYW18fCh0aGlzLl9ET01TdHJlYW09dGhpcy50b0RPTVN0cmVhbSgpKX1fZ2V0Tm9kZVN0cmVhbSgpe3JldHVybiB0aGlzLl9ub2RlU3RyZWFtfHwodGhpcy5fbm9kZVN0cmVhbT10aGlzLnRvTm9kZVN0cmVhbSgpKX19Y2xhc3MgR3IgZXh0ZW5kcyBKcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5fdmFsdWVzPVtdLHRoaXMucmVzb2x2ZXJzPVtdLHRoaXMuX2Nsb3NlZFByb21pc2U9bmV3IFByb21pc2UoKHQ9PnRoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlPXQpKX1nZXQgY2xvc2VkKCl7cmV0dXJuIHRoaXMuX2Nsb3NlZFByb21pc2V9Y2FuY2VsKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5yZXR1cm4odCl9KSl9d3JpdGUodCl7dGhpcy5fZW5zdXJlT3BlbigpJiYodGhpcy5yZXNvbHZlcnMubGVuZ3RoPD0wP3RoaXMuX3ZhbHVlcy5wdXNoKHQpOnRoaXMucmVzb2x2ZXJzLnNoaWZ0KCkucmVzb2x2ZSh7ZG9uZTohMSx2YWx1ZTp0fSkpfWFib3J0KHQpe3RoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlJiYodGhpcy5yZXNvbHZlcnMubGVuZ3RoPD0wP3RoaXMuX2Vycm9yPXtlcnJvcjp0fTp0aGlzLnJlc29sdmVycy5zaGlmdCgpLnJlamVjdCh7ZG9uZTohMCx2YWx1ZTp0fSkpfWNsb3NlKCl7aWYodGhpcy5fY2xvc2VkUHJvbWlzZVJlc29sdmUpe2NvbnN0e3Jlc29sdmVyczp0fT10aGlzO2Zvcig7dC5sZW5ndGg+MDspdC5zaGlmdCgpLnJlc29sdmUoSHIpO3RoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlKCksdGhpcy5fY2xvc2VkUHJvbWlzZVJlc29sdmU9dm9pZCAwfX1bU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCl7cmV0dXJuIHRoaXN9dG9ET01TdHJlYW0odCl7cmV0dXJuIGl0LnRvRE9NU3RyZWFtKHRoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlfHx0aGlzLl9lcnJvcj90aGlzOnRoaXMuX3ZhbHVlcyx0KX10b05vZGVTdHJlYW0odCl7cmV0dXJuIGl0LnRvTm9kZVN0cmVhbSh0aGlzLl9jbG9zZWRQcm9taXNlUmVzb2x2ZXx8dGhpcy5fZXJyb3I/dGhpczp0aGlzLl92YWx1ZXMsdCl9dGhyb3codCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5hYm9ydCh0KSxIcn0pKX1yZXR1cm4odCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5jbG9zZSgpLEhyfSkpfXJlYWQodCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4oeWllbGQgdGhpcy5uZXh0KHQsInJlYWQiKSkudmFsdWV9KSl9cGVlayh0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybih5aWVsZCB0aGlzLm5leHQodCwicGVlayIpKS52YWx1ZX0pKX1uZXh0KC4uLnQpe3JldHVybiB0aGlzLl92YWx1ZXMubGVuZ3RoPjA/UHJvbWlzZS5yZXNvbHZlKHtkb25lOiExLHZhbHVlOnRoaXMuX3ZhbHVlcy5zaGlmdCgpfSk6dGhpcy5fZXJyb3I/UHJvbWlzZS5yZWplY3Qoe2RvbmU6ITAsdmFsdWU6dGhpcy5fZXJyb3IuZXJyb3J9KTp0aGlzLl9jbG9zZWRQcm9taXNlUmVzb2x2ZT9uZXcgUHJvbWlzZSgoKHQsZSk9Pnt0aGlzLnJlc29sdmVycy5wdXNoKHtyZXNvbHZlOnQscmVqZWN0OmV9KX0pKTpQcm9taXNlLnJlc29sdmUoSHIpfV9lbnN1cmVPcGVuKCl7aWYodGhpcy5fY2xvc2VkUHJvbWlzZVJlc29sdmUpcmV0dXJuITA7dGhyb3cgbmV3IEVycm9yKCJBc3luY1F1ZXVlIGlzIGNsb3NlZCIpfX1jbGFzcyBaciBleHRlbmRzIEdye3dyaXRlKHQpe2lmKCh0PVoodCkpLmJ5dGVMZW5ndGg+MClyZXR1cm4gc3VwZXIud3JpdGUodCl9dG9TdHJpbmcodD0hMSl7cmV0dXJuIHQ/Uyh0aGlzLnRvVWludDhBcnJheSghMCkpOnRoaXMudG9VaW50OEFycmF5KCExKS50aGVuKFMpfXRvVWludDhBcnJheSh0PSExKXtyZXR1cm4gdD9LKHRoaXMuX3ZhbHVlcylbMF06KCgpPT5iKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7dmFyIHQsZTtjb25zdCBpPVtdO2xldCBuPTA7dHJ5e2Zvcih2YXIgcixzPXcodGhpcyk7IShyPXlpZWxkIHMubmV4dCgpKS5kb25lOyl7Y29uc3QgdD1yLnZhbHVlO2kucHVzaCh0KSxuKz10LmJ5dGVMZW5ndGh9fWNhdGNoKG8pe3Q9e2Vycm9yOm99fWZpbmFsbHl7dHJ5e3ImJiFyLmRvbmUmJihlPXMucmV0dXJuKSYmKHlpZWxkIGUuY2FsbChzKSl9ZmluYWxseXtpZih0KXRocm93IHQuZXJyb3J9fXJldHVybiBLKGksbilbMF19KSkpKCl9fWNsYXNzIHFye2NvbnN0cnVjdG9yKHQpe3QmJih0aGlzLnNvdXJjZT1uZXcgWHIoaXQuZnJvbUl0ZXJhYmxlKHQpKSl9W1N5bWJvbC5pdGVyYXRvcl0oKXtyZXR1cm4gdGhpc31uZXh0KHQpe3JldHVybiB0aGlzLnNvdXJjZS5uZXh0KHQpfXRocm93KHQpe3JldHVybiB0aGlzLnNvdXJjZS50aHJvdyh0KX1yZXR1cm4odCl7cmV0dXJuIHRoaXMuc291cmNlLnJldHVybih0KX1wZWVrKHQpe3JldHVybiB0aGlzLnNvdXJjZS5wZWVrKHQpfXJlYWQodCl7cmV0dXJuIHRoaXMuc291cmNlLnJlYWQodCl9fWNsYXNzIFFye2NvbnN0cnVjdG9yKHQpe3QgaW5zdGFuY2VvZiBRcj90aGlzLnNvdXJjZT10LnNvdXJjZTp0IGluc3RhbmNlb2YgWnI/dGhpcy5zb3VyY2U9bmV3IHRzKGl0LmZyb21Bc3luY0l0ZXJhYmxlKHQpKTpZKHQpP3RoaXMuc291cmNlPW5ldyB0cyhpdC5mcm9tTm9kZVN0cmVhbSh0KSk6JCh0KT90aGlzLnNvdXJjZT1uZXcgdHMoaXQuZnJvbURPTVN0cmVhbSh0KSk6aih0KT90aGlzLnNvdXJjZT1uZXcgdHMoaXQuZnJvbURPTVN0cmVhbSh0LmJvZHkpKTpFKHQpP3RoaXMuc291cmNlPW5ldyB0cyhpdC5mcm9tSXRlcmFibGUodCkpOihDKHQpfHxWKHQpKSYmKHRoaXMuc291cmNlPW5ldyB0cyhpdC5mcm9tQXN5bmNJdGVyYWJsZSh0KSkpfVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtyZXR1cm4gdGhpc31uZXh0KHQpe3JldHVybiB0aGlzLnNvdXJjZS5uZXh0KHQpfXRocm93KHQpe3JldHVybiB0aGlzLnNvdXJjZS50aHJvdyh0KX1yZXR1cm4odCl7cmV0dXJuIHRoaXMuc291cmNlLnJldHVybih0KX1nZXQgY2xvc2VkKCl7cmV0dXJuIHRoaXMuc291cmNlLmNsb3NlZH1jYW5jZWwodCl7cmV0dXJuIHRoaXMuc291cmNlLmNhbmNlbCh0KX1wZWVrKHQpe3JldHVybiB0aGlzLnNvdXJjZS5wZWVrKHQpfXJlYWQodCl7cmV0dXJuIHRoaXMuc291cmNlLnJlYWQodCl9fWNsYXNzIFhye2NvbnN0cnVjdG9yKHQpe3RoaXMuc291cmNlPXR9Y2FuY2VsKHQpe3RoaXMucmV0dXJuKHQpfXBlZWsodCl7cmV0dXJuIHRoaXMubmV4dCh0LCJwZWVrIikudmFsdWV9cmVhZCh0KXtyZXR1cm4gdGhpcy5uZXh0KHQsInJlYWQiKS52YWx1ZX1uZXh0KHQsZT0icmVhZCIpe3JldHVybiB0aGlzLnNvdXJjZS5uZXh0KHtjbWQ6ZSxzaXplOnR9KX10aHJvdyh0KXtyZXR1cm4gT2JqZWN0LmNyZWF0ZSh0aGlzLnNvdXJjZS50aHJvdyYmdGhpcy5zb3VyY2UudGhyb3codCl8fEhyKX1yZXR1cm4odCl7cmV0dXJuIE9iamVjdC5jcmVhdGUodGhpcy5zb3VyY2UucmV0dXJuJiZ0aGlzLnNvdXJjZS5yZXR1cm4odCl8fEhyKX19Y2xhc3MgdHN7Y29uc3RydWN0b3IodCl7dGhpcy5zb3VyY2U9dCx0aGlzLl9jbG9zZWRQcm9taXNlPW5ldyBQcm9taXNlKCh0PT50aGlzLl9jbG9zZWRQcm9taXNlUmVzb2x2ZT10KSl9Y2FuY2VsKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5yZXR1cm4odCl9KSl9Z2V0IGNsb3NlZCgpe3JldHVybiB0aGlzLl9jbG9zZWRQcm9taXNlfXJlYWQodCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4oeWllbGQgdGhpcy5uZXh0KHQsInJlYWQiKSkudmFsdWV9KSl9cGVlayh0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybih5aWVsZCB0aGlzLm5leHQodCwicGVlayIpKS52YWx1ZX0pKX1uZXh0KHQsZT0icmVhZCIpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMuc291cmNlLm5leHQoe2NtZDplLHNpemU6dH0pfSkpfXRocm93KHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3QgZT10aGlzLnNvdXJjZS50aHJvdyYmKHlpZWxkIHRoaXMuc291cmNlLnRocm93KHQpKXx8SHI7cmV0dXJuIHRoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlJiZ0aGlzLl9jbG9zZWRQcm9taXNlUmVzb2x2ZSgpLHRoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlPXZvaWQgMCxPYmplY3QuY3JlYXRlKGUpfSkpfXJldHVybih0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5zb3VyY2UucmV0dXJuJiYoeWllbGQgdGhpcy5zb3VyY2UucmV0dXJuKHQpKXx8SHI7cmV0dXJuIHRoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlJiZ0aGlzLl9jbG9zZWRQcm9taXNlUmVzb2x2ZSgpLHRoaXMuX2Nsb3NlZFByb21pc2VSZXNvbHZlPXZvaWQgMCxPYmplY3QuY3JlYXRlKGUpfSkpfX1jbGFzcyBlcyBleHRlbmRzIHFye2NvbnN0cnVjdG9yKHQsZSl7c3VwZXIoKSx0aGlzLnBvc2l0aW9uPTAsdGhpcy5idWZmZXI9Wih0KSx0aGlzLnNpemU9dm9pZCAwPT09ZT90aGlzLmJ1ZmZlci5ieXRlTGVuZ3RoOmV9cmVhZEludDMyKHQpe2NvbnN0e2J1ZmZlcjplLGJ5dGVPZmZzZXQ6aX09dGhpcy5yZWFkQXQodCw0KTtyZXR1cm4gbmV3IERhdGFWaWV3KGUsaSkuZ2V0SW50MzIoMCwhMCl9c2Vlayh0KXtyZXR1cm4gdGhpcy5wb3NpdGlvbj1NYXRoLm1pbih0LHRoaXMuc2l6ZSksdDx0aGlzLnNpemV9cmVhZCh0KXtjb25zdHtidWZmZXI6ZSxzaXplOmkscG9zaXRpb246bn09dGhpcztyZXR1cm4gZSYmbjxpPygibnVtYmVyIiE9dHlwZW9mIHQmJih0PU51bWJlci5QT1NJVElWRV9JTkZJTklUWSksdGhpcy5wb3NpdGlvbj1NYXRoLm1pbihpLG4rTWF0aC5taW4oaS1uLHQpKSxlLnN1YmFycmF5KG4sdGhpcy5wb3NpdGlvbikpOm51bGx9cmVhZEF0KHQsZSl7Y29uc3QgaT10aGlzLmJ1ZmZlcixuPU1hdGgubWluKHRoaXMuc2l6ZSx0K2UpO3JldHVybiBpP2kuc3ViYXJyYXkodCxuKTpuZXcgVWludDhBcnJheShlKX1jbG9zZSgpe3RoaXMuYnVmZmVyJiYodGhpcy5idWZmZXI9bnVsbCl9dGhyb3codCl7cmV0dXJuIHRoaXMuY2xvc2UoKSx7ZG9uZTohMCx2YWx1ZTp0fX1yZXR1cm4odCl7cmV0dXJuIHRoaXMuY2xvc2UoKSx7ZG9uZTohMCx2YWx1ZTp0fX19Y2xhc3MgaXMgZXh0ZW5kcyBRcntjb25zdHJ1Y3Rvcih0LGUpe3N1cGVyKCksdGhpcy5wb3NpdGlvbj0wLHRoaXMuX2hhbmRsZT10LCJudW1iZXIiPT10eXBlb2YgZT90aGlzLnNpemU9ZTp0aGlzLl9wZW5kaW5nPSgoKT0+Yih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3RoaXMuc2l6ZT0oeWllbGQgdC5zdGF0KCkpLnNpemUsZGVsZXRlIHRoaXMuX3BlbmRpbmd9KSkpKCl9cmVhZEludDMyKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3R7YnVmZmVyOmUsYnl0ZU9mZnNldDppfT15aWVsZCB0aGlzLnJlYWRBdCh0LDQpO3JldHVybiBuZXcgRGF0YVZpZXcoZSxpKS5nZXRJbnQzMigwLCEwKX0pKX1zZWVrKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuX3BlbmRpbmcmJih5aWVsZCB0aGlzLl9wZW5kaW5nKSx0aGlzLnBvc2l0aW9uPU1hdGgubWluKHQsdGhpcy5zaXplKSx0PHRoaXMuc2l6ZX0pKX1yZWFkKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7dGhpcy5fcGVuZGluZyYmKHlpZWxkIHRoaXMuX3BlbmRpbmcpO2NvbnN0e19oYW5kbGU6ZSxzaXplOmkscG9zaXRpb246bn09dGhpcztpZihlJiZuPGkpeyJudW1iZXIiIT10eXBlb2YgdCYmKHQ9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKTtsZXQgcj1uLHM9MCxvPTA7Y29uc3QgYT1NYXRoLm1pbihpLHIrTWF0aC5taW4oaS1yLHQpKSxsPW5ldyBVaW50OEFycmF5KE1hdGgubWF4KDAsKHRoaXMucG9zaXRpb249YSktcikpO2Zvcig7KHIrPW8pPGEmJihzKz1vKTxsLmJ5dGVMZW5ndGg7KSh7Ynl0ZXNSZWFkOm99PXlpZWxkIGUucmVhZChsLHMsbC5ieXRlTGVuZ3RoLXMscikpO3JldHVybiBsfXJldHVybiBudWxsfSkpfXJlYWRBdCh0LGUpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7dGhpcy5fcGVuZGluZyYmKHlpZWxkIHRoaXMuX3BlbmRpbmcpO2NvbnN0e19oYW5kbGU6aSxzaXplOm59PXRoaXM7aWYoaSYmdCtlPG4pe2NvbnN0IHI9TWF0aC5taW4obix0K2UpLHM9bmV3IFVpbnQ4QXJyYXkoci10KTtyZXR1cm4oeWllbGQgaS5yZWFkKHMsMCxlLHQpKS5idWZmZXJ9cmV0dXJuIG5ldyBVaW50OEFycmF5KGUpfSkpfWNsb3NlKCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuX2hhbmRsZTt0aGlzLl9oYW5kbGU9bnVsbCx0JiYoeWllbGQgdC5jbG9zZSgpKX0pKX10aHJvdyh0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLmNsb3NlKCkse2RvbmU6ITAsdmFsdWU6dH19KSl9cmV0dXJuKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMuY2xvc2UoKSx7ZG9uZTohMCx2YWx1ZTp0fX0pKX19ZnVuY3Rpb24gbnModCl7cmV0dXJuIHQ8MCYmKHQ9NDI5NDk2NzI5NSt0KzEpLGAweCR7dC50b1N0cmluZygxNil9YH1jb25zdCBycz1bMSwxMCwxMDAsMWUzLDFlNCwxZTUsMWU2LDFlNywxZThdO2NsYXNzIHNze2NvbnN0cnVjdG9yKHQpe3RoaXMuYnVmZmVyPXR9aGlnaCgpe3JldHVybiB0aGlzLmJ1ZmZlclsxXX1sb3coKXtyZXR1cm4gdGhpcy5idWZmZXJbMF19X3RpbWVzKHQpe2NvbnN0IGU9bmV3IFVpbnQzMkFycmF5KFt0aGlzLmJ1ZmZlclsxXT4+PjE2LDY1NTM1JnRoaXMuYnVmZmVyWzFdLHRoaXMuYnVmZmVyWzBdPj4+MTYsNjU1MzUmdGhpcy5idWZmZXJbMF1dKSxpPW5ldyBVaW50MzJBcnJheShbdC5idWZmZXJbMV0+Pj4xNiw2NTUzNSZ0LmJ1ZmZlclsxXSx0LmJ1ZmZlclswXT4+PjE2LDY1NTM1JnQuYnVmZmVyWzBdXSk7bGV0IG49ZVszXSppWzNdO3RoaXMuYnVmZmVyWzBdPTY1NTM1Jm47bGV0IHI9bj4+PjE2O3JldHVybiBuPWVbMl0qaVszXSxyKz1uLG49ZVszXSppWzJdPj4+MCxyKz1uLHRoaXMuYnVmZmVyWzBdKz1yPDwxNix0aGlzLmJ1ZmZlclsxXT1yPj4+MDxuPzY1NTM2OjAsdGhpcy5idWZmZXJbMV0rPXI+Pj4xNix0aGlzLmJ1ZmZlclsxXSs9ZVsxXSppWzNdK2VbMl0qaVsyXStlWzNdKmlbMV0sdGhpcy5idWZmZXJbMV0rPWVbMF0qaVszXStlWzFdKmlbMl0rZVsyXSppWzFdK2VbM10qaVswXTw8MTYsdGhpc31fcGx1cyh0KXtjb25zdCBlPXRoaXMuYnVmZmVyWzBdK3QuYnVmZmVyWzBdPj4+MDt0aGlzLmJ1ZmZlclsxXSs9dC5idWZmZXJbMV0sZTx0aGlzLmJ1ZmZlclswXT4+PjAmJisrdGhpcy5idWZmZXJbMV0sdGhpcy5idWZmZXJbMF09ZX1sZXNzVGhhbih0KXtyZXR1cm4gdGhpcy5idWZmZXJbMV08dC5idWZmZXJbMV18fHRoaXMuYnVmZmVyWzFdPT09dC5idWZmZXJbMV0mJnRoaXMuYnVmZmVyWzBdPHQuYnVmZmVyWzBdfWVxdWFscyh0KXtyZXR1cm4gdGhpcy5idWZmZXJbMV09PT10LmJ1ZmZlclsxXSYmdGhpcy5idWZmZXJbMF09PXQuYnVmZmVyWzBdfWdyZWF0ZXJUaGFuKHQpe3JldHVybiB0Lmxlc3NUaGFuKHRoaXMpfWhleCgpe3JldHVybmAke25zKHRoaXMuYnVmZmVyWzFdKX0gJHtucyh0aGlzLmJ1ZmZlclswXSl9YH19Y2xhc3Mgb3MgZXh0ZW5kcyBzc3t0aW1lcyh0KXtyZXR1cm4gdGhpcy5fdGltZXModCksdGhpc31wbHVzKHQpe3JldHVybiB0aGlzLl9wbHVzKHQpLHRoaXN9c3RhdGljIGZyb20odCxlPW5ldyBVaW50MzJBcnJheSgyKSl7cmV0dXJuIG9zLmZyb21TdHJpbmcoInN0cmluZyI9PXR5cGVvZiB0P3Q6dC50b1N0cmluZygpLGUpfXN0YXRpYyBmcm9tTnVtYmVyKHQsZT1uZXcgVWludDMyQXJyYXkoMikpe3JldHVybiBvcy5mcm9tU3RyaW5nKHQudG9TdHJpbmcoKSxlKX1zdGF0aWMgZnJvbVN0cmluZyh0LGU9bmV3IFVpbnQzMkFycmF5KDIpKXtjb25zdCBpPXQubGVuZ3RoLG49bmV3IG9zKGUpO2ZvcihsZXQgcj0wO3I8aTspe2NvbnN0IGU9ODxpLXI/ODppLXIscz1uZXcgb3MobmV3IFVpbnQzMkFycmF5KFtOdW1iZXIucGFyc2VJbnQodC5zbGljZShyLHIrZSksMTApLDBdKSksbz1uZXcgb3MobmV3IFVpbnQzMkFycmF5KFtyc1tlXSwwXSkpO24udGltZXMobyksbi5wbHVzKHMpLHIrPWV9cmV0dXJuIG59c3RhdGljIGNvbnZlcnRBcnJheSh0KXtjb25zdCBlPW5ldyBVaW50MzJBcnJheSgyKnQubGVuZ3RoKTtmb3IobGV0IGk9LTEsbj10Lmxlbmd0aDsrK2k8bjspb3MuZnJvbSh0W2ldLG5ldyBVaW50MzJBcnJheShlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQrMippKjQsMikpO3JldHVybiBlfXN0YXRpYyBtdWx0aXBseSh0LGUpe3JldHVybiBuZXcgb3MobmV3IFVpbnQzMkFycmF5KHQuYnVmZmVyKSkudGltZXMoZSl9c3RhdGljIGFkZCh0LGUpe3JldHVybiBuZXcgb3MobmV3IFVpbnQzMkFycmF5KHQuYnVmZmVyKSkucGx1cyhlKX19Y2xhc3MgYXMgZXh0ZW5kcyBzc3tuZWdhdGUoKXtyZXR1cm4gdGhpcy5idWZmZXJbMF09MSt+dGhpcy5idWZmZXJbMF0sdGhpcy5idWZmZXJbMV09fnRoaXMuYnVmZmVyWzFdLDA9PXRoaXMuYnVmZmVyWzBdJiYrK3RoaXMuYnVmZmVyWzFdLHRoaXN9dGltZXModCl7cmV0dXJuIHRoaXMuX3RpbWVzKHQpLHRoaXN9cGx1cyh0KXtyZXR1cm4gdGhpcy5fcGx1cyh0KSx0aGlzfWxlc3NUaGFuKHQpe2NvbnN0IGU9dGhpcy5idWZmZXJbMV08PDAsaT10LmJ1ZmZlclsxXTw8MDtyZXR1cm4gZTxpfHxlPT09aSYmdGhpcy5idWZmZXJbMF08dC5idWZmZXJbMF19c3RhdGljIGZyb20odCxlPW5ldyBVaW50MzJBcnJheSgyKSl7cmV0dXJuIGFzLmZyb21TdHJpbmcoInN0cmluZyI9PXR5cGVvZiB0P3Q6dC50b1N0cmluZygpLGUpfXN0YXRpYyBmcm9tTnVtYmVyKHQsZT1uZXcgVWludDMyQXJyYXkoMikpe3JldHVybiBhcy5mcm9tU3RyaW5nKHQudG9TdHJpbmcoKSxlKX1zdGF0aWMgZnJvbVN0cmluZyh0LGU9bmV3IFVpbnQzMkFycmF5KDIpKXtjb25zdCBpPXQuc3RhcnRzV2l0aCgiLSIpLG49dC5sZW5ndGgscj1uZXcgYXMoZSk7Zm9yKGxldCBzPWk/MTowO3M8bjspe2NvbnN0IGU9ODxuLXM/ODpuLXMsaT1uZXcgYXMobmV3IFVpbnQzMkFycmF5KFtOdW1iZXIucGFyc2VJbnQodC5zbGljZShzLHMrZSksMTApLDBdKSksbz1uZXcgYXMobmV3IFVpbnQzMkFycmF5KFtyc1tlXSwwXSkpO3IudGltZXMobyksci5wbHVzKGkpLHMrPWV9cmV0dXJuIGk/ci5uZWdhdGUoKTpyfXN0YXRpYyBjb252ZXJ0QXJyYXkodCl7Y29uc3QgZT1uZXcgVWludDMyQXJyYXkoMip0Lmxlbmd0aCk7Zm9yKGxldCBpPS0xLG49dC5sZW5ndGg7KytpPG47KWFzLmZyb20odFtpXSxuZXcgVWludDMyQXJyYXkoZS5idWZmZXIsZS5ieXRlT2Zmc2V0KzIqaSo0LDIpKTtyZXR1cm4gZX1zdGF0aWMgbXVsdGlwbHkodCxlKXtyZXR1cm4gbmV3IGFzKG5ldyBVaW50MzJBcnJheSh0LmJ1ZmZlcikpLnRpbWVzKGUpfXN0YXRpYyBhZGQodCxlKXtyZXR1cm4gbmV3IGFzKG5ldyBVaW50MzJBcnJheSh0LmJ1ZmZlcikpLnBsdXMoZSl9fWNsYXNzIGxze2NvbnN0cnVjdG9yKHQpe3RoaXMuYnVmZmVyPXR9aGlnaCgpe3JldHVybiBuZXcgYXMobmV3IFVpbnQzMkFycmF5KHRoaXMuYnVmZmVyLmJ1ZmZlcix0aGlzLmJ1ZmZlci5ieXRlT2Zmc2V0KzgsMikpfWxvdygpe3JldHVybiBuZXcgYXMobmV3IFVpbnQzMkFycmF5KHRoaXMuYnVmZmVyLmJ1ZmZlcix0aGlzLmJ1ZmZlci5ieXRlT2Zmc2V0LDIpKX1uZWdhdGUoKXtyZXR1cm4gdGhpcy5idWZmZXJbMF09MSt+dGhpcy5idWZmZXJbMF0sdGhpcy5idWZmZXJbMV09fnRoaXMuYnVmZmVyWzFdLHRoaXMuYnVmZmVyWzJdPX50aGlzLmJ1ZmZlclsyXSx0aGlzLmJ1ZmZlclszXT1+dGhpcy5idWZmZXJbM10sMD09dGhpcy5idWZmZXJbMF0mJisrdGhpcy5idWZmZXJbMV0sMD09dGhpcy5idWZmZXJbMV0mJisrdGhpcy5idWZmZXJbMl0sMD09dGhpcy5idWZmZXJbMl0mJisrdGhpcy5idWZmZXJbM10sdGhpc310aW1lcyh0KXtjb25zdCBlPW5ldyBvcyhuZXcgVWludDMyQXJyYXkoW3RoaXMuYnVmZmVyWzNdLDBdKSksaT1uZXcgb3MobmV3IFVpbnQzMkFycmF5KFt0aGlzLmJ1ZmZlclsyXSwwXSkpLG49bmV3IG9zKG5ldyBVaW50MzJBcnJheShbdGhpcy5idWZmZXJbMV0sMF0pKSxyPW5ldyBvcyhuZXcgVWludDMyQXJyYXkoW3RoaXMuYnVmZmVyWzBdLDBdKSkscz1uZXcgb3MobmV3IFVpbnQzMkFycmF5KFt0LmJ1ZmZlclszXSwwXSkpLG89bmV3IG9zKG5ldyBVaW50MzJBcnJheShbdC5idWZmZXJbMl0sMF0pKSxhPW5ldyBvcyhuZXcgVWludDMyQXJyYXkoW3QuYnVmZmVyWzFdLDBdKSksbD1uZXcgb3MobmV3IFVpbnQzMkFycmF5KFt0LmJ1ZmZlclswXSwwXSkpO2xldCBjPW9zLm11bHRpcGx5KHIsbCk7dGhpcy5idWZmZXJbMF09Yy5sb3coKTtjb25zdCBoPW5ldyBvcyhuZXcgVWludDMyQXJyYXkoW2MuaGlnaCgpLDBdKSk7Yz1vcy5tdWx0aXBseShuLGwpLGgucGx1cyhjKSxjPW9zLm11bHRpcGx5KHIsYSksaC5wbHVzKGMpLHRoaXMuYnVmZmVyWzFdPWgubG93KCksdGhpcy5idWZmZXJbM109aC5sZXNzVGhhbihjKT8xOjAsdGhpcy5idWZmZXJbMl09aC5oaWdoKCk7cmV0dXJuIG5ldyBvcyhuZXcgVWludDMyQXJyYXkodGhpcy5idWZmZXIuYnVmZmVyLHRoaXMuYnVmZmVyLmJ5dGVPZmZzZXQrOCwyKSkucGx1cyhvcy5tdWx0aXBseShpLGwpKS5wbHVzKG9zLm11bHRpcGx5KG4sYSkpLnBsdXMob3MubXVsdGlwbHkocixvKSksdGhpcy5idWZmZXJbM10rPW9zLm11bHRpcGx5KGUsbCkucGx1cyhvcy5tdWx0aXBseShpLGEpKS5wbHVzKG9zLm11bHRpcGx5KG4sbykpLnBsdXMob3MubXVsdGlwbHkocixzKSkubG93KCksdGhpc31wbHVzKHQpe2NvbnN0IGU9bmV3IFVpbnQzMkFycmF5KDQpO3JldHVybiBlWzNdPXRoaXMuYnVmZmVyWzNdK3QuYnVmZmVyWzNdPj4+MCxlWzJdPXRoaXMuYnVmZmVyWzJdK3QuYnVmZmVyWzJdPj4+MCxlWzFdPXRoaXMuYnVmZmVyWzFdK3QuYnVmZmVyWzFdPj4+MCxlWzBdPXRoaXMuYnVmZmVyWzBdK3QuYnVmZmVyWzBdPj4+MCxlWzBdPHRoaXMuYnVmZmVyWzBdPj4+MCYmKytlWzFdLGVbMV08dGhpcy5idWZmZXJbMV0+Pj4wJiYrK2VbMl0sZVsyXTx0aGlzLmJ1ZmZlclsyXT4+PjAmJisrZVszXSx0aGlzLmJ1ZmZlclszXT1lWzNdLHRoaXMuYnVmZmVyWzJdPWVbMl0sdGhpcy5idWZmZXJbMV09ZVsxXSx0aGlzLmJ1ZmZlclswXT1lWzBdLHRoaXN9aGV4KCl7cmV0dXJuYCR7bnModGhpcy5idWZmZXJbM10pfSAke25zKHRoaXMuYnVmZmVyWzJdKX0gJHtucyh0aGlzLmJ1ZmZlclsxXSl9ICR7bnModGhpcy5idWZmZXJbMF0pfWB9c3RhdGljIG11bHRpcGx5KHQsZSl7cmV0dXJuIG5ldyBscyhuZXcgVWludDMyQXJyYXkodC5idWZmZXIpKS50aW1lcyhlKX1zdGF0aWMgYWRkKHQsZSl7cmV0dXJuIG5ldyBscyhuZXcgVWludDMyQXJyYXkodC5idWZmZXIpKS5wbHVzKGUpfXN0YXRpYyBmcm9tKHQsZT1uZXcgVWludDMyQXJyYXkoNCkpe3JldHVybiBscy5mcm9tU3RyaW5nKCJzdHJpbmciPT10eXBlb2YgdD90OnQudG9TdHJpbmcoKSxlKX1zdGF0aWMgZnJvbU51bWJlcih0LGU9bmV3IFVpbnQzMkFycmF5KDQpKXtyZXR1cm4gbHMuZnJvbVN0cmluZyh0LnRvU3RyaW5nKCksZSl9c3RhdGljIGZyb21TdHJpbmcodCxlPW5ldyBVaW50MzJBcnJheSg0KSl7Y29uc3QgaT10LnN0YXJ0c1dpdGgoIi0iKSxuPXQubGVuZ3RoLHI9bmV3IGxzKGUpO2ZvcihsZXQgcz1pPzE6MDtzPG47KXtjb25zdCBlPTg8bi1zPzg6bi1zLGk9bmV3IGxzKG5ldyBVaW50MzJBcnJheShbTnVtYmVyLnBhcnNlSW50KHQuc2xpY2UocyxzK2UpLDEwKSwwLDAsMF0pKSxvPW5ldyBscyhuZXcgVWludDMyQXJyYXkoW3JzW2VdLDAsMCwwXSkpO3IudGltZXMobyksci5wbHVzKGkpLHMrPWV9cmV0dXJuIGk/ci5uZWdhdGUoKTpyfXN0YXRpYyBjb252ZXJ0QXJyYXkodCl7Y29uc3QgZT1uZXcgVWludDMyQXJyYXkoNCp0Lmxlbmd0aCk7Zm9yKGxldCBpPS0xLG49dC5sZW5ndGg7KytpPG47KWxzLmZyb20odFtpXSxuZXcgVWludDMyQXJyYXkoZS5idWZmZXIsZS5ieXRlT2Zmc2V0KzE2KmksNCkpO3JldHVybiBlfX1jbGFzcyBjcyBleHRlbmRzIFVle2NvbnN0cnVjdG9yKHQsZSxpLG4pe3N1cGVyKCksdGhpcy5ub2Rlc0luZGV4PS0xLHRoaXMuYnVmZmVyc0luZGV4PS0xLHRoaXMuYnl0ZXM9dCx0aGlzLm5vZGVzPWUsdGhpcy5idWZmZXJzPWksdGhpcy5kaWN0aW9uYXJpZXM9bn12aXNpdCh0KXtyZXR1cm4gc3VwZXIudmlzaXQodCBpbnN0YW5jZW9mIFZyP3QudHlwZTp0KX12aXNpdE51bGwodCx7bGVuZ3RoOmV9PXRoaXMubmV4dEZpZWxkTm9kZSgpKXtyZXR1cm4gY24oe3R5cGU6dCxsZW5ndGg6ZX0pfXZpc2l0Qm9vbCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGRhdGE6dGhpcy5yZWFkRGF0YSh0KX0pfXZpc2l0SW50KHQse2xlbmd0aDplLG51bGxDb3VudDppfT10aGlzLm5leHRGaWVsZE5vZGUoKSl7cmV0dXJuIGNuKHt0eXBlOnQsbGVuZ3RoOmUsbnVsbENvdW50OmksbnVsbEJpdG1hcDp0aGlzLnJlYWROdWxsQml0bWFwKHQsaSksZGF0YTp0aGlzLnJlYWREYXRhKHQpfSl9dmlzaXRGbG9hdCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGRhdGE6dGhpcy5yZWFkRGF0YSh0KX0pfXZpc2l0VXRmOCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLHZhbHVlT2Zmc2V0czp0aGlzLnJlYWRPZmZzZXRzKHQpLGRhdGE6dGhpcy5yZWFkRGF0YSh0KX0pfXZpc2l0QmluYXJ5KHQse2xlbmd0aDplLG51bGxDb3VudDppfT10aGlzLm5leHRGaWVsZE5vZGUoKSl7cmV0dXJuIGNuKHt0eXBlOnQsbGVuZ3RoOmUsbnVsbENvdW50OmksbnVsbEJpdG1hcDp0aGlzLnJlYWROdWxsQml0bWFwKHQsaSksdmFsdWVPZmZzZXRzOnRoaXMucmVhZE9mZnNldHModCksZGF0YTp0aGlzLnJlYWREYXRhKHQpfSl9dmlzaXRGaXhlZFNpemVCaW5hcnkodCx7bGVuZ3RoOmUsbnVsbENvdW50Oml9PXRoaXMubmV4dEZpZWxkTm9kZSgpKXtyZXR1cm4gY24oe3R5cGU6dCxsZW5ndGg6ZSxudWxsQ291bnQ6aSxudWxsQml0bWFwOnRoaXMucmVhZE51bGxCaXRtYXAodCxpKSxkYXRhOnRoaXMucmVhZERhdGEodCl9KX12aXNpdERhdGUodCx7bGVuZ3RoOmUsbnVsbENvdW50Oml9PXRoaXMubmV4dEZpZWxkTm9kZSgpKXtyZXR1cm4gY24oe3R5cGU6dCxsZW5ndGg6ZSxudWxsQ291bnQ6aSxudWxsQml0bWFwOnRoaXMucmVhZE51bGxCaXRtYXAodCxpKSxkYXRhOnRoaXMucmVhZERhdGEodCl9KX12aXNpdFRpbWVzdGFtcCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGRhdGE6dGhpcy5yZWFkRGF0YSh0KX0pfXZpc2l0VGltZSh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGRhdGE6dGhpcy5yZWFkRGF0YSh0KX0pfXZpc2l0RGVjaW1hbCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGRhdGE6dGhpcy5yZWFkRGF0YSh0KX0pfXZpc2l0TGlzdCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLHZhbHVlT2Zmc2V0czp0aGlzLnJlYWRPZmZzZXRzKHQpLGNoaWxkOnRoaXMudmlzaXQodC5jaGlsZHJlblswXSl9KX12aXNpdFN0cnVjdCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGNoaWxkcmVuOnRoaXMudmlzaXRNYW55KHQuY2hpbGRyZW4pfSl9dmlzaXRVbmlvbih0KXtyZXR1cm4gdC5tb2RlPT09bHQuU3BhcnNlP3RoaXMudmlzaXRTcGFyc2VVbmlvbih0KTp0aGlzLnZpc2l0RGVuc2VVbmlvbih0KX12aXNpdERlbnNlVW5pb24odCx7bGVuZ3RoOmUsbnVsbENvdW50Oml9PXRoaXMubmV4dEZpZWxkTm9kZSgpKXtyZXR1cm4gY24oe3R5cGU6dCxsZW5ndGg6ZSxudWxsQ291bnQ6aSxudWxsQml0bWFwOnRoaXMucmVhZE51bGxCaXRtYXAodCxpKSx0eXBlSWRzOnRoaXMucmVhZFR5cGVJZHModCksdmFsdWVPZmZzZXRzOnRoaXMucmVhZE9mZnNldHModCksY2hpbGRyZW46dGhpcy52aXNpdE1hbnkodC5jaGlsZHJlbil9KX12aXNpdFNwYXJzZVVuaW9uKHQse2xlbmd0aDplLG51bGxDb3VudDppfT10aGlzLm5leHRGaWVsZE5vZGUoKSl7cmV0dXJuIGNuKHt0eXBlOnQsbGVuZ3RoOmUsbnVsbENvdW50OmksbnVsbEJpdG1hcDp0aGlzLnJlYWROdWxsQml0bWFwKHQsaSksdHlwZUlkczp0aGlzLnJlYWRUeXBlSWRzKHQpLGNoaWxkcmVuOnRoaXMudmlzaXRNYW55KHQuY2hpbGRyZW4pfSl9dmlzaXREaWN0aW9uYXJ5KHQse2xlbmd0aDplLG51bGxDb3VudDppfT10aGlzLm5leHRGaWVsZE5vZGUoKSl7cmV0dXJuIGNuKHt0eXBlOnQsbGVuZ3RoOmUsbnVsbENvdW50OmksbnVsbEJpdG1hcDp0aGlzLnJlYWROdWxsQml0bWFwKHQsaSksZGF0YTp0aGlzLnJlYWREYXRhKHQuaW5kaWNlcyksZGljdGlvbmFyeTp0aGlzLnJlYWREaWN0aW9uYXJ5KHQpfSl9dmlzaXRJbnRlcnZhbCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGRhdGE6dGhpcy5yZWFkRGF0YSh0KX0pfXZpc2l0Rml4ZWRTaXplTGlzdCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLGNoaWxkOnRoaXMudmlzaXQodC5jaGlsZHJlblswXSl9KX12aXNpdE1hcCh0LHtsZW5ndGg6ZSxudWxsQ291bnQ6aX09dGhpcy5uZXh0RmllbGROb2RlKCkpe3JldHVybiBjbih7dHlwZTp0LGxlbmd0aDplLG51bGxDb3VudDppLG51bGxCaXRtYXA6dGhpcy5yZWFkTnVsbEJpdG1hcCh0LGkpLHZhbHVlT2Zmc2V0czp0aGlzLnJlYWRPZmZzZXRzKHQpLGNoaWxkOnRoaXMudmlzaXQodC5jaGlsZHJlblswXSl9KX1uZXh0RmllbGROb2RlKCl7cmV0dXJuIHRoaXMubm9kZXNbKyt0aGlzLm5vZGVzSW5kZXhdfW5leHRCdWZmZXJSYW5nZSgpe3JldHVybiB0aGlzLmJ1ZmZlcnNbKyt0aGlzLmJ1ZmZlcnNJbmRleF19cmVhZE51bGxCaXRtYXAodCxlLGk9dGhpcy5uZXh0QnVmZmVyUmFuZ2UoKSl7cmV0dXJuIGU+MCYmdGhpcy5yZWFkRGF0YSh0LGkpfHxuZXcgVWludDhBcnJheSgwKX1yZWFkT2Zmc2V0cyh0LGUpe3JldHVybiB0aGlzLnJlYWREYXRhKHQsZSl9cmVhZFR5cGVJZHModCxlKXtyZXR1cm4gdGhpcy5yZWFkRGF0YSh0LGUpfXJlYWREYXRhKHQse2xlbmd0aDplLG9mZnNldDppfT10aGlzLm5leHRCdWZmZXJSYW5nZSgpKXtyZXR1cm4gdGhpcy5ieXRlcy5zdWJhcnJheShpLGkrZSl9cmVhZERpY3Rpb25hcnkodCl7cmV0dXJuIHRoaXMuZGljdGlvbmFyaWVzLmdldCh0LmlkKX19Y2xhc3MgaHMgZXh0ZW5kcyBjc3tjb25zdHJ1Y3Rvcih0LGUsaSxuKXtzdXBlcihuZXcgVWludDhBcnJheSgwKSxlLGksbiksdGhpcy5zb3VyY2VzPXR9cmVhZE51bGxCaXRtYXAodCxlLHtvZmZzZXQ6aX09dGhpcy5uZXh0QnVmZmVyUmFuZ2UoKSl7cmV0dXJuIGU8PTA/bmV3IFVpbnQ4QXJyYXkoMCk6bm4odGhpcy5zb3VyY2VzW2ldKX1yZWFkT2Zmc2V0cyh0LHtvZmZzZXQ6ZX09dGhpcy5uZXh0QnVmZmVyUmFuZ2UoKSl7cmV0dXJuIEooVWludDhBcnJheSxKKEludDMyQXJyYXksdGhpcy5zb3VyY2VzW2VdKSl9cmVhZFR5cGVJZHModCx7b2Zmc2V0OmV9PXRoaXMubmV4dEJ1ZmZlclJhbmdlKCkpe3JldHVybiBKKFVpbnQ4QXJyYXksSih0LkFycmF5VHlwZSx0aGlzLnNvdXJjZXNbZV0pKX1yZWFkRGF0YSh0LHtvZmZzZXQ6ZX09dGhpcy5uZXh0QnVmZmVyUmFuZ2UoKSl7Y29uc3R7c291cmNlczppfT10aGlzO3JldHVybiBlZS5pc1RpbWVzdGFtcCh0KXx8KGVlLmlzSW50KHQpfHxlZS5pc1RpbWUodCkpJiY2ND09PXQuYml0V2lkdGh8fGVlLmlzRGF0ZSh0KSYmdC51bml0PT09ZHQuTUlMTElTRUNPTkQ/SihVaW50OEFycmF5LGFzLmNvbnZlcnRBcnJheShpW2VdKSk6ZWUuaXNEZWNpbWFsKHQpP0ooVWludDhBcnJheSxscy5jb252ZXJ0QXJyYXkoaVtlXSkpOmVlLmlzQmluYXJ5KHQpfHxlZS5pc0ZpeGVkU2l6ZUJpbmFyeSh0KT9mdW5jdGlvbih0KXtjb25zdCBlPXQuam9pbigiIiksaT1uZXcgVWludDhBcnJheShlLmxlbmd0aC8yKTtmb3IobGV0IG49MDtuPGUubGVuZ3RoO24rPTIpaVtuPj4xXT1OdW1iZXIucGFyc2VJbnQoZS5zbGljZShuLG4rMiksMTYpO3JldHVybiBpfShpW2VdKTplZS5pc0Jvb2wodCk/bm4oaVtlXSk6ZWUuaXNVdGY4KHQpP0EoaVtlXS5qb2luKCIiKSk6SihVaW50OEFycmF5LEoodC5BcnJheVR5cGUsaVtlXS5tYXAoKHQ9Pit0KSkpKX19Y2xhc3MgdXMgZXh0ZW5kcyBIbntjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLl92YWx1ZXM9bmV3IFBuKG5ldyBVaW50OEFycmF5KDApKX1nZXQgYnl0ZUxlbmd0aCgpe2xldCB0PXRoaXMuX3BlbmRpbmdMZW5ndGgrNCp0aGlzLmxlbmd0aDtyZXR1cm4gdGhpcy5fb2Zmc2V0cyYmKHQrPXRoaXMuX29mZnNldHMuYnl0ZUxlbmd0aCksdGhpcy5fdmFsdWVzJiYodCs9dGhpcy5fdmFsdWVzLmJ5dGVMZW5ndGgpLHRoaXMuX251bGxzJiYodCs9dGhpcy5fbnVsbHMuYnl0ZUxlbmd0aCksdH1zZXRWYWx1ZSh0LGUpe3JldHVybiBzdXBlci5zZXRWYWx1ZSh0LFooZSkpfV9mbHVzaFBlbmRpbmcodCxlKXtjb25zdCBpPXRoaXMuX29mZnNldHMsbj10aGlzLl92YWx1ZXMucmVzZXJ2ZShlKS5idWZmZXI7bGV0IHI9MDtmb3IoY29uc3RbcyxvXW9mIHQpaWYodm9pZCAwPT09bylpLnNldChzLDApO2Vsc2V7Y29uc3QgdD1vLmxlbmd0aDtuLnNldChvLHIpLGkuc2V0KHMsdCkscis9dH19fWNsYXNzIGRzIGV4dGVuZHMgWW57Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fdmFsdWVzPW5ldyBrbn1zZXRWYWx1ZSh0LGUpe3RoaXMuX3ZhbHVlcy5zZXQodCwrZSl9fWNsYXNzIHBzIGV4dGVuZHMgV257fXBzLnByb3RvdHlwZS5fc2V0VmFsdWU9cWU7Y2xhc3MgZnMgZXh0ZW5kcyBwc3t9ZnMucHJvdG90eXBlLl9zZXRWYWx1ZT1KZTtjbGFzcyB5cyBleHRlbmRzIHBze315cy5wcm90b3R5cGUuX3NldFZhbHVlPUdlO2NsYXNzIGJzIGV4dGVuZHMgV257fWJzLnByb3RvdHlwZS5fc2V0VmFsdWU9bGk7Y2xhc3MgZ3MgZXh0ZW5kcyBZbntjb25zdHJ1Y3Rvcih7dHlwZTp0LG51bGxWYWx1ZXM6ZSxkaWN0aW9uYXJ5SGFzaEZ1bmN0aW9uOml9KXtzdXBlcih7dHlwZTpuZXcgTGUodC5kaWN0aW9uYXJ5LHQuaW5kaWNlcyx0LmlkLHQuaXNPcmRlcmVkKX0pLHRoaXMuX251bGxzPW51bGwsdGhpcy5fZGljdGlvbmFyeU9mZnNldD0wLHRoaXMuX2tleXNUb0luZGljZXM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLmluZGljZXM9ZW8oe3R5cGU6dGhpcy50eXBlLmluZGljZXMsbnVsbFZhbHVlczplfSksdGhpcy5kaWN0aW9uYXJ5PWVvKHt0eXBlOnRoaXMudHlwZS5kaWN0aW9uYXJ5LG51bGxWYWx1ZXM6bnVsbH0pLCJmdW5jdGlvbiI9PXR5cGVvZiBpJiYodGhpcy52YWx1ZVRvS2V5PWkpfWdldCB2YWx1ZXMoKXtyZXR1cm4gdGhpcy5pbmRpY2VzLnZhbHVlc31nZXQgbnVsbENvdW50KCl7cmV0dXJuIHRoaXMuaW5kaWNlcy5udWxsQ291bnR9Z2V0IG51bGxCaXRtYXAoKXtyZXR1cm4gdGhpcy5pbmRpY2VzLm51bGxCaXRtYXB9Z2V0IGJ5dGVMZW5ndGgoKXtyZXR1cm4gdGhpcy5pbmRpY2VzLmJ5dGVMZW5ndGgrdGhpcy5kaWN0aW9uYXJ5LmJ5dGVMZW5ndGh9Z2V0IHJlc2VydmVkTGVuZ3RoKCl7cmV0dXJuIHRoaXMuaW5kaWNlcy5yZXNlcnZlZExlbmd0aCt0aGlzLmRpY3Rpb25hcnkucmVzZXJ2ZWRMZW5ndGh9Z2V0IHJlc2VydmVkQnl0ZUxlbmd0aCgpe3JldHVybiB0aGlzLmluZGljZXMucmVzZXJ2ZWRCeXRlTGVuZ3RoK3RoaXMuZGljdGlvbmFyeS5yZXNlcnZlZEJ5dGVMZW5ndGh9aXNWYWxpZCh0KXtyZXR1cm4gdGhpcy5pbmRpY2VzLmlzVmFsaWQodCl9c2V0VmFsaWQodCxlKXtjb25zdCBpPXRoaXMuaW5kaWNlcztyZXR1cm4gZT1pLnNldFZhbGlkKHQsZSksdGhpcy5sZW5ndGg9aS5sZW5ndGgsZX1zZXRWYWx1ZSh0LGUpe2NvbnN0IGk9dGhpcy5fa2V5c1RvSW5kaWNlcyxuPXRoaXMudmFsdWVUb0tleShlKTtsZXQgcj1pW25dO3JldHVybiB2b2lkIDA9PT1yJiYoaVtuXT1yPXRoaXMuX2RpY3Rpb25hcnlPZmZzZXQrdGhpcy5kaWN0aW9uYXJ5LmFwcGVuZChlKS5sZW5ndGgtMSksdGhpcy5pbmRpY2VzLnNldFZhbHVlKHQscil9Zmx1c2goKXtjb25zdCB0PXRoaXMudHlwZSxlPXRoaXMuX2RpY3Rpb25hcnksaT10aGlzLmRpY3Rpb25hcnkudG9WZWN0b3IoKSxuPXRoaXMuaW5kaWNlcy5mbHVzaCgpLmNsb25lKHQpO3JldHVybiBuLmRpY3Rpb25hcnk9ZT9lLmNvbmNhdChpKTppLHRoaXMuZmluaXNoZWR8fCh0aGlzLl9kaWN0aW9uYXJ5T2Zmc2V0Kz1pLmxlbmd0aCksdGhpcy5fZGljdGlvbmFyeT1uLmRpY3Rpb25hcnksdGhpcy5jbGVhcigpLG59ZmluaXNoKCl7cmV0dXJuIHRoaXMuaW5kaWNlcy5maW5pc2goKSx0aGlzLmRpY3Rpb25hcnkuZmluaXNoKCksdGhpcy5fZGljdGlvbmFyeU9mZnNldD0wLHRoaXMuX2tleXNUb0luZGljZXM9T2JqZWN0LmNyZWF0ZShudWxsKSxzdXBlci5maW5pc2goKX1jbGVhcigpe3JldHVybiB0aGlzLmluZGljZXMuY2xlYXIoKSx0aGlzLmRpY3Rpb25hcnkuY2xlYXIoKSxzdXBlci5jbGVhcigpfXZhbHVlVG9LZXkodCl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0P3Q6YCR7dH1gfX1jbGFzcyBtcyBleHRlbmRzIFdue31tcy5wcm90b3R5cGUuX3NldFZhbHVlPVplO2NsYXNzIF9zIGV4dGVuZHMgWW57c2V0VmFsdWUodCxlKXtjb25zdFtpXT10aGlzLmNoaWxkcmVuLG49dCp0aGlzLnN0cmlkZTtmb3IobGV0IHI9LTEscz1lLmxlbmd0aDsrK3I8czspaS5zZXQobityLGVbcl0pfWFkZENoaWxkKHQsZT0iMCIpe2lmKHRoaXMubnVtQ2hpbGRyZW4+MCl0aHJvdyBuZXcgRXJyb3IoIkZpeGVkU2l6ZUxpc3RCdWlsZGVyIGNhbiBvbmx5IGhhdmUgb25lIGNoaWxkLiIpO2NvbnN0IGk9dGhpcy5jaGlsZHJlbi5wdXNoKHQpO3JldHVybiB0aGlzLnR5cGU9bmV3IERlKHRoaXMudHlwZS5saXN0U2l6ZSxuZXcgVnIoZSx0LnR5cGUsITApKSxpfX1jbGFzcyB2cyBleHRlbmRzIFdue3NldFZhbHVlKHQsZSl7dGhpcy5fdmFsdWVzLnNldCh0LGUpfX1jbGFzcyB3cyBleHRlbmRzIHZze3NldFZhbHVlKHQsZSl7c3VwZXIuc2V0VmFsdWUodCxQZShlKSl9fWNsYXNzIElzIGV4dGVuZHMgdnN7fWNsYXNzIFNzIGV4dGVuZHMgdnN7fWNsYXNzIEJzIGV4dGVuZHMgV257fUJzLnByb3RvdHlwZS5fc2V0VmFsdWU9dWk7Y2xhc3MgQXMgZXh0ZW5kcyBCc3t9QXMucHJvdG90eXBlLl9zZXRWYWx1ZT1kaTtjbGFzcyBUcyBleHRlbmRzIEJze31Ucy5wcm90b3R5cGUuX3NldFZhbHVlPXBpO2NsYXNzIE9zIGV4dGVuZHMgV257c2V0VmFsdWUodCxlKXt0aGlzLl92YWx1ZXMuc2V0KHQsZSl9fWNsYXNzIERzIGV4dGVuZHMgT3N7fWNsYXNzIHhzIGV4dGVuZHMgT3N7fWNsYXNzIE1zIGV4dGVuZHMgT3N7fWNsYXNzIEZzIGV4dGVuZHMgT3N7fWNsYXNzIExzIGV4dGVuZHMgT3N7fWNsYXNzIE5zIGV4dGVuZHMgT3N7fWNsYXNzIFVzIGV4dGVuZHMgT3N7fWNsYXNzIENzIGV4dGVuZHMgT3N7fWNsYXNzIEVzIGV4dGVuZHMgSG57Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fb2Zmc2V0cz1uZXcgJG59YWRkQ2hpbGQodCxlPSIwIil7aWYodGhpcy5udW1DaGlsZHJlbj4wKXRocm93IG5ldyBFcnJvcigiTGlzdEJ1aWxkZXIgY2FuIG9ubHkgaGF2ZSBvbmUgY2hpbGQuIik7cmV0dXJuIHRoaXMuY2hpbGRyZW5bdGhpcy5udW1DaGlsZHJlbl09dCx0aGlzLnR5cGU9bmV3IEJlKG5ldyBWcihlLHQudHlwZSwhMCkpLHRoaXMubnVtQ2hpbGRyZW4tMX1fZmx1c2hQZW5kaW5nKHQpe2NvbnN0IGU9dGhpcy5fb2Zmc2V0cyxbaV09dGhpcy5jaGlsZHJlbjtmb3IoY29uc3RbbixyXW9mIHQpaWYodm9pZCAwPT09cillLnNldChuLDApO2Vsc2V7Y29uc3QgdD1yLmxlbmd0aCxzPWUuc2V0KG4sdCkuYnVmZmVyW25dO2ZvcihsZXQgZT0tMTsrK2U8dDspaS5zZXQocytlLHJbZV0pfX19Y2xhc3MgVnMgZXh0ZW5kcyBIbntzZXQodCxlKXtyZXR1cm4gc3VwZXIuc2V0KHQsZSl9c2V0VmFsdWUodCxlKXtjb25zdCBpPWUgaW5zdGFuY2VvZiBNYXA/ZTpuZXcgTWFwKE9iamVjdC5lbnRyaWVzKGUpKSxuPXRoaXMuX3BlbmRpbmd8fCh0aGlzLl9wZW5kaW5nPW5ldyBNYXApLHI9bi5nZXQodCk7ciYmKHRoaXMuX3BlbmRpbmdMZW5ndGgtPXIuc2l6ZSksdGhpcy5fcGVuZGluZ0xlbmd0aCs9aS5zaXplLG4uc2V0KHQsaSl9YWRkQ2hpbGQodCxlPWAke3RoaXMubnVtQ2hpbGRyZW59YCl7aWYodGhpcy5udW1DaGlsZHJlbj4wKXRocm93IG5ldyBFcnJvcigiTGlzdEJ1aWxkZXIgY2FuIG9ubHkgaGF2ZSBvbmUgY2hpbGQuIik7cmV0dXJuIHRoaXMuY2hpbGRyZW5bdGhpcy5udW1DaGlsZHJlbl09dCx0aGlzLnR5cGU9bmV3IHhlKG5ldyBWcihlLHQudHlwZSwhMCksdGhpcy50eXBlLmtleXNTb3J0ZWQpLHRoaXMubnVtQ2hpbGRyZW4tMX1fZmx1c2hQZW5kaW5nKHQpe2NvbnN0IGU9dGhpcy5fb2Zmc2V0cyxbaV09dGhpcy5jaGlsZHJlbjtmb3IoY29uc3RbbixyXW9mIHQpaWYodm9pZCAwPT09cillLnNldChuLDApO2Vsc2V7bGV0e1tuXTp0LFtuKzFdOnN9PWUuc2V0KG4sci5zaXplKS5idWZmZXI7Zm9yKGNvbnN0IGUgb2Ygci5lbnRyaWVzKCkpaWYoaS5zZXQodCxlKSwrK3Q+PXMpYnJlYWt9fX1jbGFzcyBScyBleHRlbmRzIFlue3NldFZhbHVlKHQsZSl7fXNldFZhbGlkKHQsZSl7cmV0dXJuIHRoaXMubGVuZ3RoPU1hdGgubWF4KHQrMSx0aGlzLmxlbmd0aCksZX19Y2xhc3MgenMgZXh0ZW5kcyBZbntzZXRWYWx1ZSh0LGUpe2NvbnN0IGk9dGhpcy5jaGlsZHJlbjtzd2l0Y2goQXJyYXkuaXNBcnJheShlKXx8ZS5jb25zdHJ1Y3Rvcil7Y2FzZSEwOnJldHVybiB0aGlzLnR5cGUuY2hpbGRyZW4uZm9yRWFjaCgoKG4scik9Pmlbcl0uc2V0KHQsZVtyXSkpKTtjYXNlIE1hcDpyZXR1cm4gdGhpcy50eXBlLmNoaWxkcmVuLmZvckVhY2goKChuLHIpPT5pW3JdLnNldCh0LGUuZ2V0KG4ubmFtZSkpKSk7ZGVmYXVsdDpyZXR1cm4gdGhpcy50eXBlLmNoaWxkcmVuLmZvckVhY2goKChuLHIpPT5pW3JdLnNldCh0LGVbbi5uYW1lXSkpKX19YWRkQ2hpbGQodCxlPWAke3RoaXMubnVtQ2hpbGRyZW59YCl7Y29uc3QgaT10aGlzLmNoaWxkcmVuLnB1c2godCk7cmV0dXJuIHRoaXMudHlwZT1uZXcgQWUoWy4uLnRoaXMudHlwZS5jaGlsZHJlbixuZXcgVnIoZSx0LnR5cGUsITApXSksaX19Y2xhc3MgUHMgZXh0ZW5kcyBXbnt9UHMucHJvdG90eXBlLl9zZXRWYWx1ZT1paTtjbGFzcyBqcyBleHRlbmRzIFBze31qcy5wcm90b3R5cGUuX3NldFZhbHVlPVFlO2NsYXNzIGtzIGV4dGVuZHMgUHN7fWtzLnByb3RvdHlwZS5fc2V0VmFsdWU9WGU7Y2xhc3MgJHMgZXh0ZW5kcyBQc3t9JHMucHJvdG90eXBlLl9zZXRWYWx1ZT10aTtjbGFzcyBZcyBleHRlbmRzIFBze31Zcy5wcm90b3R5cGUuX3NldFZhbHVlPWVpO2NsYXNzIFdzIGV4dGVuZHMgV257fVdzLnByb3RvdHlwZS5fc2V0VmFsdWU9YWk7Y2xhc3MgSHMgZXh0ZW5kcyBXc3t9SHMucHJvdG90eXBlLl9zZXRWYWx1ZT1uaTtjbGFzcyBLcyBleHRlbmRzIFdze31Lcy5wcm90b3R5cGUuX3NldFZhbHVlPXJpO2NsYXNzIEpzIGV4dGVuZHMgV3N7fUpzLnByb3RvdHlwZS5fc2V0VmFsdWU9c2k7Y2xhc3MgR3MgZXh0ZW5kcyBXc3t9R3MucHJvdG90eXBlLl9zZXRWYWx1ZT1vaTtjbGFzcyBacyBleHRlbmRzIFlue2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuX3R5cGVJZHM9bmV3IGpuKG5ldyBJbnQ4QXJyYXkoMCksMSksImZ1bmN0aW9uIj09dHlwZW9mIHQudmFsdWVUb0NoaWxkVHlwZUlkJiYodGhpcy5fdmFsdWVUb0NoaWxkVHlwZUlkPXQudmFsdWVUb0NoaWxkVHlwZUlkKX1nZXQgdHlwZUlkVG9DaGlsZEluZGV4KCl7cmV0dXJuIHRoaXMudHlwZS50eXBlSWRUb0NoaWxkSW5kZXh9YXBwZW5kKHQsZSl7cmV0dXJuIHRoaXMuc2V0KHRoaXMubGVuZ3RoLHQsZSl9c2V0KHQsZSxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9dGhpcy5fdmFsdWVUb0NoaWxkVHlwZUlkKHRoaXMsZSx0KSksdGhpcy5zZXRWYWxpZCh0LHRoaXMuaXNWYWxpZChlKSkmJnRoaXMuc2V0VmFsdWUodCxlLGkpLHRoaXN9c2V0VmFsdWUodCxlLGkpe3RoaXMuX3R5cGVJZHMuc2V0KHQsaSk7Y29uc3Qgbj10aGlzLnR5cGUudHlwZUlkVG9DaGlsZEluZGV4W2ldLHI9dGhpcy5jaGlsZHJlbltuXTtudWxsPT1yfHxyLnNldCh0LGUpfWFkZENoaWxkKHQsZT1gJHt0aGlzLmNoaWxkcmVuLmxlbmd0aH1gKXtjb25zdCBpPXRoaXMuY2hpbGRyZW4ucHVzaCh0KSx7dHlwZTp7Y2hpbGRyZW46bixtb2RlOnIsdHlwZUlkczpzfX09dGhpcyxvPVsuLi5uLG5ldyBWcihlLHQudHlwZSldO3JldHVybiB0aGlzLnR5cGU9bmV3IFRlKHIsWy4uLnMsaV0sbyksaX1fdmFsdWVUb0NoaWxkVHlwZUlkKHQsZSxpKXt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBtYXAgVW5pb25CdWlsZGVyIHZhbHVlIHRvIGNoaWxkIHR5cGVJZC4gUGFzcyB0aGUgYGNoaWxkVHlwZUlkYCBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50IHRvIHVuaW9uQnVpbGRlci5hcHBlbmQoKSwgb3Igc3VwcGx5IGEgYHZhbHVlVG9DaGlsZFR5cGVJZGAgZnVuY3Rpb24gYXMgcGFydCBvZiB0aGUgVW5pb25CdWlsZGVyIGNvbnN0cnVjdG9yIG9wdGlvbnMuIil9fWNsYXNzIHFzIGV4dGVuZHMgWnN7fWNsYXNzIFFzIGV4dGVuZHMgWnN7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fb2Zmc2V0cz1uZXcgam4obmV3IEludDMyQXJyYXkoMCkpfXNldFZhbHVlKHQsZSxpKXtjb25zdCBuPXRoaXMuX3R5cGVJZHMuc2V0KHQsaSkuYnVmZmVyW3RdLHI9dGhpcy5nZXRDaGlsZEF0KHRoaXMudHlwZS50eXBlSWRUb0NoaWxkSW5kZXhbbl0pLHM9dGhpcy5fb2Zmc2V0cy5zZXQodCxyLmxlbmd0aCkuYnVmZmVyW3RdO251bGw9PXJ8fHIuc2V0KHMsZSl9fWNsYXNzIFhzIGV4dGVuZHMgSG57Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fdmFsdWVzPW5ldyBQbihuZXcgVWludDhBcnJheSgwKSl9Z2V0IGJ5dGVMZW5ndGgoKXtsZXQgdD10aGlzLl9wZW5kaW5nTGVuZ3RoKzQqdGhpcy5sZW5ndGg7cmV0dXJuIHRoaXMuX29mZnNldHMmJih0Kz10aGlzLl9vZmZzZXRzLmJ5dGVMZW5ndGgpLHRoaXMuX3ZhbHVlcyYmKHQrPXRoaXMuX3ZhbHVlcy5ieXRlTGVuZ3RoKSx0aGlzLl9udWxscyYmKHQrPXRoaXMuX251bGxzLmJ5dGVMZW5ndGgpLHR9c2V0VmFsdWUodCxlKXtyZXR1cm4gc3VwZXIuc2V0VmFsdWUodCxBKGUpKX1fZmx1c2hQZW5kaW5nKHQsZSl7fX1Ycy5wcm90b3R5cGUuX2ZsdXNoUGVuZGluZz11cy5wcm90b3R5cGUuX2ZsdXNoUGVuZGluZztjb25zdCB0bz1uZXcgY2xhc3MgZXh0ZW5kcyBVZXt2aXNpdE51bGwoKXtyZXR1cm4gUnN9dmlzaXRCb29sKCl7cmV0dXJuIGRzfXZpc2l0SW50KCl7cmV0dXJuIE9zfXZpc2l0SW50OCgpe3JldHVybiBEc312aXNpdEludDE2KCl7cmV0dXJuIHhzfXZpc2l0SW50MzIoKXtyZXR1cm4gTXN9dmlzaXRJbnQ2NCgpe3JldHVybiBGc312aXNpdFVpbnQ4KCl7cmV0dXJuIExzfXZpc2l0VWludDE2KCl7cmV0dXJuIE5zfXZpc2l0VWludDMyKCl7cmV0dXJuIFVzfXZpc2l0VWludDY0KCl7cmV0dXJuIENzfXZpc2l0RmxvYXQoKXtyZXR1cm4gdnN9dmlzaXRGbG9hdDE2KCl7cmV0dXJuIHdzfXZpc2l0RmxvYXQzMigpe3JldHVybiBJc312aXNpdEZsb2F0NjQoKXtyZXR1cm4gU3N9dmlzaXRVdGY4KCl7cmV0dXJuIFhzfXZpc2l0QmluYXJ5KCl7cmV0dXJuIHVzfXZpc2l0Rml4ZWRTaXplQmluYXJ5KCl7cmV0dXJuIG1zfXZpc2l0RGF0ZSgpe3JldHVybiBwc312aXNpdERhdGVEYXkoKXtyZXR1cm4gZnN9dmlzaXREYXRlTWlsbGlzZWNvbmQoKXtyZXR1cm4geXN9dmlzaXRUaW1lc3RhbXAoKXtyZXR1cm4gUHN9dmlzaXRUaW1lc3RhbXBTZWNvbmQoKXtyZXR1cm4ganN9dmlzaXRUaW1lc3RhbXBNaWxsaXNlY29uZCgpe3JldHVybiBrc312aXNpdFRpbWVzdGFtcE1pY3Jvc2Vjb25kKCl7cmV0dXJuICRzfXZpc2l0VGltZXN0YW1wTmFub3NlY29uZCgpe3JldHVybiBZc312aXNpdFRpbWUoKXtyZXR1cm4gV3N9dmlzaXRUaW1lU2Vjb25kKCl7cmV0dXJuIEhzfXZpc2l0VGltZU1pbGxpc2Vjb25kKCl7cmV0dXJuIEtzfXZpc2l0VGltZU1pY3Jvc2Vjb25kKCl7cmV0dXJuIEpzfXZpc2l0VGltZU5hbm9zZWNvbmQoKXtyZXR1cm4gR3N9dmlzaXREZWNpbWFsKCl7cmV0dXJuIGJzfXZpc2l0TGlzdCgpe3JldHVybiBFc312aXNpdFN0cnVjdCgpe3JldHVybiB6c312aXNpdFVuaW9uKCl7cmV0dXJuIFpzfXZpc2l0RGVuc2VVbmlvbigpe3JldHVybiBRc312aXNpdFNwYXJzZVVuaW9uKCl7cmV0dXJuIHFzfXZpc2l0RGljdGlvbmFyeSgpe3JldHVybiBnc312aXNpdEludGVydmFsKCl7cmV0dXJuIEJzfXZpc2l0SW50ZXJ2YWxEYXlUaW1lKCl7cmV0dXJuIEFzfXZpc2l0SW50ZXJ2YWxZZWFyTW9udGgoKXtyZXR1cm4gVHN9dmlzaXRGaXhlZFNpemVMaXN0KCl7cmV0dXJuIF9zfXZpc2l0TWFwKCl7cmV0dXJuIFZzfX07ZnVuY3Rpb24gZW8odCl7Y29uc3QgZT10LnR5cGUsaT1uZXcodG8uZ2V0VmlzaXRGbihlKSgpKSh0KTtpZihlLmNoaWxkcmVuJiZlLmNoaWxkcmVuLmxlbmd0aD4wKXtjb25zdCBuPXQuY2hpbGRyZW58fFtdLHI9e251bGxWYWx1ZXM6dC5udWxsVmFsdWVzfSxzPUFycmF5LmlzQXJyYXkobik/KHQsZSk9Pm5bZV18fHI6KHtuYW1lOnR9KT0+blt0XXx8cjtmb3IoY29uc3RbdCxvXW9mIGUuY2hpbGRyZW4uZW50cmllcygpKXtjb25zdHt0eXBlOmV9PW8sbj1zKG8sdCk7aS5jaGlsZHJlbi5wdXNoKGVvKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7dHlwZTplfSkpKX19cmV0dXJuIGl9ZnVuY3Rpb24gaW8odCxlKXtpZih0IGluc3RhbmNlb2YgYW58fHQgaW5zdGFuY2VvZiBDbnx8dC50eXBlIGluc3RhbmNlb2YgZWV8fEFycmF5QnVmZmVyLmlzVmlldyh0KSlyZXR1cm4gVm4odCk7Y29uc3QgaT1bLi4ucm8oe3R5cGU6bnVsbCE9ZT9lOm5vKHQpLG51bGxWYWx1ZXM6W251bGxdfSkodCldLG49MT09PWkubGVuZ3RoP2lbMF06aS5yZWR1Y2UoKCh0LGUpPT50LmNvbmNhdChlKSkpO3JldHVybiBlZS5pc0RpY3Rpb25hcnkobi50eXBlKT9uLm1lbW9pemUoKTpufWZ1bmN0aW9uIG5vKHQpe2lmKDA9PT10Lmxlbmd0aClyZXR1cm4gbmV3IGllO2xldCBlPTAsaT0wLG49MCxyPTAscz0wLG89MDtmb3IoY29uc3QgYSBvZiB0KXtpZihudWxsIT1hKXtzd2l0Y2godHlwZW9mIGEpe2Nhc2UiYmlnaW50IjorK3I7Y29udGludWU7Y2FzZSJib29sZWFuIjorK3M7Y29udGludWU7Y2FzZSJudW1iZXIiOisraTtjb250aW51ZTtjYXNlInN0cmluZyI6KytuO2NvbnRpbnVlO2Nhc2Uib2JqZWN0IjpBcnJheS5pc0FycmF5KGEpfHwiW29iamVjdCBEYXRlXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSkmJisrbztjb250aW51ZX10aHJvdyBuZXcgVHlwZUVycm9yKCJVbmFibGUgdG8gaW5mZXIgVmVjdG9yIHR5cGUgZnJvbSBpbnB1dCB2YWx1ZXMsIGV4cGxpY2l0IHR5cGUgZGVjbGFyYXRpb24gZXhwZWN0ZWQiKX0rK2V9aWYoaStlPT09dC5sZW5ndGgpcmV0dXJuIG5ldyBmZTtpZihuK2U9PT10Lmxlbmd0aClyZXR1cm4gbmV3IExlKG5ldyBiZSxuZXcgb2UpO2lmKHIrZT09PXQubGVuZ3RoKXJldHVybiBuZXcgYWU7aWYocytlPT09dC5sZW5ndGgpcmV0dXJuIG5ldyBnZTtpZihvK2U9PT10Lmxlbmd0aClyZXR1cm4gbmV3IHZlO3Rocm93IG5ldyBUeXBlRXJyb3IoIlVuYWJsZSB0byBpbmZlciBWZWN0b3IgdHlwZSBmcm9tIGlucHV0IHZhbHVlcywgZXhwbGljaXQgdHlwZSBkZWNsYXJhdGlvbiBleHBlY3RlZCIpfWZ1bmN0aW9uIHJvKHQpe2NvbnN0e3F1ZXVlaW5nU3RyYXRlZ3k6ZT0iY291bnQifT10LHtoaWdoV2F0ZXJNYXJrOmk9KCJieXRlcyIhPT1lP051bWJlci5QT1NJVElWRV9JTkZJTklUWTpNYXRoLnBvdygyLDE0KSl9PXQsbj0iYnl0ZXMiIT09ZT8ibGVuZ3RoIjoiYnl0ZUxlbmd0aCI7cmV0dXJuIGZ1bmN0aW9uKihlKXtsZXQgcj0wO2NvbnN0IHM9ZW8odCk7Zm9yKGNvbnN0IHQgb2YgZSlzLmFwcGVuZCh0KVtuXT49aSYmKytyJiYoeWllbGQgcy50b1ZlY3RvcigpKTsocy5maW5pc2goKS5sZW5ndGg+MHx8MD09PXIpJiYoeWllbGQgcy50b1ZlY3RvcigpKX19Y2xhc3Mgc28gZXh0ZW5kcyBVZXtjb21wYXJlU2NoZW1hcyh0LGUpe3JldHVybiB0PT09ZXx8ZSBpbnN0YW5jZW9mIHQuY29uc3RydWN0b3ImJnRoaXMuY29tcGFyZU1hbnlGaWVsZHModC5maWVsZHMsZS5maWVsZHMpfWNvbXBhcmVNYW55RmllbGRzKHQsZSl7cmV0dXJuIHQ9PT1lfHxBcnJheS5pc0FycmF5KHQpJiZBcnJheS5pc0FycmF5KGUpJiZ0Lmxlbmd0aD09PWUubGVuZ3RoJiZ0LmV2ZXJ5KCgodCxpKT0+dGhpcy5jb21wYXJlRmllbGRzKHQsZVtpXSkpKX1jb21wYXJlRmllbGRzKHQsZSl7cmV0dXJuIHQ9PT1lfHxlIGluc3RhbmNlb2YgdC5jb25zdHJ1Y3RvciYmdC5uYW1lPT09ZS5uYW1lJiZ0Lm51bGxhYmxlPT09ZS5udWxsYWJsZSYmdGhpcy52aXNpdCh0LnR5cGUsZS50eXBlKX19ZnVuY3Rpb24gb28odCxlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIHQuY29uc3RydWN0b3J9ZnVuY3Rpb24gYW8odCxlKXtyZXR1cm4gdD09PWV8fG9vKHQsZSl9ZnVuY3Rpb24gbG8odCxlKXtyZXR1cm4gdD09PWV8fG9vKHQsZSkmJnQuYml0V2lkdGg9PT1lLmJpdFdpZHRoJiZ0LmlzU2lnbmVkPT09ZS5pc1NpZ25lZH1mdW5jdGlvbiBjbyh0LGUpe3JldHVybiB0PT09ZXx8b28odCxlKSYmdC5wcmVjaXNpb249PT1lLnByZWNpc2lvbn1mdW5jdGlvbiBobyh0LGUpe3JldHVybiB0PT09ZXx8b28odCxlKSYmdC51bml0PT09ZS51bml0fWZ1bmN0aW9uIHVvKHQsZSl7cmV0dXJuIHQ9PT1lfHxvbyh0LGUpJiZ0LnVuaXQ9PT1lLnVuaXQmJnQudGltZXpvbmU9PT1lLnRpbWV6b25lfWZ1bmN0aW9uIHBvKHQsZSl7cmV0dXJuIHQ9PT1lfHxvbyh0LGUpJiZ0LnVuaXQ9PT1lLnVuaXQmJnQuYml0V2lkdGg9PT1lLmJpdFdpZHRofWZ1bmN0aW9uIGZvKHQsZSl7cmV0dXJuIHQ9PT1lfHxvbyh0LGUpJiZ0Lm1vZGU9PT1lLm1vZGUmJnQudHlwZUlkcy5ldmVyeSgoKHQsaSk9PnQ9PT1lLnR5cGVJZHNbaV0pKSYmYm8uY29tcGFyZU1hbnlGaWVsZHModC5jaGlsZHJlbixlLmNoaWxkcmVuKX1mdW5jdGlvbiB5byh0LGUpe3JldHVybiB0PT09ZXx8b28odCxlKSYmdC51bml0PT09ZS51bml0fXNvLnByb3RvdHlwZS52aXNpdE51bGw9YW8sc28ucHJvdG90eXBlLnZpc2l0Qm9vbD1hbyxzby5wcm90b3R5cGUudmlzaXRJbnQ9bG8sc28ucHJvdG90eXBlLnZpc2l0SW50OD1sbyxzby5wcm90b3R5cGUudmlzaXRJbnQxNj1sbyxzby5wcm90b3R5cGUudmlzaXRJbnQzMj1sbyxzby5wcm90b3R5cGUudmlzaXRJbnQ2ND1sbyxzby5wcm90b3R5cGUudmlzaXRVaW50OD1sbyxzby5wcm90b3R5cGUudmlzaXRVaW50MTY9bG8sc28ucHJvdG90eXBlLnZpc2l0VWludDMyPWxvLHNvLnByb3RvdHlwZS52aXNpdFVpbnQ2ND1sbyxzby5wcm90b3R5cGUudmlzaXRGbG9hdD1jbyxzby5wcm90b3R5cGUudmlzaXRGbG9hdDE2PWNvLHNvLnByb3RvdHlwZS52aXNpdEZsb2F0MzI9Y28sc28ucHJvdG90eXBlLnZpc2l0RmxvYXQ2ND1jbyxzby5wcm90b3R5cGUudmlzaXRVdGY4PWFvLHNvLnByb3RvdHlwZS52aXNpdEJpbmFyeT1hbyxzby5wcm90b3R5cGUudmlzaXRGaXhlZFNpemVCaW5hcnk9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD09PWV8fG9vKHQsZSkmJnQuYnl0ZVdpZHRoPT09ZS5ieXRlV2lkdGh9LHNvLnByb3RvdHlwZS52aXNpdERhdGU9aG8sc28ucHJvdG90eXBlLnZpc2l0RGF0ZURheT1obyxzby5wcm90b3R5cGUudmlzaXREYXRlTWlsbGlzZWNvbmQ9aG8sc28ucHJvdG90eXBlLnZpc2l0VGltZXN0YW1wPXVvLHNvLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcFNlY29uZD11byxzby5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBNaWxsaXNlY29uZD11byxzby5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBNaWNyb3NlY29uZD11byxzby5wcm90b3R5cGUudmlzaXRUaW1lc3RhbXBOYW5vc2Vjb25kPXVvLHNvLnByb3RvdHlwZS52aXNpdFRpbWU9cG8sc28ucHJvdG90eXBlLnZpc2l0VGltZVNlY29uZD1wbyxzby5wcm90b3R5cGUudmlzaXRUaW1lTWlsbGlzZWNvbmQ9cG8sc28ucHJvdG90eXBlLnZpc2l0VGltZU1pY3Jvc2Vjb25kPXBvLHNvLnByb3RvdHlwZS52aXNpdFRpbWVOYW5vc2Vjb25kPXBvLHNvLnByb3RvdHlwZS52aXNpdERlY2ltYWw9YW8sc28ucHJvdG90eXBlLnZpc2l0TGlzdD1mdW5jdGlvbih0LGUpe3JldHVybiB0PT09ZXx8b28odCxlKSYmdC5jaGlsZHJlbi5sZW5ndGg9PT1lLmNoaWxkcmVuLmxlbmd0aCYmYm8uY29tcGFyZU1hbnlGaWVsZHModC5jaGlsZHJlbixlLmNoaWxkcmVuKX0sc28ucHJvdG90eXBlLnZpc2l0U3RydWN0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9PT1lfHxvbyh0LGUpJiZ0LmNoaWxkcmVuLmxlbmd0aD09PWUuY2hpbGRyZW4ubGVuZ3RoJiZiby5jb21wYXJlTWFueUZpZWxkcyh0LmNoaWxkcmVuLGUuY2hpbGRyZW4pfSxzby5wcm90b3R5cGUudmlzaXRVbmlvbj1mbyxzby5wcm90b3R5cGUudmlzaXREZW5zZVVuaW9uPWZvLHNvLnByb3RvdHlwZS52aXNpdFNwYXJzZVVuaW9uPWZvLHNvLnByb3RvdHlwZS52aXNpdERpY3Rpb25hcnk9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD09PWV8fG9vKHQsZSkmJnQuaWQ9PT1lLmlkJiZ0LmlzT3JkZXJlZD09PWUuaXNPcmRlcmVkJiZiby52aXNpdCh0LmluZGljZXMsZS5pbmRpY2VzKSYmYm8udmlzaXQodC5kaWN0aW9uYXJ5LGUuZGljdGlvbmFyeSl9LHNvLnByb3RvdHlwZS52aXNpdEludGVydmFsPXlvLHNvLnByb3RvdHlwZS52aXNpdEludGVydmFsRGF5VGltZT15byxzby5wcm90b3R5cGUudmlzaXRJbnRlcnZhbFllYXJNb250aD15byxzby5wcm90b3R5cGUudmlzaXRGaXhlZFNpemVMaXN0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9PT1lfHxvbyh0LGUpJiZ0Lmxpc3RTaXplPT09ZS5saXN0U2l6ZSYmdC5jaGlsZHJlbi5sZW5ndGg9PT1lLmNoaWxkcmVuLmxlbmd0aCYmYm8uY29tcGFyZU1hbnlGaWVsZHModC5jaGlsZHJlbixlLmNoaWxkcmVuKX0sc28ucHJvdG90eXBlLnZpc2l0TWFwPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9PT1lfHxvbyh0LGUpJiZ0LmtleXNTb3J0ZWQ9PT1lLmtleXNTb3J0ZWQmJnQuY2hpbGRyZW4ubGVuZ3RoPT09ZS5jaGlsZHJlbi5sZW5ndGgmJmJvLmNvbXBhcmVNYW55RmllbGRzKHQuY2hpbGRyZW4sZS5jaGlsZHJlbil9O2NvbnN0IGJvPW5ldyBzbztmdW5jdGlvbiBnbyh0LGUpe3JldHVybiBiby5jb21wYXJlU2NoZW1hcyh0LGUpfWZ1bmN0aW9uIG1vKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3QgaT1bLi4udC5maWVsZHNdLG49W10scj17bnVtQmF0Y2hlczplLnJlZHVjZSgoKHQsZSk9Pk1hdGgubWF4KHQsZS5sZW5ndGgpKSwwKX07bGV0IHM9MCxvPTAsYT0tMTtjb25zdCBsPWUubGVuZ3RoO2xldCBjLGg9W107Zm9yKDtyLm51bUJhdGNoZXMtLSA+MDspe2ZvcihvPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSxhPS0xOysrYTxsOyloW2FdPWM9ZVthXS5zaGlmdCgpLG89TWF0aC5taW4obyxjP2MubGVuZ3RoOm8pO051bWJlci5pc0Zpbml0ZShvKSYmKGg9X28oaSxvLGgsZSxyKSxvPjAmJihuW3MrK109Y24oe3R5cGU6bmV3IEFlKGkpLGxlbmd0aDpvLG51bGxDb3VudDowLGNoaWxkcmVuOmguc2xpY2UoKX0pKSl9cmV0dXJuW3Q9dC5hc3NpZ24oaSksbi5tYXAoKGU9Pm5ldyBEbyh0LGUpKSldfSh0LGUubWFwKCh0PT50LmRhdGEuY29uY2F0KCkpKSl9ZnVuY3Rpb24gX28odCxlLGksbixyKXt2YXIgcztjb25zdCBvPShlKzYzJi02NCk+PjM7Zm9yKGxldCBhPS0xLGw9bi5sZW5ndGg7KythPGw7KXtjb25zdCBsPWlbYV0sYz1udWxsPT1sP3ZvaWQgMDpsLmxlbmd0aDtpZihjPj1lKWM9PT1lP2lbYV09bDooaVthXT1sLnNsaWNlKDAsZSksci5udW1CYXRjaGVzPU1hdGgubWF4KHIubnVtQmF0Y2hlcyxuW2FdLnVuc2hpZnQobC5zbGljZShlLGMtZSkpKSk7ZWxzZXtjb25zdCBuPXRbYV07dFthXT1uLmNsb25lKHtudWxsYWJsZTohMH0pLGlbYV09bnVsbCE9PShzPW51bGw9PWw/dm9pZCAwOmwuX2NoYW5nZUxlbmd0aEFuZEJhY2tmaWxsTnVsbEJpdG1hcChlKSkmJnZvaWQgMCE9PXM/czpjbih7dHlwZTpuLnR5cGUsbGVuZ3RoOmUsbnVsbENvdW50OmUsbnVsbEJpdG1hcDpuZXcgVWludDhBcnJheShvKX0pfX1yZXR1cm4gaX12YXIgdm8sd28sSW8sU28sQm8sQW8sVG87Y2xhc3MgT297Y29uc3RydWN0b3IoLi4udCl7dmFyIGUsaTtpZigwPT09dC5sZW5ndGgpcmV0dXJuIHRoaXMuYmF0Y2hlcz1bXSx0aGlzLnNjaGVtYT1uZXcgRXIoW10pLHRoaXMuX29mZnNldHM9WzBdLHRoaXM7bGV0IG4scjt0WzBdaW5zdGFuY2VvZiBFciYmKG49dC5zaGlmdCgpKSx0W3QubGVuZ3RoLTFdaW5zdGFuY2VvZiBVaW50MzJBcnJheSYmKHI9dC5wb3AoKSk7Y29uc3Qgcz10PT57aWYodCl7aWYodCBpbnN0YW5jZW9mIERvKXJldHVyblt0XTtpZih0IGluc3RhbmNlb2YgT28pcmV0dXJuIHQuYmF0Y2hlcztpZih0IGluc3RhbmNlb2YgYW4pe2lmKHQudHlwZSBpbnN0YW5jZW9mIEFlKXJldHVybltuZXcgRG8obmV3IEVyKHQudHlwZS5jaGlsZHJlbiksdCldfWVsc2V7aWYoQXJyYXkuaXNBcnJheSh0KSlyZXR1cm4gdC5mbGF0TWFwKCh0PT5zKHQpKSk7aWYoImZ1bmN0aW9uIj09dHlwZW9mIHRbU3ltYm9sLml0ZXJhdG9yXSlyZXR1cm5bLi4udF0uZmxhdE1hcCgodD0+cyh0KSkpO2lmKCJvYmplY3QiPT10eXBlb2YgdCl7Y29uc3QgZT1PYmplY3Qua2V5cyh0KSxpPWUubWFwKChlPT5uZXcgQ24oW3RbZV1dKSkpLG49bmV3IEVyKGUubWFwKCgodCxlKT0+bmV3IFZyKFN0cmluZyh0KSxpW2VdLnR5cGUpKSkpLFsscl09bW8obixpKTtyZXR1cm4gMD09PXIubGVuZ3RoP1tuZXcgRG8odCldOnJ9fX1yZXR1cm5bXX0sbz10LmZsYXRNYXAoKHQ9PnModCkpKTtpZihuPW51bGwhPT0oaT1udWxsIT1uP246bnVsbD09PShlPW9bMF0pfHx2b2lkIDA9PT1lP3ZvaWQgMDplLnNjaGVtYSkmJnZvaWQgMCE9PWk/aTpuZXcgRXIoW10pLCEobiBpbnN0YW5jZW9mIEVyKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUYWJsZSBjb25zdHJ1Y3RvciBleHBlY3RzIGEgW1NjaGVtYSwgUmVjb3JkQmF0Y2hbXV0gcGFpci4iKTtmb3IoY29uc3QgYSBvZiBvKXtpZighKGEgaW5zdGFuY2VvZiBEbykpdGhyb3cgbmV3IFR5cGVFcnJvcigiVGFibGUgY29uc3RydWN0b3IgZXhwZWN0cyBhIFtTY2hlbWEsIFJlY29yZEJhdGNoW11dIHBhaXIuIik7aWYoIWdvKG4sYS5zY2hlbWEpKXRocm93IG5ldyBUeXBlRXJyb3IoIlRhYmxlIGFuZCBpbm5lciBSZWNvcmRCYXRjaCBzY2hlbWFzIG11c3QgYmUgZXF1aXZhbGVudC4iKX10aGlzLnNjaGVtYT1uLHRoaXMuYmF0Y2hlcz1vLHRoaXMuX29mZnNldHM9bnVsbCE9cj9yOmRuKHRoaXMuZGF0YSl9Z2V0IGRhdGEoKXtyZXR1cm4gdGhpcy5iYXRjaGVzLm1hcCgoKHtkYXRhOnR9KT0+dCkpfWdldCBudW1Db2xzKCl7cmV0dXJuIHRoaXMuc2NoZW1hLmZpZWxkcy5sZW5ndGh9Z2V0IG51bVJvd3MoKXtyZXR1cm4gdGhpcy5kYXRhLnJlZHVjZSgoKHQsZSk9PnQrZS5sZW5ndGgpLDApfWdldCBudWxsQ291bnQoKXtyZXR1cm4tMT09PXRoaXMuX251bGxDb3VudCYmKHRoaXMuX251bGxDb3VudD11bih0aGlzLmRhdGEpKSx0aGlzLl9udWxsQ291bnR9aXNWYWxpZCh0KXtyZXR1cm4hMX1nZXQodCl7cmV0dXJuIG51bGx9c2V0KHQsZSl7fWluZGV4T2YodCxlKXtyZXR1cm4tMX1nZXRCeXRlTGVuZ3RoKHQpe3JldHVybiAwfVtTeW1ib2wuaXRlcmF0b3JdKCl7cmV0dXJuIFRuLnZpc2l0KG5ldyBDbih0aGlzLmRhdGEpKX10b0FycmF5KCl7cmV0dXJuWy4uLnRoaXNdfXRvU3RyaW5nKCl7cmV0dXJuYFtcbiAgJHt0aGlzLnRvQXJyYXkoKS5qb2luKCIsXG4gICIpfVxuXWB9Y29uY2F0KC4uLnQpe2NvbnN0IGU9dGhpcy5zY2hlbWEsaT10aGlzLmRhdGEuY29uY2F0KHQuZmxhdE1hcCgoKHtkYXRhOnR9KT0+dCkpKTtyZXR1cm4gbmV3IE9vKGUsaS5tYXAoKHQ9Pm5ldyBEbyhlLHQpKSkpfXNsaWNlKHQsZSl7Y29uc3QgaT10aGlzLnNjaGVtYTtbdCxlXT1KaSh7bGVuZ3RoOnRoaXMubnVtUm93c30sdCxlKTtjb25zdCBuPXBuKHRoaXMuZGF0YSx0aGlzLl9vZmZzZXRzLHQsZSk7cmV0dXJuIG5ldyBPbyhpLG4ubWFwKCh0PT5uZXcgRG8oaSx0KSkpKX1nZXRDaGlsZCh0KXtyZXR1cm4gdGhpcy5nZXRDaGlsZEF0KHRoaXMuc2NoZW1hLmZpZWxkcy5maW5kSW5kZXgoKGU9PmUubmFtZT09PXQpKSl9Z2V0Q2hpbGRBdCh0KXtpZih0Pi0xJiZ0PHRoaXMuc2NoZW1hLmZpZWxkcy5sZW5ndGgpe2NvbnN0IGU9dGhpcy5kYXRhLm1hcCgoZT0+ZS5jaGlsZHJlblt0XSkpO2lmKDA9PT1lLmxlbmd0aCl7Y29uc3R7dHlwZTppfT10aGlzLnNjaGVtYS5maWVsZHNbdF0sbj1jbih7dHlwZTppLGxlbmd0aDowLG51bGxDb3VudDowfSk7ZS5wdXNoKG4uX2NoYW5nZUxlbmd0aEFuZEJhY2tmaWxsTnVsbEJpdG1hcCh0aGlzLm51bVJvd3MpKX1yZXR1cm4gbmV3IENuKGUpfXJldHVybiBudWxsfXNldENoaWxkKHQsZSl7dmFyIGk7cmV0dXJuIHRoaXMuc2V0Q2hpbGRBdChudWxsPT09KGk9dGhpcy5zY2hlbWEuZmllbGRzKXx8dm9pZCAwPT09aT92b2lkIDA6aS5maW5kSW5kZXgoKGU9PmUubmFtZT09PXQpKSxlKX1zZXRDaGlsZEF0KHQsZSl7bGV0IGk9dGhpcy5zY2hlbWEsbj1bLi4udGhpcy5iYXRjaGVzXTtpZih0Pi0xJiZ0PHRoaXMubnVtQ29scyl7ZXx8KGU9bmV3IENuKFtjbih7dHlwZTpuZXcgaWUsbGVuZ3RoOnRoaXMubnVtUm93c30pXSkpO2NvbnN0IHI9aS5maWVsZHMuc2xpY2UoKSxzPXJbdF0uY2xvbmUoe3R5cGU6ZS50eXBlfSksbz10aGlzLnNjaGVtYS5maWVsZHMubWFwKCgodCxlKT0+dGhpcy5nZXRDaGlsZEF0KGUpKSk7W3JbdF0sb1t0XV09W3MsZV0sW2ksbl09bW8oaSxvKX1yZXR1cm4gbmV3IE9vKGksbil9c2VsZWN0KHQpe2NvbnN0IGU9dGhpcy5zY2hlbWEuZmllbGRzLnJlZHVjZSgoKHQsZSxpKT0+dC5zZXQoZS5uYW1lLGkpKSxuZXcgTWFwKTtyZXR1cm4gdGhpcy5zZWxlY3RBdCh0Lm1hcCgodD0+ZS5nZXQodCkpKS5maWx0ZXIoKHQ9PnQ+LTEpKSl9c2VsZWN0QXQodCl7Y29uc3QgZT10aGlzLnNjaGVtYS5zZWxlY3RBdCh0KSxpPXRoaXMuYmF0Y2hlcy5tYXAoKGU9PmUuc2VsZWN0QXQodCkpKTtyZXR1cm4gbmV3IE9vKGUsaSl9YXNzaWduKHQpe2NvbnN0IGU9dGhpcy5zY2hlbWEuZmllbGRzLFtpLG5dPXQuc2NoZW1hLmZpZWxkcy5yZWR1Y2UoKCh0LGksbik9Pntjb25zdFtyLHNdPXQsbz1lLmZpbmRJbmRleCgodD0+dC5uYW1lPT09aS5uYW1lKSk7cmV0dXJufm8/c1tvXT1uOnIucHVzaChuKSx0fSksW1tdLFtdXSkscj10aGlzLnNjaGVtYS5hc3NpZ24odC5zY2hlbWEpLHM9Wy4uLmUubWFwKCgodCxlKT0+W2UsbltlXV0pKS5tYXAoKChbZSxpXSk9PnZvaWQgMD09PWk/dGhpcy5nZXRDaGlsZEF0KGUpOnQuZ2V0Q2hpbGRBdChpKSkpLC4uLmkubWFwKChlPT50LmdldENoaWxkQXQoZSkpKV0uZmlsdGVyKEJvb2xlYW4pO3JldHVybiBuZXcgT28oLi4ubW8ocixzKSl9fXZvPVN5bWJvbC50b1N0cmluZ1RhZyxPb1t2b109KHQ9Pih0LnNjaGVtYT1udWxsLHQuYmF0Y2hlcz1bXSx0Ll9vZmZzZXRzPW5ldyBVaW50MzJBcnJheShbMF0pLHQuX251bGxDb3VudD0tMSx0W1N5bWJvbC5pc0NvbmNhdFNwcmVhZGFibGVdPSEwLHQuaXNWYWxpZD1ibih5biksdC5nZXQ9Ym4oamkuZ2V0VmlzaXRGbih2dC5TdHJ1Y3QpKSx0LnNldD1nbihmaS5nZXRWaXNpdEZuKHZ0LlN0cnVjdCkpLHQuaW5kZXhPZj1tbihJbi5nZXRWaXNpdEZuKHZ0LlN0cnVjdCkpLHQuZ2V0Qnl0ZUxlbmd0aD1ibihGbi5nZXRWaXNpdEZuKHZ0LlN0cnVjdCkpLCJUYWJsZSIpKShPby5wcm90b3R5cGUpO2NsYXNzIERve2NvbnN0cnVjdG9yKC4uLnQpe3N3aXRjaCh0Lmxlbmd0aCl7Y2FzZSAyOmlmKFt0aGlzLnNjaGVtYV09dCwhKHRoaXMuc2NoZW1hIGluc3RhbmNlb2YgRXIpKXRocm93IG5ldyBUeXBlRXJyb3IoIlJlY29yZEJhdGNoIGNvbnN0cnVjdG9yIGV4cGVjdHMgYSBbU2NoZW1hLCBEYXRhXSBwYWlyLiIpO2lmKFssdGhpcy5kYXRhPWNuKHtudWxsQ291bnQ6MCx0eXBlOm5ldyBBZSh0aGlzLnNjaGVtYS5maWVsZHMpLGNoaWxkcmVuOnRoaXMuc2NoZW1hLmZpZWxkcy5tYXAoKHQ9PmNuKHt0eXBlOnQudHlwZSxudWxsQ291bnQ6MH0pKSl9KV09dCwhKHRoaXMuZGF0YSBpbnN0YW5jZW9mIGFuKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJSZWNvcmRCYXRjaCBjb25zdHJ1Y3RvciBleHBlY3RzIGEgW1NjaGVtYSwgRGF0YV0gcGFpci4iKTtbdGhpcy5zY2hlbWEsdGhpcy5kYXRhXT14byh0aGlzLnNjaGVtYSx0aGlzLmRhdGEuY2hpbGRyZW4pO2JyZWFrO2Nhc2UgMTp7Y29uc3RbZV09dCx7ZmllbGRzOmksY2hpbGRyZW46bixsZW5ndGg6cn09T2JqZWN0LmtleXMoZSkucmVkdWNlKCgodCxpLG4pPT4odC5jaGlsZHJlbltuXT1lW2ldLHQubGVuZ3RoPU1hdGgubWF4KHQubGVuZ3RoLGVbaV0ubGVuZ3RoKSx0LmZpZWxkc1tuXT1Wci5uZXcoe25hbWU6aSx0eXBlOmVbaV0udHlwZSxudWxsYWJsZTohMH0pLHQpKSx7bGVuZ3RoOjAsZmllbGRzOm5ldyBBcnJheSxjaGlsZHJlbjpuZXcgQXJyYXl9KSxzPW5ldyBFcihpKSxvPWNuKHt0eXBlOm5ldyBBZShpKSxsZW5ndGg6cixjaGlsZHJlbjpuLG51bGxDb3VudDowfSk7W3RoaXMuc2NoZW1hLHRoaXMuZGF0YV09eG8ocyxvLmNoaWxkcmVuLHIpO2JyZWFrfWRlZmF1bHQ6dGhyb3cgbmV3IFR5cGVFcnJvcigiUmVjb3JkQmF0Y2ggY29uc3RydWN0b3IgZXhwZWN0cyBhbiBPYmplY3QgbWFwcGluZyBuYW1lcyB0byBjaGlsZCBEYXRhLCBvciBhIFtTY2hlbWEsIERhdGFdIHBhaXIuIil9fWdldCBkaWN0aW9uYXJpZXMoKXtyZXR1cm4gdGhpcy5fZGljdGlvbmFyaWVzfHwodGhpcy5fZGljdGlvbmFyaWVzPU1vKHRoaXMuc2NoZW1hLmZpZWxkcyx0aGlzLmRhdGEuY2hpbGRyZW4pKX1nZXQgbnVtQ29scygpe3JldHVybiB0aGlzLnNjaGVtYS5maWVsZHMubGVuZ3RofWdldCBudW1Sb3dzKCl7cmV0dXJuIHRoaXMuZGF0YS5sZW5ndGh9Z2V0IG51bGxDb3VudCgpe3JldHVybiB0aGlzLmRhdGEubnVsbENvdW50fWlzVmFsaWQodCl7cmV0dXJuIHRoaXMuZGF0YS5nZXRWYWxpZCh0KX1nZXQodCl7cmV0dXJuIGppLnZpc2l0KHRoaXMuZGF0YSx0KX1zZXQodCxlKXtyZXR1cm4gZmkudmlzaXQodGhpcy5kYXRhLHQsZSl9aW5kZXhPZih0LGUpe3JldHVybiBJbi52aXNpdCh0aGlzLmRhdGEsdCxlKX1nZXRCeXRlTGVuZ3RoKHQpe3JldHVybiBGbi52aXNpdCh0aGlzLmRhdGEsdCl9W1N5bWJvbC5pdGVyYXRvcl0oKXtyZXR1cm4gVG4udmlzaXQobmV3IENuKFt0aGlzLmRhdGFdKSl9dG9BcnJheSgpe3JldHVyblsuLi50aGlzXX1jb25jYXQoLi4udCl7cmV0dXJuIG5ldyBPbyh0aGlzLnNjaGVtYSxbdGhpcywuLi50XSl9c2xpY2UodCxlKXtjb25zdFtpXT1uZXcgQ24oW3RoaXMuZGF0YV0pLnNsaWNlKHQsZSkuZGF0YTtyZXR1cm4gbmV3IERvKHRoaXMuc2NoZW1hLGkpfWdldENoaWxkKHQpe3ZhciBlO3JldHVybiB0aGlzLmdldENoaWxkQXQobnVsbD09PShlPXRoaXMuc2NoZW1hLmZpZWxkcyl8fHZvaWQgMD09PWU/dm9pZCAwOmUuZmluZEluZGV4KChlPT5lLm5hbWU9PT10KSkpfWdldENoaWxkQXQodCl7cmV0dXJuIHQ+LTEmJnQ8dGhpcy5zY2hlbWEuZmllbGRzLmxlbmd0aD9uZXcgQ24oW3RoaXMuZGF0YS5jaGlsZHJlblt0XV0pOm51bGx9c2V0Q2hpbGQodCxlKXt2YXIgaTtyZXR1cm4gdGhpcy5zZXRDaGlsZEF0KG51bGw9PT0oaT10aGlzLnNjaGVtYS5maWVsZHMpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmZpbmRJbmRleCgoZT0+ZS5uYW1lPT09dCkpLGUpfXNldENoaWxkQXQodCxlKXtsZXQgaT10aGlzLnNjaGVtYSxuPXRoaXMuZGF0YTtpZih0Pi0xJiZ0PHRoaXMubnVtQ29scyl7ZXx8KGU9bmV3IENuKFtjbih7dHlwZTpuZXcgaWUsbGVuZ3RoOnRoaXMubnVtUm93c30pXSkpO2NvbnN0IHI9aS5maWVsZHMuc2xpY2UoKSxzPW4uY2hpbGRyZW4uc2xpY2UoKSxvPXJbdF0uY2xvbmUoe3R5cGU6ZS50eXBlfSk7W3JbdF0sc1t0XV09W28sZS5kYXRhWzBdXSxpPW5ldyBFcihyLG5ldyBNYXAodGhpcy5zY2hlbWEubWV0YWRhdGEpKSxuPWNuKHt0eXBlOm5ldyBBZShyKSxjaGlsZHJlbjpzfSl9cmV0dXJuIG5ldyBEbyhpLG4pfXNlbGVjdCh0KXtjb25zdCBlPXRoaXMuc2NoZW1hLnNlbGVjdCh0KSxpPW5ldyBBZShlLmZpZWxkcyksbj1bXTtmb3IoY29uc3QgciBvZiB0KXtjb25zdCB0PXRoaXMuc2NoZW1hLmZpZWxkcy5maW5kSW5kZXgoKHQ9PnQubmFtZT09PXIpKTt+dCYmKG5bdF09dGhpcy5kYXRhLmNoaWxkcmVuW3RdKX1yZXR1cm4gbmV3IERvKGUsY24oe3R5cGU6aSxsZW5ndGg6dGhpcy5udW1Sb3dzLGNoaWxkcmVuOm59KSl9c2VsZWN0QXQodCl7Y29uc3QgZT10aGlzLnNjaGVtYS5zZWxlY3RBdCh0KSxpPXQubWFwKCh0PT50aGlzLmRhdGEuY2hpbGRyZW5bdF0pKS5maWx0ZXIoQm9vbGVhbiksbj1jbih7dHlwZTpuZXcgQWUoZS5maWVsZHMpLGxlbmd0aDp0aGlzLm51bVJvd3MsY2hpbGRyZW46aX0pO3JldHVybiBuZXcgRG8oZSxuKX19ZnVuY3Rpb24geG8odCxlLGk9ZS5yZWR1Y2UoKCh0LGUpPT5NYXRoLm1heCh0LGUubGVuZ3RoKSksMCkpe3ZhciBuO2NvbnN0IHI9Wy4uLnQuZmllbGRzXSxzPVsuLi5lXSxvPShpKzYzJi02NCk+PjM7Zm9yKGNvbnN0W2EsbF1vZiB0LmZpZWxkcy5lbnRyaWVzKCkpe2NvbnN0IHQ9ZVthXTt0JiZ0Lmxlbmd0aD09PWl8fChyW2FdPWwuY2xvbmUoe251bGxhYmxlOiEwfSksc1thXT1udWxsIT09KG49bnVsbD09dD92b2lkIDA6dC5fY2hhbmdlTGVuZ3RoQW5kQmFja2ZpbGxOdWxsQml0bWFwKGkpKSYmdm9pZCAwIT09bj9uOmNuKHt0eXBlOmwudHlwZSxsZW5ndGg6aSxudWxsQ291bnQ6aSxudWxsQml0bWFwOm5ldyBVaW50OEFycmF5KG8pfSkpfXJldHVyblt0LmFzc2lnbihyKSxjbih7dHlwZTpuZXcgQWUociksbGVuZ3RoOmksY2hpbGRyZW46c30pXX1mdW5jdGlvbiBNbyh0LGUsaT1uZXcgTWFwKXtmb3IobGV0IG49LTEscj10Lmxlbmd0aDsrK248cjspe2NvbnN0IHI9dFtuXS50eXBlLHM9ZVtuXTtpZihlZS5pc0RpY3Rpb25hcnkocikpaWYoaS5oYXMoci5pZCkpe2lmKGkuZ2V0KHIuaWQpIT09cy5kaWN0aW9uYXJ5KXRocm93IG5ldyBFcnJvcigiQ2Fubm90IGNyZWF0ZSBTY2hlbWEgY29udGFpbmluZyB0d28gZGlmZmVyZW50IGRpY3Rpb25hcmllcyB3aXRoIHRoZSBzYW1lIElkIil9ZWxzZSBzLmRpY3Rpb25hcnkmJmkuc2V0KHIuaWQscy5kaWN0aW9uYXJ5KTtyLmNoaWxkcmVuJiZyLmNoaWxkcmVuLmxlbmd0aD4wJiZNbyhyLmNoaWxkcmVuLHMuY2hpbGRyZW4saSl9cmV0dXJuIGl9d289U3ltYm9sLnRvU3RyaW5nVGFnLERvW3dvXT0odD0+KHQuX251bGxDb3VudD0tMSx0W1N5bWJvbC5pc0NvbmNhdFNwcmVhZGFibGVdPSEwLCJSZWNvcmRCYXRjaCIpKShEby5wcm90b3R5cGUpO2NsYXNzIEZvIGV4dGVuZHMgRG97Y29uc3RydWN0b3IodCl7Y29uc3QgZT10LmZpZWxkcy5tYXAoKHQ9PmNuKHt0eXBlOnQudHlwZX0pKSk7c3VwZXIodCxjbih7dHlwZTpuZXcgQWUodC5maWVsZHMpLG51bGxDb3VudDowLGNoaWxkcmVuOmV9KSl9fShTbz1Jb3x8KElvPXt9KSlbU28uQlVGRkVSPTBdPSJCVUZGRVIiLChBbz1Cb3x8KEJvPXt9KSlbQW8uTFo0X0ZSQU1FPTBdPSJMWjRfRlJBTUUiLEFvW0FvLlpTVEQ9MV09IlpTVEQiO2NsYXNzIExve2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0JvZHlDb21wcmVzc2lvbih0LGUpe3JldHVybihlfHxuZXcgTG8pLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzQm9keUNvbXByZXNzaW9uKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgTG8pLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1jb2RlYygpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQ4KHRoaXMuYmJfcG9zK3QpOkJvLkxaNF9GUkFNRX1tZXRob2QoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50OCh0aGlzLmJiX3Bvcyt0KTpJby5CVUZGRVJ9c3RhdGljIHN0YXJ0Qm9keUNvbXByZXNzaW9uKHQpe3Quc3RhcnRPYmplY3QoMil9c3RhdGljIGFkZENvZGVjKHQsZSl7dC5hZGRGaWVsZEludDgoMCxlLEJvLkxaNF9GUkFNRSl9c3RhdGljIGFkZE1ldGhvZCh0LGUpe3QuYWRkRmllbGRJbnQ4KDEsZSxJby5CVUZGRVIpfXN0YXRpYyBlbmRCb2R5Q29tcHJlc3Npb24odCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9c3RhdGljIGNyZWF0ZUJvZHlDb21wcmVzc2lvbih0LGUsaSl7cmV0dXJuIExvLnN0YXJ0Qm9keUNvbXByZXNzaW9uKHQpLExvLmFkZENvZGVjKHQsZSksTG8uYWRkTWV0aG9kKHQsaSksTG8uZW5kQm9keUNvbXByZXNzaW9uKHQpfX1jbGFzcyBOb3tjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfW9mZnNldCgpe3JldHVybiB0aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiX3Bvcyl9bGVuZ3RoKCl7cmV0dXJuIHRoaXMuYmIucmVhZEludDY0KHRoaXMuYmJfcG9zKzgpfXN0YXRpYyBzaXplT2YoKXtyZXR1cm4gMTZ9c3RhdGljIGNyZWF0ZUJ1ZmZlcih0LGUsaSl7cmV0dXJuIHQucHJlcCg4LDE2KSx0LndyaXRlSW50NjQoaSksdC53cml0ZUludDY0KGUpLHQub2Zmc2V0KCl9fWNsYXNzIFVve2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9bGVuZ3RoKCl7cmV0dXJuIHRoaXMuYmIucmVhZEludDY0KHRoaXMuYmJfcG9zKX1udWxsQ291bnQoKXtyZXR1cm4gdGhpcy5iYi5yZWFkSW50NjQodGhpcy5iYl9wb3MrOCl9c3RhdGljIHNpemVPZigpe3JldHVybiAxNn1zdGF0aWMgY3JlYXRlRmllbGROb2RlKHQsZSxpKXtyZXR1cm4gdC5wcmVwKDgsMTYpLHQud3JpdGVJbnQ2NChpKSx0LndyaXRlSW50NjQoZSksdC5vZmZzZXQoKX19Y2xhc3MgQ297Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MH1fX2luaXQodCxlKXtyZXR1cm4gdGhpcy5iYl9wb3M9dCx0aGlzLmJiPWUsdGhpc31zdGF0aWMgZ2V0Um9vdEFzUmVjb3JkQmF0Y2godCxlKXtyZXR1cm4oZXx8bmV3IENvKS5fX2luaXQodC5yZWFkSW50MzIodC5wb3NpdGlvbigpKSt0LnBvc2l0aW9uKCksdCl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc1JlY29yZEJhdGNoKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgQ28pLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1sZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50NjQodGhpcy5iYl9wb3MrdCk6dGhpcy5iYi5jcmVhdGVMb25nKDAsMCl9bm9kZXModCxlKXtjb25zdCBpPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIGk/KGV8fG5ldyBVbykuX19pbml0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MraSkrMTYqdCx0aGlzLmJiKTpudWxsfW5vZGVzTGVuZ3RoKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9YnVmZmVycyh0LGUpe2NvbnN0IGk9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gaT8oZXx8bmV3IE5vKS5fX2luaXQodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytpKSsxNip0LHRoaXMuYmIpOm51bGx9YnVmZmVyc0xlbmd0aCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gdD90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3Bvcyt0KTowfWNvbXByZXNzaW9uKHQpe2NvbnN0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMCk7cmV0dXJuIGU/KHR8fG5ldyBMbykuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiX3BvcytlKSx0aGlzLmJiKTpudWxsfXN0YXRpYyBzdGFydFJlY29yZEJhdGNoKHQpe3Quc3RhcnRPYmplY3QoNCl9c3RhdGljIGFkZExlbmd0aCh0LGUpe3QuYWRkRmllbGRJbnQ2NCgwLGUsdC5jcmVhdGVMb25nKDAsMCkpfXN0YXRpYyBhZGROb2Rlcyh0LGUpe3QuYWRkRmllbGRPZmZzZXQoMSxlLDApfXN0YXRpYyBzdGFydE5vZGVzVmVjdG9yKHQsZSl7dC5zdGFydFZlY3RvcigxNixlLDgpfXN0YXRpYyBhZGRCdWZmZXJzKHQsZSl7dC5hZGRGaWVsZE9mZnNldCgyLGUsMCl9c3RhdGljIHN0YXJ0QnVmZmVyc1ZlY3Rvcih0LGUpe3Quc3RhcnRWZWN0b3IoMTYsZSw4KX1zdGF0aWMgYWRkQ29tcHJlc3Npb24odCxlKXt0LmFkZEZpZWxkT2Zmc2V0KDMsZSwwKX1zdGF0aWMgZW5kUmVjb3JkQmF0Y2godCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9fWNsYXNzIEVve2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTB9X19pbml0KHQsZSl7cmV0dXJuIHRoaXMuYmJfcG9zPXQsdGhpcy5iYj1lLHRoaXN9c3RhdGljIGdldFJvb3RBc0RpY3Rpb25hcnlCYXRjaCh0LGUpe3JldHVybihlfHxuZXcgRW8pLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzRGljdGlvbmFyeUJhdGNoKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgRW8pLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX1pZCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiX3Bvcyt0KTp0aGlzLmJiLmNyZWF0ZUxvbmcoMCwwKX1kYXRhKHQpe2NvbnN0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gZT8odHx8bmV3IENvKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK2UpLHRoaXMuYmIpOm51bGx9aXNEZWx0YSgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4hIXQmJiEhdGhpcy5iYi5yZWFkSW50OCh0aGlzLmJiX3Bvcyt0KX1zdGF0aWMgc3RhcnREaWN0aW9uYXJ5QmF0Y2godCl7dC5zdGFydE9iamVjdCgzKX1zdGF0aWMgYWRkSWQodCxlKXt0LmFkZEZpZWxkSW50NjQoMCxlLHQuY3JlYXRlTG9uZygwLDApKX1zdGF0aWMgYWRkRGF0YSh0LGUpe3QuYWRkRmllbGRPZmZzZXQoMSxlLDApfXN0YXRpYyBhZGRJc0RlbHRhKHQsZSl7dC5hZGRGaWVsZEludDgoMiwrZSwwKX1zdGF0aWMgZW5kRGljdGlvbmFyeUJhdGNoKHQpe3JldHVybiB0LmVuZE9iamVjdCgpfX0hZnVuY3Rpb24odCl7dFt0Lk5PTkU9MF09Ik5PTkUiLHRbdC5TY2hlbWE9MV09IlNjaGVtYSIsdFt0LkRpY3Rpb25hcnlCYXRjaD0yXT0iRGljdGlvbmFyeUJhdGNoIix0W3QuUmVjb3JkQmF0Y2g9M109IlJlY29yZEJhdGNoIix0W3QuVGVuc29yPTRdPSJUZW5zb3IiLHRbdC5TcGFyc2VUZW5zb3I9NV09IlNwYXJzZVRlbnNvciJ9KFRvfHwoVG89e30pKTtjbGFzcyBWb3tjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wfV9faW5pdCh0LGUpe3JldHVybiB0aGlzLmJiX3Bvcz10LHRoaXMuYmI9ZSx0aGlzfXN0YXRpYyBnZXRSb290QXNNZXNzYWdlKHQsZSl7cmV0dXJuKGV8fG5ldyBWbykuX19pbml0KHQucmVhZEludDMyKHQucG9zaXRpb24oKSkrdC5wb3NpdGlvbigpLHQpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNNZXNzYWdlKHQsZSl7cmV0dXJuIHQuc2V0UG9zaXRpb24odC5wb3NpdGlvbigpKzQpLChlfHxuZXcgVm8pLl9faW5pdCh0LnJlYWRJbnQzMih0LnBvc2l0aW9uKCkpK3QucG9zaXRpb24oKSx0KX12ZXJzaW9uKCl7Y29uc3QgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDE2KHRoaXMuYmJfcG9zK3QpOmVyLlYxfWhlYWRlclR5cGUoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkVWludDgodGhpcy5iYl9wb3MrdCk6VG8uTk9ORX1oZWFkZXIodCl7Y29uc3QgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiBlP3RoaXMuYmIuX191bmlvbih0LHRoaXMuYmJfcG9zK2UpOm51bGx9Ym9keUxlbmd0aCgpe2NvbnN0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50NjQodGhpcy5iYl9wb3MrdCk6dGhpcy5iYi5jcmVhdGVMb25nKDAsMCl9Y3VzdG9tTWV0YWRhdGEodCxlKXtjb25zdCBpPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTIpO3JldHVybiBpPyhlfHxuZXcgZnIpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytpKSs0KnQpLHRoaXMuYmIpOm51bGx9Y3VzdG9tTWV0YWRhdGFMZW5ndGgoKXtjb25zdCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTIpO3JldHVybiB0P3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK3QpOjB9c3RhdGljIHN0YXJ0TWVzc2FnZSh0KXt0LnN0YXJ0T2JqZWN0KDUpfXN0YXRpYyBhZGRWZXJzaW9uKHQsZSl7dC5hZGRGaWVsZEludDE2KDAsZSxlci5WMSl9c3RhdGljIGFkZEhlYWRlclR5cGUodCxlKXt0LmFkZEZpZWxkSW50OCgxLGUsVG8uTk9ORSl9c3RhdGljIGFkZEhlYWRlcih0LGUpe3QuYWRkRmllbGRPZmZzZXQoMixlLDApfXN0YXRpYyBhZGRCb2R5TGVuZ3RoKHQsZSl7dC5hZGRGaWVsZEludDY0KDMsZSx0LmNyZWF0ZUxvbmcoMCwwKSl9c3RhdGljIGFkZEN1c3RvbU1ldGFkYXRhKHQsZSl7dC5hZGRGaWVsZE9mZnNldCg0LGUsMCl9c3RhdGljIGNyZWF0ZUN1c3RvbU1ldGFkYXRhVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig0LGUubGVuZ3RoLDQpO2ZvcihsZXQgaT1lLmxlbmd0aC0xO2k+PTA7aS0tKXQuYWRkT2Zmc2V0KGVbaV0pO3JldHVybiB0LmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydEN1c3RvbU1ldGFkYXRhVmVjdG9yKHQsZSl7dC5zdGFydFZlY3Rvcig0LGUsNCl9c3RhdGljIGVuZE1lc3NhZ2UodCl7cmV0dXJuIHQuZW5kT2JqZWN0KCl9c3RhdGljIGZpbmlzaE1lc3NhZ2VCdWZmZXIodCxlKXt0LmZpbmlzaChlKX1zdGF0aWMgZmluaXNoU2l6ZVByZWZpeGVkTWVzc2FnZUJ1ZmZlcih0LGUpe3QuZmluaXNoKGUsdm9pZCAwLCEwKX1zdGF0aWMgY3JlYXRlTWVzc2FnZSh0LGUsaSxuLHIscyl7cmV0dXJuIFZvLnN0YXJ0TWVzc2FnZSh0KSxWby5hZGRWZXJzaW9uKHQsZSksVm8uYWRkSGVhZGVyVHlwZSh0LGkpLFZvLmFkZEhlYWRlcih0LG4pLFZvLmFkZEJvZHlMZW5ndGgodCxyKSxWby5hZGRDdXN0b21NZXRhZGF0YSh0LHMpLFZvLmVuZE1lc3NhZ2UodCl9fXZhciBSbz1Rbjtjb25zdCB6bz1uZXcgY2xhc3MgZXh0ZW5kcyBVZXt2aXNpdCh0LGUpe3JldHVybiBudWxsPT10fHxudWxsPT1lP3ZvaWQgMDpzdXBlci52aXNpdCh0LGUpfXZpc2l0TnVsbCh0LGUpe3JldHVybiBPci5zdGFydE51bGwoZSksT3IuZW5kTnVsbChlKX12aXNpdEludCh0LGUpe3JldHVybiB5ci5zdGFydEludChlKSx5ci5hZGRCaXRXaWR0aChlLHQuYml0V2lkdGgpLHlyLmFkZElzU2lnbmVkKGUsdC5pc1NpZ25lZCkseXIuZW5kSW50KGUpfXZpc2l0RmxvYXQodCxlKXtyZXR1cm4gU3Iuc3RhcnRGbG9hdGluZ1BvaW50KGUpLFNyLmFkZFByZWNpc2lvbihlLHQucHJlY2lzaW9uKSxTci5lbmRGbG9hdGluZ1BvaW50KGUpfXZpc2l0QmluYXJ5KHQsZSl7cmV0dXJuIGdyLnN0YXJ0QmluYXJ5KGUpLGdyLmVuZEJpbmFyeShlKX12aXNpdEJvb2wodCxlKXtyZXR1cm4gbXIuc3RhcnRCb29sKGUpLG1yLmVuZEJvb2woZSl9dmlzaXRVdGY4KHQsZSl7cmV0dXJuIExyLnN0YXJ0VXRmOChlKSxMci5lbmRVdGY4KGUpfXZpc2l0RGVjaW1hbCh0LGUpe3JldHVybiB2ci5zdGFydERlY2ltYWwoZSksdnIuYWRkU2NhbGUoZSx0LnNjYWxlKSx2ci5hZGRQcmVjaXNpb24oZSx0LnByZWNpc2lvbiksdnIuYWRkQml0V2lkdGgoZSx0LmJpdFdpZHRoKSx2ci5lbmREZWNpbWFsKGUpfXZpc2l0RGF0ZSh0LGUpe3JldHVybiBfci5zdGFydERhdGUoZSksX3IuYWRkVW5pdChlLHQudW5pdCksX3IuZW5kRGF0ZShlKX12aXNpdFRpbWUodCxlKXtyZXR1cm4geHIuc3RhcnRUaW1lKGUpLHhyLmFkZFVuaXQoZSx0LnVuaXQpLHhyLmFkZEJpdFdpZHRoKGUsdC5iaXRXaWR0aCkseHIuZW5kVGltZShlKX12aXNpdFRpbWVzdGFtcCh0LGUpe2NvbnN0IGk9dC50aW1lem9uZSYmZS5jcmVhdGVTdHJpbmcodC50aW1lem9uZSl8fHZvaWQgMDtyZXR1cm4gTXIuc3RhcnRUaW1lc3RhbXAoZSksTXIuYWRkVW5pdChlLHQudW5pdCksdm9pZCAwIT09aSYmTXIuYWRkVGltZXpvbmUoZSxpKSxNci5lbmRUaW1lc3RhbXAoZSl9dmlzaXRJbnRlcnZhbCh0LGUpe3JldHVybiBCci5zdGFydEludGVydmFsKGUpLEJyLmFkZFVuaXQoZSx0LnVuaXQpLEJyLmVuZEludGVydmFsKGUpfXZpc2l0TGlzdCh0LGUpe3JldHVybiBBci5zdGFydExpc3QoZSksQXIuZW5kTGlzdChlKX12aXNpdFN0cnVjdCh0LGUpe3JldHVybiBEci5zdGFydFN0cnVjdF8oZSksRHIuZW5kU3RydWN0XyhlKX12aXNpdFVuaW9uKHQsZSl7RnIuc3RhcnRUeXBlSWRzVmVjdG9yKGUsdC50eXBlSWRzLmxlbmd0aCk7Y29uc3QgaT1Gci5jcmVhdGVUeXBlSWRzVmVjdG9yKGUsdC50eXBlSWRzKTtyZXR1cm4gRnIuc3RhcnRVbmlvbihlKSxGci5hZGRNb2RlKGUsdC5tb2RlKSxGci5hZGRUeXBlSWRzKGUsaSksRnIuZW5kVW5pb24oZSl9dmlzaXREaWN0aW9uYXJ5KHQsZSl7Y29uc3QgaT10aGlzLnZpc2l0KHQuaW5kaWNlcyxlKTtyZXR1cm4gYnIuc3RhcnREaWN0aW9uYXJ5RW5jb2RpbmcoZSksYnIuYWRkSWQoZSxuZXcgUm8odC5pZCwwKSksYnIuYWRkSXNPcmRlcmVkKGUsdC5pc09yZGVyZWQpLHZvaWQgMCE9PWkmJmJyLmFkZEluZGV4VHlwZShlLGkpLGJyLmVuZERpY3Rpb25hcnlFbmNvZGluZyhlKX12aXNpdEZpeGVkU2l6ZUJpbmFyeSh0LGUpe3JldHVybiB3ci5zdGFydEZpeGVkU2l6ZUJpbmFyeShlKSx3ci5hZGRCeXRlV2lkdGgoZSx0LmJ5dGVXaWR0aCksd3IuZW5kRml4ZWRTaXplQmluYXJ5KGUpfXZpc2l0Rml4ZWRTaXplTGlzdCh0LGUpe3JldHVybiBJci5zdGFydEZpeGVkU2l6ZUxpc3QoZSksSXIuYWRkTGlzdFNpemUoZSx0Lmxpc3RTaXplKSxJci5lbmRGaXhlZFNpemVMaXN0KGUpfXZpc2l0TWFwKHQsZSl7cmV0dXJuIFRyLnN0YXJ0TWFwKGUpLFRyLmFkZEtleXNTb3J0ZWQoZSx0LmtleXNTb3J0ZWQpLFRyLmVuZE1hcChlKX19O2Z1bmN0aW9uIFBvKHQpe3JldHVybiBuZXcgcW8odC5jb3VudCxrbyh0LmNvbHVtbnMpLCRvKHQuY29sdW1ucykpfWZ1bmN0aW9uIGpvKHQsZSl7cmV0dXJuKHQuY2hpbGRyZW58fFtdKS5maWx0ZXIoQm9vbGVhbikubWFwKCh0PT5Wci5mcm9tSlNPTih0LGUpKSl9ZnVuY3Rpb24ga28odCl7cmV0dXJuKHR8fFtdKS5yZWR1Y2UoKCh0LGUpPT57cmV0dXJuWy4uLnQsbmV3IHRhKGUuY291bnQsKGk9ZS5WQUxJRElUWSwoaXx8W10pLnJlZHVjZSgoKHQsZSk9PnQrICsoMD09PWUpKSwwKSkpLC4uLmtvKGUuY2hpbGRyZW4pXTt2YXIgaX0pLFtdKX1mdW5jdGlvbiAkbyh0LGU9W10pe2ZvcihsZXQgaT0tMSxuPSh0fHxbXSkubGVuZ3RoOysraTxuOyl7Y29uc3Qgbj10W2ldO24uVkFMSURJVFkmJmUucHVzaChuZXcgWG8oZS5sZW5ndGgsbi5WQUxJRElUWS5sZW5ndGgpKSxuLlRZUEUmJmUucHVzaChuZXcgWG8oZS5sZW5ndGgsbi5UWVBFLmxlbmd0aCkpLG4uT0ZGU0VUJiZlLnB1c2gobmV3IFhvKGUubGVuZ3RoLG4uT0ZGU0VULmxlbmd0aCkpLG4uREFUQSYmZS5wdXNoKG5ldyBYbyhlLmxlbmd0aCxuLkRBVEEubGVuZ3RoKSksZT0kbyhuLmNoaWxkcmVuLGUpfXJldHVybiBlfWZ1bmN0aW9uIFlvKHQpe3JldHVybiBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKHR8fHt9KSl9ZnVuY3Rpb24gV28odCl7cmV0dXJuIG5ldyBuZSh0LmlzU2lnbmVkLHQuYml0V2lkdGgpfWZ1bmN0aW9uIEhvKHQsZSl7Y29uc3QgaT10LnR5cGUubmFtZTtzd2l0Y2goaSl7Y2FzZSJOT05FIjpjYXNlIm51bGwiOnJldHVybiBuZXcgaWU7Y2FzZSJiaW5hcnkiOnJldHVybiBuZXcgeWU7Y2FzZSJ1dGY4IjpyZXR1cm4gbmV3IGJlO2Nhc2UiYm9vbCI6cmV0dXJuIG5ldyBnZTtjYXNlImxpc3QiOnJldHVybiBuZXcgQmUoKGV8fFtdKVswXSk7Y2FzZSJzdHJ1Y3QiOmNhc2Uic3RydWN0XyI6cmV0dXJuIG5ldyBBZShlfHxbXSl9c3dpdGNoKGkpe2Nhc2UiaW50Ijp7Y29uc3QgZT10LnR5cGU7cmV0dXJuIG5ldyBuZShlLmlzU2lnbmVkLGUuYml0V2lkdGgpfWNhc2UiZmxvYXRpbmdwb2ludCI6e2NvbnN0IGU9dC50eXBlO3JldHVybiBuZXcgZGUoaHRbZS5wcmVjaXNpb25dKX1jYXNlImRlY2ltYWwiOntjb25zdCBlPXQudHlwZTtyZXR1cm4gbmV3IG1lKGUuc2NhbGUsZS5wcmVjaXNpb24sZS5iaXRXaWR0aCl9Y2FzZSJkYXRlIjp7Y29uc3QgZT10LnR5cGU7cmV0dXJuIG5ldyBfZShkdFtlLnVuaXRdKX1jYXNlInRpbWUiOntjb25zdCBlPXQudHlwZTtyZXR1cm4gbmV3IHdlKGZ0W2UudW5pdF0sZS5iaXRXaWR0aCl9Y2FzZSJ0aW1lc3RhbXAiOntjb25zdCBlPXQudHlwZTtyZXR1cm4gbmV3IEllKGZ0W2UudW5pdF0sZS50aW1lem9uZSl9Y2FzZSJpbnRlcnZhbCI6e2NvbnN0IGU9dC50eXBlO3JldHVybiBuZXcgU2UoYnRbZS51bml0XSl9Y2FzZSJ1bmlvbiI6e2NvbnN0IGk9dC50eXBlO3JldHVybiBuZXcgVGUobHRbaS5tb2RlXSxpLnR5cGVJZHN8fFtdLGV8fFtdKX1jYXNlImZpeGVkc2l6ZWJpbmFyeSI6e2NvbnN0IGU9dC50eXBlO3JldHVybiBuZXcgT2UoZS5ieXRlV2lkdGgpfWNhc2UiZml4ZWRzaXplbGlzdCI6e2NvbnN0IGk9dC50eXBlO3JldHVybiBuZXcgRGUoaS5saXN0U2l6ZSwoZXx8W10pWzBdKX1jYXNlIm1hcCI6e2NvbnN0IGk9dC50eXBlO3JldHVybiBuZXcgeGUoKGV8fFtdKVswXSxpLmtleXNTb3J0ZWQpfX10aHJvdyBuZXcgRXJyb3IoYFVucmVjb2duaXplZCB0eXBlOiAiJHtpfSJgKX12YXIgS289UW4sSm89cHIsR289ZHI7Y2xhc3MgWm97Y29uc3RydWN0b3IodCxlLGksbil7dGhpcy5fdmVyc2lvbj1lLHRoaXMuX2hlYWRlclR5cGU9aSx0aGlzLmJvZHk9bmV3IFVpbnQ4QXJyYXkoMCksbiYmKHRoaXMuX2NyZWF0ZUhlYWRlcj0oKT0+biksdGhpcy5fYm9keUxlbmd0aD0ibnVtYmVyIj09dHlwZW9mIHQ/dDp0Lmxvd31zdGF0aWMgZnJvbUpTT04odCxlKXtjb25zdCBpPW5ldyBabygwLG90LlY0LGUpO3JldHVybiBpLl9jcmVhdGVIZWFkZXI9ZnVuY3Rpb24odCxlKXtyZXR1cm4oKT0+e3N3aXRjaChlKXtjYXNlIG10LlNjaGVtYTpyZXR1cm4gRXIuZnJvbUpTT04odCk7Y2FzZSBtdC5SZWNvcmRCYXRjaDpyZXR1cm4gcW8uZnJvbUpTT04odCk7Y2FzZSBtdC5EaWN0aW9uYXJ5QmF0Y2g6cmV0dXJuIFFvLmZyb21KU09OKHQpfXRocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pemVkIE1lc3NhZ2UgdHlwZTogeyBuYW1lOiAke210W2VdfSwgdHlwZTogJHtlfSB9YCl9fSh0LGUpLGl9c3RhdGljIGRlY29kZSh0KXt0PW5ldyBHbyhaKHQpKTtjb25zdCBlPVZvLmdldFJvb3RBc01lc3NhZ2UodCksaT1lLmJvZHlMZW5ndGgoKSxuPWUudmVyc2lvbigpLHI9ZS5oZWFkZXJUeXBlKCkscz1uZXcgWm8oaSxuLHIpO3JldHVybiBzLl9jcmVhdGVIZWFkZXI9ZnVuY3Rpb24odCxlKXtyZXR1cm4oKT0+e3N3aXRjaChlKXtjYXNlIG10LlNjaGVtYTpyZXR1cm4gRXIuZGVjb2RlKHQuaGVhZGVyKG5ldyBVcikpO2Nhc2UgbXQuUmVjb3JkQmF0Y2g6cmV0dXJuIHFvLmRlY29kZSh0LmhlYWRlcihuZXcgQ28pLHQudmVyc2lvbigpKTtjYXNlIG10LkRpY3Rpb25hcnlCYXRjaDpyZXR1cm4gUW8uZGVjb2RlKHQuaGVhZGVyKG5ldyBFbyksdC52ZXJzaW9uKCkpfXRocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pemVkIE1lc3NhZ2UgdHlwZTogeyBuYW1lOiAke210W2VdfSwgdHlwZTogJHtlfSB9YCl9fShlLHIpLHN9c3RhdGljIGVuY29kZSh0KXtjb25zdCBlPW5ldyBKbztsZXQgaT0tMTtyZXR1cm4gdC5pc1NjaGVtYSgpP2k9RXIuZW5jb2RlKGUsdC5oZWFkZXIoKSk6dC5pc1JlY29yZEJhdGNoKCk/aT1xby5lbmNvZGUoZSx0LmhlYWRlcigpKTp0LmlzRGljdGlvbmFyeUJhdGNoKCkmJihpPVFvLmVuY29kZShlLHQuaGVhZGVyKCkpKSxWby5zdGFydE1lc3NhZ2UoZSksVm8uYWRkVmVyc2lvbihlLG90LlY0KSxWby5hZGRIZWFkZXIoZSxpKSxWby5hZGRIZWFkZXJUeXBlKGUsdC5oZWFkZXJUeXBlKSxWby5hZGRCb2R5TGVuZ3RoKGUsbmV3IEtvKHQuYm9keUxlbmd0aCwwKSksVm8uZmluaXNoTWVzc2FnZUJ1ZmZlcihlLFZvLmVuZE1lc3NhZ2UoZSkpLGUuYXNVaW50OEFycmF5KCl9c3RhdGljIGZyb20odCxlPTApe2lmKHQgaW5zdGFuY2VvZiBFcilyZXR1cm4gbmV3IFpvKDAsb3QuVjQsbXQuU2NoZW1hLHQpO2lmKHQgaW5zdGFuY2VvZiBxbylyZXR1cm4gbmV3IFpvKGUsb3QuVjQsbXQuUmVjb3JkQmF0Y2gsdCk7aWYodCBpbnN0YW5jZW9mIFFvKXJldHVybiBuZXcgWm8oZSxvdC5WNCxtdC5EaWN0aW9uYXJ5QmF0Y2gsdCk7dGhyb3cgbmV3IEVycm9yKGBVbnJlY29nbml6ZWQgTWVzc2FnZSBoZWFkZXI6ICR7dH1gKX1nZXQgdHlwZSgpe3JldHVybiB0aGlzLmhlYWRlclR5cGV9Z2V0IHZlcnNpb24oKXtyZXR1cm4gdGhpcy5fdmVyc2lvbn1nZXQgaGVhZGVyVHlwZSgpe3JldHVybiB0aGlzLl9oZWFkZXJUeXBlfWdldCBib2R5TGVuZ3RoKCl7cmV0dXJuIHRoaXMuX2JvZHlMZW5ndGh9aGVhZGVyKCl7cmV0dXJuIHRoaXMuX2NyZWF0ZUhlYWRlcigpfWlzU2NoZW1hKCl7cmV0dXJuIHRoaXMuaGVhZGVyVHlwZT09PW10LlNjaGVtYX1pc1JlY29yZEJhdGNoKCl7cmV0dXJuIHRoaXMuaGVhZGVyVHlwZT09PW10LlJlY29yZEJhdGNofWlzRGljdGlvbmFyeUJhdGNoKCl7cmV0dXJuIHRoaXMuaGVhZGVyVHlwZT09PW10LkRpY3Rpb25hcnlCYXRjaH19Y2xhc3MgcW97Y29uc3RydWN0b3IodCxlLGkpe3RoaXMuX25vZGVzPWUsdGhpcy5fYnVmZmVycz1pLHRoaXMuX2xlbmd0aD0ibnVtYmVyIj09dHlwZW9mIHQ/dDp0Lmxvd31nZXQgbm9kZXMoKXtyZXR1cm4gdGhpcy5fbm9kZXN9Z2V0IGxlbmd0aCgpe3JldHVybiB0aGlzLl9sZW5ndGh9Z2V0IGJ1ZmZlcnMoKXtyZXR1cm4gdGhpcy5fYnVmZmVyc319Y2xhc3MgUW97Y29uc3RydWN0b3IodCxlLGk9ITEpe3RoaXMuX2RhdGE9dCx0aGlzLl9pc0RlbHRhPWksdGhpcy5faWQ9Im51bWJlciI9PXR5cGVvZiBlP2U6ZS5sb3d9Z2V0IGlkKCl7cmV0dXJuIHRoaXMuX2lkfWdldCBkYXRhKCl7cmV0dXJuIHRoaXMuX2RhdGF9Z2V0IGlzRGVsdGEoKXtyZXR1cm4gdGhpcy5faXNEZWx0YX1nZXQgbGVuZ3RoKCl7cmV0dXJuIHRoaXMuZGF0YS5sZW5ndGh9Z2V0IG5vZGVzKCl7cmV0dXJuIHRoaXMuZGF0YS5ub2Rlc31nZXQgYnVmZmVycygpe3JldHVybiB0aGlzLmRhdGEuYnVmZmVyc319Y2xhc3MgWG97Y29uc3RydWN0b3IodCxlKXt0aGlzLm9mZnNldD0ibnVtYmVyIj09dHlwZW9mIHQ/dDp0Lmxvdyx0aGlzLmxlbmd0aD0ibnVtYmVyIj09dHlwZW9mIGU/ZTplLmxvd319Y2xhc3MgdGF7Y29uc3RydWN0b3IodCxlKXt0aGlzLmxlbmd0aD0ibnVtYmVyIj09dHlwZW9mIHQ/dDp0Lmxvdyx0aGlzLm51bGxDb3VudD0ibnVtYmVyIj09dHlwZW9mIGU/ZTplLmxvd319ZnVuY3Rpb24gZWEodCxlKXtjb25zdCBpPVtdO2ZvcihsZXQgbixyPS0xLHM9LTEsbz10LmNoaWxkcmVuTGVuZ3RoKCk7KytyPG87KShuPXQuY2hpbGRyZW4ocikpJiYoaVsrK3NdPVZyLmRlY29kZShuLGUpKTtyZXR1cm4gaX1mdW5jdGlvbiBpYSh0KXtjb25zdCBlPW5ldyBNYXA7aWYodClmb3IobGV0IGksbixyPS0xLHM9TWF0aC50cnVuYyh0LmN1c3RvbU1ldGFkYXRhTGVuZ3RoKCkpOysrcjxzOykoaT10LmN1c3RvbU1ldGFkYXRhKHIpKSYmbnVsbCE9KG49aS5rZXkoKSkmJmUuc2V0KG4saS52YWx1ZSgpKTtyZXR1cm4gZX1mdW5jdGlvbiBuYSh0KXtyZXR1cm4gbmV3IG5lKHQuaXNTaWduZWQoKSx0LmJpdFdpZHRoKCkpfWZ1bmN0aW9uIHJhKHQsZSl7Y29uc3QgaT10LnR5cGVUeXBlKCk7c3dpdGNoKGkpe2Nhc2UgdXIuTk9ORTpjYXNlIHVyLk51bGw6cmV0dXJuIG5ldyBpZTtjYXNlIHVyLkJpbmFyeTpyZXR1cm4gbmV3IHllO2Nhc2UgdXIuVXRmODpyZXR1cm4gbmV3IGJlO2Nhc2UgdXIuQm9vbDpyZXR1cm4gbmV3IGdlO2Nhc2UgdXIuTGlzdDpyZXR1cm4gbmV3IEJlKChlfHxbXSlbMF0pO2Nhc2UgdXIuU3RydWN0XzpyZXR1cm4gbmV3IEFlKGV8fFtdKX1zd2l0Y2goaSl7Y2FzZSB1ci5JbnQ6e2NvbnN0IGU9dC50eXBlKG5ldyB5cik7cmV0dXJuIG5ldyBuZShlLmlzU2lnbmVkKCksZS5iaXRXaWR0aCgpKX1jYXNlIHVyLkZsb2F0aW5nUG9pbnQ6e2NvbnN0IGU9dC50eXBlKG5ldyBTcik7cmV0dXJuIG5ldyBkZShlLnByZWNpc2lvbigpKX1jYXNlIHVyLkRlY2ltYWw6e2NvbnN0IGU9dC50eXBlKG5ldyB2cik7cmV0dXJuIG5ldyBtZShlLnNjYWxlKCksZS5wcmVjaXNpb24oKSxlLmJpdFdpZHRoKCkpfWNhc2UgdXIuRGF0ZTp7Y29uc3QgZT10LnR5cGUobmV3IF9yKTtyZXR1cm4gbmV3IF9lKGUudW5pdCgpKX1jYXNlIHVyLlRpbWU6e2NvbnN0IGU9dC50eXBlKG5ldyB4cik7cmV0dXJuIG5ldyB3ZShlLnVuaXQoKSxlLmJpdFdpZHRoKCkpfWNhc2UgdXIuVGltZXN0YW1wOntjb25zdCBlPXQudHlwZShuZXcgTXIpO3JldHVybiBuZXcgSWUoZS51bml0KCksZS50aW1lem9uZSgpKX1jYXNlIHVyLkludGVydmFsOntjb25zdCBlPXQudHlwZShuZXcgQnIpO3JldHVybiBuZXcgU2UoZS51bml0KCkpfWNhc2UgdXIuVW5pb246e2NvbnN0IGk9dC50eXBlKG5ldyBGcik7cmV0dXJuIG5ldyBUZShpLm1vZGUoKSxpLnR5cGVJZHNBcnJheSgpfHxbXSxlfHxbXSl9Y2FzZSB1ci5GaXhlZFNpemVCaW5hcnk6e2NvbnN0IGU9dC50eXBlKG5ldyB3cik7cmV0dXJuIG5ldyBPZShlLmJ5dGVXaWR0aCgpKX1jYXNlIHVyLkZpeGVkU2l6ZUxpc3Q6e2NvbnN0IGk9dC50eXBlKG5ldyBJcik7cmV0dXJuIG5ldyBEZShpLmxpc3RTaXplKCksKGV8fFtdKVswXSl9Y2FzZSB1ci5NYXA6e2NvbnN0IGk9dC50eXBlKG5ldyBUcik7cmV0dXJuIG5ldyB4ZSgoZXx8W10pWzBdLGkua2V5c1NvcnRlZCgpKX19dGhyb3cgbmV3IEVycm9yKGBVbnJlY29nbml6ZWQgdHlwZTogIiR7dXJbaV19IiAoJHtpfSlgKX1Wci5lbmNvZGU9ZnVuY3Rpb24odCxlKXtsZXQgaT0tMSxuPS0xLHI9LTE7Y29uc3Qgcz1lLnR5cGU7bGV0IG89ZS50eXBlSWQ7ZWUuaXNEaWN0aW9uYXJ5KHMpPyhvPXMuZGljdGlvbmFyeS50eXBlSWQscj16by52aXNpdChzLHQpLG49em8udmlzaXQocy5kaWN0aW9uYXJ5LHQpKTpuPXpvLnZpc2l0KHMsdCk7Y29uc3QgYT0ocy5jaGlsZHJlbnx8W10pLm1hcCgoZT0+VnIuZW5jb2RlKHQsZSkpKSxsPU5yLmNyZWF0ZUNoaWxkcmVuVmVjdG9yKHQsYSksYz1lLm1ldGFkYXRhJiZlLm1ldGFkYXRhLnNpemU+MD9Oci5jcmVhdGVDdXN0b21NZXRhZGF0YVZlY3Rvcih0LFsuLi5lLm1ldGFkYXRhXS5tYXAoKChbZSxpXSk9Pntjb25zdCBuPXQuY3JlYXRlU3RyaW5nKGAke2V9YCkscj10LmNyZWF0ZVN0cmluZyhgJHtpfWApO3JldHVybiBmci5zdGFydEtleVZhbHVlKHQpLGZyLmFkZEtleSh0LG4pLGZyLmFkZFZhbHVlKHQsciksZnIuZW5kS2V5VmFsdWUodCl9KSkpOi0xO2UubmFtZSYmKGk9dC5jcmVhdGVTdHJpbmcoZS5uYW1lKSk7TnIuc3RhcnRGaWVsZCh0KSxOci5hZGRUeXBlKHQsbiksTnIuYWRkVHlwZVR5cGUodCxvKSxOci5hZGRDaGlsZHJlbih0LGwpLE5yLmFkZE51bGxhYmxlKHQsISFlLm51bGxhYmxlKSwtMSE9PWkmJk5yLmFkZE5hbWUodCxpKTstMSE9PXImJk5yLmFkZERpY3Rpb25hcnkodCxyKTstMSE9PWMmJk5yLmFkZEN1c3RvbU1ldGFkYXRhKHQsYyk7cmV0dXJuIE5yLmVuZEZpZWxkKHQpfSxWci5kZWNvZGU9ZnVuY3Rpb24odCxlKXtsZXQgaSxuLHIscyxvLGE7ZSYmKGE9dC5kaWN0aW9uYXJ5KCkpP2UuaGFzKGk9YS5pZCgpLmxvdyk/KHM9KHM9YS5pbmRleFR5cGUoKSk/bmEocyk6bmV3IG9lLG89bmV3IExlKGUuZ2V0KGkpLHMsaSxhLmlzT3JkZXJlZCgpKSxuPW5ldyBWcih0Lm5hbWUoKSxvLHQubnVsbGFibGUoKSxpYSh0KSkpOihzPShzPWEuaW5kZXhUeXBlKCkpP25hKHMpOm5ldyBvZSxlLnNldChpLHI9cmEodCxlYSh0LGUpKSksbz1uZXcgTGUocixzLGksYS5pc09yZGVyZWQoKSksbj1uZXcgVnIodC5uYW1lKCksbyx0Lm51bGxhYmxlKCksaWEodCkpKToocj1yYSh0LGVhKHQsZSkpLG49bmV3IFZyKHQubmFtZSgpLHIsdC5udWxsYWJsZSgpLGlhKHQpKSk7cmV0dXJuIG58fG51bGx9LFZyLmZyb21KU09OPWZ1bmN0aW9uKHQsZSl7bGV0IGksbixyLHMsbyxhO3JldHVybiBlJiYocz10LmRpY3Rpb25hcnkpP2UuaGFzKGk9cy5pZCk/KG49KG49cy5pbmRleFR5cGUpP1dvKG4pOm5ldyBvZSxhPW5ldyBMZShlLmdldChpKSxuLGkscy5pc09yZGVyZWQpLHI9bmV3IFZyKHQubmFtZSxhLHQubnVsbGFibGUsWW8odC5jdXN0b21NZXRhZGF0YSkpKToobj0obj1zLmluZGV4VHlwZSk/V28obik6bmV3IG9lLGUuc2V0KGksbz1Ibyh0LGpvKHQsZSkpKSxhPW5ldyBMZShvLG4saSxzLmlzT3JkZXJlZCkscj1uZXcgVnIodC5uYW1lLGEsdC5udWxsYWJsZSxZbyh0LmN1c3RvbU1ldGFkYXRhKSkpOihvPUhvKHQsam8odCxlKSkscj1uZXcgVnIodC5uYW1lLG8sdC5udWxsYWJsZSxZbyh0LmN1c3RvbU1ldGFkYXRhKSkpLHJ8fG51bGx9LEVyLmVuY29kZT1mdW5jdGlvbih0LGUpe2NvbnN0IGk9ZS5maWVsZHMubWFwKChlPT5Wci5lbmNvZGUodCxlKSkpO1VyLnN0YXJ0RmllbGRzVmVjdG9yKHQsaS5sZW5ndGgpO2NvbnN0IG49VXIuY3JlYXRlRmllbGRzVmVjdG9yKHQsaSkscj1lLm1ldGFkYXRhJiZlLm1ldGFkYXRhLnNpemU+MD9Vci5jcmVhdGVDdXN0b21NZXRhZGF0YVZlY3Rvcih0LFsuLi5lLm1ldGFkYXRhXS5tYXAoKChbZSxpXSk9Pntjb25zdCBuPXQuY3JlYXRlU3RyaW5nKGAke2V9YCkscj10LmNyZWF0ZVN0cmluZyhgJHtpfWApO3JldHVybiBmci5zdGFydEtleVZhbHVlKHQpLGZyLmFkZEtleSh0LG4pLGZyLmFkZFZhbHVlKHQsciksZnIuZW5kS2V5VmFsdWUodCl9KSkpOi0xO1VyLnN0YXJ0U2NoZW1hKHQpLFVyLmFkZEZpZWxkcyh0LG4pLFVyLmFkZEVuZGlhbm5lc3ModCxzYT9pci5MaXR0bGU6aXIuQmlnKSwtMSE9PXImJlVyLmFkZEN1c3RvbU1ldGFkYXRhKHQscik7cmV0dXJuIFVyLmVuZFNjaGVtYSh0KX0sRXIuZGVjb2RlPWZ1bmN0aW9uKHQsZT1uZXcgTWFwKXtjb25zdCBpPWZ1bmN0aW9uKHQsZSl7Y29uc3QgaT1bXTtmb3IobGV0IG4scj0tMSxzPS0xLG89dC5maWVsZHNMZW5ndGgoKTsrK3I8bzspKG49dC5maWVsZHMocikpJiYoaVsrK3NdPVZyLmRlY29kZShuLGUpKTtyZXR1cm4gaX0odCxlKTtyZXR1cm4gbmV3IEVyKGksaWEodCksZSl9LEVyLmZyb21KU09OPWZ1bmN0aW9uKHQsZT1uZXcgTWFwKXtyZXR1cm4gbmV3IEVyKGZ1bmN0aW9uKHQsZSl7cmV0dXJuKHQuZmllbGRzfHxbXSkuZmlsdGVyKEJvb2xlYW4pLm1hcCgodD0+VnIuZnJvbUpTT04odCxlKSkpfSh0LGUpLFlvKHQuY3VzdG9tTWV0YWRhdGEpLGUpfSxxby5lbmNvZGU9ZnVuY3Rpb24odCxlKXtjb25zdCBpPWUubm9kZXN8fFtdLG49ZS5idWZmZXJzfHxbXTtDby5zdGFydE5vZGVzVmVjdG9yKHQsaS5sZW5ndGgpO2Zvcihjb25zdCBvIG9mIGkuc2xpY2UoKS5yZXZlcnNlKCkpdGEuZW5jb2RlKHQsbyk7Y29uc3Qgcj10LmVuZFZlY3RvcigpO0NvLnN0YXJ0QnVmZmVyc1ZlY3Rvcih0LG4ubGVuZ3RoKTtmb3IoY29uc3QgbyBvZiBuLnNsaWNlKCkucmV2ZXJzZSgpKVhvLmVuY29kZSh0LG8pO2NvbnN0IHM9dC5lbmRWZWN0b3IoKTtyZXR1cm4gQ28uc3RhcnRSZWNvcmRCYXRjaCh0KSxDby5hZGRMZW5ndGgodCxuZXcgS28oZS5sZW5ndGgsMCkpLENvLmFkZE5vZGVzKHQsciksQ28uYWRkQnVmZmVycyh0LHMpLENvLmVuZFJlY29yZEJhdGNoKHQpfSxxby5kZWNvZGU9ZnVuY3Rpb24odCxlPW90LlY0KXtyZXR1cm4gbmV3IHFvKHQubGVuZ3RoKCksZnVuY3Rpb24odCl7Y29uc3QgZT1bXTtmb3IobGV0IGksbj0tMSxyPS0xLHM9dC5ub2Rlc0xlbmd0aCgpOysrbjxzOykoaT10Lm5vZGVzKG4pKSYmKGVbKytyXT10YS5kZWNvZGUoaSkpO3JldHVybiBlfSh0KSxmdW5jdGlvbih0LGUpe2NvbnN0IGk9W107Zm9yKGxldCBuLHI9LTEscz0tMSxvPXQuYnVmZmVyc0xlbmd0aCgpOysrcjxvOykobj10LmJ1ZmZlcnMocikpJiYoZTxvdC5WNCYmKG4uYmJfcG9zKz04KihyKzEpKSxpWysrc109WG8uZGVjb2RlKG4pKTtyZXR1cm4gaX0odCxlKSl9LHFvLmZyb21KU09OPVBvLFFvLmVuY29kZT1mdW5jdGlvbih0LGUpe2NvbnN0IGk9cW8uZW5jb2RlKHQsZS5kYXRhKTtyZXR1cm4gRW8uc3RhcnREaWN0aW9uYXJ5QmF0Y2godCksRW8uYWRkSWQodCxuZXcgS28oZS5pZCwwKSksRW8uYWRkSXNEZWx0YSh0LGUuaXNEZWx0YSksRW8uYWRkRGF0YSh0LGkpLEVvLmVuZERpY3Rpb25hcnlCYXRjaCh0KX0sUW8uZGVjb2RlPWZ1bmN0aW9uKHQsZT1vdC5WNCl7cmV0dXJuIG5ldyBRbyhxby5kZWNvZGUodC5kYXRhKCksZSksdC5pZCgpLHQuaXNEZWx0YSgpKX0sUW8uZnJvbUpTT049ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBRbyhQbyh0LmRhdGEpLHQuaWQsdC5pc0RlbHRhKX0sdGEuZW5jb2RlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIFVvLmNyZWF0ZUZpZWxkTm9kZSh0LG5ldyBLbyhlLmxlbmd0aCwwKSxuZXcgS28oZS5udWxsQ291bnQsMCkpfSx0YS5kZWNvZGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyB0YSh0Lmxlbmd0aCgpLHQubnVsbENvdW50KCkpfSxYby5lbmNvZGU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gTm8uY3JlYXRlQnVmZmVyKHQsbmV3IEtvKGUub2Zmc2V0LDApLG5ldyBLbyhlLmxlbmd0aCwwKSl9LFhvLmRlY29kZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IFhvKHQub2Zmc2V0KCksdC5sZW5ndGgoKSl9O2NvbnN0IHNhPSgoKT0+e2NvbnN0IHQ9bmV3IEFycmF5QnVmZmVyKDIpO3JldHVybiBuZXcgRGF0YVZpZXcodCkuc2V0SW50MTYoMCwyNTYsITApLDI1Nj09PW5ldyBJbnQxNkFycmF5KHQpWzBdfSkoKSxvYT10PT5gRXhwZWN0ZWQgJHttdFt0XX0gTWVzc2FnZSBpbiBzdHJlYW0sIGJ1dCB3YXMgbnVsbCBvciBsZW5ndGggMC5gLGFhPXQ9PmBIZWFkZXIgcG9pbnRlciBvZiBmbGF0YnVmZmVyLWVuY29kZWQgJHttdFt0XX0gTWVzc2FnZSBpcyBudWxsIG9yIGxlbmd0aCAwLmAsbGE9KHQsZSk9PmBFeHBlY3RlZCB0byByZWFkICR7dH0gbWV0YWRhdGEgYnl0ZXMsIGJ1dCBvbmx5IHJlYWQgJHtlfS5gLGNhPSh0LGUpPT5gRXhwZWN0ZWQgdG8gcmVhZCAke3R9IGJ5dGVzIGZvciBtZXNzYWdlIGJvZHksIGJ1dCBvbmx5IHJlYWQgJHtlfS5gO2NsYXNzIGhhe2NvbnN0cnVjdG9yKHQpe3RoaXMuc291cmNlPXQgaW5zdGFuY2VvZiBxcj90Om5ldyBxcih0KX1bU3ltYm9sLml0ZXJhdG9yXSgpe3JldHVybiB0aGlzfW5leHQoKXtsZXQgdDtyZXR1cm4odD10aGlzLnJlYWRNZXRhZGF0YUxlbmd0aCgpKS5kb25lfHwtMT09PXQudmFsdWUmJih0PXRoaXMucmVhZE1ldGFkYXRhTGVuZ3RoKCkpLmRvbmV8fCh0PXRoaXMucmVhZE1ldGFkYXRhKHQudmFsdWUpKS5kb25lP0hyOnR9dGhyb3codCl7cmV0dXJuIHRoaXMuc291cmNlLnRocm93KHQpfXJldHVybih0KXtyZXR1cm4gdGhpcy5zb3VyY2UucmV0dXJuKHQpfXJlYWRNZXNzYWdlKHQpe2xldCBlO2lmKChlPXRoaXMubmV4dCgpKS5kb25lKXJldHVybiBudWxsO2lmKG51bGwhPXQmJmUudmFsdWUuaGVhZGVyVHlwZSE9PXQpdGhyb3cgbmV3IEVycm9yKG9hKHQpKTtyZXR1cm4gZS52YWx1ZX1yZWFkTWVzc2FnZUJvZHkodCl7aWYodDw9MClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoMCk7Y29uc3QgZT1aKHRoaXMuc291cmNlLnJlYWQodCkpO2lmKGUuYnl0ZUxlbmd0aDx0KXRocm93IG5ldyBFcnJvcihjYSh0LGUuYnl0ZUxlbmd0aCkpO3JldHVybiBlLmJ5dGVPZmZzZXQlOD09MCYmZS5ieXRlT2Zmc2V0K2UuYnl0ZUxlbmd0aDw9ZS5idWZmZXIuYnl0ZUxlbmd0aD9lOmUuc2xpY2UoKX1yZWFkU2NoZW1hKHQ9ITEpe2NvbnN0IGU9bXQuU2NoZW1hLGk9dGhpcy5yZWFkTWVzc2FnZShlKSxuPW51bGw9PWk/dm9pZCAwOmkuaGVhZGVyKCk7aWYodCYmIW4pdGhyb3cgbmV3IEVycm9yKGFhKGUpKTtyZXR1cm4gbn1yZWFkTWV0YWRhdGFMZW5ndGgoKXtjb25zdCB0PXRoaXMuc291cmNlLnJlYWQocGEpLGU9dCYmbmV3IGRyKHQpLGk9KG51bGw9PWU/dm9pZCAwOmUucmVhZEludDMyKDApKXx8MDtyZXR1cm57ZG9uZTowPT09aSx2YWx1ZTppfX1yZWFkTWV0YWRhdGEodCl7Y29uc3QgZT10aGlzLnNvdXJjZS5yZWFkKHQpO2lmKCFlKXJldHVybiBIcjtpZihlLmJ5dGVMZW5ndGg8dCl0aHJvdyBuZXcgRXJyb3IobGEodCxlLmJ5dGVMZW5ndGgpKTtyZXR1cm57ZG9uZTohMSx2YWx1ZTpaby5kZWNvZGUoZSl9fX1jbGFzcyB1YXtjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuc291cmNlPXQgaW5zdGFuY2VvZiBRcj90OlAodCk/bmV3IGlzKHQsZSk6bmV3IFFyKHQpfVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtyZXR1cm4gdGhpc31uZXh0KCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtsZXQgdDtyZXR1cm4odD15aWVsZCB0aGlzLnJlYWRNZXRhZGF0YUxlbmd0aCgpKS5kb25lfHwtMT09PXQudmFsdWUmJih0PXlpZWxkIHRoaXMucmVhZE1ldGFkYXRhTGVuZ3RoKCkpLmRvbmV8fCh0PXlpZWxkIHRoaXMucmVhZE1ldGFkYXRhKHQudmFsdWUpKS5kb25lP0hyOnR9KSl9dGhyb3codCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5zb3VyY2UudGhyb3codCl9KSl9cmV0dXJuKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMuc291cmNlLnJldHVybih0KX0pKX1yZWFkTWVzc2FnZSh0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2xldCBlO2lmKChlPXlpZWxkIHRoaXMubmV4dCgpKS5kb25lKXJldHVybiBudWxsO2lmKG51bGwhPXQmJmUudmFsdWUuaGVhZGVyVHlwZSE9PXQpdGhyb3cgbmV3IEVycm9yKG9hKHQpKTtyZXR1cm4gZS52YWx1ZX0pKX1yZWFkTWVzc2FnZUJvZHkodCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtpZih0PD0wKXJldHVybiBuZXcgVWludDhBcnJheSgwKTtjb25zdCBlPVooeWllbGQgdGhpcy5zb3VyY2UucmVhZCh0KSk7aWYoZS5ieXRlTGVuZ3RoPHQpdGhyb3cgbmV3IEVycm9yKGNhKHQsZS5ieXRlTGVuZ3RoKSk7cmV0dXJuIGUuYnl0ZU9mZnNldCU4PT0wJiZlLmJ5dGVPZmZzZXQrZS5ieXRlTGVuZ3RoPD1lLmJ1ZmZlci5ieXRlTGVuZ3RoP2U6ZS5zbGljZSgpfSkpfXJlYWRTY2hlbWEodD0hMSl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtjb25zdCBlPW10LlNjaGVtYSxpPXlpZWxkIHRoaXMucmVhZE1lc3NhZ2UoZSksbj1udWxsPT1pP3ZvaWQgMDppLmhlYWRlcigpO2lmKHQmJiFuKXRocm93IG5ldyBFcnJvcihhYShlKSk7cmV0dXJuIG59KSl9cmVhZE1ldGFkYXRhTGVuZ3RoKCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtjb25zdCB0PXlpZWxkIHRoaXMuc291cmNlLnJlYWQocGEpLGU9dCYmbmV3IGRyKHQpLGk9KG51bGw9PWU/dm9pZCAwOmUucmVhZEludDMyKDApKXx8MDtyZXR1cm57ZG9uZTowPT09aSx2YWx1ZTppfX0pKX1yZWFkTWV0YWRhdGEodCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtjb25zdCBlPXlpZWxkIHRoaXMuc291cmNlLnJlYWQodCk7aWYoIWUpcmV0dXJuIEhyO2lmKGUuYnl0ZUxlbmd0aDx0KXRocm93IG5ldyBFcnJvcihsYSh0LGUuYnl0ZUxlbmd0aCkpO3JldHVybntkb25lOiExLHZhbHVlOlpvLmRlY29kZShlKX19KSl9fWNsYXNzIGRhIGV4dGVuZHMgaGF7Y29uc3RydWN0b3IodCl7c3VwZXIobmV3IFVpbnQ4QXJyYXkoMCkpLHRoaXMuX3NjaGVtYT0hMSx0aGlzLl9ib2R5PVtdLHRoaXMuX2JhdGNoSW5kZXg9MCx0aGlzLl9kaWN0aW9uYXJ5SW5kZXg9MCx0aGlzLl9qc29uPXQgaW5zdGFuY2VvZiBLcj90Om5ldyBLcih0KX1uZXh0KCl7Y29uc3R7X2pzb246dH09dGhpcztpZighdGhpcy5fc2NoZW1hKXt0aGlzLl9zY2hlbWE9ITA7cmV0dXJue2RvbmU6ITEsdmFsdWU6Wm8uZnJvbUpTT04odC5zY2hlbWEsbXQuU2NoZW1hKX19aWYodGhpcy5fZGljdGlvbmFyeUluZGV4PHQuZGljdGlvbmFyaWVzLmxlbmd0aCl7Y29uc3QgZT10LmRpY3Rpb25hcmllc1t0aGlzLl9kaWN0aW9uYXJ5SW5kZXgrK107dGhpcy5fYm9keT1lLmRhdGEuY29sdW1ucztyZXR1cm57ZG9uZTohMSx2YWx1ZTpaby5mcm9tSlNPTihlLG10LkRpY3Rpb25hcnlCYXRjaCl9fWlmKHRoaXMuX2JhdGNoSW5kZXg8dC5iYXRjaGVzLmxlbmd0aCl7Y29uc3QgZT10LmJhdGNoZXNbdGhpcy5fYmF0Y2hJbmRleCsrXTt0aGlzLl9ib2R5PWUuY29sdW1ucztyZXR1cm57ZG9uZTohMSx2YWx1ZTpaby5mcm9tSlNPTihlLG10LlJlY29yZEJhdGNoKX19cmV0dXJuIHRoaXMuX2JvZHk9W10sSHJ9cmVhZE1lc3NhZ2VCb2R5KHQpe3JldHVybiBmdW5jdGlvbiB0KGUpe3JldHVybihlfHxbXSkucmVkdWNlKCgoZSxpKT0+Wy4uLmUsLi4uaS5WQUxJRElUWSYmW2kuVkFMSURJVFldfHxbXSwuLi5pLlRZUEUmJltpLlRZUEVdfHxbXSwuLi5pLk9GRlNFVCYmW2kuT0ZGU0VUXXx8W10sLi4uaS5EQVRBJiZbaS5EQVRBXXx8W10sLi4udChpLmNoaWxkcmVuKV0pLFtdKX0odGhpcy5fYm9keSl9cmVhZE1lc3NhZ2UodCl7bGV0IGU7aWYoKGU9dGhpcy5uZXh0KCkpLmRvbmUpcmV0dXJuIG51bGw7aWYobnVsbCE9dCYmZS52YWx1ZS5oZWFkZXJUeXBlIT09dCl0aHJvdyBuZXcgRXJyb3Iob2EodCkpO3JldHVybiBlLnZhbHVlfXJlYWRTY2hlbWEoKXtjb25zdCB0PW10LlNjaGVtYSxlPXRoaXMucmVhZE1lc3NhZ2UodCksaT1udWxsPT1lP3ZvaWQgMDplLmhlYWRlcigpO2lmKCFlfHwhaSl0aHJvdyBuZXcgRXJyb3IoYWEodCkpO3JldHVybiBpfX1jb25zdCBwYT00LGZhPSJBUlJPVzEiLHlhPW5ldyBVaW50OEFycmF5KGZhLmxlbmd0aCk7Zm9yKGxldCBHYT0wO0dhPGZhLmxlbmd0aDtHYSs9MSl5YVtHYV09ZmEuY29kZVBvaW50QXQoR2EpO2Z1bmN0aW9uIGJhKHQsZT0wKXtmb3IobGV0IGk9LTEsbj15YS5sZW5ndGg7KytpPG47KWlmKHlhW2ldIT09dFtlK2ldKXJldHVybiExO3JldHVybiEwfWNvbnN0IGdhPXlhLmxlbmd0aCxtYT1nYStwYSxfYT0yKmdhK3BhO2NsYXNzIHZhIGV4dGVuZHMgSnJ7Y29uc3RydWN0b3IodCl7c3VwZXIoKSx0aGlzLl9pbXBsPXR9Z2V0IGNsb3NlZCgpe3JldHVybiB0aGlzLl9pbXBsLmNsb3NlZH1nZXQgc2NoZW1hKCl7cmV0dXJuIHRoaXMuX2ltcGwuc2NoZW1hfWdldCBhdXRvRGVzdHJveSgpe3JldHVybiB0aGlzLl9pbXBsLmF1dG9EZXN0cm95fWdldCBkaWN0aW9uYXJpZXMoKXtyZXR1cm4gdGhpcy5faW1wbC5kaWN0aW9uYXJpZXN9Z2V0IG51bURpY3Rpb25hcmllcygpe3JldHVybiB0aGlzLl9pbXBsLm51bURpY3Rpb25hcmllc31nZXQgbnVtUmVjb3JkQmF0Y2hlcygpe3JldHVybiB0aGlzLl9pbXBsLm51bVJlY29yZEJhdGNoZXN9Z2V0IGZvb3Rlcigpe3JldHVybiB0aGlzLl9pbXBsLmlzRmlsZSgpP3RoaXMuX2ltcGwuZm9vdGVyOm51bGx9aXNTeW5jKCl7cmV0dXJuIHRoaXMuX2ltcGwuaXNTeW5jKCl9aXNBc3luYygpe3JldHVybiB0aGlzLl9pbXBsLmlzQXN5bmMoKX1pc0ZpbGUoKXtyZXR1cm4gdGhpcy5faW1wbC5pc0ZpbGUoKX1pc1N0cmVhbSgpe3JldHVybiB0aGlzLl9pbXBsLmlzU3RyZWFtKCl9bmV4dCgpe3JldHVybiB0aGlzLl9pbXBsLm5leHQoKX10aHJvdyh0KXtyZXR1cm4gdGhpcy5faW1wbC50aHJvdyh0KX1yZXR1cm4odCl7cmV0dXJuIHRoaXMuX2ltcGwucmV0dXJuKHQpfWNhbmNlbCgpe3JldHVybiB0aGlzLl9pbXBsLmNhbmNlbCgpfXJlc2V0KHQpe3JldHVybiB0aGlzLl9pbXBsLnJlc2V0KHQpLHRoaXMuX0RPTVN0cmVhbT12b2lkIDAsdGhpcy5fbm9kZVN0cmVhbT12b2lkIDAsdGhpc31vcGVuKHQpe2NvbnN0IGU9dGhpcy5faW1wbC5vcGVuKHQpO3JldHVybiBDKGUpP2UudGhlbigoKCk9PnRoaXMpKTp0aGlzfXJlYWRSZWNvcmRCYXRjaCh0KXtyZXR1cm4gdGhpcy5faW1wbC5pc0ZpbGUoKT90aGlzLl9pbXBsLnJlYWRSZWNvcmRCYXRjaCh0KTpudWxsfVtTeW1ib2wuaXRlcmF0b3JdKCl7cmV0dXJuIHRoaXMuX2ltcGxbU3ltYm9sLml0ZXJhdG9yXSgpfVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtyZXR1cm4gdGhpcy5faW1wbFtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKX10b0RPTVN0cmVhbSgpe3JldHVybiBpdC50b0RPTVN0cmVhbSh0aGlzLmlzU3luYygpP3tbU3ltYm9sLml0ZXJhdG9yXTooKT0+dGhpc306e1tTeW1ib2wuYXN5bmNJdGVyYXRvcl06KCk9PnRoaXN9KX10b05vZGVTdHJlYW0oKXtyZXR1cm4gaXQudG9Ob2RlU3RyZWFtKHRoaXMuaXNTeW5jKCk/e1tTeW1ib2wuaXRlcmF0b3JdOigpPT50aGlzfTp7W1N5bWJvbC5hc3luY0l0ZXJhdG9yXTooKT0+dGhpc30se29iamVjdE1vZGU6ITB9KX1zdGF0aWMgdGhyb3VnaE5vZGUodCl7dGhyb3cgbmV3IEVycm9yKCcidGhyb3VnaE5vZGUiIG5vdCBhdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpfXN0YXRpYyB0aHJvdWdoRE9NKHQsZSl7dGhyb3cgbmV3IEVycm9yKCcidGhyb3VnaERPTSIgbm90IGF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyl9c3RhdGljIGZyb20odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiB2YT90OlIodCk/ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyB3YShuZXcgTWEodCkpfSh0KTpQKHQpP2Z1bmN0aW9uKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3R7c2l6ZTplfT15aWVsZCB0LnN0YXQoKSxpPW5ldyBpcyh0LGUpO3JldHVybiBlPj1fYSYmYmEoeWllbGQgaS5yZWFkQXQoMCxnYSs3Ji04KSk/bmV3IEJhKG5ldyB4YShpKSk6bmV3IElhKG5ldyBPYShpKSl9KSl9KHQpOkModCk/KCgpPT5iKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHZhLmZyb20oeWllbGQgdCl9KSkpKCk6aih0KXx8JCh0KXx8WSh0KXx8Vih0KT9mdW5jdGlvbih0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2NvbnN0IGU9eWllbGQgdC5wZWVrKGdhKzcmLTgpO3JldHVybiBlJiZlLmJ5dGVMZW5ndGg+PTQ/YmEoZSk/bmV3IFNhKG5ldyBEYSh5aWVsZCB0LnJlYWQoKSkpOm5ldyBJYShuZXcgT2EodCkpOm5ldyBJYShuZXcgT2EoZnVuY3Rpb24oKXtyZXR1cm4gXyh0aGlzLGFyZ3VtZW50cywoZnVuY3Rpb24qKCl7fSkpfSgpKSl9KSl9KG5ldyBRcih0KSk6ZnVuY3Rpb24odCl7Y29uc3QgZT10LnBlZWsoZ2ErNyYtOCk7cmV0dXJuIGUmJmUuYnl0ZUxlbmd0aD49ND9iYShlKT9uZXcgU2EobmV3IERhKHQucmVhZCgpKSk6bmV3IHdhKG5ldyBUYSh0KSk6bmV3IHdhKG5ldyBUYShmdW5jdGlvbiooKXt9KCkpKX0obmV3IHFyKHQpKX1zdGF0aWMgcmVhZEFsbCh0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIHZhP3QuaXNTeW5jKCk/TGEodCk6TmEodCk6Uih0KXx8QXJyYXlCdWZmZXIuaXNWaWV3KHQpfHxFKHQpfHx6KHQpP0xhKHQpOk5hKHQpfX1jbGFzcyB3YSBleHRlbmRzIHZhe2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuX2ltcGw9dH1yZWFkQWxsKCl7cmV0dXJuWy4uLnRoaXNdfVtTeW1ib2wuaXRlcmF0b3JdKCl7cmV0dXJuIHRoaXMuX2ltcGxbU3ltYm9sLml0ZXJhdG9yXSgpfVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtyZXR1cm4gXyh0aGlzLGFyZ3VtZW50cywoZnVuY3Rpb24qKCl7eWllbGQgbSh5aWVsZCp2KHcodGhpc1tTeW1ib2wuaXRlcmF0b3JdKCkpKSl9KSl9fWNsYXNzIElhIGV4dGVuZHMgdmF7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5faW1wbD10fXJlYWRBbGwoKXt2YXIgdCxlO3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3QgaT1uZXcgQXJyYXk7dHJ5e2Zvcih2YXIgbixyPXcodGhpcyk7IShuPXlpZWxkIHIubmV4dCgpKS5kb25lOyl7Y29uc3QgdD1uLnZhbHVlO2kucHVzaCh0KX19Y2F0Y2gocyl7dD17ZXJyb3I6c319ZmluYWxseXt0cnl7biYmIW4uZG9uZSYmKGU9ci5yZXR1cm4pJiYoeWllbGQgZS5jYWxsKHIpKX1maW5hbGx5e2lmKHQpdGhyb3cgdC5lcnJvcn19cmV0dXJuIGl9KSl9W1N5bWJvbC5pdGVyYXRvcl0oKXt0aHJvdyBuZXcgRXJyb3IoIkFzeW5jUmVjb3JkQmF0Y2hTdHJlYW1SZWFkZXIgaXMgbm90IEl0ZXJhYmxlIil9W1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpe3JldHVybiB0aGlzLl9pbXBsW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpfX1jbGFzcyBTYSBleHRlbmRzIHdhe2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuX2ltcGw9dH19Y2xhc3MgQmEgZXh0ZW5kcyBJYXtjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLl9pbXBsPXR9fWNsYXNzIEFhe2NvbnN0cnVjdG9yKHQ9bmV3IE1hcCl7dGhpcy5jbG9zZWQ9ITEsdGhpcy5hdXRvRGVzdHJveT0hMCx0aGlzLl9kaWN0aW9uYXJ5SW5kZXg9MCx0aGlzLl9yZWNvcmRCYXRjaEluZGV4PTAsdGhpcy5kaWN0aW9uYXJpZXM9dH1nZXQgbnVtRGljdGlvbmFyaWVzKCl7cmV0dXJuIHRoaXMuX2RpY3Rpb25hcnlJbmRleH1nZXQgbnVtUmVjb3JkQmF0Y2hlcygpe3JldHVybiB0aGlzLl9yZWNvcmRCYXRjaEluZGV4fWlzU3luYygpe3JldHVybiExfWlzQXN5bmMoKXtyZXR1cm4hMX1pc0ZpbGUoKXtyZXR1cm4hMX1pc1N0cmVhbSgpe3JldHVybiExfXJlc2V0KHQpe3JldHVybiB0aGlzLl9kaWN0aW9uYXJ5SW5kZXg9MCx0aGlzLl9yZWNvcmRCYXRjaEluZGV4PTAsdGhpcy5zY2hlbWE9dCx0aGlzLmRpY3Rpb25hcmllcz1uZXcgTWFwLHRoaXN9X2xvYWRSZWNvcmRCYXRjaCh0LGUpe2NvbnN0IGk9dGhpcy5fbG9hZFZlY3RvcnModCxlLHRoaXMuc2NoZW1hLmZpZWxkcyksbj1jbih7dHlwZTpuZXcgQWUodGhpcy5zY2hlbWEuZmllbGRzKSxsZW5ndGg6dC5sZW5ndGgsY2hpbGRyZW46aX0pO3JldHVybiBuZXcgRG8odGhpcy5zY2hlbWEsbil9X2xvYWREaWN0aW9uYXJ5QmF0Y2godCxlKXtjb25zdHtpZDppLGlzRGVsdGE6bn09dCx7ZGljdGlvbmFyaWVzOnIsc2NoZW1hOnN9PXRoaXMsbz1yLmdldChpKTtpZihufHwhbyl7Y29uc3Qgcj1zLmRpY3Rpb25hcmllcy5nZXQoaSksYT10aGlzLl9sb2FkVmVjdG9ycyh0LmRhdGEsZSxbcl0pO3JldHVybihvJiZuP28uY29uY2F0KG5ldyBDbihhKSk6bmV3IENuKGEpKS5tZW1vaXplKCl9cmV0dXJuIG8ubWVtb2l6ZSgpfV9sb2FkVmVjdG9ycyh0LGUsaSl7cmV0dXJuIG5ldyBjcyhlLHQubm9kZXMsdC5idWZmZXJzLHRoaXMuZGljdGlvbmFyaWVzKS52aXNpdE1hbnkoaSl9fWNsYXNzIFRhIGV4dGVuZHMgQWF7Y29uc3RydWN0b3IodCxlKXtzdXBlcihlKSx0aGlzLl9yZWFkZXI9Uih0KT9uZXcgZGEodGhpcy5faGFuZGxlPXQpOm5ldyBoYSh0aGlzLl9oYW5kbGU9dCl9aXNTeW5jKCl7cmV0dXJuITB9aXNTdHJlYW0oKXtyZXR1cm4hMH1bU3ltYm9sLml0ZXJhdG9yXSgpe3JldHVybiB0aGlzfWNhbmNlbCgpeyF0aGlzLmNsb3NlZCYmKHRoaXMuY2xvc2VkPSEwKSYmKHRoaXMucmVzZXQoKS5fcmVhZGVyLnJldHVybigpLHRoaXMuX3JlYWRlcj1udWxsLHRoaXMuZGljdGlvbmFyaWVzPW51bGwpfW9wZW4odCl7cmV0dXJuIHRoaXMuY2xvc2VkfHwodGhpcy5hdXRvRGVzdHJveT1GYSh0aGlzLHQpLHRoaXMuc2NoZW1hfHwodGhpcy5zY2hlbWE9dGhpcy5fcmVhZGVyLnJlYWRTY2hlbWEoKSl8fHRoaXMuY2FuY2VsKCkpLHRoaXN9dGhyb3codCl7cmV0dXJuIXRoaXMuY2xvc2VkJiZ0aGlzLmF1dG9EZXN0cm95JiYodGhpcy5jbG9zZWQ9ITApP3RoaXMucmVzZXQoKS5fcmVhZGVyLnRocm93KHQpOkhyfXJldHVybih0KXtyZXR1cm4hdGhpcy5jbG9zZWQmJnRoaXMuYXV0b0Rlc3Ryb3kmJih0aGlzLmNsb3NlZD0hMCk/dGhpcy5yZXNldCgpLl9yZWFkZXIucmV0dXJuKHQpOkhyfW5leHQoKXtpZih0aGlzLmNsb3NlZClyZXR1cm4gSHI7bGV0IHQ7Y29uc3R7X3JlYWRlcjplfT10aGlzO2Zvcig7dD10aGlzLl9yZWFkTmV4dE1lc3NhZ2VBbmRWYWxpZGF0ZSgpOylpZih0LmlzU2NoZW1hKCkpdGhpcy5yZXNldCh0LmhlYWRlcigpKTtlbHNle2lmKHQuaXNSZWNvcmRCYXRjaCgpKXt0aGlzLl9yZWNvcmRCYXRjaEluZGV4Kys7Y29uc3QgaT10LmhlYWRlcigpLG49ZS5yZWFkTWVzc2FnZUJvZHkodC5ib2R5TGVuZ3RoKTtyZXR1cm57ZG9uZTohMSx2YWx1ZTp0aGlzLl9sb2FkUmVjb3JkQmF0Y2goaSxuKX19aWYodC5pc0RpY3Rpb25hcnlCYXRjaCgpKXt0aGlzLl9kaWN0aW9uYXJ5SW5kZXgrKztjb25zdCBpPXQuaGVhZGVyKCksbj1lLnJlYWRNZXNzYWdlQm9keSh0LmJvZHlMZW5ndGgpLHI9dGhpcy5fbG9hZERpY3Rpb25hcnlCYXRjaChpLG4pO3RoaXMuZGljdGlvbmFyaWVzLnNldChpLmlkLHIpfX1yZXR1cm4gdGhpcy5zY2hlbWEmJjA9PT10aGlzLl9yZWNvcmRCYXRjaEluZGV4Pyh0aGlzLl9yZWNvcmRCYXRjaEluZGV4Kysse2RvbmU6ITEsdmFsdWU6bmV3IEZvKHRoaXMuc2NoZW1hKX0pOnRoaXMucmV0dXJuKCl9X3JlYWROZXh0TWVzc2FnZUFuZFZhbGlkYXRlKHQpe3JldHVybiB0aGlzLl9yZWFkZXIucmVhZE1lc3NhZ2UodCl9fWNsYXNzIE9hIGV4dGVuZHMgQWF7Y29uc3RydWN0b3IodCxlKXtzdXBlcihlKSx0aGlzLl9yZWFkZXI9bmV3IHVhKHRoaXMuX2hhbmRsZT10KX1pc0FzeW5jKCl7cmV0dXJuITB9aXNTdHJlYW0oKXtyZXR1cm4hMH1bU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCl7cmV0dXJuIHRoaXN9Y2FuY2VsKCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXshdGhpcy5jbG9zZWQmJih0aGlzLmNsb3NlZD0hMCkmJih5aWVsZCB0aGlzLnJlc2V0KCkuX3JlYWRlci5yZXR1cm4oKSx0aGlzLl9yZWFkZXI9bnVsbCx0aGlzLmRpY3Rpb25hcmllcz1udWxsKX0pKX1vcGVuKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuY2xvc2VkfHwodGhpcy5hdXRvRGVzdHJveT1GYSh0aGlzLHQpLHRoaXMuc2NoZW1hfHwodGhpcy5zY2hlbWE9eWllbGQgdGhpcy5fcmVhZGVyLnJlYWRTY2hlbWEoKSl8fCh5aWVsZCB0aGlzLmNhbmNlbCgpKSksdGhpc30pKX10aHJvdyh0KXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybiF0aGlzLmNsb3NlZCYmdGhpcy5hdXRvRGVzdHJveSYmKHRoaXMuY2xvc2VkPSEwKT95aWVsZCB0aGlzLnJlc2V0KCkuX3JlYWRlci50aHJvdyh0KTpIcn0pKX1yZXR1cm4odCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4hdGhpcy5jbG9zZWQmJnRoaXMuYXV0b0Rlc3Ryb3kmJih0aGlzLmNsb3NlZD0hMCk/eWllbGQgdGhpcy5yZXNldCgpLl9yZWFkZXIucmV0dXJuKHQpOkhyfSkpfW5leHQoKXtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2lmKHRoaXMuY2xvc2VkKXJldHVybiBIcjtsZXQgdDtjb25zdHtfcmVhZGVyOmV9PXRoaXM7Zm9yKDt0PXlpZWxkIHRoaXMuX3JlYWROZXh0TWVzc2FnZUFuZFZhbGlkYXRlKCk7KWlmKHQuaXNTY2hlbWEoKSl5aWVsZCB0aGlzLnJlc2V0KHQuaGVhZGVyKCkpO2Vsc2V7aWYodC5pc1JlY29yZEJhdGNoKCkpe3RoaXMuX3JlY29yZEJhdGNoSW5kZXgrKztjb25zdCBpPXQuaGVhZGVyKCksbj15aWVsZCBlLnJlYWRNZXNzYWdlQm9keSh0LmJvZHlMZW5ndGgpO3JldHVybntkb25lOiExLHZhbHVlOnRoaXMuX2xvYWRSZWNvcmRCYXRjaChpLG4pfX1pZih0LmlzRGljdGlvbmFyeUJhdGNoKCkpe3RoaXMuX2RpY3Rpb25hcnlJbmRleCsrO2NvbnN0IGk9dC5oZWFkZXIoKSxuPXlpZWxkIGUucmVhZE1lc3NhZ2VCb2R5KHQuYm9keUxlbmd0aCkscj10aGlzLl9sb2FkRGljdGlvbmFyeUJhdGNoKGksbik7dGhpcy5kaWN0aW9uYXJpZXMuc2V0KGkuaWQscil9fXJldHVybiB0aGlzLnNjaGVtYSYmMD09PXRoaXMuX3JlY29yZEJhdGNoSW5kZXg/KHRoaXMuX3JlY29yZEJhdGNoSW5kZXgrKyx7ZG9uZTohMSx2YWx1ZTpuZXcgRm8odGhpcy5zY2hlbWEpfSk6eWllbGQgdGhpcy5yZXR1cm4oKX0pKX1fcmVhZE5leHRNZXNzYWdlQW5kVmFsaWRhdGUodCl7cmV0dXJuIGIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5fcmVhZGVyLnJlYWRNZXNzYWdlKHQpfSkpfX1jbGFzcyBEYSBleHRlbmRzIFRhe2NvbnN0cnVjdG9yKHQsZSl7c3VwZXIodCBpbnN0YW5jZW9mIGVzP3Q6bmV3IGVzKHQpLGUpfWdldCBmb290ZXIoKXtyZXR1cm4gdGhpcy5fZm9vdGVyfWdldCBudW1EaWN0aW9uYXJpZXMoKXtyZXR1cm4gdGhpcy5fZm9vdGVyP3RoaXMuX2Zvb3Rlci5udW1EaWN0aW9uYXJpZXM6MH1nZXQgbnVtUmVjb3JkQmF0Y2hlcygpe3JldHVybiB0aGlzLl9mb290ZXI/dGhpcy5fZm9vdGVyLm51bVJlY29yZEJhdGNoZXM6MH1pc1N5bmMoKXtyZXR1cm4hMH1pc0ZpbGUoKXtyZXR1cm4hMH1vcGVuKHQpe2lmKCF0aGlzLmNsb3NlZCYmIXRoaXMuX2Zvb3Rlcil7dGhpcy5zY2hlbWE9KHRoaXMuX2Zvb3Rlcj10aGlzLl9yZWFkRm9vdGVyKCkpLnNjaGVtYTtmb3IoY29uc3QgdCBvZiB0aGlzLl9mb290ZXIuZGljdGlvbmFyeUJhdGNoZXMoKSl0JiZ0aGlzLl9yZWFkRGljdGlvbmFyeUJhdGNoKHRoaXMuX2RpY3Rpb25hcnlJbmRleCsrKX1yZXR1cm4gc3VwZXIub3Blbih0KX1yZWFkUmVjb3JkQmF0Y2godCl7dmFyIGU7aWYodGhpcy5jbG9zZWQpcmV0dXJuIG51bGw7dGhpcy5fZm9vdGVyfHx0aGlzLm9wZW4oKTtjb25zdCBpPW51bGw9PT0oZT10aGlzLl9mb290ZXIpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmdldFJlY29yZEJhdGNoKHQpO2lmKGkmJnRoaXMuX2hhbmRsZS5zZWVrKGkub2Zmc2V0KSl7Y29uc3QgdD10aGlzLl9yZWFkZXIucmVhZE1lc3NhZ2UobXQuUmVjb3JkQmF0Y2gpO2lmKG51bGw9PXQ/dm9pZCAwOnQuaXNSZWNvcmRCYXRjaCgpKXtjb25zdCBlPXQuaGVhZGVyKCksaT10aGlzLl9yZWFkZXIucmVhZE1lc3NhZ2VCb2R5KHQuYm9keUxlbmd0aCk7cmV0dXJuIHRoaXMuX2xvYWRSZWNvcmRCYXRjaChlLGkpfX1yZXR1cm4gbnVsbH1fcmVhZERpY3Rpb25hcnlCYXRjaCh0KXt2YXIgZTtjb25zdCBpPW51bGw9PT0oZT10aGlzLl9mb290ZXIpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmdldERpY3Rpb25hcnlCYXRjaCh0KTtpZihpJiZ0aGlzLl9oYW5kbGUuc2VlayhpLm9mZnNldCkpe2NvbnN0IHQ9dGhpcy5fcmVhZGVyLnJlYWRNZXNzYWdlKG10LkRpY3Rpb25hcnlCYXRjaCk7aWYobnVsbD09dD92b2lkIDA6dC5pc0RpY3Rpb25hcnlCYXRjaCgpKXtjb25zdCBlPXQuaGVhZGVyKCksaT10aGlzLl9yZWFkZXIucmVhZE1lc3NhZ2VCb2R5KHQuYm9keUxlbmd0aCksbj10aGlzLl9sb2FkRGljdGlvbmFyeUJhdGNoKGUsaSk7dGhpcy5kaWN0aW9uYXJpZXMuc2V0KGUuaWQsbil9fX1fcmVhZEZvb3Rlcigpe2NvbnN0e19oYW5kbGU6dH09dGhpcyxlPXQuc2l6ZS1tYSxpPXQucmVhZEludDMyKGUpLG49dC5yZWFkQXQoZS1pLGkpO3JldHVybiAkci5kZWNvZGUobil9X3JlYWROZXh0TWVzc2FnZUFuZFZhbGlkYXRlKHQpe3ZhciBlO2lmKHRoaXMuX2Zvb3Rlcnx8dGhpcy5vcGVuKCksdGhpcy5fZm9vdGVyJiZ0aGlzLl9yZWNvcmRCYXRjaEluZGV4PHRoaXMubnVtUmVjb3JkQmF0Y2hlcyl7Y29uc3QgaT1udWxsPT09KGU9dGhpcy5fZm9vdGVyKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5nZXRSZWNvcmRCYXRjaCh0aGlzLl9yZWNvcmRCYXRjaEluZGV4KTtpZihpJiZ0aGlzLl9oYW5kbGUuc2VlayhpLm9mZnNldCkpcmV0dXJuIHRoaXMuX3JlYWRlci5yZWFkTWVzc2FnZSh0KX1yZXR1cm4gbnVsbH19Y2xhc3MgeGEgZXh0ZW5kcyBPYXtjb25zdHJ1Y3Rvcih0LC4uLmUpe2NvbnN0IGk9Im51bWJlciIhPXR5cGVvZiBlWzBdP2Uuc2hpZnQoKTp2b2lkIDAsbj1lWzBdaW5zdGFuY2VvZiBNYXA/ZS5zaGlmdCgpOnZvaWQgMDtzdXBlcih0IGluc3RhbmNlb2YgaXM/dDpuZXcgaXModCxpKSxuKX1nZXQgZm9vdGVyKCl7cmV0dXJuIHRoaXMuX2Zvb3Rlcn1nZXQgbnVtRGljdGlvbmFyaWVzKCl7cmV0dXJuIHRoaXMuX2Zvb3Rlcj90aGlzLl9mb290ZXIubnVtRGljdGlvbmFyaWVzOjB9Z2V0IG51bVJlY29yZEJhdGNoZXMoKXtyZXR1cm4gdGhpcy5fZm9vdGVyP3RoaXMuX2Zvb3Rlci5udW1SZWNvcmRCYXRjaGVzOjB9aXNGaWxlKCl7cmV0dXJuITB9aXNBc3luYygpe3JldHVybiEwfW9wZW4odCl7Y29uc3QgZT1PYmplY3QuY3JlYXRlKG51bGwse29wZW46e2dldDooKT0+c3VwZXIub3Blbn19KTtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2lmKCF0aGlzLmNsb3NlZCYmIXRoaXMuX2Zvb3Rlcil7dGhpcy5zY2hlbWE9KHRoaXMuX2Zvb3Rlcj15aWVsZCB0aGlzLl9yZWFkRm9vdGVyKCkpLnNjaGVtYTtmb3IoY29uc3QgdCBvZiB0aGlzLl9mb290ZXIuZGljdGlvbmFyeUJhdGNoZXMoKSl0JiYoeWllbGQgdGhpcy5fcmVhZERpY3Rpb25hcnlCYXRjaCh0aGlzLl9kaWN0aW9uYXJ5SW5kZXgrKykpfXJldHVybiB5aWVsZCBlLm9wZW4uY2FsbCh0aGlzLHQpfSkpfXJlYWRSZWNvcmRCYXRjaCh0KXt2YXIgZTtyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2lmKHRoaXMuY2xvc2VkKXJldHVybiBudWxsO3RoaXMuX2Zvb3Rlcnx8KHlpZWxkIHRoaXMub3BlbigpKTtjb25zdCBpPW51bGw9PT0oZT10aGlzLl9mb290ZXIpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmdldFJlY29yZEJhdGNoKHQpO2lmKGkmJih5aWVsZCB0aGlzLl9oYW5kbGUuc2VlayhpLm9mZnNldCkpKXtjb25zdCB0PXlpZWxkIHRoaXMuX3JlYWRlci5yZWFkTWVzc2FnZShtdC5SZWNvcmRCYXRjaCk7aWYobnVsbD09dD92b2lkIDA6dC5pc1JlY29yZEJhdGNoKCkpe2NvbnN0IGU9dC5oZWFkZXIoKSxpPXlpZWxkIHRoaXMuX3JlYWRlci5yZWFkTWVzc2FnZUJvZHkodC5ib2R5TGVuZ3RoKTtyZXR1cm4gdGhpcy5fbG9hZFJlY29yZEJhdGNoKGUsaSl9fXJldHVybiBudWxsfSkpfV9yZWFkRGljdGlvbmFyeUJhdGNoKHQpe3ZhciBlO3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3QgaT1udWxsPT09KGU9dGhpcy5fZm9vdGVyKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5nZXREaWN0aW9uYXJ5QmF0Y2godCk7aWYoaSYmKHlpZWxkIHRoaXMuX2hhbmRsZS5zZWVrKGkub2Zmc2V0KSkpe2NvbnN0IHQ9eWllbGQgdGhpcy5fcmVhZGVyLnJlYWRNZXNzYWdlKG10LkRpY3Rpb25hcnlCYXRjaCk7aWYobnVsbD09dD92b2lkIDA6dC5pc0RpY3Rpb25hcnlCYXRjaCgpKXtjb25zdCBlPXQuaGVhZGVyKCksaT15aWVsZCB0aGlzLl9yZWFkZXIucmVhZE1lc3NhZ2VCb2R5KHQuYm9keUxlbmd0aCksbj10aGlzLl9sb2FkRGljdGlvbmFyeUJhdGNoKGUsaSk7dGhpcy5kaWN0aW9uYXJpZXMuc2V0KGUuaWQsbil9fX0pKX1fcmVhZEZvb3Rlcigpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3R7X2hhbmRsZTp0fT10aGlzO3QuX3BlbmRpbmcmJih5aWVsZCB0Ll9wZW5kaW5nKTtjb25zdCBlPXQuc2l6ZS1tYSxpPXlpZWxkIHQucmVhZEludDMyKGUpLG49eWllbGQgdC5yZWFkQXQoZS1pLGkpO3JldHVybiAkci5kZWNvZGUobil9KSl9X3JlYWROZXh0TWVzc2FnZUFuZFZhbGlkYXRlKHQpe3JldHVybiBiKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7aWYodGhpcy5fZm9vdGVyfHwoeWllbGQgdGhpcy5vcGVuKCkpLHRoaXMuX2Zvb3RlciYmdGhpcy5fcmVjb3JkQmF0Y2hJbmRleDx0aGlzLm51bVJlY29yZEJhdGNoZXMpe2NvbnN0IGU9dGhpcy5fZm9vdGVyLmdldFJlY29yZEJhdGNoKHRoaXMuX3JlY29yZEJhdGNoSW5kZXgpO2lmKGUmJih5aWVsZCB0aGlzLl9oYW5kbGUuc2VlayhlLm9mZnNldCkpKXJldHVybiB5aWVsZCB0aGlzLl9yZWFkZXIucmVhZE1lc3NhZ2UodCl9cmV0dXJuIG51bGx9KSl9fWNsYXNzIE1hIGV4dGVuZHMgVGF7Y29uc3RydWN0b3IodCxlKXtzdXBlcih0LGUpfV9sb2FkVmVjdG9ycyh0LGUsaSl7cmV0dXJuIG5ldyBocyhlLHQubm9kZXMsdC5idWZmZXJzLHRoaXMuZGljdGlvbmFyaWVzKS52aXNpdE1hbnkoaSl9fWZ1bmN0aW9uIEZhKHQsZSl7cmV0dXJuIGUmJiJib29sZWFuIj09dHlwZW9mIGUuYXV0b0Rlc3Ryb3k/ZS5hdXRvRGVzdHJveTp0LmF1dG9EZXN0cm95fWZ1bmN0aW9uKkxhKHQpe2NvbnN0IGU9dmEuZnJvbSh0KTt0cnl7aWYoIWUub3Blbih7YXV0b0Rlc3Ryb3k6ITF9KS5jbG9zZWQpZG97eWllbGQgZX13aGlsZSghZS5yZXNldCgpLm9wZW4oKS5jbG9zZWQpfWZpbmFsbHl7ZS5jYW5jZWwoKX19ZnVuY3Rpb24gTmEodCl7cmV0dXJuIF8odGhpcyxhcmd1bWVudHMsKGZ1bmN0aW9uKigpe2NvbnN0IGU9eWllbGQgbSh2YS5mcm9tKHQpKTt0cnl7aWYoISh5aWVsZCBtKGUub3Blbih7YXV0b0Rlc3Ryb3k6ITF9KSkpLmNsb3NlZClkb3t5aWVsZCB5aWVsZCBtKGUpfXdoaWxlKCEoeWllbGQgbShlLnJlc2V0KCkub3BlbigpKSkuY2xvc2VkKX1maW5hbGx5e3lpZWxkIG0oZS5jYW5jZWwoKSl9fSkpfWNsYXNzIFVhIGV4dGVuZHMgVWV7Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuX2J5dGVMZW5ndGg9MCx0aGlzLl9ub2Rlcz1bXSx0aGlzLl9idWZmZXJzPVtdLHRoaXMuX2J1ZmZlclJlZ2lvbnM9W119c3RhdGljIGFzc2VtYmxlKC4uLnQpe2NvbnN0IGU9dD0+dC5mbGF0TWFwKCh0PT5BcnJheS5pc0FycmF5KHQpP2UodCk6dCBpbnN0YW5jZW9mIERvP3QuZGF0YS5jaGlsZHJlbjp0LmRhdGEpKSxpPW5ldyBVYTtyZXR1cm4gaS52aXNpdE1hbnkoZSh0KSksaX12aXNpdCh0KXtpZih0IGluc3RhbmNlb2YgQ24pcmV0dXJuIHRoaXMudmlzaXRNYW55KHQuZGF0YSksdGhpcztjb25zdHt0eXBlOmV9PXQ7aWYoIWVlLmlzRGljdGlvbmFyeShlKSl7Y29uc3R7bGVuZ3RoOmksbnVsbENvdW50Om59PXQ7aWYoaT4yMTQ3NDgzNjQ3KXRocm93IG5ldyBSYW5nZUVycm9yKCJDYW5ub3Qgd3JpdGUgYXJyYXlzIGxhcmdlciB0aGFuIDJeMzEgLSAxIGluIGxlbmd0aCIpO2VlLmlzTnVsbChlKXx8Q2EuY2FsbCh0aGlzLG48PTA/bmV3IFVpbnQ4QXJyYXkoMCk6ZW4odC5vZmZzZXQsaSx0Lm51bGxCaXRtYXApKSx0aGlzLm5vZGVzLnB1c2gobmV3IHRhKGksbikpfXJldHVybiBzdXBlci52aXNpdCh0KX12aXNpdE51bGwodCl7cmV0dXJuIHRoaXN9dmlzaXREaWN0aW9uYXJ5KHQpe3JldHVybiB0aGlzLnZpc2l0KHQuY2xvbmUodC50eXBlLmluZGljZXMpKX1nZXQgbm9kZXMoKXtyZXR1cm4gdGhpcy5fbm9kZXN9Z2V0IGJ1ZmZlcnMoKXtyZXR1cm4gdGhpcy5fYnVmZmVyc31nZXQgYnl0ZUxlbmd0aCgpe3JldHVybiB0aGlzLl9ieXRlTGVuZ3RofWdldCBidWZmZXJSZWdpb25zKCl7cmV0dXJuIHRoaXMuX2J1ZmZlclJlZ2lvbnN9fWZ1bmN0aW9uIENhKHQpe2NvbnN0IGU9dC5ieXRlTGVuZ3RoKzcmLTg7cmV0dXJuIHRoaXMuYnVmZmVycy5wdXNoKHQpLHRoaXMuYnVmZmVyUmVnaW9ucy5wdXNoKG5ldyBYbyh0aGlzLl9ieXRlTGVuZ3RoLGUpKSx0aGlzLl9ieXRlTGVuZ3RoKz1lLHRoaXN9ZnVuY3Rpb24gRWEodCl7cmV0dXJuIENhLmNhbGwodGhpcyx0LnZhbHVlcy5zdWJhcnJheSgwLHQubGVuZ3RoKnQuc3RyaWRlKSl9ZnVuY3Rpb24gVmEodCl7Y29uc3R7bGVuZ3RoOmUsdmFsdWVzOmksdmFsdWVPZmZzZXRzOm59PXQscj1uWzBdLHM9bltlXSxvPU1hdGgubWluKHMtcixpLmJ5dGVMZW5ndGgtcik7cmV0dXJuIENhLmNhbGwodGhpcyxldCgtblswXSxlLG4pKSxDYS5jYWxsKHRoaXMsaS5zdWJhcnJheShyLHIrbykpLHRoaXN9ZnVuY3Rpb24gUmEodCl7Y29uc3R7bGVuZ3RoOmUsdmFsdWVPZmZzZXRzOml9PXQ7cmV0dXJuIGkmJkNhLmNhbGwodGhpcyxldChpWzBdLGUsaSkpLHRoaXMudmlzaXQodC5jaGlsZHJlblswXSl9ZnVuY3Rpb24gemEodCl7cmV0dXJuIHRoaXMudmlzaXRNYW55KHQudHlwZS5jaGlsZHJlbi5tYXAoKChlLGkpPT50LmNoaWxkcmVuW2ldKSkuZmlsdGVyKEJvb2xlYW4pKVswXX1VYS5wcm90b3R5cGUudmlzaXRCb29sPWZ1bmN0aW9uKHQpe2xldCBlO3JldHVybiB0Lm51bGxDb3VudD49dC5sZW5ndGg/Q2EuY2FsbCh0aGlzLG5ldyBVaW50OEFycmF5KDApKTooZT10LnZhbHVlcylpbnN0YW5jZW9mIFVpbnQ4QXJyYXk/Q2EuY2FsbCh0aGlzLGVuKHQub2Zmc2V0LHQubGVuZ3RoLGUpKTpDYS5jYWxsKHRoaXMsbm4odC52YWx1ZXMpKX0sVWEucHJvdG90eXBlLnZpc2l0SW50PUVhLFVhLnByb3RvdHlwZS52aXNpdEZsb2F0PUVhLFVhLnByb3RvdHlwZS52aXNpdFV0Zjg9VmEsVWEucHJvdG90eXBlLnZpc2l0QmluYXJ5PVZhLFVhLnByb3RvdHlwZS52aXNpdEZpeGVkU2l6ZUJpbmFyeT1FYSxVYS5wcm90b3R5cGUudmlzaXREYXRlPUVhLFVhLnByb3RvdHlwZS52aXNpdFRpbWVzdGFtcD1FYSxVYS5wcm90b3R5cGUudmlzaXRUaW1lPUVhLFVhLnByb3RvdHlwZS52aXNpdERlY2ltYWw9RWEsVWEucHJvdG90eXBlLnZpc2l0TGlzdD1SYSxVYS5wcm90b3R5cGUudmlzaXRTdHJ1Y3Q9emEsVWEucHJvdG90eXBlLnZpc2l0VW5pb249ZnVuY3Rpb24odCl7Y29uc3R7dHlwZTplLGxlbmd0aDppLHR5cGVJZHM6bix2YWx1ZU9mZnNldHM6cn09dDtpZihDYS5jYWxsKHRoaXMsbiksZS5tb2RlPT09bHQuU3BhcnNlKXJldHVybiB6YS5jYWxsKHRoaXMsdCk7aWYoZS5tb2RlPT09bHQuRGVuc2Upe2lmKHQub2Zmc2V0PD0wKXJldHVybiBDYS5jYWxsKHRoaXMsciksemEuY2FsbCh0aGlzLHQpO3tjb25zdCBzPW4ucmVkdWNlKCgodCxlKT0+TWF0aC5tYXgodCxlKSksblswXSksbz1uZXcgSW50MzJBcnJheShzKzEpLGE9bmV3IEludDMyQXJyYXkocysxKS5maWxsKC0xKSxsPW5ldyBJbnQzMkFycmF5KGkpLGM9ZXQoLXJbMF0saSxyKTtmb3IobGV0IHQsZSxyPS0xOysrcjxpOyktMT09PShlPWFbdD1uW3JdXSkmJihlPWFbdF09Y1t0XSksbFtyXT1jW3JdLWUsKytvW3RdO0NhLmNhbGwodGhpcyxsKTtmb3IobGV0IG4scj0tMSxoPWUuY2hpbGRyZW4ubGVuZ3RoOysrcjxoOylpZihuPXQuY2hpbGRyZW5bcl0pe2NvbnN0IHQ9ZS50eXBlSWRzW3JdLHM9TWF0aC5taW4oaSxvW3RdKTt0aGlzLnZpc2l0KG4uc2xpY2UoYVt0XSxzKSl9fX1yZXR1cm4gdGhpc30sVWEucHJvdG90eXBlLnZpc2l0SW50ZXJ2YWw9RWEsVWEucHJvdG90eXBlLnZpc2l0Rml4ZWRTaXplTGlzdD1SYSxVYS5wcm90b3R5cGUudmlzaXRNYXA9UmE7Y2xhc3MgUGEgZXh0ZW5kcyBKcntjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMuX3Bvc2l0aW9uPTAsdGhpcy5fc3RhcnRlZD0hMSx0aGlzLl9zaW5rPW5ldyBacix0aGlzLl9zY2hlbWE9bnVsbCx0aGlzLl9kaWN0aW9uYXJ5QmxvY2tzPVtdLHRoaXMuX3JlY29yZEJhdGNoQmxvY2tzPVtdLHRoaXMuX2RpY3Rpb25hcnlEZWx0YU9mZnNldHM9bmV3IE1hcCxVKHQpfHwodD17YXV0b0Rlc3Ryb3k6ITAsd3JpdGVMZWdhY3lJcGNGb3JtYXQ6ITF9KSx0aGlzLl9hdXRvRGVzdHJveT0iYm9vbGVhbiIhPXR5cGVvZiB0LmF1dG9EZXN0cm95fHx0LmF1dG9EZXN0cm95LHRoaXMuX3dyaXRlTGVnYWN5SXBjRm9ybWF0PSJib29sZWFuIj09dHlwZW9mIHQud3JpdGVMZWdhY3lJcGNGb3JtYXQmJnQud3JpdGVMZWdhY3lJcGNGb3JtYXR9c3RhdGljIHRocm91Z2hOb2RlKHQpe3Rocm93IG5ldyBFcnJvcignInRocm91Z2hOb2RlIiBub3QgYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKX1zdGF0aWMgdGhyb3VnaERPTSh0LGUpe3Rocm93IG5ldyBFcnJvcignInRocm91Z2hET00iIG5vdCBhdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpfXRvU3RyaW5nKHQ9ITEpe3JldHVybiB0aGlzLl9zaW5rLnRvU3RyaW5nKHQpfXRvVWludDhBcnJheSh0PSExKXtyZXR1cm4gdGhpcy5fc2luay50b1VpbnQ4QXJyYXkodCl9d3JpdGVBbGwodCl7cmV0dXJuIEModCk/dC50aGVuKCh0PT50aGlzLndyaXRlQWxsKHQpKSk6Vih0KT9ZYSh0aGlzLHQpOiRhKHRoaXMsdCl9Z2V0IGNsb3NlZCgpe3JldHVybiB0aGlzLl9zaW5rLmNsb3NlZH1bU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCl7cmV0dXJuIHRoaXMuX3NpbmtbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCl9dG9ET01TdHJlYW0odCl7cmV0dXJuIHRoaXMuX3NpbmsudG9ET01TdHJlYW0odCl9dG9Ob2RlU3RyZWFtKHQpe3JldHVybiB0aGlzLl9zaW5rLnRvTm9kZVN0cmVhbSh0KX1jbG9zZSgpe3JldHVybiB0aGlzLnJlc2V0KCkuX3NpbmsuY2xvc2UoKX1hYm9ydCh0KXtyZXR1cm4gdGhpcy5yZXNldCgpLl9zaW5rLmFib3J0KHQpfWZpbmlzaCgpe3JldHVybiB0aGlzLl9hdXRvRGVzdHJveT90aGlzLmNsb3NlKCk6dGhpcy5yZXNldCh0aGlzLl9zaW5rLHRoaXMuX3NjaGVtYSksdGhpc31yZXNldCh0PXRoaXMuX3NpbmssZT1udWxsKXt2YXIgaTtyZXR1cm4gdD09PXRoaXMuX3Npbmt8fHQgaW5zdGFuY2VvZiBacj90aGlzLl9zaW5rPXQ6KHRoaXMuX3Npbms9bmV3IFpyLHQmJihVKGk9dCkmJk4oaS5hYm9ydCkmJk4oaS5nZXRXcml0ZXIpJiYhayhpKSk/dGhpcy50b0RPTVN0cmVhbSh7dHlwZToiYnl0ZXMifSkucGlwZVRvKHQpOnQmJih0PT5VKHQpJiZOKHQuZW5kKSYmTih0LndyaXRlKSYmTCh0LndyaXRhYmxlKSYmIWsodCkpKHQpJiZ0aGlzLnRvTm9kZVN0cmVhbSh7b2JqZWN0TW9kZTohMX0pLnBpcGUodCkpLHRoaXMuX3N0YXJ0ZWQmJnRoaXMuX3NjaGVtYSYmdGhpcy5fd3JpdGVGb290ZXIodGhpcy5fc2NoZW1hKSx0aGlzLl9zdGFydGVkPSExLHRoaXMuX2RpY3Rpb25hcnlCbG9ja3M9W10sdGhpcy5fcmVjb3JkQmF0Y2hCbG9ja3M9W10sdGhpcy5fZGljdGlvbmFyeURlbHRhT2Zmc2V0cz1uZXcgTWFwLGUmJmdvKGUsdGhpcy5fc2NoZW1hKXx8KG51bGw9PWU/KHRoaXMuX3Bvc2l0aW9uPTAsdGhpcy5fc2NoZW1hPW51bGwpOih0aGlzLl9zdGFydGVkPSEwLHRoaXMuX3NjaGVtYT1lLHRoaXMuX3dyaXRlU2NoZW1hKGUpKSksdGhpc313cml0ZSh0KXtsZXQgZT1udWxsO2lmKCF0aGlzLl9zaW5rKXRocm93IG5ldyBFcnJvcigiUmVjb3JkQmF0Y2hXcml0ZXIgaXMgY2xvc2VkIik7aWYobnVsbD09dClyZXR1cm4gdGhpcy5maW5pc2goKSYmdm9pZCAwO2lmKHQgaW5zdGFuY2VvZiBPbyYmIShlPXQuc2NoZW1hKSlyZXR1cm4gdGhpcy5maW5pc2goKSYmdm9pZCAwO2lmKHQgaW5zdGFuY2VvZiBEbyYmIShlPXQuc2NoZW1hKSlyZXR1cm4gdGhpcy5maW5pc2goKSYmdm9pZCAwO2lmKGUmJiFnbyhlLHRoaXMuX3NjaGVtYSkpe2lmKHRoaXMuX3N0YXJ0ZWQmJnRoaXMuX2F1dG9EZXN0cm95KXJldHVybiB0aGlzLmNsb3NlKCk7dGhpcy5yZXNldCh0aGlzLl9zaW5rLGUpfXQgaW5zdGFuY2VvZiBEbz90IGluc3RhbmNlb2YgRm98fHRoaXMuX3dyaXRlUmVjb3JkQmF0Y2godCk6dCBpbnN0YW5jZW9mIE9vP3RoaXMud3JpdGVBbGwodC5iYXRjaGVzKTpFKHQpJiZ0aGlzLndyaXRlQWxsKHQpfV93cml0ZU1lc3NhZ2UodCxlPTgpe2NvbnN0IGk9ZS0xLG49Wm8uZW5jb2RlKHQpLHI9bi5ieXRlTGVuZ3RoLHM9dGhpcy5fd3JpdGVMZWdhY3lJcGNGb3JtYXQ/NDo4LG89citzK2kmfmksYT1vLXItcztyZXR1cm4gdC5oZWFkZXJUeXBlPT09bXQuUmVjb3JkQmF0Y2g/dGhpcy5fcmVjb3JkQmF0Y2hCbG9ja3MucHVzaChuZXcgV3Iobyx0LmJvZHlMZW5ndGgsdGhpcy5fcG9zaXRpb24pKTp0LmhlYWRlclR5cGU9PT1tdC5EaWN0aW9uYXJ5QmF0Y2gmJnRoaXMuX2RpY3Rpb25hcnlCbG9ja3MucHVzaChuZXcgV3Iobyx0LmJvZHlMZW5ndGgsdGhpcy5fcG9zaXRpb24pKSx0aGlzLl93cml0ZUxlZ2FjeUlwY0Zvcm1hdHx8dGhpcy5fd3JpdGUoSW50MzJBcnJheS5vZigtMSkpLHRoaXMuX3dyaXRlKEludDMyQXJyYXkub2Yoby1zKSkscj4wJiZ0aGlzLl93cml0ZShuKSx0aGlzLl93cml0ZVBhZGRpbmcoYSl9X3dyaXRlKHQpe2lmKHRoaXMuX3N0YXJ0ZWQpe2NvbnN0IGU9Wih0KTtlJiZlLmJ5dGVMZW5ndGg+MCYmKHRoaXMuX3Npbmsud3JpdGUoZSksdGhpcy5fcG9zaXRpb24rPWUuYnl0ZUxlbmd0aCl9cmV0dXJuIHRoaXN9X3dyaXRlU2NoZW1hKHQpe3JldHVybiB0aGlzLl93cml0ZU1lc3NhZ2UoWm8uZnJvbSh0KSl9X3dyaXRlRm9vdGVyKHQpe3JldHVybiB0aGlzLl93cml0ZUxlZ2FjeUlwY0Zvcm1hdD90aGlzLl93cml0ZShJbnQzMkFycmF5Lm9mKDApKTp0aGlzLl93cml0ZShJbnQzMkFycmF5Lm9mKC0xLDApKX1fd3JpdGVNYWdpYygpe3JldHVybiB0aGlzLl93cml0ZSh5YSl9X3dyaXRlUGFkZGluZyh0KXtyZXR1cm4gdD4wP3RoaXMuX3dyaXRlKG5ldyBVaW50OEFycmF5KHQpKTp0aGlzfV93cml0ZVJlY29yZEJhdGNoKHQpe2NvbnN0e2J5dGVMZW5ndGg6ZSxub2RlczppLGJ1ZmZlclJlZ2lvbnM6bixidWZmZXJzOnJ9PVVhLmFzc2VtYmxlKHQpLHM9bmV3IHFvKHQubnVtUm93cyxpLG4pLG89Wm8uZnJvbShzLGUpO3JldHVybiB0aGlzLl93cml0ZURpY3Rpb25hcmllcyh0KS5fd3JpdGVNZXNzYWdlKG8pLl93cml0ZUJvZHlCdWZmZXJzKHIpfV93cml0ZURpY3Rpb25hcnlCYXRjaCh0LGUsaT0hMSl7dGhpcy5fZGljdGlvbmFyeURlbHRhT2Zmc2V0cy5zZXQoZSx0Lmxlbmd0aCsodGhpcy5fZGljdGlvbmFyeURlbHRhT2Zmc2V0cy5nZXQoZSl8fDApKTtjb25zdHtieXRlTGVuZ3RoOm4sbm9kZXM6cixidWZmZXJSZWdpb25zOnMsYnVmZmVyczpvfT1VYS5hc3NlbWJsZShuZXcgQ24oW3RdKSksYT1uZXcgcW8odC5sZW5ndGgscixzKSxsPW5ldyBRbyhhLGUsaSksYz1aby5mcm9tKGwsbik7cmV0dXJuIHRoaXMuX3dyaXRlTWVzc2FnZShjKS5fd3JpdGVCb2R5QnVmZmVycyhvKX1fd3JpdGVCb2R5QnVmZmVycyh0KXtsZXQgZSxpLG47Zm9yKGxldCByPS0xLHM9dC5sZW5ndGg7KytyPHM7KShlPXRbcl0pJiYoaT1lLmJ5dGVMZW5ndGgpPjAmJih0aGlzLl93cml0ZShlKSwobj0oaSs3Ji04KS1pKT4wJiZ0aGlzLl93cml0ZVBhZGRpbmcobikpO3JldHVybiB0aGlzfV93cml0ZURpY3Rpb25hcmllcyh0KXtmb3IobGV0W2UsaV1vZiB0LmRpY3Rpb25hcmllcyl7bGV0IHQ9dGhpcy5fZGljdGlvbmFyeURlbHRhT2Zmc2V0cy5nZXQoZSl8fDA7aWYoMD09PXR8fChpPW51bGw9PWk/dm9pZCAwOmkuc2xpY2UodCkpLmxlbmd0aD4wKWZvcihjb25zdCBuIG9mIGkuZGF0YSl0aGlzLl93cml0ZURpY3Rpb25hcnlCYXRjaChuLGUsdD4wKSx0Kz1uLmxlbmd0aH1yZXR1cm4gdGhpc319Y2xhc3MgamEgZXh0ZW5kcyBQYXtzdGF0aWMgd3JpdGVBbGwodCxlKXtjb25zdCBpPW5ldyBqYShlKTtyZXR1cm4gQyh0KT90LnRoZW4oKHQ9Pmkud3JpdGVBbGwodCkpKTpWKHQpP1lhKGksdCk6JGEoaSx0KX19Y2xhc3Mga2EgZXh0ZW5kcyBQYXtzdGF0aWMgd3JpdGVBbGwodCl7Y29uc3QgZT1uZXcga2E7cmV0dXJuIEModCk/dC50aGVuKCh0PT5lLndyaXRlQWxsKHQpKSk6Vih0KT9ZYShlLHQpOiRhKGUsdCl9Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuX2F1dG9EZXN0cm95PSEwfV93cml0ZVNjaGVtYSh0KXtyZXR1cm4gdGhpcy5fd3JpdGVNYWdpYygpLl93cml0ZVBhZGRpbmcoMil9X3dyaXRlRm9vdGVyKHQpe2NvbnN0IGU9JHIuZW5jb2RlKG5ldyAkcih0LG90LlY0LHRoaXMuX3JlY29yZEJhdGNoQmxvY2tzLHRoaXMuX2RpY3Rpb25hcnlCbG9ja3MpKTtyZXR1cm4gc3VwZXIuX3dyaXRlRm9vdGVyKHQpLl93cml0ZShlKS5fd3JpdGUoSW50MzJBcnJheS5vZihlLmJ5dGVMZW5ndGgpKS5fd3JpdGVNYWdpYygpfX1mdW5jdGlvbiAkYSh0LGUpe2xldCBpPWU7ZSBpbnN0YW5jZW9mIE9vJiYoaT1lLmJhdGNoZXMsdC5yZXNldCh2b2lkIDAsZS5zY2hlbWEpKTtmb3IoY29uc3QgbiBvZiBpKXQud3JpdGUobik7cmV0dXJuIHQuZmluaXNoKCl9ZnVuY3Rpb24gWWEodCxlKXt2YXIgaSxuLHIscztyZXR1cm4gYih0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3RyeXtmb3IoaT13KGUpOyEobj15aWVsZCBpLm5leHQoKSkuZG9uZTspe2NvbnN0IGU9bi52YWx1ZTt0LndyaXRlKGUpfX1jYXRjaChvKXtyPXtlcnJvcjpvfX1maW5hbGx5e3RyeXtuJiYhbi5kb25lJiYocz1pLnJldHVybikmJih5aWVsZCBzLmNhbGwoaSkpfWZpbmFsbHl7aWYocil0aHJvdyByLmVycm9yfX1yZXR1cm4gdC5maW5pc2goKX0pKX1mdW5jdGlvbiBXYSh0KXtjb25zdCBlPXZhLmZyb20odCk7cmV0dXJuIEMoZSk/KCgpPT5iKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIG5ldyBPbyh5aWVsZCh5aWVsZCBlKS5yZWFkQWxsKCkpfSkpKSgpOm5ldyBPbyhlLnJlYWRBbGwoKSl9ZnVuY3Rpb24gSGEodCxlKXtjb25zdCBpPWVvKHt0eXBlOm5ldyBMZShuZXcgaGUsbmV3IGJlKSxoaWdoV2F0ZXJNYXJrOjFlNn0pO3JldHVybiB0LmZvckVhY2goKHQ9PmkuYXBwZW5kKHQpKSksaS5maW5pc2goKS50b1ZlY3RvcigpfWZ1bmN0aW9uIEthKHQpe2NvbnN0IGU9V2EodCksaT17fTtmb3IoY29uc3QgbiBvZiBlLnNjaGVtYS5maWVsZHMpaWYobi50eXBlLmRpY3Rpb25hcnkpe2lbbi5uYW1lXT1uZXcgTWFwO2NvbnN0IHQ9ZS5nZXRDaGlsZChuLm5hbWUpLmRhdGFbMF0uZGljdGlvbmFyeS50b0FycmF5KCk7bGV0IHI9MDtmb3IoY29uc3QgZSBvZiB0KWlbbi5uYW1lXS5zZXQocixlKSxyKyt9cmV0dXJuIGl9ZnVuY3Rpb24gSmEodCxlLGkpe2NvbnN0IG49V2EoZSkscj1uZXcgTWFwLHM9bmV3IE1hcDtmb3IoY29uc3RbaCx1XW9mIE9iamVjdC5lbnRyaWVzKHQpKXIuc2V0KGgsQXJyYXkobi5sZW5ndGgpKSxzLnNldChoLEZ1bmN0aW9uKCJkYXR1bSIsdSkpO2xldCBvPTA7Zm9yKGxldCBoPTA7aDxuLm51bVJvd3M7aCsrKXtjb25zdCB0PW4uZ2V0KGgpO2Zvcihjb25zdFtlLGldb2YgcylyLmdldChlKVtvXT1pKHQpO28rK31jb25zdCBhPXt9O2Zvcihjb25zdHtuYW1lOmgsdHlwZTp1fW9mIG4uc2NoZW1hLmZpZWxkcyl7aWYodm9pZCAwPT09dSl0aHJvdyJOTyBTVUNIIFRZUEUiO2lmKCFzLmhhcyhoKSl7Y29uc3QgdD1uLmdldENoaWxkKGgpO2lmKGFbaF09Iml4Ij09PWg/aW8oWy4uLnRdLm1hcCgodD0+TnVtYmVyKHQpKSksbmV3IHBlKTp0LHUuZGljdGlvbmFyeSl7Y29uc3QgZT1uZXcgRmxvYXQzMkFycmF5KG4uZGF0YVswXS5sZW5ndGgpO2ZvcihsZXQgaT0wO2k8bi5kYXRhWzBdLmxlbmd0aDtpKyspZVtpXT10LmRhdGFbMF0udmFsdWVzW2ldLTIwNDc7YVtgJHtofV9mbG9hdF92ZXJzaW9uYF09Vm4oZSl9OD09PXUudHlwZUlkJiYoYVtgJHtofV9mbG9hdF92ZXJzaW9uYF09aW8oWy4uLnQuZGF0YVswXS52YWx1ZXNdLm1hcCgodD0+TnVtYmVyKHQpKSksbmV3IHBlKSl9fU1hdGgubWF4KC4uLm4uc2NoZW1hLmRpY3Rpb25hcmllcy5rZXlzKCkpO2Zvcihjb25zdFtoLHVdb2Ygcil7bGV0IHQ7Y29uc29sZS5sb2coe2s6aH0pLHQ9InN0cmluZyI9PXR5cGVvZiB1WzBdP0hhKHUpOmZsb2F0VmVjdG9yKHUpLGFbaF09dH1jb25zdCBsPWZ1bmN0aW9uKHQpe2NvbnN0IGU9e30saT1PYmplY3QuZW50cmllcyh0KTtmb3IoY29uc3RbbixyXW9mIGkpZVtuXT1pbyhyKTtyZXR1cm4gbmV3IE9vKGUpfShhKSx7YnVmZmVyOmN9PWZ1bmN0aW9uKHQsZT0ic3RyZWFtIil7cmV0dXJuKCJzdHJlYW0iPT09ZT9qYTprYSkud3JpdGVBbGwodCkudG9VaW50OEFycmF5KCEwKX0obCk7cmV0dXJuIGN9byh7ZmV0Y2g6KHQsZSk9Pih0Lm1hdGNoKCJodHRwczovL2dpdGh1YiIpJiYodCs9Ij9yYXc9dHJ1ZSIpLGZldGNoKHQpLnRoZW4oKHQ9PnQuYXJyYXlCdWZmZXIoKSkpLnRoZW4oKHQ9Pntjb25zdCBpPVdhKHQpLHttZXRhZGF0YTpufT1pLnNjaGVtYTtsZXQgcjtPYmplY3Qua2V5cyhlKS5sZW5ndGgscj1KYShlLHQpO2NvbnN0IHM9S2Eocik7cmV0dXJuW2Qocixbcl0pLG4sc119KSkpLHJ1bl90cmFuc2Zvcm1zKHQsZSl7Y29uc29sZS5sb2coInRyYW5zZm9ybWluZyIpO2NvbnN0IGk9SmEodCxlKSxuPUthKGkpO3JldHVybltkKGksW2ldKSxuXX19KX0oKTsK",mb="undefined"!=typeof window&&window.Blob&&new Blob([atob(pb)],{type:"text/javascript;charset=utf-8"});function bb(){const t=mb&&(window.URL||window.webkitURL).createObjectURL(mb);try{return t?new Worker(t,{}):new Worker("data:application/javascript;base64,"+pb,{type:"module"})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}class fb extends class{}{constructor(){super(),this._children=[],this.max_ix=void 0,this.promise=Promise.resolve(),this.download_state="Unattempted"}get children(){return this._children}get dictionary_lookups(){return this.parent.dictionary_lookups}download(){throw new Error("Not implemented")}is_visible(t,e){if(void 0===this.min_ix)return!1;if(this.min_ix>t)return!1;const n=this.extent;return!(n.x[0]>e.x[1]||n.x[1]<e.x[0]||n.y[0]>e.y[1]||n.y[1]<e.y[0])}get tileWorker(){return this.parent.tileWorker}get needed_mutations(){this._current_mutations=this._current_mutations||{};const t={};for(const[e,n]of Object.entries(this.mutations)){n!==this._current_mutations[e]&&(t[e]=n)}return t}apply_mutations_once(){const{needed_mutations:t}=this;return 0===Object.keys(t).length?Promise.resolve("complete"):void 0===t?Promise.resolve("deferred"):this.extend_promise((()=>(this._table=void 0,this.tileWorker.run_transforms(t,sb(this._table_buffer,[this._table_buffer])).then((([e,n])=>(this._table_buffer=e,Object.assign(this._current_mutations,t),this.local_dictionary_lookups=n,this.update_master_dictionary_lookups(),"changed"))))))}*points(t,e=!1){if(this.is_visible(1e100,t)){for(const e of this)Xb([e.x,e.y],t)&&(yield e);if(0==e){for(const n of this.children)if(n.ready)for(const i of n.points(t,e))Xb([i.x,i.y],t)&&(yield i)}else{let n=this.children.map((n=>{const i={t:n,iterator:n.points(t,e),next:void 0};return i.next=i.iterator.next(),i}));for(n=n.filter((t=>{var e;return null==(e=null==t?void 0:t.next)?void 0:e.value}));n.length>0;){let t=0;for(let e=1;e<n.length;e++)n[e].next.value.ix<n[t].next.value.ix&&(t=e);yield n[t].next.value,n[t].next=n[t].iterator.next(),n[t].next.done&&(n=n.splice(t,1))}}}}forEach(t){for(const e of this.points())void 0!==e&&t(e)}set highest_known_ix(t){(null==this._highest_known_ix||this._highest_known_ix<t)&&(this._highest_known_ix=t,this.parent&&(this.parent.highest_known_ix=t))}get highest_known_ix(){return this._highest_known_ix}get table(){if(this._table)return this._table;if(this._table_buffer&&this._table_buffer.byteLength>0)return this._table=Em(this._table_buffer);throw new Error("Attempted to access table on tile without table buffer.")}get min_ix(){return void 0!==this._min_ix?this._min_ix:this.parent?this.parent.max_ix+1:void 0}async schema(){return await this.download(),this._schema}extend_promise(t){return this.promise=this.promise.then((()=>t())),this.promise}get ready(){return this._table_buffer&&this._table_buffer.byteLength>0}get _schema(){if(this.__schema)return this.__schema;const t=[];for(const e of this.table.schema.fields){const{name:n,type:i}=e;console.log({type:i,id:i.typeId}),5==(null==i?void 0:i.typeId)&&t.push({name:n,type:"string",extent:[]}),i&&i.dictionary&&t.push({name:n,type:"dictionary",keys:this.table.getChild(n).data[0].dictionary.toArray(),extent:[-2047,this.table.getChild(n).data[0].dictionary.length-2047]}),i&&8==i.typeId&&(console.log(i),t.push({name:n,type:"date",extent:Vt(this.table.getChild(n).data[0].values)})),i&&3==i.typeId&&(console.log({type:i}),t.push({name:n,type:"float",extent:Vt(this.table.getChild(n).data[0].values)}))}return this.__schema=t,t}*yielder(){for(const t of this.table)t&&(yield t)}update_master_dictionary_lookups(){const t=this.local_dictionary_lookups;for(const[e,n]of Object.entries(t)){this.dictionary_lookups[e]=this.dictionary_lookups[e]||new Map;const t=this.dictionary_lookups[e];let i=0;for(const[l,a]of n.entries())t.has(a)||(i=t.size/2,t.set(i,a),t.set(a,i)),this.dictionary_lookups[e]}this.dictionary_lookups}get theoretical_extent(){const t=this.root_extent,[e,n,i]=this.codes,l=(t.x[1]-t.x[0])/2**e,a=(t.y[1]-t.y[0])/2**e;return{x:[t.x[0]+n*l,t.x[0]+(n+1)*l],y:[t.y[0]+i*a,t.y[0]+(i+1)*a]}}get extent(){return this._extent?this._extent:this.theoretical_extent}get mutations(){return this.parent.mutations}[Symbol.iterator](){return this.yielder()}count(...t){const e=[];for(const i of t){const t=this.table.getChild(i);t&&e.push(t)}const n=new hb;for(let i=0;i<this.table.data[0].length;i++){const t=e.map((t=>t.get(i)));n.inc(...t)}return n}get root_extent(){return void 0===this.parent?{x:[-1/0,1/0],y:[-1/0,1/0]}:this.parent.root_extent}}class yb extends fb{constructor(t,e,n,i){super(),this._mutations=new Map,this._children=[],this._already_called=!1,this.child_locations=[],this.url=t,this.parent=n,void 0===n&&(this._mutations=i.mutate),this.key=e;const[l,a,r]=e.split("/").map((t=>parseInt(t)));this.codes=[l,a,r],this.class=new.target}async download_to_depth(t,e={x:[-1,1],y:[-1,1]},n=!1){if(console.log("Downloading"),!this.is_visible(t,e))return[];if(this.max_ix<t&&n){const n=this.children.map((t=>t.download()));if(this.children.length)for(const i of this._children)n.concat(i.download_to_depth(t,e,!1));return Promise.all(n)}if(await this.download(),this.max_ix<t&&this.is_visible(t,e)&&n){const n=this._children.map((n=>n.download_to_depth(t,e)));return Promise.all(n).then((t=>this))}return this}download(){if(this._download)return this._download;if(this._already_called)throw"Illegally attempting to download twice";this._already_called=!0;const t=this.url.match("//")?`${this.url}/${this.key}.feather`:`${window.location.origin}/${this.url}/${this.key}.feather`;return this.download_state="In progress",this._download=this.tileWorker.fetch(t,this.needed_mutations).then((([t,e,n])=>{this.download_state="Complete",this._current_mutations=JSON.parse(JSON.stringify(this.needed_mutations)),this._table_buffer=t,this._table=Em(t),this._extent=JSON.parse(e.get("extent")),this.child_locations=JSON.parse(e.get("children"));const i=this.table.getChild("ix");if(null===i)throw"No ix column in table";return this._min_ix=Number(i.get(0)),this.max_ix=Number(i.get(i.length-1)),this.highest_known_ix=this.max_ix,this._current_mutations=JSON.parse(JSON.stringify(this.needed_mutations)),this.local_dictionary_lookups=n,this.update_master_dictionary_lookups(),this.table})).catch((t=>{throw this.download_state="Failed",console.error(`Error: Remote Tile at ${this.url}/${this.key}.feather not found.\n        \n        `),t})),this._download}get children(){if("Complete"!==this.download_state)return[];if(this._children.length<this.child_locations.length)for(const t of this.child_locations)this._children.push(new this.class(this.url,t,this));return this._children}}class Zb extends yb{constructor(t,e={}){let n;if(t.match(/(\/[0-9]+){3}/)){const e=t.split("/");t=e.slice(0,-3).join("/"),n=e.slice(-3).join("/")}else n="0/0/0";super(t,n,void 0,e),this.key="0/0/0",this.extend_promise((()=>this.download())),this._min_ix=1}get root_extent(){return this._extent?this._extent:{x:[parseFloat("-inf"),parseFloat("inf")],y:[parseFloat("-inf"),parseFloat("inf")]}}log_tiles(t=1,e=(t=>`${t.children.length}`)){const n=[],i=Nt(2**t);for(const l of i){n[l]=[];for(const t of i)n[l][t]=" ";n[l][2**t]="|"}n[2**t]=Array(2**t+1).fill("-"),this.visit((i=>{const[l,a,r]=i.key.split("/").map((t=>+t));l===t&&(n[r][a]="_",n[r][a]=e(i))}))}download_most_needed_tiles(t,e,n=4){this._download_queue||(this._download_queue=new Set);const i=this._download_queue;if(i.size>=n)return;const l=[];for(this.visit((function(e){if("Unattempted"===e.download_state){const n=function(t,e){const n=t.extent;if(void 0===e.x||void 0===e.y)throw"no corners";if(n.x[0]>e.x[1]||n.x[1]<e.x[0]||n.y[0]>e.y[1]||n.y[1]<e.y[0])return 0;const i={x:[Lt([e.x[0],n.x[0]]),Ht([e.x[1],n.x[1]])],y:[Lt([e.y[0],n.y[0]]),Ht([e.y[1],n.y[1]])]},{x:l,y:a}=i;let r=0;l[0]>l[1]&&(r-=1);a[0]>a[1]&&(r-=2);if(r<0)return r;return Gb(i)/Gb(e)}(e,t);l.push([n,e,t])}})),l.sort(((t,e)=>t[0]-e[0]));l.length&&i.size<n;){const t=l.pop();if(void 0===t)throw new Error("Ran out of tiles unexpectedly");const[n,a,r]=t;a.min_ix&&a.min_ix>e||n<=0||(i.add(a.key),a.download().catch((t=>{throw console.warn("Error on",a.key),i.delete(a.key),t})).then((()=>i.delete(a.key))))}}get children(){if("Complete"!==this.download_state)return[];if(this._children.length<this.child_locations.length)for(const t of this.child_locations)this._children.push(new yb(this.url,t,this,{}));return this._children}get mutations(){return this._mutations?this._mutations:this._mutations=new Map}findPoint(t){return this.map((t=>t)).filter((e=>e.ready&&e.table&&e.min_ix<=t&&e.max_ix>=t)).map((e=>{const n=Gt([...e.table.getChild("ix").data[0].values],t);return e.table.get(n)&&e.table.get(n).ix===t?e.table.get(n):null})).filter((t=>t))}apply_mutations(t,e=!1){Object.assign(this.mutations,t);const n=this.map((e=>e.apply_mutations_once(t)));return e?n:Promise.all(n)}get dictionary_lookups(){return this._dictionary_lookups?this._dictionary_lookups:this._dictionary_lookups={}}get tileWorker(){if(void 0!==this._tileWorkers)return this._tileWorkers.unshift(this._tileWorkers.pop()),this._tileWorkers[0];this._tileWorkers=[];for(const t of Nt(4))this._tileWorkers.push(ib(new bb));return this._tileWorkers[0]}map(t,e=!1){const n=[];return this.visit((e=>{n.push(t(e))}),e=e),n}visit(t,e=!1,n=(()=>!0)){const i=[this],l=[];let a;for(;a=i.shift();)e?l.push(a):t(a),n(a)&&"Complete"==a.download_state&&i.push(...a.children);if(e)for(;a=l.pop();)t(a)}}function Xb(t,e){return void 0===e||t[0]<e.x[1]&&t[0]>e.x[0]&&t[1]<e.y[1]&&t[1]>e.y[0]}function Gb(t){return(t.x[1]-t.x[0])*(t.y[1]-t.y[0])}const Vb=[{id:"canvas-2d-background",nodetype:"canvas"},{id:"webgl-canvas",nodetype:"canvas"},{id:"canvas-2d",nodetype:"canvas"},{id:"deepscatter-svg",nodetype:"svg"}];module.exports=class{constructor(t,e,n){this.bound=!1,void 0!==t&&this.bind(t,e,n),this.width=e,this.height=n,this.ready=Promise.resolve(),this.d3={select:mt}}bind(t,e,n){if(this.div=mt(t).selectAll("div.deepscatter_container").data([1]).join("div").attr("class","deepscatter_container").style("position","absolute"),this.div.empty())throw console.error(t),"Must pass a valid div selector";this.elements=[],this.prefs={zoom_balance:.35,duration:2,point_size:1,alpha:.4,click_function:"alert(`You clicked on a point with data ${JSON.stringify(datum)}`)"};for(const i of Vb){const t=this.div.append("div").attr("id",`container-for-${i.id}`).style("position","absolute").style("top",0).style("left",0).style("pointer-events","deepscatter-svg"===i.id?"auto":"none");t.append(i.nodetype).attr("id",i.id).attr("width",e||window.innerWidth).attr("height",n||window.innerHeight),this.elements.push(t)}this.bound=!0}async reinitialize(){const{prefs:t}=this;this._root=new Zb(this.source_url,t),await this._root.download(),this._renderer=new ts("#container-for-webgl-canvas",this._root,this),this._zoom=new Ea("#deepscatter-svg",this.prefs),this._zoom.attach_tiles(this._root),this._zoom.attach_renderer("regl",this._renderer),this._zoom.initialize_zoom();const e=mt("#container-for-canvas-2d-background").select("canvas").node().getContext("2d");return e.fillStyle=t.background_color||"rgba(133, 133, 111, .8)",e.fillRect(0,0,2*window.innerWidth,2*window.innerHeight),this._renderer.initialize(),this.ready=this._root.promise,this.ready}visualize_tiles(){const t=this,e=t.elements[2].selectAll("canvas").node().getContext("2d");e.clearRect(0,0,1e4,1e4);const{x_:n,y_:i}=t._zoom.scales();e.strokeStyle="#888888";const l=t._root.map((t=>t));for(const a of Nt(13))setTimeout((()=>{for(const t of l){if(t.codes[0]!=a)continue;if(!t.extent)continue;const[l,r]=t.extent.x.map((t=>n(t))),[o,s]=t.extent.y.map((t=>i(t))),d=t.codes[0];e.lineWidth=8/Math.sqrt(d),e.globalAlpha=.33,e.strokeRect(l,o,r-l,s-o),"Unattempted"!==t.download_state&&e.fillRect(l,o,r-l,s-o),e.globalAlpha=1}}),400*a)}update_prefs(t){for(const e in["jitter","alpha","max_points"])t[`last_${e}`]=this.prefs[e]||void 0;if(this.prefs.encoding&&t.encoding)for(const e of Object.keys(this.prefs.encoding))t.encoding[e]&&(this.prefs.encoding[e]=t.encoding[e]);pn(this.prefs,t)}set tooltip_html(t){this._zoom?this._zoom._tooltip_html_function=t:setTimeout((()=>this.tooltip_html=t),100)}get tooltip_html(){return this._zoom.tooltip_html}async plotAPI(t){if(null==t)return Promise.resolve(1);if(this.update_prefs(t),t.lookup_tables){const e=[];this.lookup_promises=this.lookup_promises||new Map;for(const n of t.lookup_tables)this.lookup_promises.get(n)||e.push(this.load_lookup_table(n));await Promise.all(e)}t.source_url&&t.source_url!==this.source_url&&(this.source_url=t.source_url,await this.reinitialize()),t.basemap_gleofeather&&(t.polygons=[{file:t.basemap_gleofeather}]),await this._root.promise,t.mutate&&this._root.apply_mutations(t.mutate);const{width:e,height:n}=this;this.update_prefs(t),void 0!==t.zoom&&(null===t.zoom?(this._zoom.zoom_to(1,e/2,n/2),t.zoom=void 0):t.zoom.bbox&&this._zoom.zoom_to_bbox(t.zoom.bbox,t.duration)),this._renderer.most_recent_restart=Date.now(),this._renderer.aes.apply_encoding(t.encoding),this._renderer.apply_webgl_scale&&this._renderer.apply_webgl_scale(t),this._renderer.reglframe&&(this._renderer.reglframe.cancel(),this._renderer.reglframe=void 0),this._renderer.reglframe=this._renderer.regl.frame((()=>{this._renderer.tick("Basic")})),this._zoom.restart_timer(6e4)}async root_table(){return!!this._root&&this._root.table}get query(){const t=JSON.parse(JSON.stringify(this.prefs));return t.zoom={bbox:this._renderer.zoom.current_corners()},t}top_n_points(t=20){const{_root:e,_renderer:n}=this,i=n.zoom.current_corners(),l=[],a=n.aes.filter.current.get_function(),r=n.aes.filter2.current.get_function();for(const o of e.points(i,!0))if(a(o)&&r(o)&&l.push(o),l.length>=t)return l;return l}drawContours(t,e){const n=(e||mt("body")).select("#canvas-2d").node().getContext("2d");for(const i of t){n.fillStyle="rgba(25, 25, 29, 1)",n.fillRect(0,0,2*window.innerWidth,2*window.innerHeight),n.strokeStyle="#8a0303",n.fillStyle="rgba(30, 30, 34, 1)",n.lineWidth=Lt([.45,.25*Math.exp(Math.log(this._zoom.transform.k/2))]);const t=ln(sn().scale(this._zoom.transform.k).translate([this._zoom.transform.x,this._zoom.transform.y]),n);n.beginPath(),t(i),n.fill()}}contours(t){const e=this._renderer.calculate_contours(t),{x:n,y:i,x_:l,y_:a}=this._zoom.scales();!function t(e){if(e){if(e.coordinates)return t(e.coordinates);if(e.length){if(e[0].length)return e.map(t);e[0]=n(l.invert(e[0])),e[1]=i(a.invert(e[1]))}}}(e),this.drawContours(e)}};
